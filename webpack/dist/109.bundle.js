"use strict";(self.webpackChunkmonaco_custom_bundle=self.webpackChunkmonaco_custom_bundle||[]).push([[109],{44109:(e,t,i)=>{i.r(t),i.d(t,{default:()=>fa}),i(29769);var s=i(97108),n=i(29250),o=i(80855),r=i(56346),a=i(74741),c=i(9488),d=i(15393),l=i(71050),u=i(59523),h=i(17301),g=i(4669),p=i(5976),b=i(36248),m=i(14603),f=i(98e3),v=i(65520),w=i(63580),S=i(94565),C=i(33108),k=i(93983),y=i(97103),D=(i(49953),i(75761)),x=i(72065),I=i(59422),E=i(41157),N=i(48205),T=i(40382),L=i(33425),_=i(8321),A=i(97295),M=i(72042),B=i(81294),R=i(89872);let F=class{constructor(e,t){this.breakpointContribution=e,this.contextKeyService=t,this.breakpointsWhen="string"==typeof e.when?k.Ao.deserialize(e.when):void 0}get language(){return this.breakpointContribution.language}get enabled(){return!this.breakpointsWhen||this.contextKeyService.contextMatchesRules(this.breakpointsWhen)}};F=(0,o.g)([(0,o.f)(1,k.i6)],F);var V=i(98401),P=i(44474),O=i(71765),W=i(70666),H=i(66663),$=i(6684),U=i(46445),q=i(78787);let z=class{constructor(e,t,i,s,n,o,r,a,c){this.adapterManager=e,this.configurationService=s,this.resourcePropertiesService=n,this.configurationResolverService=o,this.environmentService=r,this.debugService=a,this.contextKeyService=c,this.mergedExtensionDescriptions=[],this.debuggerContribution={type:t.type},this.merge(t,i),this.debuggerWhen="string"==typeof this.debuggerContribution.when?k.Ao.deserialize(this.debuggerContribution.when):void 0}merge(e,t){this.mergedExtensionDescriptions.indexOf(t)<0&&(this.mergedExtensionDescriptions.push(t),function e(t,i,s,n=0){return(0,V.Kn)(t)?((0,V.Kn)(i)&&Object.keys(i).forEach((o=>{"__proto__"!==o&&((0,V.Kn)(t[o])&&(0,V.Kn)(i[o])?e(t[o],i[o],s,n+1):o in t?s&&(0===n&&"type"===o||(t[o]=i[o])):t[o]=i[o])})),t):i}(this.debuggerContribution,e,t.isBuiltin),(0,$.b3)(e)&&(this.mainExtensionDescription=t))}async startDebugging(e,t){const i=this.debugService.getModel().getSession(t);return await this.debugService.startDebugging(void 0,e,{parentSession:i},void 0)}async createDebugAdapter(e){await this.adapterManager.activateDebuggers("onDebugAdapterProtocolTracker",this.type);const t=this.adapterManager.createDebugAdapter(e);if(t)return Promise.resolve(t);throw new Error(w.NC("cannot.find.da","Cannot find debug adapter for type '{0}'.",this.type))}async substituteVariables(e,t){const i=await this.adapterManager.substituteVariables(this.type,e,t);return await this.configurationResolverService.resolveWithInteractionReplace(e,i,"launch",this.variables,i.__configurationTarget)}runInTerminal(e,t){return this.adapterManager.runInTerminal(this.type,e,t)}get label(){return this.debuggerContribution.label||this.debuggerContribution.type}get type(){return this.debuggerContribution.type}get variables(){return this.debuggerContribution.variables}get configurationSnippets(){return this.debuggerContribution.configurationSnippets}get languages(){return this.debuggerContribution.languages}get when(){return this.debuggerWhen}get enabled(){return!this.debuggerWhen||this.contextKeyService.contextMatchesRules(this.debuggerWhen)}get strings(){return this.debuggerContribution.strings??this.debuggerContribution.uiMessages}interestedInLanguage(e){return!!(this.languages&&this.languages.indexOf(e)>=0)}hasInitialConfiguration(){return!!this.debuggerContribution.initialConfigurations}hasConfigurationProvider(){return this.debugService.getConfigurationManager().hasDebugConfigurationProvider(this.type)}getInitialConfigurationContent(e){let t=this.debuggerContribution.initialConfigurations||[];e&&(t=t.concat(e));const i="\r\n"===this.resourcePropertiesService.getEOL(W.ov.from({scheme:H.lg.untitled,path:"1"}))?"\r\n":"\n",s=JSON.stringify(t,null,"\t").split("\n").map((e=>"\t"+e)).join(i).trim();let n=["{",`\t// ${w.NC("launch.config.comment1","Use IntelliSense to learn about possible attributes.")}`,`\t// ${w.NC("launch.config.comment2","Hover to view descriptions of existing attributes.")}`,`\t// ${w.NC("launch.config.comment3","For more information, visit: {0}","https://go.microsoft.com/fwlink/?linkid=830387")}`,'\t"version": "0.2.0",',`\t"configurations": ${s}`,"}"].join(i);const o=this.configurationService.getValue();return o.editor&&o.editor.insertSpaces&&(n=n.replace(new RegExp("\t","g")," ".repeat(o.editor.tabSize))),Promise.resolve(n)}getMainExtensionDescriptor(){return this.mainExtensionDescription||this.mergedExtensionDescriptions[0]}getCustomTelemetryEndpoint(){const e=this.debuggerContribution.aiKey;if(!e)return;const t="other"!==(0,U.x0)(this.environmentService.remoteAuthority);return{id:`${this.getMainExtensionDescriptor().publisher}.${this.type}`,aiKey:e,sendErrorTelemetry:t}}getSchemaAttributes(e){return this.debuggerContribution.configurationAttributes?Object.keys(this.debuggerContribution.configurationAttributes).map((t=>{const i=`${this.type}:${t}`,s=`${this.type}:${t}:platform`,o=this.debuggerContribution.configurationAttributes[t],r=["name","type","request"];o.required=o.required&&o.required.length?r.concat(o.required):r,o.additionalProperties=!1,o.type="object",o.properties||(o.properties={});const a=o.properties;a.type={enum:[this.type],enumDescriptions:[this.label],description:w.NC("debugType","Type of configuration."),pattern:"^(?!node2)",deprecationMessage:this.debuggerContribution.deprecated||(this.enabled?void 0:(0,n.RB)(this.type)),doNotSuggest:!!this.debuggerContribution.deprecated,errorMessage:w.NC("debugTypeNotRecognised","The debug type is not recognized. Make sure that you have a corresponding debug extension installed and that it is enabled."),patternErrorMessage:w.NC("node2NotSupported",'"node2" is no longer supported, use "node" instead and set the "protocol" attribute to "inspector".')},a.request={enum:[t],description:w.NC("debugRequest",'Request type of configuration. Can be "launch" or "attach".')};for(const t in e.common.properties)a[t]={$ref:`#/definitions/common/properties/${t}`};Object.keys(a).forEach((e=>{var t;(t=a[e]).pattern=t.pattern||"^(?!.*\\$\\{(env|config|command)\\.)",t.patternErrorMessage=t.patternErrorMessage||w.NC("deprecatedVariables","'env.', 'config.' and 'command.' are deprecated, use 'env:', 'config:' and 'command:' instead.")})),e[i]={...o},e[s]={type:"object",additionalProperties:!1,properties:(0,b.hX)(a,(e=>"type"!==e&&"request"!==e&&"name"!==e))};const c={...o};return c.properties={...a,windows:{$ref:`#/definitions/${s}`,description:w.NC("debugWindowsConfiguration","Windows specific launch configuration attributes.")},osx:{$ref:`#/definitions/${s}`,description:w.NC("debugOSXConfiguration","OS X specific launch configuration attributes.")},linux:{$ref:`#/definitions/${s}`,description:w.NC("debugLinuxConfiguration","Linux specific launch configuration attributes.")}},c})):null}};z=(0,o.g)([(0,o.f)(3,C.Ui),(0,o.f)(4,O.y),(0,o.f)(5,P.qb),(0,o.f)(6,q.n),(0,o.f)(7,n.tn),(0,o.f)(8,k.i6)],z);var j=i(26963),K=i(10469);const G=w.NC("JsonSchema.input.id","The input's id is used to associate an input with a variable of the form ${input:id}."),Q=w.NC("JsonSchema.input.type","The type of user input prompt to use."),J=w.NC("JsonSchema.input.description","The description is shown when the user is prompted for input."),X=w.NC("JsonSchema.input.default","The default value for the input."),Z={definitions:{inputs:{type:"array",description:w.NC("JsonSchema.inputs","User inputs. Used for defining user input prompts, such as free string input or a choice from several options."),items:{oneOf:[{type:"object",required:["id","type","description"],additionalProperties:!1,properties:{id:{type:"string",description:G},type:{type:"string",description:Q,enum:["promptString"],enumDescriptions:[w.NC("JsonSchema.input.type.promptString","The 'promptString' type opens an input box to ask the user for input.")]},description:{type:"string",description:J},default:{type:"string",description:X},password:{type:"boolean",description:w.NC("JsonSchema.input.password","Controls if a password input is shown. Password input hides the typed text.")}}},{type:"object",required:["id","type","description","options"],additionalProperties:!1,properties:{id:{type:"string",description:G},type:{type:"string",description:Q,enum:["pickString"],enumDescriptions:[w.NC("JsonSchema.input.type.pickString","The 'pickString' type shows a selection list.")]},description:{type:"string",description:J},default:{type:"string",description:X},options:{type:"array",description:w.NC("JsonSchema.input.options","An array of strings that defines the options for a quick pick."),items:{oneOf:[{type:"string"},{type:"object",required:["value"],additionalProperties:!1,properties:{label:{type:"string",description:w.NC("JsonSchema.input.pickString.optionLabel","Label for the option.")},value:{type:"string",description:w.NC("JsonSchema.input.pickString.optionValue","Value for the option.")}}}]}}}},{type:"object",required:["id","type","command"],additionalProperties:!1,properties:{id:{type:"string",description:G},type:{type:"string",description:Q,enum:["command"],enumDescriptions:[w.NC("JsonSchema.input.type.command","The 'command' type executes a command.")]},command:{type:"string",description:w.NC("JsonSchema.input.command.command","The command to execute for this input variable.")},args:{oneOf:[{type:"object",description:w.NC("JsonSchema.input.command.args","Optional arguments passed to the command.")},{type:"array",description:w.NC("JsonSchema.input.command.args","Optional arguments passed to the command.")},{type:"string",description:w.NC("JsonSchema.input.command.args","Optional arguments passed to the command.")}]}}}]}}}},Y=j.ut.registerExtensionPoint({extensionPoint:"debuggers",defaultExtensionKind:["workspace"],jsonSchema:{description:w.NC("vscode.extension.contributes.debuggers","Contributes debug adapters."),type:"array",defaultSnippets:[{body:[{type:""}]}],items:{additionalProperties:!1,type:"object",defaultSnippets:[{body:{type:"",program:"",runtime:""}}],properties:{type:{description:w.NC("vscode.extension.contributes.debuggers.type","Unique identifier for this debug adapter."),type:"string"},label:{description:w.NC("vscode.extension.contributes.debuggers.label","Display name for this debug adapter."),type:"string"},program:{description:w.NC("vscode.extension.contributes.debuggers.program","Path to the debug adapter program. Path is either absolute or relative to the extension folder."),type:"string"},args:{description:w.NC("vscode.extension.contributes.debuggers.args","Optional arguments to pass to the adapter."),type:"array"},runtime:{description:w.NC("vscode.extension.contributes.debuggers.runtime","Optional runtime in case the program attribute is not an executable but requires a runtime."),type:"string"},runtimeArgs:{description:w.NC("vscode.extension.contributes.debuggers.runtimeArgs","Optional runtime arguments."),type:"array"},variables:{description:w.NC("vscode.extension.contributes.debuggers.variables","Mapping from interactive variables (e.g. ${action.pickProcess}) in `launch.json` to a command."),type:"object"},initialConfigurations:{description:w.NC("vscode.extension.contributes.debuggers.initialConfigurations","Configurations for generating the initial 'launch.json'."),type:["array","string"]},languages:{description:w.NC("vscode.extension.contributes.debuggers.languages",'List of languages for which the debug extension could be considered the "default debugger".'),type:"array"},configurationSnippets:{description:w.NC("vscode.extension.contributes.debuggers.configurationSnippets","Snippets for adding new configurations in 'launch.json'."),type:"array"},configurationAttributes:{description:w.NC("vscode.extension.contributes.debuggers.configurationAttributes","JSON schema configurations for validating 'launch.json'."),type:"object"},when:{description:w.NC("vscode.extension.contributes.debuggers.when","Condition which must be true to enable this type of debugger. Consider using 'shellExecutionSupported', 'virtualWorkspace', 'resourceScheme' or an extension-defined context key as appropriate for this."),type:"string",default:""},deprecated:{description:w.NC("vscode.extension.contributes.debuggers.deprecated","Optional message to mark this debug type as being deprecated."),type:"string",default:""},windows:{description:w.NC("vscode.extension.contributes.debuggers.windows","Windows specific settings."),type:"object",properties:{runtime:{description:w.NC("vscode.extension.contributes.debuggers.windows.runtime","Runtime used for Windows."),type:"string"}}},osx:{description:w.NC("vscode.extension.contributes.debuggers.osx","macOS specific settings."),type:"object",properties:{runtime:{description:w.NC("vscode.extension.contributes.debuggers.osx.runtime","Runtime used for macOS."),type:"string"}}},linux:{description:w.NC("vscode.extension.contributes.debuggers.linux","Linux specific settings."),type:"object",properties:{runtime:{description:w.NC("vscode.extension.contributes.debuggers.linux.runtime","Runtime used for Linux."),type:"string"}}},strings:{description:w.NC("vscode.extension.contributes.debuggers.strings","UI strings contributed by this debug adapter."),type:"object",properties:{unverifiedBreakpoints:{description:w.NC("vscode.extension.contributes.debuggers.strings.unverifiedBreakpoints","When there are unverified breakpoints in a language supported by this debug adapter, this message will appear on the breakpoint hover and in the breakpoints view. Markdown and command links are supported."),type:"string"}}}}}}}),ee=j.ut.registerExtensionPoint({extensionPoint:"breakpoints",jsonSchema:{description:w.NC("vscode.extension.contributes.breakpoints","Contributes breakpoints."),type:"array",defaultSnippets:[{body:[{language:""}]}],items:{type:"object",additionalProperties:!1,defaultSnippets:[{body:{language:""}}],properties:{language:{description:w.NC("vscode.extension.contributes.breakpoints.language","Allow breakpoints for this language."),type:"string"},when:{description:w.NC("vscode.extension.contributes.breakpoints.when","Condition which must be true to enable breakpoints in this language. Consider matching this to the debugger when clause as appropriate."),type:"string",default:""}}}}}),te={type:"object",description:w.NC("presentation","Presentation options on how to show this configuration in the debug configuration dropdown and the command palette."),properties:{hidden:{type:"boolean",default:!1,description:w.NC("presentation.hidden","Controls if this configuration should be shown in the configuration dropdown and the command palette.")},group:{type:"string",default:"",description:w.NC("presentation.group","Group that this configuration belongs to. Used for grouping and sorting in the configuration dropdown and the command palette.")},order:{type:"number",default:1,description:w.NC("presentation.order","Order of this configuration within a group. Used for grouping and sorting in the configuration dropdown and the command palette.")}},default:{hidden:!1,group:"",order:1}},ie={name:"Compound",configurations:[]},se={id:K.yY,type:"object",title:w.NC("app.launch.json.title","Launch"),allowTrailingCommas:!0,allowComments:!0,required:[],default:{version:"0.2.0",configurations:[],compounds:[]},properties:{version:{type:"string",description:w.NC("app.launch.json.version","Version of this file format."),default:"0.2.0"},configurations:{type:"array",description:w.NC("app.launch.json.configurations","List of configurations. Add new configurations or edit existing ones by using IntelliSense."),items:{defaultSnippets:[],type:"object",oneOf:[]}},compounds:{type:"array",description:w.NC("app.launch.json.compounds","List of compounds. Each compound references multiple configurations which will get launched together."),items:{type:"object",required:["name","configurations"],properties:{name:{type:"string",description:w.NC("app.launch.json.compound.name","Name of compound. Appears in the launch configuration drop down menu.")},presentation:te,configurations:{type:"array",default:[],items:{oneOf:[{enum:[],description:w.NC("useUniqueNames","Please use unique configuration names.")},{type:"object",required:["name"],properties:{name:{enum:[],description:w.NC("app.launch.json.compound.name","Name of compound. Appears in the launch configuration drop down menu.")},folder:{enum:[],description:w.NC("app.launch.json.compound.folder","Name of folder in which the compound is located.")}}}]},description:w.NC("app.launch.json.compounds.configurations","Names of configurations that will be started as part of this compound.")},stopAll:{type:"boolean",default:!1,description:w.NC("app.launch.json.compound.stopAll","Controls whether manually terminating one session will stop all of the compound sessions.")},preLaunchTask:{type:"string",default:"",description:w.NC("compoundPrelaunchTask","Task to run before any of the compound configurations start.")}},default:ie},default:[ie]},inputs:Z.definitions.inputs}};var ne=i(44827),oe=i(24448),re=i(12021),ae=i(22384),ce=i(76446);const de=R.B.as(B.I.JSONContribution);let le=class extends p.JT{constructor(e,t,i,s,o,r,a,c,d,l,u){super(),this.editorService=t,this.configurationService=i,this.quickInputService=s,this.instantiationService=o,this.commandService=r,this.extensionService=a,this.contextKeyService=c,this.languageService=d,this.dialogService=l,this.lifecycleService=u,this.debugAdapterFactories=new Map,this._onDidRegisterDebugger=new g.Q5,this._onDidDebuggersExtPointRead=new g.Q5,this.breakpointContributions=[],this.debuggerWhenKeys=new Set,this.usedDebugTypes=new Set,this.adapterDescriptorFactories=[],this.debuggers=[],this.registerListeners(),this.contextKeyService.bufferChangeEvents((()=>{this.debuggersAvailable=n.Qe.bindTo(c),this.debugExtensionsAvailable=n.Ju.bindTo(c)})),this._register(this.contextKeyService.onDidChangeContext((e=>{e.affectsSome(this.debuggerWhenKeys)&&(this.debuggersAvailable.set(this.hasEnabledDebuggers()),this.updateDebugAdapterSchema())}))),this._register(this.onDidDebuggersExtPointRead((()=>{this.debugExtensionsAvailable.set(this.debuggers.length>0)}))),this.lifecycleService.when(4).then((()=>this.debugExtensionsAvailable.set(this.debuggers.length>0))),this._register(e.onDidNewSession((e=>{this.usedDebugTypes.add(e.configuration.type)})))}registerListeners(){Y.setHandler(((e,t)=>{t.added.forEach((e=>{e.value.forEach((t=>{if(t.type&&"string"==typeof t.type||e.collector.error(w.NC("debugNoType","Debugger 'type' can not be omitted and must be of type 'string'.")),"*"!==t.type){const i=this.getDebugger(t.type);if(i)i.merge(t,e.description);else{const i=this.instantiationService.createInstance(z,this,t,e.description);i.when?.keys().forEach((e=>this.debuggerWhenKeys.add(e))),this.debuggers.push(i)}}}))})),e.forEach((e=>{e.value.forEach((t=>{"*"===t.type&&this.debuggers.forEach((i=>i.merge(t,e.description)))}))})),t.removed.forEach((e=>{const t=e.value.map((e=>e.type));this.debuggers=this.debuggers.filter((e=>-1===t.indexOf(e.type)))})),this.updateDebugAdapterSchema(),this._onDidDebuggersExtPointRead.fire()})),ee.setHandler((e=>{this.breakpointContributions=e.flatMap((e=>e.value.map((e=>this.instantiationService.createInstance(F,e)))))}))}updateDebugAdapterSchema(){const e=se.properties.configurations.items,t=ne.Z.getJsonSchema(),i={common:{properties:{name:{type:"string",description:w.NC("debugName","Name of configuration; appears in the launch configuration dropdown menu."),default:"Launch"},debugServer:{type:"number",description:w.NC("debugServer","For debug extension development only: if a port is specified VS Code tries to connect to a debug adapter running in server mode"),default:4711},preLaunchTask:{anyOf:[t,{type:["string"]}],default:"",defaultSnippets:[{body:{task:"",type:""}}],description:w.NC("debugPrelaunchTask","Task to run before debug session starts.")},postDebugTask:{anyOf:[t,{type:["string"]}],default:"",defaultSnippets:[{body:{task:"",type:""}}],description:w.NC("debugPostDebugTask","Task to run after debug session ends.")},presentation:te,internalConsoleOptions:n._u,suppressMultipleSessionWarning:{type:"boolean",description:w.NC("suppressMultipleSessionWarning","Disable the warning when trying to start the same debug configuration more than once."),default:!0}}}};se.definitions=i,e.oneOf=[],e.defaultSnippets=[],this.debuggers.forEach((t=>{const s=t.getSchemaAttributes(i);s&&e.oneOf&&e.oneOf.push(...s);const n=t.configurationSnippets;n&&e.defaultSnippets&&e.defaultSnippets.push(...n)})),de.registerSchema(K.yY,se)}registerDebugAdapterFactory(e,t){return e.forEach((e=>this.debugAdapterFactories.set(e,t))),this.debuggersAvailable.set(this.hasEnabledDebuggers()),this._onDidRegisterDebugger.fire(),{dispose:()=>{e.forEach((e=>this.debugAdapterFactories.delete(e)))}}}hasEnabledDebuggers(){for(const[e]of this.debugAdapterFactories){const t=this.getDebugger(e);if(t&&t.enabled)return!0}return!1}createDebugAdapter(e){const t=this.debugAdapterFactories.get(e.configuration.type);if(t)return t.createDebugAdapter(e)}substituteVariables(e,t,i){const s=this.debugAdapterFactories.get(e);return s?s.substituteVariables(t,i):Promise.resolve(i)}runInTerminal(e,t,i){const s=this.debugAdapterFactories.get(e);return s?s.runInTerminal(t,i):Promise.resolve(void 0)}registerDebugAdapterDescriptorFactory(e){return this.adapterDescriptorFactories.push(e),{dispose:()=>{this.unregisterDebugAdapterDescriptorFactory(e)}}}unregisterDebugAdapterDescriptorFactory(e){const t=this.adapterDescriptorFactories.indexOf(e);t>=0&&this.adapterDescriptorFactories.splice(t,1)}getDebugAdapterDescriptor(e){const t=e.configuration,i=this.adapterDescriptorFactories.filter((e=>e.type===t.type&&e.createDebugAdapterDescriptor));return 1===i.length?i[0].createDebugAdapterDescriptor(e):Promise.resolve(void 0)}getDebuggerLabel(e){const t=this.getDebugger(e);if(t)return t.label}get onDidRegisterDebugger(){return this._onDidRegisterDebugger.event}get onDidDebuggersExtPointRead(){return this._onDidDebuggersExtPointRead.event}canSetBreakpointsIn(e){const t=e.getLanguageId();return!(!t||"jsonc"===t||"log"===t)&&(!!this.configurationService.getValue("debug").allowBreakpointsEverywhere||this.breakpointContributions.some((e=>e.language===t&&e.enabled)))}getDebugger(e){return this.debuggers.find((t=>A.qq(t.type,e)))}getEnabledDebugger(e){const t=this.getDebugger(e);return t&&t.enabled?t:void 0}someDebuggerInterestedInLanguage(e){return!!this.debuggers.filter((e=>e.enabled)).find((t=>t.interestedInLanguage(e)))}async guessDebugger(e){const t=this.editorService.activeTextEditorControl;let i=[],s=null,n=null;if((0,v.CL)(t)){n=t.getModel();const e=n?n.getLanguageId():void 0;e&&(s=this.languageService.getLanguageName(e));const o=this.debuggers.filter((e=>e.enabled)).filter((t=>e&&t.interestedInLanguage(e)));if(1===o.length)return o[0];o.length>1&&(i=o)}if((!s||e||n&&this.canSetBreakpointsIn(n))&&0===i.length&&(await this.activateDebuggers("onDebugInitialConfigurations"),i=this.debuggers.filter((e=>e.enabled)).filter((e=>e.hasInitialConfiguration()||e.hasConfigurationProvider()))),0===i.length&&s){s.indexOf(" ")>=0&&(s=`'${s}'`);const{confirmed:e}=await this.dialogService.confirm({type:m.Z.Warning,message:w.NC("CouldNotFindLanguage","You don't have an extension for debugging {0}. Should we find a {0} extension in the Marketplace?",s),primaryButton:w.NC({key:"findExtension",comment:["&& denotes a mnemonic"]},"&&Find {0} extension",s)});return void(e&&await this.commandService.executeCommand("debug.installAdditionalDebuggers",s))}this.initExtensionActivationsIfNeeded(),i.sort(((e,t)=>e.label.localeCompare(t.label)));const o=[],r=[];i.forEach((e=>{const t=e.getMainExtensionDescriptor();t.id&&this.earlyActivatedExtensions?.has(t.id)||this.usedDebugTypes.has(e.type)?o.push(e):r.push(e)}));const a=[];o.length>0&&a.push({type:"separator",label:w.NC("suggestedDebuggers","Suggested")},...o.map((e=>({label:e.label,debugger:e})))),r.length>0&&(a.length>0&&a.push({type:"separator",label:""}),a.push(...r.map((e=>({label:e.label,debugger:e}))))),a.push({type:"separator",label:""},{label:s?w.NC("installLanguage","Install an extension for {0}...",s):w.NC("installExt","Install extension...")});const c=w.NC("selectDebug","Select debugger");return this.quickInputService.pick(a,{activeItem:a[0],placeHolder:c}).then((e=>{if(e&&e.debugger)return e.debugger;e&&this.commandService.executeCommand("debug.installAdditionalDebuggers",s)}))}initExtensionActivationsIfNeeded(){if(!this.earlyActivatedExtensions){this.earlyActivatedExtensions=new Set;const e=this.extensionService.getExtensionsStatus();for(const t in e)e[t].activationTimes&&this.earlyActivatedExtensions.add(t)}}async activateDebuggers(e,t){this.initExtensionActivationsIfNeeded();const i=[this.extensionService.activateByEvent(e),this.extensionService.activateByEvent("onDebug")];t&&i.push(this.extensionService.activateByEvent(`${e}:${t}`)),await Promise.all(i)}};le=(0,o.g)([(0,o.f)(1,oe.AR),(0,o.f)(2,C.Ui),(0,o.f)(3,E.eJ),(0,o.f)(4,x.TG),(0,o.f)(5,S.H),(0,o.f)(6,re.QS),(0,o.f)(7,k.i6),(0,o.f)(8,M.O),(0,o.f)(9,ce.Ss),(0,o.f)(10,ae.g)],le);var ue=i(67894),he=i(61683),ge=i(95935),pe=i(26904),be=i(25670),me=i(5104),fe=i(43202),ve=i(46973),we=i(5826);const Se=R.B.as(B.I.JSONContribution);Se.registerSchema(K.yY,se);const Ce="debug.selectedconfigname",ke="debug.selectedroot",ye="debug.selectedtype",De="debug.recentdynamicconfigurations";let xe=class{constructor(e,t,i,s,o,r,a,c,d,l){this.adapterManager=e,this.contextService=t,this.configurationService=i,this.quickInputService=s,this.instantiationService=o,this.storageService=r,this.extensionService=a,this.historyService=c,this.uriIdentityService=d,this.getSelectedConfig=()=>Promise.resolve(void 0),this.selectedDynamic=!1,this._onDidSelectConfigurationName=new g.Q5,this.configProviders=[],this.toDispose=[],this.initLaunches(),this.setCompoundSchemaValues(),this.registerListeners();const u=this.storageService.get(ke,1),h=this.storageService.get(ye,1),p=this.launches.find((e=>e.uri.toString()===u)),b=this.storageService.get(Ce,1);this.debugConfigurationTypeContext=n.MO.bindTo(l);const m=h?{type:h}:void 0;p&&p.getConfigurationNames().length?this.selectConfiguration(p,b,void 0,m):this.launches.length>0&&this.selectConfiguration(void 0,b,void 0,m)}registerDebugConfigurationProvider(e){return this.configProviders.push(e),{dispose:()=>{this.unregisterDebugConfigurationProvider(e)}}}unregisterDebugConfigurationProvider(e){const t=this.configProviders.indexOf(e);t>=0&&this.configProviders.splice(t,1)}hasDebugConfigurationProvider(e,t){return void 0===t&&(t=n.j4.Initial),!!this.configProviders.find((i=>i.provideDebugConfigurations&&i.type===e&&i.triggerKind===t))}async resolveConfigurationByProviders(e,t,i,s){const n=async(t,i)=>{"*"!==t&&await this.adapterManager.activateDebuggers("onDebugResolve",t);for(const n of this.configProviders)n.type===t&&n.resolveDebugConfiguration&&i&&(i=await n.resolveDebugConfiguration(e,i,s));return i};let o=i.type??t,r=i;for(let e=new Set;r&&!e.has(o);)e.add(o),r=await n(o,r),r=await n("*",r),o=r?.type??t;return r}async resolveDebugConfigurationWithSubstitutedVariables(e,t,i,s){const n=this.configProviders.filter((e=>e.type===t&&e.resolveDebugConfigurationWithSubstitutedVariables)).concat(this.configProviders.filter((e=>"*"===e.type&&e.resolveDebugConfigurationWithSubstitutedVariables)));let o=i;return await(0,d.vP)(n.map((t=>async()=>{o&&(o=await t.resolveDebugConfigurationWithSubstitutedVariables(e,o,s))}))),o}async provideDebugConfigurations(e,t,i){return await this.adapterManager.activateDebuggers("onDebugInitialConfigurations"),(await Promise.all(this.configProviders.filter((e=>e.type===t&&e.triggerKind===n.j4.Initial&&e.provideDebugConfigurations)).map((t=>t.provideDebugConfigurations(e,i))))).reduce(((e,t)=>e.concat(t)),[])}async getDynamicProviders(){await this.extensionService.whenInstalledExtensionsRegistered();const e="onDebugDynamicConfigurations";return this.extensionService.extensions.reduce(((t,i)=>{if(!i.activationEvents)return t;const s=[];let n=!1;for(const t of i.activationEvents)t===e?n=!0:t.startsWith(`${e}:`)&&s.push(t.slice(29));if(s.length)return t.concat(s);if(n){const e=i.contributes?.debuggers?.[0].type;return e?t.concat(e):t}return t}),[]).map((t=>({label:this.adapterManager.getDebuggerLabel(t),getProvider:async()=>(await this.adapterManager.activateDebuggers(e,t),this.configProviders.find((e=>e.type===t&&e.triggerKind===n.j4.Dynamic&&e.provideDebugConfigurations))),type:t,pick:async()=>{await this.adapterManager.activateDebuggers(e,t);const i=new l.A,s=[],o=this.configProviders.find((e=>e.type===t&&e.triggerKind===n.j4.Dynamic&&e.provideDebugConfigurations));this.getLaunches().forEach((e=>{e.workspace&&o&&s.push(o.provideDebugConfigurations(e.workspace.uri,i.token).then((t=>t.map((t=>({label:t.name,description:e.name,config:t,buttons:[{iconClass:be.kS.asClassName(me.us),tooltip:w.NC("editLaunchConfig","Edit Debug Configuration in launch.json")}],launch:e}))))))}));const r=new p.SL,a=r.add(this.quickInputService.createQuickPick());a.busy=!0,a.placeholder=w.NC("selectConfiguration","Select Launch Configuration");const d=new Promise((e=>{r.add(a.onDidAccept((()=>e(a.activeItems[0])))),r.add(a.onDidTriggerItemButton((async t=>{e(void 0);const{launch:i,config:s}=t.item;await i.openConfigFile({preserveFocus:!1,type:s.type,suppressInitialConfigs:!0}),await i.writeConfiguration(s),await this.selectConfiguration(i,s.name),this.removeRecentDynamicConfigurations(s.name,s.type)})))})),u=await Promise.all(s),h=(0,c.xH)(u);a.items=h,a.busy=!1,a.show();const g=await d;if(r.dispose(),g)return g;i.cancel()}})))}getAllConfigurations(){const e=[];for(const t of this.launches)for(const i of t.getConfigurationNames()){const s=t.getConfiguration(i)||t.getCompound(i);s&&e.push({launch:t,name:i,presentation:s.presentation})}return(0,$.u8)(e)}removeRecentDynamicConfigurations(e,t){const i=this.getRecentDynamicConfigurations().filter((i=>i.name!==e||i.type!==t));this.storageService.store(De,JSON.stringify(i),1,1),this.selectedConfiguration.name===e&&this.selectedType===t&&this.selectedDynamic?this.selectConfiguration(void 0,void 0):this._onDidSelectConfigurationName.fire()}getRecentDynamicConfigurations(){return JSON.parse(this.storageService.get(De,1,"[]"))}registerListeners(){this.toDispose.push(g.ju.any(this.contextService.onDidChangeWorkspaceFolders,this.contextService.onDidChangeWorkbenchState)((()=>{this.initLaunches(),this.selectConfiguration(void 0),this.setCompoundSchemaValues()}))),this.toDispose.push(this.configurationService.onDidChangeConfiguration((async e=>{e.affectsConfiguration("launch")&&(await this.selectConfiguration(void 0),this.setCompoundSchemaValues())}))),this.toDispose.push(this.adapterManager.onDidDebuggersExtPointRead((()=>{this.setCompoundSchemaValues()})))}initLaunches(){this.launches=this.contextService.getWorkspace().folders.map((e=>this.instantiationService.createInstance(Ee,this,this.adapterManager,e))),3===this.contextService.getWorkbenchState()&&this.launches.push(this.instantiationService.createInstance(Ne,this,this.adapterManager)),this.launches.push(this.instantiationService.createInstance(Te,this,this.adapterManager)),this.selectedLaunch&&-1===this.launches.indexOf(this.selectedLaunch)&&this.selectConfiguration(void 0)}setCompoundSchemaValues(){const e=se.properties.compounds.items.properties.configurations,t=this.launches.map((e=>e.getConfigurationNames(!0))).reduce(((e,t)=>e.concat(t)),[]);e.items.oneOf[0].enum=t,e.items.oneOf[1].properties.name.enum=t;const i=this.contextService.getWorkspace().folders.map((e=>e.name));e.items.oneOf[1].properties.folder.enum=i,Se.registerSchema(K.yY,se)}getLaunches(){return this.launches}getLaunch(e){if(W.ov.isUri(e))return this.launches.find((t=>t.workspace&&this.uriIdentityService.extUri.isEqual(t.workspace.uri,e)))}get selectedConfiguration(){return{launch:this.selectedLaunch,name:this.selectedName,getConfig:this.getSelectedConfig,type:this.selectedType}}get onDidSelectConfiguration(){return this._onDidSelectConfigurationName.event}getWorkspaceLaunch(){if(3===this.contextService.getWorkbenchState())return this.launches[this.launches.length-1]}async selectConfiguration(e,t,i,s){if(void 0===e){const t=this.historyService.getLastActiveWorkspaceRoot();(e=this.getLaunch(t))&&0!==e.getConfigurationNames().length||(e=this.launches.find((e=>!(!e||!e.getConfigurationNames().length)))||e||this.launches[0])}const n=this.selectedLaunch,o=this.selectedName,r=this.selectedDynamic;this.selectedLaunch=e,this.selectedLaunch?this.storageService.store(ke,this.selectedLaunch.uri.toString(),1,1):this.storageService.remove(ke,1);const a=e?e.getConfigurationNames():[];this.getSelectedConfig=()=>{const t=this.selectedName?e?.getConfiguration(this.selectedName):void 0;return Promise.resolve(t||i)};let d=i?.type;if(t&&a.indexOf(t)>=0)this.setSelectedLaunchName(t);else if(s&&s.type){if(d=s.type,!i){const i=(await this.getDynamicProviders()).filter((e=>e.type===d));this.getSelectedConfig=async()=>{const s=await Promise.all(i.map((e=>e.getProvider()))),n=s.length>0?s[0]:void 0;if(n&&e&&e.workspace){const i=new l.A,s=(await n.provideDebugConfigurations(e.workspace.uri,i.token)).find((e=>e.name===t));if(s)return s}}}this.setSelectedLaunchName(t);let n=this.getRecentDynamicConfigurations();t&&s.type&&(n.unshift({name:t,type:s.type}),n=(0,c.EB)(n,(e=>`${e.name} : ${e.type}`)),this.storageService.store(De,JSON.stringify(n),1,1))}else if(!this.selectedName||-1===a.indexOf(this.selectedName)){const e=a.length?a[0]:void 0;this.setSelectedLaunchName(e)}!i&&e&&this.selectedName&&(i=e.getConfiguration(this.selectedName),d=i?.type),this.selectedType=s?.type||i?.type,this.selectedDynamic=!!s,this.storageService.store(ye,s?this.selectedType:void 0,1,1),d?this.debugConfigurationTypeContext.set(d):this.debugConfigurationTypeContext.reset(),this.selectedLaunch===n&&this.selectedName===o&&r===this.selectedDynamic||this._onDidSelectConfigurationName.fire()}setSelectedLaunchName(e){this.selectedName=e,this.selectedName?this.storageService.store(Ce,this.selectedName,1,1):this.storageService.remove(Ce,1)}dispose(){this.toDispose=(0,p.B9)(this.toDispose)}};xe=(0,o.g)([(0,o.f)(1,T.ec),(0,o.f)(2,C.Ui),(0,o.f)(3,E.eJ),(0,o.f)(4,x.TG),(0,o.f)(5,pe.Uy),(0,o.f)(6,re.QS),(0,o.f)(7,fe.CE),(0,o.f)(8,N.v),(0,o.f)(9,k.i6)],xe);class Ie{constructor(e,t){this.configurationManager=e,this.adapterManager=t}getCompound(e){const t=this.getConfig();if(t&&t.compounds)return t.compounds.find((t=>t.name===e))}getConfigurationNames(e=!1){const t=this.getConfig();if(t&&(Array.isArray(t.configurations)||Array.isArray(t.compounds))){const i=[];return t.configurations&&i.push(...t.configurations.filter((e=>e&&"string"==typeof e.name))),e?i.map((e=>e.name)):(t.compounds&&i.push(...t.compounds.filter((e=>"string"==typeof e.name&&e.configurations&&e.configurations.length))),(0,$.u8)(i).map((e=>e.name)))}return[]}getConfiguration(e){const t=b.I8(this.getConfig());if(!t||!t.configurations)return;const i=t.configurations.find((t=>t&&t.name===e));return i&&(i.__configurationTarget=this instanceof Te?2:this instanceof Ne?5:6),i}async getInitialConfigurationContent(e,t,i,s){let n="";const o=t?this.adapterManager.getEnabledDebugger(t):await this.adapterManager.guessDebugger(!0);if(o){const t=i?await this.configurationManager.provideDebugConfigurations(e,o.type,s||l.T.None):[];n=await o.getInitialConfigurationContent(t)}return n}get hidden(){return!1}}let Ee=class extends Ie{constructor(e,t,i,s,n,o,r){super(e,t),this.workspace=i,this.fileService=s,this.textFileService=n,this.editorService=o,this.configurationService=r}get uri(){return ge.Vo(this.workspace.uri,"/.vscode/launch.json")}get name(){return this.workspace.name}getConfig(){return this.configurationService.inspect("launch",{resource:this.workspace.uri}).workspaceFolderValue}async openConfigFile({preserveFocus:e,type:t,suppressInitialConfigs:i},s){const n=this.uri;let o=!1,r="";try{r=(await this.fileService.readFile(n)).value.toString()}catch{if(r=await this.getInitialConfigurationContent(this.workspace.uri,t,!i,s),!r)return{editor:null,created:!1};o=!0;try{await this.textFileService.write(n,r)}catch(e){throw new Error(w.NC("DebugConfig.failed","Unable to create 'launch.json' file inside the '.vscode' folder ({0}).",e.message))}}const a=r.indexOf(`"${this.configurationManager.selectedConfiguration.name}"`);let c=1;for(let e=0;e<a;e++)"\n"===r.charAt(e)&&c++;const d=c>1?{startLineNumber:c,startColumn:4}:void 0,l=await this.editorService.openEditor({resource:n,options:{selection:d,preserveFocus:e,pinned:o,revealIfVisible:!0}},oe.LP);return{editor:(0,V.M2)(l),created:o}}async writeConfiguration(e){const t=b.I8(this.getConfig());t.configurations||(t.configurations=[]),t.configurations.push(e),await this.configurationService.updateValue("launch",t,{resource:this.workspace.uri},6)}};Ee=(0,o.g)([(0,o.f)(3,D.sn),(0,o.f)(4,we.MM),(0,o.f)(5,oe.AR),(0,o.f)(6,C.Ui)],Ee);let Ne=class extends Ie{constructor(e,t,i,s,n){super(e,t),this.editorService=i,this.configurationService=s,this.contextService=n}get workspace(){}get uri(){return this.contextService.getWorkspace().configuration}get name(){return w.NC("workspace","workspace")}getConfig(){return this.configurationService.inspect("launch").workspaceValue}async openConfigFile({preserveFocus:e,type:t,useInitialConfigs:i},s){if(!this.getConfig()){const e=await this.getInitialConfigurationContent(void 0,t,i,s);if(!e)return{editor:null,created:!1};await this.configurationService.updateValue("launch",he.Qc(e),5)}const n=await this.editorService.openEditor({resource:this.contextService.getWorkspace().configuration,options:{preserveFocus:e}},oe.LP);return{editor:(0,V.M2)(n),created:!1}}};Ne=(0,o.g)([(0,o.f)(2,oe.AR),(0,o.f)(3,C.Ui),(0,o.f)(4,T.ec)],Ne);let Te=class extends Ie{constructor(e,t,i,s){super(e,t),this.configurationService=i,this.preferencesService=s}get workspace(){}get uri(){return this.preferencesService.userSettingsResource}get name(){return w.NC("user settings","user settings")}get hidden(){return!0}getConfig(){return this.configurationService.inspect("launch").userValue}async openConfigFile({preserveFocus:e,type:t,useInitialContent:i}){const s=await this.preferencesService.openUserSettings({jsonEditor:!0,preserveFocus:e,revealSetting:{key:"launch"}});return{editor:(0,V.M2)(s),created:!1}}};Te=(0,o.g)([(0,o.f)(2,C.Ui),(0,o.f)(3,ve.UP)],Te);var Le=i(53060),_e=i(59870),Ae=i(35146);const Me=/range=([0-9]+):([0-9]+)/;class Be{constructor(e){this.debugService=e,this.memoryFdCounter=0,this.fdMemory=new Map,this.changeEmitter=new g.Q5,this.onDidChangeCapabilities=g.ju.None,this.onDidChangeFile=this.changeEmitter.event,this.capabilities=1028,e.onDidEndSession((e=>{for(const[t,i]of this.fdMemory)i.session===e&&this.close(t)}))}watch(e,t){if(t.recursive)return(0,p.OF)((()=>{}));const{session:i,memoryReference:s,offset:n}=this.parseUri(e),o=new p.SL;return o.add(i.onDidChangeState((()=>{3!==i.state&&0!==i.state||this.changeEmitter.fire([{type:2,resource:e}])}))),o.add(i.onDidInvalidateMemory((t=>{t.body.memoryReference===s&&(n&&(t.body.offset>=n.toOffset||t.body.offset+t.body.count<n.fromOffset)||this.changeEmitter.fire([{resource:e,type:0}]))}))),o}stat(e){const{readOnly:t}=this.parseUri(e);return Promise.resolve({type:D.Tv.File,mtime:0,ctime:0,size:0,permissions:t?D.rM.Readonly:void 0})}mkdir(){throw(0,D.BU)("Not allowed",D.bH.NoPermissions)}readdir(){throw(0,D.BU)("Not allowed",D.bH.NoPermissions)}delete(){throw(0,D.BU)("Not allowed",D.bH.NoPermissions)}rename(){throw(0,D.BU)("Not allowed",D.bH.NoPermissions)}open(e,t){const{session:i,memoryReference:s,offset:n}=this.parseUri(e),o=this.memoryFdCounter++;let r=i.getMemory(s);return n&&(r=new Re(r,n)),this.fdMemory.set(o,{session:i,region:r}),Promise.resolve(o)}close(e){return this.fdMemory.get(e)?.region.dispose(),this.fdMemory.delete(e),Promise.resolve()}async writeFile(e,t){const{offset:i}=this.parseUri(e);if(!i)throw(0,D.BU)("Range must be present to read a file",D.bH.FileNotFound);const s=await this.open(e,{create:!1});try{await this.write(s,i.fromOffset,t,0,t.length)}finally{this.close(s)}}async readFile(e){const{offset:t}=this.parseUri(e);if(!t)throw(0,D.BU)("Range must be present to read a file",D.bH.FileNotFound);const i=new Uint8Array(t.toOffset-t.fromOffset),s=await this.open(e,{create:!1});try{return await this.read(s,t.fromOffset,i,0,i.length),i}finally{this.close(s)}}async read(e,t,i,s,n){const o=this.fdMemory.get(e);if(!o)throw(0,D.BU)("No file with that descriptor open",D.bH.Unavailable);const r=await o.region.read(t,n);let a=0;for(const e of r)switch(e.type){case 1:return a;case 2:if(a>0)return a;throw(0,D.BU)(e.error,D.bH.Unknown);case 0:{const o=Math.max(0,t-e.offset),r=e.data.slice(o,Math.min(e.data.byteLength,o+(n-a)));i.set(r.buffer,s+a),a+=r.byteLength;break}default:(0,Ae.vE)(e)}return a}write(e,t,i,s,n){const o=this.fdMemory.get(e);if(!o)throw(0,D.BU)("No file with that descriptor open",D.bH.Unavailable);return o.region.write(t,Le.KN.wrap(i).slice(s,s+n))}parseUri(e){if(e.scheme!==n.Sb)throw(0,D.BU)(`Cannot open file with scheme ${e.scheme}`,D.bH.FileNotFound);const t=this.debugService.getModel().getSession(e.authority);if(!t)throw(0,D.BU)("Debug session not found",D.bH.FileNotFound);let i;const s=Me.exec(e.query);s&&(i={fromOffset:Number(s[1]),toOffset:Number(s[2])});const[,o]=e.path.split("/");return{session:t,offset:i,readOnly:!t.capabilities.supportsWriteMemoryRequest,sessionId:e.authority,memoryReference:decodeURIComponent(o)}}}class Re extends p.JT{constructor(e,t){super(),this.parent=e,this.range=t,this.invalidateEmitter=new g.Q5,this.onDidInvalidate=this.invalidateEmitter.event,this.width=this.range.toOffset-this.range.fromOffset,this.writable=e.writable,this._register(e),this._register(e.onDidInvalidate((e=>{const i=(0,_e.uZ)(e.fromOffset-t.fromOffset,0,this.width),s=(0,_e.uZ)(e.toOffset-t.fromOffset,0,this.width);s>i&&this.invalidateEmitter.fire({fromOffset:i,toOffset:s})})))}read(e,t){if(e<0)throw new RangeError(`Invalid fromOffset: ${e}`);return this.parent.read(this.range.fromOffset+e,this.range.fromOffset+Math.min(t,this.width))}write(e,t){return this.parent.write(this.range.fromOffset+e,t)}}var Fe=i(68843),Ve=i(1432),Pe=i(43557),Oe=i(51902),We=i(10829),He=i(50988);let $e=class{constructor(e,t,i,s,n,o,r,a){this.dbgr=t,this.sessionId=i,this.name=s,this.extensionHostDebugService=n,this.openerService=o,this.notificationService=r,this.dialogSerivce=a,this.allThreadsContinued=!0,this._readyForBreakpoints=!1,this.debugAdapterStopped=!1,this.inShutdown=!1,this.terminated=!1,this.firedAdapterExitEvent=!1,this.startTime=0,this.didReceiveStoppedEvent=!1,this._onDidInitialize=new g.Q5,this._onDidStop=new g.Q5,this._onDidContinued=new g.Q5,this._onDidTerminateDebugee=new g.Q5,this._onDidExitDebugee=new g.Q5,this._onDidThread=new g.Q5,this._onDidOutput=new g.Q5,this._onDidBreakpoint=new g.Q5,this._onDidLoadedSource=new g.Q5,this._onDidProgressStart=new g.Q5,this._onDidProgressUpdate=new g.Q5,this._onDidProgressEnd=new g.Q5,this._onDidInvalidated=new g.Q5,this._onDidInvalidateMemory=new g.Q5,this._onDidCustomEvent=new g.Q5,this._onDidEvent=new g.Q5,this._onDidExitAdapter=new g.Q5,this.stoppedSinceLastStep=!1,this.toDispose=[],this.debugAdapter=e,this._capabilities=Object.create(null),this.toDispose.push(this.debugAdapter.onError((e=>{this.shutdown(e)}))),this.toDispose.push(this.debugAdapter.onExit((e=>{0!==e?this.shutdown(new Error(`exit code: ${e}`)):this.shutdown()}))),this.debugAdapter.onEvent((e=>{switch(e.event){case"initialized":this._readyForBreakpoints=!0,this._onDidInitialize.fire(e);break;case"loadedSource":this._onDidLoadedSource.fire(e);break;case"capabilities":if(e.body){const t=e.body.capabilities;this.mergeCapabilities(t)}break;case"stopped":this.didReceiveStoppedEvent=!0,this.stoppedSinceLastStep=!0,this._onDidStop.fire(e);break;case"continued":this.allThreadsContinued=!1!==e.body.allThreadsContinued,this._onDidContinued.fire(e);break;case"thread":this._onDidThread.fire(e);break;case"output":this._onDidOutput.fire(e);break;case"breakpoint":this._onDidBreakpoint.fire(e);break;case"terminated":this._onDidTerminateDebugee.fire(e);break;case"exit":this._onDidExitDebugee.fire(e);break;case"progressStart":this._onDidProgressStart.fire(e);break;case"progressUpdate":this._onDidProgressUpdate.fire(e);break;case"progressEnd":this._onDidProgressEnd.fire(e);break;case"invalidated":this._onDidInvalidated.fire(e);break;case"memory":this._onDidInvalidateMemory.fire(e);break;case"process":case"module":break;default:this._onDidCustomEvent.fire(e)}this._onDidEvent.fire(e)})),this.debugAdapter.onRequest((e=>this.dispatchRequest(e)))}get isInShutdown(){return this.inShutdown}get onDidExitAdapter(){return this._onDidExitAdapter.event}get capabilities(){return this._capabilities}get readyForBreakpoints(){return this._readyForBreakpoints}get onDidInitialize(){return this._onDidInitialize.event}get onDidStop(){return this._onDidStop.event}get onDidContinued(){return this._onDidContinued.event}get onDidTerminateDebugee(){return this._onDidTerminateDebugee.event}get onDidExitDebugee(){return this._onDidExitDebugee.event}get onDidThread(){return this._onDidThread.event}get onDidOutput(){return this._onDidOutput.event}get onDidBreakpoint(){return this._onDidBreakpoint.event}get onDidLoadedSource(){return this._onDidLoadedSource.event}get onDidCustomEvent(){return this._onDidCustomEvent.event}get onDidProgressStart(){return this._onDidProgressStart.event}get onDidProgressUpdate(){return this._onDidProgressUpdate.event}get onDidProgressEnd(){return this._onDidProgressEnd.event}get onDidInvalidated(){return this._onDidInvalidated.event}get onDidInvalidateMemory(){return this._onDidInvalidateMemory.event}get onDidEvent(){return this._onDidEvent.event}async start(){if(!this.debugAdapter)return Promise.reject(new Error(w.NC("noDebugAdapterStart","No debug adapter, can not start debug session.")));await this.debugAdapter.startSession(),this.startTime=(new Date).getTime()}async initialize(e){const t=await this.send("initialize",e,void 0,void 0,!1);return t&&this.mergeCapabilities(t.body),t}disconnect(e){const t=this.capabilities.supportTerminateDebuggee?e.terminateDebuggee:void 0,i=this.capabilities.supportTerminateDebuggee&&this.capabilities.supportSuspendDebuggee?e.suspendDebuggee:void 0;return this.shutdown(void 0,e.restart,t,i)}async launchOrAttach(e){const t=await this.send(e.request,e,void 0,void 0,!1);return t&&this.mergeCapabilities(t.body),t}terminate(e=!1){return this.capabilities.supportsTerminateRequest?this.terminated?this.disconnect({terminateDebuggee:!0,restart:e}):(this.terminated=!0,this.send("terminate",{restart:e},void 0)):Promise.reject(new Error("terminated not supported"))}restart(e){return this.capabilities.supportsRestartRequest?this.send("restart",e):Promise.reject(new Error("restart not supported"))}async next(e){this.stoppedSinceLastStep=!1;const t=await this.send("next",e);return this.stoppedSinceLastStep||this.fireSimulatedContinuedEvent(e.threadId),t}async stepIn(e){this.stoppedSinceLastStep=!1;const t=await this.send("stepIn",e);return this.stoppedSinceLastStep||this.fireSimulatedContinuedEvent(e.threadId),t}async stepOut(e){this.stoppedSinceLastStep=!1;const t=await this.send("stepOut",e);return this.stoppedSinceLastStep||this.fireSimulatedContinuedEvent(e.threadId),t}async continue(e){this.stoppedSinceLastStep=!1;const t=await this.send("continue",e);return t&&t.body&&void 0!==t.body.allThreadsContinued&&(this.allThreadsContinued=t.body.allThreadsContinued),this.stoppedSinceLastStep||this.fireSimulatedContinuedEvent(e.threadId,this.allThreadsContinued),t}pause(e){return this.send("pause",e)}terminateThreads(e){return this.capabilities.supportsTerminateThreadsRequest?this.send("terminateThreads",e):Promise.reject(new Error("terminateThreads not supported"))}setVariable(e){return this.capabilities.supportsSetVariable?this.send("setVariable",e):Promise.reject(new Error("setVariable not supported"))}setExpression(e){return this.capabilities.supportsSetExpression?this.send("setExpression",e):Promise.reject(new Error("setExpression not supported"))}async restartFrame(e,t){if(this.capabilities.supportsRestartFrame){this.stoppedSinceLastStep=!1;const i=await this.send("restartFrame",e);return this.stoppedSinceLastStep||this.fireSimulatedContinuedEvent(t),i}return Promise.reject(new Error("restartFrame not supported"))}stepInTargets(e){return this.capabilities.supportsStepInTargetsRequest?this.send("stepInTargets",e):Promise.reject(new Error("stepInTargets not supported"))}completions(e,t){return this.capabilities.supportsCompletionsRequest?this.send("completions",e,t):Promise.reject(new Error("completions not supported"))}setBreakpoints(e){return this.send("setBreakpoints",e)}setFunctionBreakpoints(e){return this.capabilities.supportsFunctionBreakpoints?this.send("setFunctionBreakpoints",e):Promise.reject(new Error("setFunctionBreakpoints not supported"))}dataBreakpointInfo(e){return this.capabilities.supportsDataBreakpoints?this.send("dataBreakpointInfo",e):Promise.reject(new Error("dataBreakpointInfo not supported"))}setDataBreakpoints(e){return this.capabilities.supportsDataBreakpoints?this.send("setDataBreakpoints",e):Promise.reject(new Error("setDataBreakpoints not supported"))}setExceptionBreakpoints(e){return this.send("setExceptionBreakpoints",e)}breakpointLocations(e){return this.capabilities.supportsBreakpointLocationsRequest?this.send("breakpointLocations",e):Promise.reject(new Error("breakpointLocations is not supported"))}configurationDone(){return this.capabilities.supportsConfigurationDoneRequest?this.send("configurationDone",null):Promise.reject(new Error("configurationDone not supported"))}stackTrace(e,t){return this.send("stackTrace",e,t)}exceptionInfo(e){return this.capabilities.supportsExceptionInfoRequest?this.send("exceptionInfo",e):Promise.reject(new Error("exceptionInfo not supported"))}scopes(e,t){return this.send("scopes",e,t)}variables(e,t){return this.send("variables",e,t)}source(e){return this.send("source",e)}loadedSources(e){return this.capabilities.supportsLoadedSourcesRequest?this.send("loadedSources",e):Promise.reject(new Error("loadedSources not supported"))}threads(){return this.send("threads",null)}evaluate(e){return this.send("evaluate",e)}async stepBack(e){if(this.capabilities.supportsStepBack){this.stoppedSinceLastStep=!1;const t=await this.send("stepBack",e);return this.stoppedSinceLastStep||this.fireSimulatedContinuedEvent(e.threadId),t}return Promise.reject(new Error("stepBack not supported"))}async reverseContinue(e){if(this.capabilities.supportsStepBack){this.stoppedSinceLastStep=!1;const t=await this.send("reverseContinue",e);return this.stoppedSinceLastStep||this.fireSimulatedContinuedEvent(e.threadId),t}return Promise.reject(new Error("reverseContinue not supported"))}gotoTargets(e){return this.capabilities.supportsGotoTargetsRequest?this.send("gotoTargets",e):Promise.reject(new Error("gotoTargets is not supported"))}async goto(e){if(this.capabilities.supportsGotoTargetsRequest){this.stoppedSinceLastStep=!1;const t=await this.send("goto",e);return this.stoppedSinceLastStep||this.fireSimulatedContinuedEvent(e.threadId),t}return Promise.reject(new Error("goto is not supported"))}async setInstructionBreakpoints(e){return this.capabilities.supportsInstructionBreakpoints?await this.send("setInstructionBreakpoints",e):Promise.reject(new Error("setInstructionBreakpoints is not supported"))}async disassemble(e){return this.capabilities.supportsDisassembleRequest?await this.send("disassemble",e):Promise.reject(new Error("disassemble is not supported"))}async readMemory(e){return this.capabilities.supportsReadMemoryRequest?await this.send("readMemory",e):Promise.reject(new Error("readMemory is not supported"))}async writeMemory(e){return this.capabilities.supportsWriteMemoryRequest?await this.send("writeMemory",e):Promise.reject(new Error("writeMemory is not supported"))}cancel(e){return this.send("cancel",e)}custom(e,t){return this.send(e,t)}async shutdown(e,t=!1,i=void 0,s=void 0){if(!this.inShutdown){if(this.inShutdown=!0,!this.debugAdapter)return this.stopAdapter(e);try{const n={restart:t};"boolean"==typeof i&&(n.terminateDebuggee=i),"boolean"==typeof s&&(n.suspendDebuggee=s),await this.send("disconnect",n,void 0,e?200:2e3)}catch(e){}finally{await this.stopAdapter(e)}}}async stopAdapter(e){try{if(this.debugAdapter){const e=this.debugAdapter;this.debugAdapter=null,await e.stopSession(),this.debugAdapterStopped=!0}}finally{this.fireAdapterExitEvent(e)}}fireAdapterExitEvent(e){if(!this.firedAdapterExitEvent){this.firedAdapterExitEvent=!0;const t={emittedStopped:this.didReceiveStoppedEvent,sessionLengthInSeconds:((new Date).getTime()-this.startTime)/1e3};e&&!this.debugAdapterStopped&&(t.error=e),this._onDidExitAdapter.fire(t)}}async dispatchRequest(e){const t={type:"response",seq:0,command:e.command,request_seq:e.seq,success:!0},i=e=>this.debugAdapter&&this.debugAdapter.sendResponse(e);if("launchVSCode"===e.command)try{let s=await this.launchVsCode(e.arguments);if(!s.success){const{confirmed:n}=await this.dialogSerivce.confirm({type:I.zb.Warning,message:w.NC("canNotStart","The debugger needs to open a new tab or window for the debuggee but the browser prevented this. You must give permission to continue."),primaryButton:w.NC({key:"continue",comment:["&& denotes a mnemonic"]},"&&Continue")});n?s=await this.launchVsCode(e.arguments):(t.success=!1,i(t),await this.shutdown())}t.body={rendererDebugPort:s.rendererDebugPort},i(t)}catch(e){t.success=!1,t.message=e.message,i(t)}else if("runInTerminal"===e.command)try{const s=await this.dbgr.runInTerminal(e.arguments,this.sessionId),n=t;n.body={},"number"==typeof s&&(n.body.shellProcessId=s),i(n)}catch(e){t.success=!1,t.message=e.message,i(t)}else if("startDebugging"===e.command)try{const s=e.arguments,n={...s.configuration,request:s.request,type:this.dbgr.type,name:s.configuration.name||this.name};await this.dbgr.startDebugging(n,this.sessionId)||(t.success=!1,t.message="Failed to start debugging"),i(t)}catch(e){t.success=!1,t.message=e.message,i(t)}else t.success=!1,t.message=`unknown request '${e.command}'`,i(t)}launchVsCode(e){const t=[];for(const i of e.args){const e=(i.prefix||"")+(i.path||""),s=/^--(.+)=(.+)$/.exec(e);if(s&&3===s.length){const e=s[1];let n=s[2];"file-uri"!==e&&"folder-uri"!==e||(0,$.p3)(i.path)||(n=(0,$.p3)(n)?n:W.ov.file(n).toString()),t.push(`--${e}=${n}`)}else t.push(e)}return e.env&&t.push(`--extensionEnvironment=${JSON.stringify(e.env)}`),this.extensionHostDebugService.openExtensionDevelopmentHostWindow(t,!!e.debugRenderer)}send(e,t,i,s,n=!0){return new Promise(((n,o)=>{if(!this.debugAdapter)return void(this.inShutdown?n(void 0):o(new Error(w.NC("noDebugAdapter","No debugger available found. Can not send '{0}'.",e))));let r;const a=this.debugAdapter.sendRequest(e,t,(e=>{r?.dispose(),e.success?n(e):o(e)}),s);i&&(r=i.onCancellationRequested((()=>{r.dispose(),this.capabilities.supportsCancelRequest&&this.cancel({requestId:a})})))})).then(void 0,(e=>Promise.reject(this.handleErrorResponse(e,n))))}handleErrorResponse(e,t){if("canceled"===e.command&&"canceled"===e.message)return new h.FU;const i=e?.body?.error,s=e?.message||"",n=i?(0,$.PW)(i.format,!1,i.variables):s,o=i?.url;if(i&&o){const e=i.urlLabel?i.urlLabel:w.NC("moreInfo","More Info"),t=W.ov.parse(o),s=t.scheme===H.lg.command?"debug.moreInfo.command":"debug.moreInfo";return(0,u.JO)(n,[(0,a.xw)({id:s,label:e,run:()=>this.openerService.open(t,{allowCommands:!0})})])}t&&i&&i.format&&i.showUser&&this.notificationService.error(n);const r=new h.QD(n);return r.showUser=i?.showUser,r}mergeCapabilities(e){e&&(this._capabilities=b.jB(this._capabilities,e))}fireSimulatedContinuedEvent(e,t=!1){this._onDidContinued.fire({type:"event",event:"continued",body:{threadId:e,allThreadsContinued:t},seq:void 0})}dispose(){(0,p.B9)(this.toDispose)}};$e=(0,o.g)([(0,o.f)(4,y.Q),(0,o.f)(5,He.v4),(0,o.f)(6,I.lT),(0,o.f)(7,ce.Ss)],$e);var Ue=i(91825),qe=i(76743);let ze=0;const je=()=>"topReplElement:"+ze++;class Ke{constructor(e,t,i,s,n,o){this.session=e,this.id=t,this.value=i,this.severity=s,this.sourceData=n,this.expression=o,this._count=1,this._onDidChangeCount=new g.Q5}toString(e=!1){let t=this.value;for(let e=1;e<this.count;e++)t+=(t.endsWith("\n")?"":"\n")+this.value;return t+(this.sourceData&&e?` ${this.sourceData.source.name}`:"")}getId(){return this.id}getChildren(){return this.expression?.getChildren()||Promise.resolve([])}set count(e){this._count=e,this._onDidChangeCount.fire()}get count(){return this._count}get onDidChangeCount(){return this._onDidChangeCount.event}get hasChildren(){return!!this.expression?.hasChildren}}class Ge{constructor(e,t,i){this.expression=e,this.severity=t,this.sourceData=i,this.id=(0,f.R)(),this.hasChildren=e.hasChildren}getChildren(){return this.expression.getChildren()}toString(){return this.expression.toString()}getId(){return this.id}}class Qe{static{this.MAX_CHILDREN=1e3}constructor(e,t,i,s,n){this.id=e,this.name=t,this.valueObj=i,this.sourceData=s,this.annotation=n}getId(){return this.id}get value(){return null===this.valueObj?"null":Array.isArray(this.valueObj)?`Array[${this.valueObj.length}]`:(0,V.Kn)(this.valueObj)?"Object":(0,V.HD)(this.valueObj)?`"${this.valueObj}"`:String(this.valueObj)||""}get hasChildren(){return Array.isArray(this.valueObj)&&this.valueObj.length>0||(0,V.Kn)(this.valueObj)&&Object.getOwnPropertyNames(this.valueObj).length>0}evaluateLazy(){throw new Error("Method not implemented.")}getChildren(){let e=[];return Array.isArray(this.valueObj)?e=this.valueObj.slice(0,Qe.MAX_CHILDREN).map(((e,t)=>new Qe(`${this.id}:${t}`,String(t),e))):(0,V.Kn)(this.valueObj)&&(e=Object.getOwnPropertyNames(this.valueObj).slice(0,Qe.MAX_CHILDREN).map(((e,t)=>new Qe(`${this.id}:${t}`,e,this.valueObj[e])))),Promise.resolve(e)}toString(){return`${this.name}\n${this.value}`}}class Je{constructor(e){this.value=e,this.id=(0,f.R)()}toString(){return this.value}getId(){return this.id}}class Xe extends Ue.Ly{get available(){return this._available}constructor(e){super(void 0,void 0,0,(0,f.R)()),this.originalExpression=e,this._available=!0}async evaluateExpression(e,t,i,s){const n=await super.evaluateExpression(e,t,i,s);return this._available=n,n}toString(){return`${this.value}`}}class Ze{static{this.COUNTER=0}constructor(e,t,i){this.name=e,this.autoExpand=t,this.sourceData=i,this.children=[],this.ended=!1,this.id="replGroup:"+Ze.COUNTER++}get hasChildren(){return!0}getId(){return this.id}toString(e=!1){const t=e&&this.sourceData?` ${this.sourceData.source.name}`:"";return this.name+t}addChild(e){const t=this.children.length?this.children[this.children.length-1]:void 0;t instanceof Ze&&!t.hasEnded?t.addChild(e):this.children.push(e)}getChildren(){return this.children}end(){const e=this.children.length?this.children[this.children.length-1]:void 0;e instanceof Ze&&!e.hasEnded?e.end():this.ended=!0}get hasEnded(){return this.ended}}class Ye{constructor(e){this.configurationService=e,this.replElements=[],this._onDidChangeElements=new g.Q5,this.onDidChangeElements=this._onDidChangeElements.event}getReplElements(){return this.replElements}async addReplExpression(e,t,i){this.addReplElement(new Je(i));const s=new Xe(i);await s.evaluateExpression(i,e,t,"repl"),this.addReplElement(s)}appendToRepl(e,{output:t,expression:i,sev:s,source:n}){const o=t.lastIndexOf("[2J");if(-1!==o&&(this.removeReplExpressions(),this.appendToRepl(e,{output:w.NC("consoleCleared","Console was cleared"),sev:m.Z.Ignore}),t=t.substring(o+4)),i)return void this.addReplElement(t?new Ke(e,je(),t,s,n,i):new Ge(i,s,n));const r=this.replElements.length?this.replElements[this.replElements.length-1]:void 0;if(r instanceof Ke&&r.severity===s){const i=this.configurationService.getValue("debug");if(r.value===t&&(c=n,!(a=r.sourceData)&&!c||a&&c&&a.column===c.column&&a.lineNumber===c.lineNumber&&a.source.uri.toString()===c.source.uri.toString())&&i.console.collapseIdenticalLines)return void r.count++;if(!r.value.endsWith("\n")&&!r.value.endsWith("\r\n")&&1===r.count)return this.replElements[this.replElements.length-1]=new Ke(e,je(),r.value+t,s,n),void this._onDidChangeElements.fire()}var a,c;const d=new Ke(e,je(),t,s,n);this.addReplElement(d)}startGroup(e,t,i){const s=new Ze(e,t,i);this.addReplElement(s)}endGroup(){const e=this.replElements[this.replElements.length-1];e instanceof Ze&&e.end()}addReplElement(e){const t=this.replElements.length?this.replElements[this.replElements.length-1]:void 0;t instanceof Ze&&!t.hasEnded?t.addChild(e):(this.replElements.push(e),this.replElements.length>1e4&&this.replElements.splice(0,this.replElements.length-1e4)),this._onDidChangeElements.fire()}removeReplExpressions(){this.replElements.length>0&&(this.replElements=[],this._onDidChangeElements.fire())}clone(){const e=new Ye(this.configurationService);return e.replElements=this.replElements.slice(),e}}var et=i(85526),tt=i(7481);let it=class{constructor(e,t,i,s,n,o,r,a,c,l,u,h,b,m,f,v,w,S,C){this.id=e,this._configuration=t,this.root=i,this.model=s,this.debugService=o,this.telemetryService=r,this.hostService=a,this.configurationService=c,this.paneCompositeService=l,this.workspaceContextService=u,this.productService=h,this.notificationService=b,this.uriIdentityService=f,this.instantiationService=v,this.customEndpointTelemetryService=w,this.workbenchEnvironmentService=S,this.logService=C,this.initialized=!1,this.sources=new Map,this.threads=new Map,this.threadIds=[],this.cancellationMap=new Map,this.rawListeners=[],this.stoppedDetails=[],this._onDidChangeState=new g.Q5,this._onDidEndAdapter=new g.Q5,this._onDidLoadedSource=new g.Q5,this._onDidCustomEvent=new g.Q5,this._onDidProgressStart=new g.Q5,this._onDidProgressUpdate=new g.Q5,this._onDidProgressEnd=new g.Q5,this._onDidInvalidMemory=new g.Q5,this._onDidChangeREPLElements=new g.Q5,this._onDidChangeName=new g.Q5,this._options=n||{},this.parentSession=this._options.parentSession,this.hasSeparateRepl()?this.repl=new Ye(this.configurationService):this.repl=this.parentSession.repl;const k=new p.SL,y=k.add(new p.XK);y.value=this.repl.onDidChangeElements((()=>this._onDidChangeREPLElements.fire())),m&&k.add(m.onWillShutdown((()=>{this.shutdown(),(0,p.B9)(k)})));const D=this._options.compoundRoot;D&&k.add(D.onDidSessionStop((()=>this.terminate()))),this.passFocusScheduler=new d.pY((()=>{if(this.debugService.getModel().getSessions().some((e=>2===e.state))||this.getAllThreads().some((e=>e.stopped)))if("number"==typeof this.lastContinuedThreadId){const e=this.debugService.getViewModel().focusedThread;if(e&&e.threadId===this.lastContinuedThreadId&&!e.stopped){const e=this.getStoppedDetails()?.threadId,t="number"==typeof e?this.getThread(e):void 0;this.debugService.focusStackFrame(void 0,t)}}else{const e=this.debugService.getViewModel().focusedSession;e&&e.getId()===this.getId()&&2!==e.state&&this.debugService.focusStackFrame(void 0)}}),800);const x=this._options.parentSession;x&&k.add(x.onDidEndAdapter((()=>{this.hasSeparateRepl()||!1!==this.raw?.isInShutdown||(this.repl=this.repl.clone(),y.value=this.repl.onDidChangeElements((()=>this._onDidChangeREPLElements.fire())),this.parentSession=void 0)})))}getId(){return this.id}setSubId(e){this._subId=e}getMemory(e){return new Ue.Br(e,this)}get subId(){return this._subId}get configuration(){return this._configuration.resolved}get unresolvedConfiguration(){return this._configuration.unresolved}get lifecycleManagedByParent(){return!!this._options.lifecycleManagedByParent}get compact(){return!!this._options.compact}get saveBeforeRestart(){return this._options.saveBeforeRestart??!this._options?.parentSession}get compoundRoot(){return this._options.compoundRoot}get suppressDebugStatusbar(){return this._options.suppressDebugStatusbar??!1}get suppressDebugToolbar(){return this._options.suppressDebugToolbar??!1}get suppressDebugView(){return this._options.suppressDebugView??!1}get autoExpandLazyVariables(){return this.configurationService.getValue("debug").autoExpandLazyVariables}setConfiguration(e){this._configuration=e}getLabel(){return this.workspaceContextService.getWorkspace().folders.length>1&&this.root?`${this.name} (${ge.Hx(this.root.uri)})`:this.name}setName(e){this._name=e,this._onDidChangeName.fire(e)}get name(){return this._name||this.configuration.name}get state(){if(!this.initialized)return 1;if(!this.raw)return 0;const e=this.debugService.getViewModel().focusedThread;return e&&e.session===this?e.stopped?2:3:this.getAllThreads().some((e=>e.stopped))?2:3}get capabilities(){return this.raw?this.raw.capabilities:Object.create(null)}get onDidChangeState(){return this._onDidChangeState.event}get onDidEndAdapter(){return this._onDidEndAdapter.event}get onDidChangeReplElements(){return this._onDidChangeREPLElements.event}get onDidChangeName(){return this._onDidChangeName.event}get onDidCustomEvent(){return this._onDidCustomEvent.event}get onDidLoadedSource(){return this._onDidLoadedSource.event}get onDidProgressStart(){return this._onDidProgressStart.event}get onDidProgressUpdate(){return this._onDidProgressUpdate.event}get onDidProgressEnd(){return this._onDidProgressEnd.event}get onDidInvalidateMemory(){return this._onDidInvalidMemory.event}async initialize(e){this.raw&&await this.shutdown();try{const t=await e.createDebugAdapter(this);this.raw=this.instantiationService.createInstance($e,t,e,this.id,this.configuration.name),await this.raw.start(),this.registerListeners(),await this.raw.initialize({clientID:"vscode",clientName:this.productService.nameLong,adapterID:this.configuration.type,pathFormat:"path",linesStartAt1:!0,columnsStartAt1:!0,supportsVariableType:!0,supportsVariablePaging:!0,supportsRunInTerminalRequest:!0,locale:Ve.dK,supportsProgressReporting:!0,supportsInvalidatedEvent:!0,supportsMemoryReferences:!0,supportsArgsCanBeInterpretedByShell:!0,supportsMemoryEvent:!0,supportsStartDebuggingRequest:!0}),this.initialized=!0,this._onDidChangeState.fire(),this.debugService.setExceptionBreakpointsForSession(this,this.raw&&this.raw.capabilities.exceptionBreakpointFilters||[])}catch(e){throw this.initialized=!0,this._onDidChangeState.fire(),await this.shutdown(),e}}async launchOrAttach(e){if(!this.raw)throw new Error((0,w.NC)("noDebugAdapter","No debugger available, can not send '{0}'","launch or attach"));if(this.parentSession&&0===this.parentSession.state)throw(0,h.F0)();e.__sessionId=this.getId();try{await this.raw.launchOrAttach(e)}catch(e){throw this.shutdown(),e}}async terminate(e=!1){this.raw||this.onDidExitAdapter(),this.cancelAllRequests(),this._options.lifecycleManagedByParent&&this.parentSession?await this.parentSession.terminate(e):this.raw&&(this.raw.capabilities.supportsTerminateRequest&&"launch"===this._configuration.resolved.request?await this.raw.terminate(e):await this.raw.disconnect({restart:e,terminateDebuggee:!0})),e||this._options.compoundRoot?.sessionStopped()}async disconnect(e=!1,t=!1){this.raw||this.onDidExitAdapter(),this.cancelAllRequests(),this._options.lifecycleManagedByParent&&this.parentSession?await this.parentSession.disconnect(e,t):this.raw&&await this.raw.disconnect({restart:e,terminateDebuggee:!1,suspendDebuggee:t}),e||this._options.compoundRoot?.sessionStopped()}async restart(){if(!this.raw)throw new Error((0,w.NC)("noDebugAdapter","No debugger available, can not send '{0}'","restart"));this.cancelAllRequests(),this._options.lifecycleManagedByParent&&this.parentSession?await this.parentSession.restart():await this.raw.restart({arguments:this.configuration})}async sendBreakpoints(e,t,i){if(!this.raw)throw new Error((0,w.NC)("noDebugAdapter","No debugger available, can not send '{0}'","breakpoints"));if(!this.raw.readyForBreakpoints)return Promise.resolve(void 0);const s=this.getRawSource(e);t.length&&!s.adapterData&&(s.adapterData=t[0].adapterData),s.path&&(s.path=(0,Fe.DT)(s.path));const n=await this.raw.setBreakpoints({source:s,lines:t.map((e=>e.sessionAgnosticData.lineNumber)),breakpoints:t.map((e=>({line:e.sessionAgnosticData.lineNumber,column:e.sessionAgnosticData.column,condition:e.condition,hitCondition:e.hitCondition,logMessage:e.logMessage}))),sourceModified:i});if(n&&n.body){const e=new Map;for(let i=0;i<t.length;i++)e.set(t[i].getId(),n.body.breakpoints[i]);this.model.setBreakpointSessionData(this.getId(),this.capabilities,e)}}async sendFunctionBreakpoints(e){if(!this.raw)throw new Error((0,w.NC)("noDebugAdapter","No debugger available, can not send '{0}'","function breakpoints"));if(this.raw.readyForBreakpoints){const t=await this.raw.setFunctionBreakpoints({breakpoints:e});if(t&&t.body){const i=new Map;for(let s=0;s<e.length;s++)i.set(e[s].getId(),t.body.breakpoints[s]);this.model.setBreakpointSessionData(this.getId(),this.capabilities,i)}}}async sendExceptionBreakpoints(e){if(!this.raw)throw new Error((0,w.NC)("noDebugAdapter","No debugger available, can not send '{0}'","exception breakpoints"));if(this.raw.readyForBreakpoints){const t=this.capabilities.supportsExceptionFilterOptions?{filters:[],filterOptions:e.map((e=>e.condition?{filterId:e.filter,condition:e.condition}:{filterId:e.filter}))}:{filters:e.map((e=>e.filter))},i=await this.raw.setExceptionBreakpoints(t);if(i&&i.body&&i.body.breakpoints){const t=new Map;for(let s=0;s<e.length;s++)t.set(e[s].getId(),i.body.breakpoints[s]);this.model.setBreakpointSessionData(this.getId(),this.capabilities,t)}}}async dataBreakpointInfo(e,t){if(!this.raw)throw new Error((0,w.NC)("noDebugAdapter","No debugger available, can not send '{0}'","data breakpoints info"));if(!this.raw.readyForBreakpoints)throw new Error((0,w.NC)("sessionNotReadyForBreakpoints","Session is not ready for breakpoints"));const i=await this.raw.dataBreakpointInfo({name:e,variablesReference:t});return i?.body}async sendDataBreakpoints(e){if(!this.raw)throw new Error((0,w.NC)("noDebugAdapter","No debugger available, can not send '{0}'","data breakpoints"));if(this.raw.readyForBreakpoints){const t=await this.raw.setDataBreakpoints({breakpoints:e});if(t&&t.body){const i=new Map;for(let s=0;s<e.length;s++)i.set(e[s].getId(),t.body.breakpoints[s]);this.model.setBreakpointSessionData(this.getId(),this.capabilities,i)}}}async sendInstructionBreakpoints(e){if(!this.raw)throw new Error((0,w.NC)("noDebugAdapter","No debugger available, can not send '{0}'","instruction breakpoints"));if(this.raw.readyForBreakpoints){const t=await this.raw.setInstructionBreakpoints({breakpoints:e});if(t&&t.body){const i=new Map;for(let s=0;s<e.length;s++)i.set(e[s].getId(),t.body.breakpoints[s]);this.model.setBreakpointSessionData(this.getId(),this.capabilities,i)}}}async breakpointsLocations(e,t){if(!this.raw)throw new Error((0,w.NC)("noDebugAdapter","No debugger available, can not send '{0}'","breakpoints locations"));const i=this.getRawSource(e),s=await this.raw.breakpointLocations({source:i,line:t});if(!s||!s.body||!s.body.breakpoints)return[];const n=s.body.breakpoints.map((e=>({lineNumber:e.line,column:e.column||1})));return(0,c.EB)(n,(e=>`${e.lineNumber}:${e.column}`))}getDebugProtocolBreakpoint(e){return this.model.getDebugProtocolBreakpoint(e,this.getId())}customRequest(e,t){if(!this.raw)throw new Error((0,w.NC)("noDebugAdapter","No debugger available, can not send '{0}'",e));return this.raw.custom(e,t)}stackTrace(e,t,i,s){if(!this.raw)throw new Error((0,w.NC)("noDebugAdapter","No debugger available, can not send '{0}'","stackTrace"));const n=this.getNewCancellationToken(e,s);return this.raw.stackTrace({threadId:e,startFrame:t,levels:i},n)}async exceptionInfo(e){if(!this.raw)throw new Error((0,w.NC)("noDebugAdapter","No debugger available, can not send '{0}'","exceptionInfo"));const t=await this.raw.exceptionInfo({threadId:e});if(t)return{id:t.body.exceptionId,description:t.body.description,breakMode:t.body.breakMode,details:t.body.details}}scopes(e,t){if(!this.raw)throw new Error((0,w.NC)("noDebugAdapter","No debugger available, can not send '{0}'","scopes"));const i=this.getNewCancellationToken(t);return this.raw.scopes({frameId:e},i)}variables(e,t,i,s,n){if(!this.raw)throw new Error((0,w.NC)("noDebugAdapter","No debugger available, can not send '{0}'","variables"));const o=t?this.getNewCancellationToken(t):void 0;return this.raw.variables({variablesReference:e,filter:i,start:s,count:n},o)}evaluate(e,t,i){if(!this.raw)throw new Error((0,w.NC)("noDebugAdapter","No debugger available, can not send '{0}'","evaluate"));return this.raw.evaluate({expression:e,frameId:t,context:i})}async restartFrame(e,t){if(!this.raw)throw new Error((0,w.NC)("noDebugAdapter","No debugger available, can not send '{0}'","restartFrame"));await this.raw.restartFrame({frameId:e},t)}setLastSteppingGranularity(e,t){const i=this.getThread(e);i&&(i.lastSteppingGranularity=t)}async next(e,t){if(!this.raw)throw new Error((0,w.NC)("noDebugAdapter","No debugger available, can not send '{0}'","next"));this.setLastSteppingGranularity(e,t),await this.raw.next({threadId:e,granularity:t})}async stepIn(e,t,i){if(!this.raw)throw new Error((0,w.NC)("noDebugAdapter","No debugger available, can not send '{0}'","stepIn"));this.setLastSteppingGranularity(e,i),await this.raw.stepIn({threadId:e,targetId:t,granularity:i})}async stepOut(e,t){if(!this.raw)throw new Error((0,w.NC)("noDebugAdapter","No debugger available, can not send '{0}'","stepOut"));this.setLastSteppingGranularity(e,t),await this.raw.stepOut({threadId:e,granularity:t})}async stepBack(e,t){if(!this.raw)throw new Error((0,w.NC)("noDebugAdapter","No debugger available, can not send '{0}'","stepBack"));this.setLastSteppingGranularity(e,t),await this.raw.stepBack({threadId:e,granularity:t})}async continue(e){if(!this.raw)throw new Error((0,w.NC)("noDebugAdapter","No debugger available, can not send '{0}'","continue"));await this.raw.continue({threadId:e})}async reverseContinue(e){if(!this.raw)throw new Error((0,w.NC)("noDebugAdapter","No debugger available, can not send '{0}'","reverse continue"));await this.raw.reverseContinue({threadId:e})}async pause(e){if(!this.raw)throw new Error((0,w.NC)("noDebugAdapter","No debugger available, can not send '{0}'","pause"));await this.raw.pause({threadId:e})}async terminateThreads(e){if(!this.raw)throw new Error((0,w.NC)("noDebugAdapter","No debugger available, can not send '{0}'","terminateThreads"));await this.raw.terminateThreads({threadIds:e})}setVariable(e,t,i){if(!this.raw)throw new Error((0,w.NC)("noDebugAdapter","No debugger available, can not send '{0}'","setVariable"));return this.raw.setVariable({variablesReference:e,name:t,value:i})}setExpression(e,t,i){if(!this.raw)throw new Error((0,w.NC)("noDebugAdapter","No debugger available, can not send '{0}'","setExpression"));return this.raw.setExpression({expression:t,value:i,frameId:e})}gotoTargets(e,t,i){if(!this.raw)throw new Error((0,w.NC)("noDebugAdapter","No debugger available, can not send '{0}'","gotoTargets"));return this.raw.gotoTargets({source:e,line:t,column:i})}goto(e,t){if(!this.raw)throw new Error((0,w.NC)("noDebugAdapter","No debugger available, can not send '{0}'","goto"));return this.raw.goto({threadId:e,targetId:t})}loadSource(e){if(!this.raw)return Promise.reject(new Error((0,w.NC)("noDebugAdapter","No debugger available, can not send '{0}'","loadSource")));const t=this.getSourceForUri(e);let i;if(t)i=t.raw;else{const t=qe.Hw.getEncodedDebugData(e);i={path:t.path,sourceReference:t.sourceReference}}return this.raw.source({sourceReference:i.sourceReference||0,source:i})}async getLoadedSources(){if(!this.raw)return Promise.reject(new Error((0,w.NC)("noDebugAdapter","No debugger available, can not send '{0}'","getLoadedSources")));const e=await this.raw.loadedSources({});return e&&e.body&&e.body.sources?e.body.sources.map((e=>this.getSource(e))):[]}async completions(e,t,i,s,n,o){if(!this.raw)return Promise.reject(new Error((0,w.NC)("noDebugAdapter","No debugger available, can not send '{0}'","completions")));const r=this.getNewCancellationToken(t,o);return this.raw.completions({frameId:e,text:i,column:s.column,line:s.lineNumber},r)}async stepInTargets(e){if(!this.raw)return Promise.reject(new Error((0,w.NC)("noDebugAdapter","No debugger available, can not send '{0}'","stepInTargets")));const t=await this.raw.stepInTargets({frameId:e});return t?.body.targets}async cancel(e){return this.raw?this.raw.cancel({progressId:e}):Promise.reject(new Error((0,w.NC)("noDebugAdapter","No debugger available, can not send '{0}'","cancel")))}async disassemble(e,t,i,s){if(!this.raw)return Promise.reject(new Error((0,w.NC)("noDebugAdapter","No debugger available, can not send '{0}'","disassemble")));const n=await this.raw.disassemble({memoryReference:e,offset:t,instructionOffset:i,instructionCount:s,resolveSymbols:!0});return n?.body?.instructions}readMemory(e,t,i){return this.raw?this.raw.readMemory({count:i,memoryReference:e,offset:t}):Promise.reject(new Error((0,w.NC)("noDebugAdapter","No debugger available, can not send '{0}'","readMemory")))}writeMemory(e,t,i,s){return this.raw?this.raw.writeMemory({memoryReference:e,offset:t,allowPartial:s,data:i}):Promise.reject(new Error((0,w.NC)("noDebugAdapter","No debugger available, can not send '{0}'","disassemble")))}getThread(e){return this.threads.get(e)}getAllThreads(){const e=[];return this.threadIds.forEach((t=>{const i=this.threads.get(t);i&&e.push(i)})),e}clearThreads(e,t=void 0){if(null!=t){const i=this.threads.get(t);i&&(i.clearCallStack(),i.stoppedDetails=void 0,i.stopped=!1,e&&this.threads.delete(t))}else this.threads.forEach((e=>{e.clearCallStack(),e.stoppedDetails=void 0,e.stopped=!1})),e&&(this.threads.clear(),this.threadIds=[],Ue.Ly.allValues.clear())}getStoppedDetails(){return this.stoppedDetails.length>=1?this.stoppedDetails[0]:void 0}rawUpdate(e){this.threadIds=[],e.threads.forEach((e=>{if(this.threadIds.push(e.id),this.threads.has(e.id)){if(e.name){const t=this.threads.get(e.id);t&&(t.name=e.name)}}else this.threads.set(e.id,new Ue.jz(this,e.name,e.id))})),this.threads.forEach((e=>{-1===this.threadIds.indexOf(e.threadId)&&this.threads.delete(e.threadId)}));const t=e.stoppedDetails;if(t)if(t.allThreadsStopped)this.threads.forEach((e=>{e.stoppedDetails=e.threadId===t.threadId?t:{reason:e.stoppedDetails?.reason},e.stopped=!0,e.clearCallStack()}));else{const e="number"==typeof t.threadId?this.threads.get(t.threadId):void 0;e&&(e.stoppedDetails=t,e.clearCallStack(),e.stopped=!0)}}async fetchThreads(e){if(this.raw){const t=await this.raw.threads();t&&t.body&&t.body.threads&&this.model.rawUpdate({sessionId:this.getId(),threads:t.body.threads,stoppedDetails:e})}}initializeForTest(e){this.raw=e,this.registerListeners()}registerListeners(){if(!this.raw)return;this.rawListeners.push(this.raw.onDidInitialize((async()=>{r.i7((0,w.NC)("debuggingStarted","Debugging started."));const e=async()=>{if(this.raw&&this.raw.capabilities.supportsConfigurationDoneRequest)try{await this.raw.configurationDone()}catch(e){this.notificationService.error(e),this.raw?.disconnect({})}};try{await this.debugService.sendAllBreakpoints(this)}finally{await e(),await this.fetchThreads()}})));const e=new d.ci;this.rawListeners.push(this.raw.onDidStop((async t=>{e.queue((async()=>{this.passFocusScheduler.cancel(),this.stoppedDetails.push(t.body),await this.fetchThreads(t.body);const e=this.debugService.getViewModel().focusedThread,i=void 0!==e&&e.session===this&&!this.threads.has(e.threadId);i&&this.debugService.focusStackFrame(void 0,void 0);const s="number"==typeof t.body.threadId?this.getThread(t.body.threadId):void 0;if(s){const e=this.model.refreshTopOfCallstack(s),o=async()=>{if(i||!t.body.preserveFocusHint&&s.getCallStack().length){const e=this.debugService.getViewModel().focusedStackFrame;if(!e||e.thread.session===this){const e=!this.configurationService.getValue("debug").focusEditorOnBreak;await this.debugService.focusStackFrame(void 0,s,void 0,{preserveFocus:e})}s.stoppedDetails&&("breakpoint"!==s.stoppedDetails.reason||"openOnDebugBreak"!==this.configurationService.getValue("debug").openDebug||this.suppressDebugView||await this.paneCompositeService.openPaneComposite(n.f3,0),this.configurationService.getValue("debug").focusWindowOnBreak&&!this.workbenchEnvironmentService.extensionTestsLocationURI&&await this.hostService.focus({force:!0}))}};await e.topCallStack,o(),await e.wholeCallStack;const r=this.debugService.getViewModel().focusedStackFrame;r&&r.source&&"deemphasize"!==r.source.presentationHint&&"deemphasize"!==r.presentationHint||o()}this._onDidChangeState.fire()}))}))),this.rawListeners.push(this.raw.onDidThread((t=>{e.queue((async()=>{if("started"===t.body.reason)this.fetchThreadsScheduler||(this.fetchThreadsScheduler=new d.pY((()=>{this.fetchThreads()}),100),this.rawListeners.push(this.fetchThreadsScheduler)),this.fetchThreadsScheduler.isScheduled()||this.fetchThreadsScheduler.schedule();else if("exited"===t.body.reason){this.model.clearThreads(this.getId(),!0,t.body.threadId);const e=this.debugService.getViewModel(),i=e.focusedThread;this.passFocusScheduler.cancel(),i&&t.body.threadId===i.threadId&&this.debugService.focusStackFrame(void 0,void 0,e.focusedSession,{explicit:!1})}}))}))),this.rawListeners.push(this.raw.onDidTerminateDebugee((async e=>{r.i7((0,w.NC)("debuggingStopped","Debugging stopped.")),e.body&&e.body.restart?await this.debugService.restartSession(this,e.body.restart):this.raw&&await this.raw.disconnect({terminateDebuggee:!1})}))),this.rawListeners.push(this.raw.onDidContinued((t=>{e.queue((async()=>{const e=!1!==t.body.allThreadsContinued?void 0:t.body.threadId;if("number"==typeof e){this.stoppedDetails=this.stoppedDetails.filter((t=>t.threadId!==e));const t=this.cancellationMap.get(e);this.cancellationMap.delete(e),t?.forEach((e=>e.cancel()))}else this.stoppedDetails=[],this.cancelAllRequests();this.lastContinuedThreadId=e,this.passFocusScheduler.schedule(),this.model.clearThreads(this.getId(),!1,e),this._onDidChangeState.fire()}))})));const t=new d.ci;this.rawListeners.push(this.raw.onDidOutput((async e=>{const i="stderr"===e.body.category?m.Z.Error:"console"===e.body.category?m.Z.Warning:m.Z.Info;if(e.body.variablesReference){const s=e.body.source&&e.body.line?{lineNumber:e.body.line,column:e.body.column?e.body.column:1,source:this.getSource(e.body.source)}:void 0,n=new Ue.Ly(this,void 0,e.body.variablesReference,(0,f.R)()).getChildren();t.queue((async()=>{const t=await n;1!==t.length?t.forEach((t=>{t.name=null,this.appendToRepl({output:"",expression:t,sev:i,source:s},"important"===e.body.category)})):this.appendToRepl({output:e.body.output,expression:t[0],sev:i,source:s},"important"===e.body.category)}))}else t.queue((async()=>{if(!e.body||!this.raw)return;if("telemetry"===e.body.category){const t=this.raw.dbgr.getCustomTelemetryEndpoint();if(t&&0!==this.telemetryService.telemetryLevel){let i=e.body.data;!t.sendErrorTelemetry&&e.body.data&&(i=(0,$.Xc)(e.body.data)),this.customEndpointTelemetryService.publicLog(t,e.body.output,i)}return}const t=e.body.source&&e.body.line?{lineNumber:e.body.line,column:e.body.column?e.body.column:1,source:this.getSource(e.body.source)}:void 0;if("start"!==e.body.group&&"startCollapsed"!==e.body.group)("end"!==e.body.group||(this.repl.endGroup(),e.body.output))&&"string"==typeof e.body.output&&this.appendToRepl({output:e.body.output,sev:i,source:t},"important"===e.body.category);else{const i="start"===e.body.group;this.repl.startGroup(e.body.output||"",i,t)}}))}))),this.rawListeners.push(this.raw.onDidBreakpoint((e=>{const t=e.body&&e.body.breakpoint?e.body.breakpoint.id:void 0,i=this.model.getBreakpoints().find((e=>e.getIdFromAdapter(this.getId())===t)),s=this.model.getFunctionBreakpoints().find((e=>e.getIdFromAdapter(this.getId())===t)),n=this.model.getDataBreakpoints().find((e=>e.getIdFromAdapter(this.getId())===t)),o=this.model.getExceptionBreakpoints().find((e=>e.getIdFromAdapter(this.getId())===t));if("new"===e.body.reason&&e.body.breakpoint.source&&e.body.breakpoint.line){const t=this.getSource(e.body.breakpoint.source),i=this.model.addBreakpoints(t.uri,[{column:e.body.breakpoint.column,enabled:!0,lineNumber:e.body.breakpoint.line}],!1);if(1===i.length){const t=new Map([[i[0].getId(),e.body.breakpoint]]);this.model.setBreakpointSessionData(this.getId(),this.capabilities,t)}}if("removed"===e.body.reason&&(i&&this.model.removeBreakpoints([i]),s&&this.model.removeFunctionBreakpoints(s.getId()),n&&this.model.removeDataBreakpoints(n.getId())),"changed"===e.body.reason){if(i){i.column||(e.body.breakpoint.column=void 0);const t=new Map([[i.getId(),e.body.breakpoint]]);this.model.setBreakpointSessionData(this.getId(),this.capabilities,t)}if(s){const t=new Map([[s.getId(),e.body.breakpoint]]);this.model.setBreakpointSessionData(this.getId(),this.capabilities,t)}if(n){const t=new Map([[n.getId(),e.body.breakpoint]]);this.model.setBreakpointSessionData(this.getId(),this.capabilities,t)}if(o){const t=new Map([[o.getId(),e.body.breakpoint]]);this.model.setBreakpointSessionData(this.getId(),this.capabilities,t)}}}))),this.rawListeners.push(this.raw.onDidLoadedSource((e=>{this._onDidLoadedSource.fire({reason:e.body.reason,source:this.getSource(e.body.source)})}))),this.rawListeners.push(this.raw.onDidCustomEvent((e=>{this._onDidCustomEvent.fire(e)}))),this.rawListeners.push(this.raw.onDidProgressStart((e=>{this._onDidProgressStart.fire(e)}))),this.rawListeners.push(this.raw.onDidProgressUpdate((e=>{this._onDidProgressUpdate.fire(e)}))),this.rawListeners.push(this.raw.onDidProgressEnd((e=>{this._onDidProgressEnd.fire(e)}))),this.rawListeners.push(this.raw.onDidInvalidateMemory((e=>{this._onDidInvalidMemory.fire(e)}))),this.rawListeners.push(this.raw.onDidInvalidated((async e=>{(!e.body.areas||1!==e.body.areas.length||"variables"!==e.body.areas[0]&&"watch"!==e.body.areas[0])&&(this.cancelAllRequests(),this.model.clearThreads(this.getId(),!0),await this.fetchThreads(this.getStoppedDetails()));const t=this.debugService.getViewModel();t.focusedSession===this&&t.updateViews()}))),this.rawListeners.push(this.raw.onDidExitAdapter((e=>this.onDidExitAdapter(e))))}onDidExitAdapter(e){this.initialized=!0,this.model.setBreakpointSessionData(this.getId(),this.capabilities,void 0),this.shutdown(),this._onDidEndAdapter.fire(e)}shutdown(){(0,p.B9)(this.rawListeners),this.raw&&(this.raw.disconnect({}),this.raw.dispose(),this.raw=void 0),this.fetchThreadsScheduler?.dispose(),this.fetchThreadsScheduler=void 0,this.passFocusScheduler.cancel(),this.passFocusScheduler.dispose(),this.model.clearThreads(this.getId(),!0),this._onDidChangeState.fire()}getSourceForUri(e){return this.sources.get(this.uriIdentityService.asCanonicalUri(e).toString())}getSource(e){let t=new qe.Hw(e,this.getId(),this.uriIdentityService,this.logService);const i=t.uri.toString(),s=this.sources.get(i);return s?(t=s,t.raw=(0,b.jB)(t.raw,e),t.raw&&e&&(t.raw.presentationHint=e.presentationHint)):this.sources.set(i,t),t}getRawSource(e){const t=this.getSourceForUri(e);if(t)return t.raw;{const t=qe.Hw.getEncodedDebugData(e);return{name:t.name,path:t.path,sourceReference:t.sourceReference}}}getNewCancellationToken(e,t){const i=new l.A(t),s=this.cancellationMap.get(e)||[];return s.push(i),this.cancellationMap.set(e,s),i.token}cancelAllRequests(){this.cancellationMap.forEach((e=>e.forEach((e=>e.cancel())))),this.cancellationMap.clear()}getReplElements(){return this.repl.getReplElements()}hasSeparateRepl(){return!this.parentSession||"mergeWithParent"!==this._options.repl}removeReplExpressions(){this.repl.removeReplExpressions()}async addReplExpression(e,t){await this.repl.addReplExpression(this,e,t),this.debugService.getViewModel().updateViews()}appendToRepl(e,t){this.repl.appendToRepl(this,e),t&&this.notificationService.notify({message:e.output.toString(),severity:e.sev,source:this.name})}};it=(0,o.g)([(0,o.f)(5,n.tn),(0,o.f)(6,We.bU),(0,o.f)(7,et.$),(0,o.f)(8,C.Ui),(0,o.f)(9,tt.c),(0,o.f)(10,T.ec),(0,o.f)(11,Oe.a),(0,o.f)(12,I.lT),(0,o.f)(13,ae.g),(0,o.f)(14,N.v),(0,o.f)(15,x.TG),(0,o.f)(16,We.$h),(0,o.f)(17,q.n),(0,o.f)(18,Pe.VZ)],it);var st=i(49594),nt=i(4038),ot=i(98674);function rt(e,t){return(i,s=null,n)=>{const o=t((t=>{if(e(t))return o.dispose(),i.call(s,t)}),null,n);return o}}const at="debug.taskerrorchoice";let ct=class{constructor(e,t,i,s,n,o,r){this.taskService=e,this.markerService=t,this.configurationService=i,this.viewsService=s,this.dialogService=n,this.storageService=o,this.commandService=r,this.canceled=!1}cancel(){this.canceled=!0}async runTaskAndCheckErrors(e,t){try{this.canceled=!1;const i=await this.runTask(e,t);if(this.canceled||i&&void 0===i.exitCode)return 0;const s=t?this.markerService.read({severities:ot.ZL.Error,take:2}).length:0,n=i&&0===i.exitCode,o=i&&0!==i.exitCode,r=this.configurationService.getValue("debug").onTaskErrors;if(n||"debugAnyway"===r||0===s&&!o)return 1;if("showErrors"===r)return await this.viewsService.openView(st.s.MARKERS_VIEW_ID,!0),Promise.resolve(0);if("abort"===r)return Promise.resolve(0);const a="string"==typeof t?t:t?t.name:"",c=s>1?w.NC("preLaunchTaskErrors","Errors exist after running preLaunchTask '{0}'.",a):1===s?w.NC("preLaunchTaskError","Error exists after running preLaunchTask '{0}'.",a):i&&"number"==typeof i.exitCode?w.NC("preLaunchTaskExitCode","The preLaunchTask '{0}' terminated with exit code {1}.",a,i.exitCode):w.NC("preLaunchTaskTerminated","The preLaunchTask '{0}' terminated.",a);let d;!function(e){e[e.DebugAnyway=1]="DebugAnyway",e[e.ShowErrors=2]="ShowErrors",e[e.Cancel=0]="Cancel"}(d||(d={}));const{result:l,checkboxChecked:u}=await this.dialogService.prompt({type:m.Z.Warning,message:c,buttons:[{label:w.NC({key:"debugAnyway",comment:["&& denotes a mnemonic"]},"&&Debug Anyway"),run:()=>d.DebugAnyway},{label:w.NC({key:"showErrors",comment:["&& denotes a mnemonic"]},"&&Show Errors"),run:()=>d.ShowErrors}],cancelButton:{label:w.NC("abort","Abort"),run:()=>d.Cancel},checkbox:{label:w.NC("remember","Remember my choice in user settings")}}),h=l===d.DebugAnyway,g=l===d.Cancel;return u&&this.configurationService.updateValue("debug.onTaskErrors",l===d.DebugAnyway?"debugAnyway":g?"abort":"showErrors"),g?Promise.resolve(0):h?1:(await this.viewsService.openView(st.s.MARKERS_VIEW_ID,!0),Promise.resolve(0))}catch(e){const t=this.taskService.configureAction(),i=JSON.parse(this.storageService.get(at,1,"{}"));let s,n=-1;if(function(e){e[e.DebugAnyway=0]="DebugAnyway",e[e.ConfigureTask=1]="ConfigureTask",e[e.Cancel=2]="Cancel"}(s||(s={})),void 0!==i[e.message])n=i[e.message];else{const{result:o,checkboxChecked:r}=await this.dialogService.prompt({type:m.Z.Error,message:e.message,buttons:[{label:w.NC({key:"debugAnyway",comment:["&& denotes a mnemonic"]},"&&Debug Anyway"),run:()=>s.DebugAnyway},{label:t.label,run:()=>s.ConfigureTask}],cancelButton:{run:()=>s.Cancel},checkbox:{label:w.NC("rememberTask","Remember my choice for this task")}});n=o,r&&(i[e.message]=n,this.storageService.store(at,JSON.stringify(i),1,1))}return n===s.ConfigureTask&&await t.run(),n===s.DebugAnyway?1:0}}async runTask(e,t){if(!t)return Promise.resolve(null);if(!e)return Promise.reject(new Error(w.NC("invalidTaskReference","Task '{0}' can not be referenced from a launch configuration that is in a different workspace folder.","string"==typeof t?t:t.type)));const i=await this.taskService.getTask(e,t);if(!i){const e="string"==typeof t?w.NC("DebugTaskNotFoundWithTaskId","Could not find the task '{0}'.",t):w.NC("DebugTaskNotFound","Could not find the specified task.");return Promise.reject((0,u.JO)(e,[new a.aU(ue.TP,ue.cG,void 0,!0,(()=>this.commandService.executeCommand(ue.TP)))]))}let s=!1;const n=new Promise(((e,t)=>rt((e=>("inactive"===e.kind||"processEnded"===e.kind&&void 0===e.exitCode)&&e.taskId===i._id),this.taskService.onDidStateChange)((t=>{s=!0,e("processEnded"===t.kind?{exitCode:t.exitCode}:null)})))),o=this.taskService.getActiveTasks().then((async e=>{if(e.find((e=>e._id===i._id)))return(await this.taskService.getBusyTasks()).find((e=>e._id===i._id))?(s=!0,n):Promise.resolve(null);rt((e=>("active"===e.kind||"dependsOnStarted"===e.kind)&&e.taskId===i._id),this.taskService.onDidStateChange)((()=>{s=!0}));const t=this.taskService.run(i);return i.configurationProperties.isBackground?n:t.then(V.M2)}));return new Promise(((e,n)=>{const r=new Promise((e=>rt((e=>"acquiredInput"===e.kind&&e.taskId===i._id),this.taskService.onDidStateChange)((()=>{e()}))));o.then((t=>{s=!0,e(t)}),(e=>n(e))),r.then((()=>{const e=i.configurationProperties.isBackground?5e3:1e4;setTimeout((()=>{if(!s){const e="string"==typeof t?w.NC("taskNotTrackedWithTaskId","The task '{0}' cannot be tracked. Make sure to have a problem matcher defined.",t):w.NC("taskNotTracked","The task '{0}' cannot be tracked. Make sure to have a problem matcher defined.",JSON.stringify(t));n({severity:m.Z.Error,message:e})}}),e)}))}))}};ct=(0,o.g)([(0,o.f)(0,nt.mh),(0,o.f)(1,ot.lT),(0,o.f)(2,C.Ui),(0,o.f)(3,_.qC),(0,o.f)(4,ce.Ss),(0,o.f)(5,pe.Uy),(0,o.f)(6,S.H)],ct);class dt{constructor(){this.stopped=!1,this.stopEmitter=new g.Q5,this.onDidSessionStop=this.stopEmitter.event}sessionStopped(){this.stopped||(this.stopped=!0,this.stopEmitter.fire())}}const lt="debug.breakpoint",ut="debug.functionbreakpoint",ht="debug.databreakpoint",gt="debug.exceptionbreakpoint",pt="debug.watchexpressions",bt="debug.chosenenvironment",mt="debug.uxstate";let ft=class{constructor(e,t,i,s){this.storageService=e,this.textFileService=t,this.uriIdentityService=i,this.logService=s}loadDebugUxState(){return this.storageService.get(mt,1,"default")}storeDebugUxState(e){this.storageService.store(mt,e,1,1)}loadBreakpoints(){let e;try{e=JSON.parse(this.storageService.get(lt,1,"[]")).map((e=>new Ue.Uo(W.ov.parse(e.uri.external||e.source.uri.external),e.lineNumber,e.column,e.enabled,e.condition,e.hitCondition,e.logMessage,e.adapterData,this.textFileService,this.uriIdentityService,this.logService,e.id)))}catch(e){}return e||[]}loadFunctionBreakpoints(){let e;try{e=JSON.parse(this.storageService.get(ut,1,"[]")).map((e=>new Ue.Tp(e.name,e.enabled,e.hitCondition,e.condition,e.logMessage,e.id)))}catch(e){}return e||[]}loadExceptionBreakpoints(){let e;try{e=JSON.parse(this.storageService.get(gt,1,"[]")).map((e=>new Ue.hO(e.filter,e.label,e.enabled,e.supportsCondition,e.condition,e.description,e.conditionDescription,!!e.fallback)))}catch(e){}return e||[]}loadDataBreakpoints(){let e;try{e=JSON.parse(this.storageService.get(ht,1,"[]")).map((e=>new Ue.K1(e.description,e.dataId,!0,e.enabled,e.hitCondition,e.condition,e.logMessage,e.accessTypes,e.accessType,e.id)))}catch(e){}return e||[]}loadWatchExpressions(){let e;try{e=JSON.parse(this.storageService.get(pt,1,"[]")).map((e=>new Ue.A2(e.name,e.id)))}catch(e){}return e||[]}loadChosenEnvironments(){return JSON.parse(this.storageService.get(bt,1,"{}"))}storeChosenEnvironments(e){this.storageService.store(bt,JSON.stringify(e),1,1)}storeWatchExpressions(e){e.length?this.storageService.store(pt,JSON.stringify(e.map((e=>({name:e.name,id:e.getId()})))),1,1):this.storageService.remove(pt,1)}storeBreakpoints(e){const t=e.getBreakpoints();t.length?this.storageService.store(lt,JSON.stringify(t),1,1):this.storageService.remove(lt,1);const i=e.getFunctionBreakpoints();i.length?this.storageService.store(ut,JSON.stringify(i),1,1):this.storageService.remove(ut,1);const s=e.getDataBreakpoints().filter((e=>e.canPersist));s.length?this.storageService.store(ht,JSON.stringify(s),1,1):this.storageService.remove(ht,1);const n=e.getExceptionBreakpoints();n.length?this.storageService.store(gt,JSON.stringify(n),1,1):this.storageService.remove(gt,1)}};ft=(0,o.g)([(0,o.f)(0,pe.Uy),(0,o.f)(1,we.MM),(0,o.f)(2,N.v),(0,o.f)(3,Pe.VZ)],ft);let vt=class{constructor(e,t){this.model=e,this.telemetryService=t}logDebugSessionStart(e,t){const i=e.getMainExtensionDescriptor();this.telemetryService.publicLog("debugSessionStart",{type:e.type,breakpointCount:this.model.getBreakpoints().length,exceptionBreakpoints:this.model.getExceptionBreakpoints(),watchExpressionsCount:this.model.getWatchExpressions().length,extensionName:i.identifier.value,isBuiltin:i.isBuiltin,launchJsonExists:t})}logDebugSessionStop(e,t){const i=this.model.getBreakpoints();this.telemetryService.publicLog("debugSessionStop",{type:e&&e.configuration.type,success:t.emittedStopped||0===i.length,sessionLengthInSeconds:t.sessionLengthInSeconds,breakpointCount:i.length,watchExpressionsCount:this.model.getWatchExpressions().length})}};vt=(0,o.g)([(0,o.f)(1,We.bU)],vt);class wt{constructor(e){this.contextKeyService=e,this.firstSessionStart=!0,this._onDidFocusSession=new g.Q5,this._onDidFocusThread=new g.Q5,this._onDidFocusStackFrame=new g.Q5,this._onDidSelectExpression=new g.Q5,this._onDidEvaluateLazyExpression=new g.Q5,this._onWillUpdateViews=new g.Q5,e.bufferChangeEvents((()=>{this.expressionSelectedContextKey=n.xT.bindTo(e),this.loadedScriptsSupportedContextKey=n.NJ.bindTo(e),this.stepBackSupportedContextKey=n.RX.bindTo(e),this.focusedSessionIsAttach=n.dU.bindTo(e),this.restartFrameSupportedContextKey=n.wx.bindTo(e),this.stepIntoTargetsSupported=n.o8.bindTo(e),this.jumpToCursorSupported=n.dr.bindTo(e),this.setVariableSupported=n.jA.bindTo(e),this.setExpressionSupported=n.Wx.bindTo(e),this.multiSessionDebug=n.d5.bindTo(e),this.terminateDebuggeeSupported=n.rv.bindTo(e),this.suspendDebuggeeSupported=n.uz.bindTo(e),this.disassembleRequestSupported=n.Pt.bindTo(e),this.focusedStackFrameHasInstructionPointerReference=n.pL.bindTo(e)}))}getId(){return"root"}get focusedSession(){return this._focusedSession}get focusedThread(){return this._focusedThread}get focusedStackFrame(){return this._focusedStackFrame}setFocus(e,t,i,s){const n=this._focusedStackFrame!==e,o=this._focusedSession!==i,r=this._focusedThread!==t;this._focusedStackFrame=e,this._focusedThread=t,this._focusedSession=i,this.contextKeyService.bufferChangeEvents((()=>{this.loadedScriptsSupportedContextKey.set(!!i&&!!i.capabilities.supportsLoadedSourcesRequest),this.stepBackSupportedContextKey.set(!!i&&!!i.capabilities.supportsStepBack),this.restartFrameSupportedContextKey.set(!!i&&!!i.capabilities.supportsRestartFrame),this.stepIntoTargetsSupported.set(!!i&&!!i.capabilities.supportsStepInTargetsRequest),this.jumpToCursorSupported.set(!!i&&!!i.capabilities.supportsGotoTargetsRequest),this.setVariableSupported.set(!!i&&!!i.capabilities.supportsSetVariable),this.setExpressionSupported.set(!!i&&!!i.capabilities.supportsSetExpression),this.terminateDebuggeeSupported.set(!!i&&!!i.capabilities.supportTerminateDebuggee),this.suspendDebuggeeSupported.set(!!i&&!!i.capabilities.supportSuspendDebuggee),this.disassembleRequestSupported.set(!!i?.capabilities.supportsDisassembleRequest),this.focusedStackFrameHasInstructionPointerReference.set(!!e?.instructionPointerReference);const t=!!i&&(0,$.Q5)(i);this.focusedSessionIsAttach.set(t)})),o&&this._onDidFocusSession.fire(i),n?this._onDidFocusStackFrame.fire({stackFrame:e,explicit:s,session:i}):r&&this._onDidFocusThread.fire({thread:t,explicit:s,session:i})}get onDidFocusSession(){return this._onDidFocusSession.event}get onDidFocusThread(){return this._onDidFocusThread.event}get onDidFocusStackFrame(){return this._onDidFocusStackFrame.event}getSelectedExpression(){return this.selectedExpression}setSelectedExpression(e,t){this.selectedExpression=e?{expression:e,settingWatch:t}:void 0,this.expressionSelectedContextKey.set(!!e),this._onDidSelectExpression.fire(this.selectedExpression)}get onDidSelectExpression(){return this._onDidSelectExpression.event}get onDidEvaluateLazyExpression(){return this._onDidEvaluateLazyExpression.event}updateViews(){this._onWillUpdateViews.fire()}get onWillUpdateViews(){return this._onWillUpdateViews.event}isMultiSessionView(){return!!this.multiSessionDebug.get()}setMultiSessionView(e){this.multiSessionDebug.set(e)}async evaluateLazyExpression(e){await e.evaluateLazy(),this._onDidEvaluateLazyExpression.fire(e)}}var St=i(92714),Ct=i(26513),kt=i(68398),yt=i(9301);let Dt=class{constructor(e,t,i,s,o,r,a,c,d,l,u,h,b,m,f,v,S,C,k,y){this.editorService=e,this.paneCompositeService=t,this.viewsService=i,this.viewDescriptorService=s,this.notificationService=o,this.dialogService=r,this.layoutService=a,this.contextService=c,this.contextKeyService=d,this.lifecycleService=l,this.instantiationService=u,this.extensionService=h,this.fileService=b,this.configurationService=m,this.extensionHostDebugService=f,this.activityService=v,this.commandService=S,this.quickInputService=C,this.workspaceTrustRequestService=k,this.uriIdentityService=y,this.disposables=new p.SL,this.initializing=!1,this.sessionCancellationTokens=new Map,this.haveDoneLazySetup=!1,this.breakpointsToSendOnResourceSaved=new Set,this._onDidChangeState=new g.Q5,this._onDidNewSession=new g.Q5,this._onWillNewSession=new g.Q5,this._onDidEndSession=new g.Q5,this.adapterManager=this.instantiationService.createInstance(le,{onDidNewSession:this.onDidNewSession}),this.disposables.add(this.adapterManager),this.configurationManager=this.instantiationService.createInstance(xe,this.adapterManager),this.disposables.add(this.configurationManager),this.debugStorage=this.instantiationService.createInstance(ft),this.chosenEnvironments=this.debugStorage.loadChosenEnvironments(),this.model=this.instantiationService.createInstance(Ue.nR,this.debugStorage),this.telemetry=this.instantiationService.createInstance(vt,this.model),this.viewModel=new wt(d),this.taskRunner=this.instantiationService.createInstance(ct),this.disposables.add(this.fileService.onDidFilesChange((e=>this.onFileChanges(e)))),this.disposables.add(this.lifecycleService.onWillShutdown(this.dispose,this)),this.disposables.add(this.extensionHostDebugService.onAttachSession((e=>{const t=this.model.getSession(e.sessionId,!0);t&&(t.configuration.request="attach",t.configuration.port=e.port,t.setSubId(e.subId),this.launchOrAttachToSession(t))}))),this.disposables.add(this.extensionHostDebugService.onTerminateSession((e=>{const t=this.model.getSession(e.sessionId);t&&t.subId===e.subId&&t.disconnect()}))),this.disposables.add(this.viewModel.onDidFocusStackFrame((()=>{this.onStateChange()}))),this.disposables.add(this.viewModel.onDidFocusSession((e=>{this.onStateChange(),e&&this.setExceptionBreakpointFallbackSession(e.getId())}))),this.disposables.add(g.ju.any(this.adapterManager.onDidRegisterDebugger,this.configurationManager.onDidSelectConfiguration)((()=>{const e=0!==this.state||this.configurationManager.getAllConfigurations().length>0&&this.adapterManager.hasEnabledDebuggers()?"default":"simple";this.debugUx.set(e),this.debugStorage.storeDebugUxState(e)}))),this.disposables.add(this.model.onDidChangeCallStack((()=>{const e=this.model.getSessions().filter((e=>!e.parentSession)).length;if(this.activity?.dispose(),e>0){const t=this.viewDescriptorService.getViewContainerByViewId(n.Vw);t&&(this.activity=this.activityService.showViewContainerActivity(t.id,{badge:new kt.mA(e,(e=>1===e?w.NC("1activeSession","1 active session"):w.NC("nActiveSessions","{0} active sessions",e)))}))}}))),this.disposables.add(e.onDidActiveEditorChange((()=>{this.contextKeyService.bufferChangeEvents((()=>{e.activeEditor===St.n.instance?this.disassemblyViewFocus.set(!0):this.disassemblyViewFocus?.reset()}))}))),this.disposables.add(this.lifecycleService.onBeforeShutdown((()=>{for(const t of e.editors)t.resource?.scheme===n.Sb&&t.dispose()}))),this.initContextKeys(d)}initContextKeys(e){queueMicrotask((()=>{e.bufferChangeEvents((()=>{this.debugType=n.Lx.bindTo(e),this.debugState=n.KA.bindTo(e),this.hasDebugged=n.$N.bindTo(e),this.inDebugMode=n.hO.bindTo(e),this.debugUx=n.Kw.bindTo(e),this.debugUx.set(this.debugStorage.loadDebugUxState()),this.breakpointsExist=n.LK.bindTo(e),this.disassemblyViewFocus=n.oN.bindTo(e)}));const t=()=>this.breakpointsExist.set(!!(this.model.getBreakpoints().length||this.model.getDataBreakpoints().length||this.model.getFunctionBreakpoints().length));t(),this.disposables.add(this.model.onDidChangeBreakpoints((()=>t())))}))}getModel(){return this.model}getViewModel(){return this.viewModel}getConfigurationManager(){return this.configurationManager}getAdapterManager(){return this.adapterManager}sourceIsNotAvailable(e){this.model.sourceIsNotAvailable(e)}dispose(){this.disposables.dispose()}get state(){const e=this.viewModel.focusedSession;return e?e.state:this.initializing?1:0}get initializingOptions(){return this._initializingOptions}startInitializingState(e){this.initializing||(this.initializing=!0,this._initializingOptions=e,this.onStateChange())}endInitializingState(){this.initializing&&(this.initializing=!1,this._initializingOptions=void 0,this.onStateChange())}cancelTokens(e){if(e){const t=this.sessionCancellationTokens.get(e);t&&(t.cancel(),this.sessionCancellationTokens.delete(e))}else this.sessionCancellationTokens.forEach((e=>e.cancel())),this.sessionCancellationTokens.clear()}onStateChange(){const e=this.state;this.previousState!==e&&(this.contextKeyService.bufferChangeEvents((()=>{this.debugState.set((0,n.wD)(e)),this.inDebugMode.set(0!==e);const t=0!==e&&1!==e||this.adapterManager.hasEnabledDebuggers()&&this.configurationManager.selectedConfiguration.name?"default":"simple";this.debugUx.set(t),this.debugStorage.storeDebugUxState(t)})),this.previousState=e,this._onDidChangeState.fire(e))}get onDidChangeState(){return this._onDidChangeState.event}get onDidNewSession(){return this._onDidNewSession.event}get onWillNewSession(){return this._onWillNewSession.event}get onDidEndSession(){return this._onDidEndSession.event}lazySetup(){this.haveDoneLazySetup||(this.disposables.add(this.fileService.registerProvider(n.Sb,new Be(this))),this.haveDoneLazySetup=!0)}async startDebugging(e,t,i,s=!i?.parentSession){const n=i&&i.noDebug?w.NC("runTrust","Running executes build tasks and program code from your workspace."):w.NC("debugTrust","Debugging executes build tasks and program code from your workspace.");if(!await this.workspaceTrustRequestService.requestWorkspaceTrust({message:n}))return!1;this.lazySetup(),this.startInitializingState(i),this.hasDebugged.set(!0);try{let n,o;if(await this.extensionService.activateByEvent("onDebug"),s&&await(0,$.RZ)(this.configurationService,this.editorService),await this.extensionService.whenInstalledExtensionsRegistered(),t||(t=this.configurationManager.selectedConfiguration.name),"string"==typeof t&&e?(n=e.getConfiguration(t),o=e.getCompound(t)):"string"!=typeof t&&(n=t),o){if(!o.configurations)throw new Error(w.NC({key:"compoundMustHaveConfigurations",comment:['compound indicates a "compounds" configuration item','"configurations" is an attribute and should not be localized']},'Compound must have "configurations" attribute set in order to start multiple configurations.'));if(o.preLaunchTask&&0===await this.taskRunner.runTaskAndCheckErrors(e?.workspace||this.contextService.getWorkspace(),o.preLaunchTask))return this.endInitializingState(),!1;o.stopAll&&(i={...i,compoundRoot:new dt});const t=(await Promise.all(o.configurations.map((t=>{const s="string"==typeof t?t:t.name;if(s===o.name)return Promise.resolve(!1);let n;if("string"==typeof t){const t=this.configurationManager.getLaunches().filter((e=>!!e.getConfiguration(s)));if(1===t.length)n=t[0];else{if(!(e&&t.length>1&&t.indexOf(e)>=0))throw new Error(0===t.length?w.NC("noConfigurationNameInWorkspace","Could not find launch configuration '{0}' in the workspace.",s):w.NC("multipleConfigurationNamesInWorkspace","There are multiple launch configurations '{0}' in the workspace. Use folder name to qualify the configuration.",s));n=e}}else if(t.folder){const e=this.configurationManager.getLaunches().filter((e=>e.workspace&&e.workspace.name===t.folder&&!!e.getConfiguration(t.name)));if(1!==e.length)throw new Error(w.NC("noFolderWithName","Can not find folder with name '{0}' for configuration '{1}' in compound '{2}'.",t.folder,t.name,o.name));n=e[0]}return this.createSession(n,n.getConfiguration(s),i)})))).every((e=>!!e));return this.endInitializingState(),t}if(t&&!n){const i=e?w.NC("configMissing","Configuration '{0}' is missing in 'launch.json'.","string"==typeof t?t:t.name):w.NC("launchJsonDoesNotExist","'launch.json' does not exist for passed workspace folder.");throw new Error(i)}const r=await this.createSession(e,n,i);return this.endInitializingState(),r}catch(e){return this.notificationService.error(e),this.endInitializingState(),Promise.reject(e)}}async createSession(e,t,i){let s;t?s=t.type:t=Object.create(null),(i&&i.noDebug||i&&void 0===i.noDebug&&i.parentSession&&i.parentSession.configuration.noDebug)&&(t.noDebug=!0);const o=(0,b.I8)(t);let r,c;s||(c=this.editorService.activeEditor,c&&c.resource&&(s=this.chosenEnvironments[c.resource.toString()]),s||(r=await this.adapterManager.guessDebugger(!1),r&&(s=r.type)));const d=new l.A,u=(0,f.R)();this.sessionCancellationTokens.set(u,d);const h=await this.configurationManager.resolveConfigurationByProviders(e&&e.workspace?e.workspace.uri:void 0,s,t,d.token);if(h&&h.type)try{let t=await this.substituteVariables(e,h);if(!t)return!1;if(d.token.isCancellationRequested)return!1;const l=e?.workspace||this.contextService.getWorkspace();if(0===await this.taskRunner.runTaskAndCheckErrors(l,t.preLaunchTask))return!1;const g=await this.configurationManager.resolveDebugConfigurationWithSubstitutedVariables(e&&e.workspace?e.workspace.uri:void 0,s,t,d.token);if(!g)return e&&s&&null===g&&!d.token.isCancellationRequested&&await e.openConfigFile({preserveFocus:!0,type:s},d.token),!1;t=g;const p=this.adapterManager.getDebugger(t.type);if(!p||"attach"!==h.request&&"launch"!==h.request){let e;e="attach"!==h.request&&"launch"!==h.request?h.request?w.NC("debugRequestNotSupported","Attribute '{0}' has an unsupported value '{1}' in the chosen debug configuration.","request",h.request):w.NC("debugRequesMissing","Attribute '{0}' is missing from the chosen debug configuration.","request"):t.type?w.NC("debugTypeNotSupported","Configured debug type '{0}' is not supported.",t.type):w.NC("debugTypeMissing","Missing property 'type' for the chosen launch configuration.");const i=[];return i.push(new a.aU("installAdditionalDebuggers",w.NC({key:"installAdditionalDebuggers",comment:['Placeholder is the debug type, so for example "node", "python"']},"Install {0} Extension",t.type),void 0,!0,(async()=>this.commandService.executeCommand("debug.installAdditionalDebuggers",t?.type)))),await this.showError(e,i),!1}if(!p.enabled)return await this.showError((0,n.RB)(p.type),[]),!1;const b=await this.doCreateSession(u,e?.workspace,{resolved:t,unresolved:o},i);return b&&r&&c&&c.resource&&(this.chosenEnvironments[c.resource.toString()]=r.type,this.debugStorage.storeChosenEnvironments(this.chosenEnvironments)),b}catch(t){return t&&t.message?await this.showError(t.message):1===this.contextService.getWorkbenchState()&&await this.showError(w.NC("noFolderWorkspaceDebugError","The active file can not be debugged. Make sure it is saved and that you have a debug extension installed for that file type.")),e&&!d.token.isCancellationRequested&&await e.openConfigFile({preserveFocus:!0},d.token),!1}return e&&s&&null===h&&!d.token.isCancellationRequested&&await e.openConfigFile({preserveFocus:!0,type:s},d.token),!1}async doCreateSession(e,t,i,s){const o=this.instantiationService.createInstance(it,e,i,t,this.model,s);if(s?.startedByUser&&this.model.getSessions().some((e=>e.getLabel()===o.getLabel()))&&!0!==i.resolved.suppressMultipleSessionWarning&&!(await this.dialogService.confirm({message:w.NC("multipleSession","'{0}' is already running. Do you want to start another instance?",o.getLabel())})).confirmed)return!1;this.model.addSession(o),this.registerSessionListeners(o),this._onWillNewSession.fire(o);const r=this.configurationService.getValue("debug").openDebug;i.resolved.noDebug||!("openOnSessionStart"===r||"neverOpen"!==r&&this.viewModel.firstSessionStart)||o.suppressDebugView||await this.paneCompositeService.openPaneComposite(n.f3,0);try{await this.launchOrAttachToSession(o);const e=o.configuration.internalConsoleOptions||this.configurationService.getValue("debug").internalConsoleOptions;("openOnSessionStart"===e||this.viewModel.firstSessionStart&&"openOnFirstSessionStart"===e)&&this.viewsService.openView(n.FT,!1),this.viewModel.firstSessionStart=!1;const t=this.configurationService.getValue("debug").showSubSessionsInToolBar,i=this.model.getSessions();return(t?i:i.filter((e=>!e.parentSession))).length>1&&this.viewModel.setMultiSessionView(!0),this._onDidNewSession.fire(o),!0}catch(e){if(h.n2(e))return!1;if(o&&o.getReplElements().length>0&&this.viewsService.openView(n.FT,!1),o.configuration&&"attach"===o.configuration.request&&o.configuration.__autoAttach)return!1;const t=e instanceof Error?e.message:e;return!1!==e.showUser&&await this.showError(t,(0,u.TF)(e)?e.actions:[]),!1}}async launchOrAttachToSession(e,t=!1){const i=this.adapterManager.getDebugger(e.configuration.type);try{await e.initialize(i),await e.launchOrAttach(e.configuration);const s=!!e.root&&!!this.configurationService.getValue("launch",{resource:e.root.uri});await this.telemetry.logDebugSessionStart(i,s),(t||!this.viewModel.focusedSession||e.parentSession===this.viewModel.focusedSession&&e.compact)&&await this.focusStackFrame(void 0,void 0,e)}catch(t){return this.viewModel.focusedSession===e&&await this.focusStackFrame(void 0),Promise.reject(t)}}registerSessionListeners(e){const t=new d.pY((()=>{3===e.state&&this.viewModel.focusedSession===e&&this.viewModel.setFocus(void 0,this.viewModel.focusedThread,e,!1)}),200);this.disposables.add(e.onDidChangeState((()=>{3===e.state&&this.viewModel.focusedSession===e&&t.schedule(),e===this.viewModel.focusedSession&&this.onStateChange()}))),this.disposables.add(e.onDidEndAdapter((async t=>{t&&(t.error&&this.notificationService.error(w.NC("debugAdapterCrash","Debug adapter process has terminated unexpectedly ({0})",t.error.message||t.error.toString())),this.telemetry.logDebugSessionStop(e,t));const i=(0,$.Zf)(e);if(i&&3===i.state&&i.configuration.noDebug&&this.extensionHostDebugService.close(i.getId()),e.configuration.postDebugTask){const t=e.root??this.contextService.getWorkspace();try{await this.taskRunner.runTask(t,e.configuration.postDebugTask)}catch(e){this.notificationService.error(e)}}this.endInitializingState(),this.cancelTokens(e.getId()),this._onDidEndSession.fire(e);const s=this.viewModel.focusedSession;if(s&&s.getId()===e.getId()){const{session:e,thread:t,stackFrame:i}=xt(this.model,void 0,void 0,void 0,s);this.viewModel.setFocus(i,t,e,!1)}if(0===this.model.getSessions().length&&(this.viewModel.setMultiSessionView(!1),this.layoutService.isVisible("workbench.parts.sidebar")&&this.configurationService.getValue("debug").openExplorerOnEnd&&this.paneCompositeService.openPaneComposite(Ct.f3,0),this.model.getDataBreakpoints().filter((e=>!e.canPersist)).forEach((e=>this.model.removeDataBreakpoints(e.getId()))),this.configurationService.getValue("debug").console.closeOnEnd)){const e=this.viewDescriptorService.getViewContainerByViewId(n.FT);e&&this.viewsService.isViewContainerVisible(e.id)&&this.viewsService.closeViewContainer(e.id)}this.model.removeExceptionBreakpointsForSession(e.getId())})))}async restartSession(e,t){e.saveBeforeRestart&&await(0,$.RZ)(this.configurationService,this.editorService);const i=!!t,s=async()=>{if(i)return Promise.resolve(1);const t=e.root||this.contextService.getWorkspace();await this.taskRunner.runTask(t,e.configuration.preRestartTask),await this.taskRunner.runTask(t,e.configuration.postDebugTask);const s=await this.taskRunner.runTaskAndCheckErrors(t,e.configuration.preLaunchTask);return 1!==s?s:this.taskRunner.runTaskAndCheckErrors(t,e.configuration.postRestartTask)},n=(0,$.Zf)(e);if(n)return void(1===await s()&&this.extensionHostDebugService.reload(n.getId()));let o,r=!1;const a=e.root?this.configurationManager.getLaunch(e.root.uri):void 0;a&&(o=a.getConfiguration(e.configuration.name),o&&!(0,b.fS)(o,e.unresolvedConfiguration)&&(o.type=e.configuration.type,o.noDebug=e.configuration.noDebug,r=!0));let c=e.configuration;if(a&&r&&o){const t=new l.A;this.sessionCancellationTokens.set(e.getId(),t);const i=await this.configurationManager.resolveConfigurationByProviders(a.workspace?a.workspace.uri:void 0,o.type,o,t.token);i?(c=await this.substituteVariables(a,i),c&&!t.token.isCancellationRequested&&(c=await this.configurationManager.resolveDebugConfigurationWithSubstitutedVariables(a&&a.workspace?a.workspace.uri:void 0,o.type,c,t.token))):c=i}if(c&&e.setConfiguration({resolved:c,unresolved:o}),e.configuration.__restart=t,e.capabilities.supportsRestartRequest)return void(1===await s()&&await e.restart());const d=!!this.viewModel.focusedSession&&e.getId()===this.viewModel.focusedSession.getId();return i?await e.disconnect(!0):await e.terminate(!0),new Promise(((t,i)=>{setTimeout((async()=>{if(1===await s()){if(!c)return t(void 0);try{await this.launchOrAttachToSession(e,d),this._onDidNewSession.fire(e),t(void 0)}catch(e){i(e)}}}),300)}))}async stopSession(e,t=!1,i=!1){if(e)return t?e.disconnect(void 0,i):e.terminate();const s=this.model.getSessions();return 0===s.length&&(this.taskRunner.cancel(),await this.quickInputService.cancel(),this.endInitializingState(),this.cancelTokens(void 0)),Promise.all(s.map((e=>t?e.disconnect(void 0,i):e.terminate())))}async substituteVariables(e,t){const i=this.adapterManager.getDebugger(t.type);if(i){let s;if(e&&e.workspace)s=e.workspace;else{const e=this.contextService.getWorkspace().folders;1===e.length&&(s=e[0])}try{return await i.substituteVariables(s,t)}catch(i){return void this.showError(i.message,void 0,!!e?.getConfiguration(t.name))}}return Promise.resolve(t)}async showError(e,t=[],i=!0){const s=new a.aU(ue.TP,ue.cG,void 0,!0,(()=>this.commandService.executeCommand(ue.TP))),n=t.filter((e=>e.id.endsWith(".command"))).length>0?t:[...t,...i?[s]:[]];await this.dialogService.prompt({type:m.Z.Error,message:e,buttons:n.map((e=>({label:e.label,run:()=>e.run()}))),cancelButton:!0})}async focusStackFrame(e,t,i,s){const{stackFrame:n,thread:o,session:a}=xt(this.model,e,t,i);if(n){const e=await n.openInEditor(this.editorService,s?.preserveFocus??!0,s?.sideBySide,s?.pinned);if(e)if(e.input===St.n.instance);else{const t=e.getControl();if(n&&(0,v.CL)(t)&&t.hasModel()){const e=t.getModel(),i=n.range.startLineNumber;if(i>=1&&i<=e.getLineCount()){const e=t.getModel().getLineContent(i);r.Z9(w.NC({key:"debuggingPaused",comment:['First placeholder is the file line content, second placeholder is the reason why debugging is stopped, for example "breakpoint", third is the stack frame name, and last is the line number.']},"{0}, debugging paused {1}, {2}:{3}",e,o&&o.stoppedDetails?`, reason ${o.stoppedDetails.reason}`:"",n.source?n.source.name:"",n.range.startLineNumber))}}}}a?this.debugType.set(a.configuration.type):this.debugType.reset(),this.viewModel.setFocus(n,o,a,!!s?.explicit)}addWatchExpression(e){const t=this.model.addWatchExpression(e);e||this.viewModel.setSelectedExpression(t,!1),this.debugStorage.storeWatchExpressions(this.model.getWatchExpressions())}renameWatchExpression(e,t){this.model.renameWatchExpression(e,t),this.debugStorage.storeWatchExpressions(this.model.getWatchExpressions())}moveWatchExpression(e,t){this.model.moveWatchExpression(e,t),this.debugStorage.storeWatchExpressions(this.model.getWatchExpressions())}removeWatchExpressions(e){this.model.removeWatchExpressions(e),this.debugStorage.storeWatchExpressions(this.model.getWatchExpressions())}canSetBreakpointsIn(e){return this.adapterManager.canSetBreakpointsIn(e)}async enableOrDisableBreakpoints(e,t){t?(this.model.setEnablement(t,e),this.debugStorage.storeBreakpoints(this.model),t instanceof Ue.Uo?await this.sendBreakpoints(t.originalUri):t instanceof Ue.Tp?await this.sendFunctionBreakpoints():t instanceof Ue.K1?await this.sendDataBreakpoints():t instanceof Ue.k9?await this.sendInstructionBreakpoints():await this.sendExceptionBreakpoints()):(this.model.enableOrDisableAllBreakpoints(e),this.debugStorage.storeBreakpoints(this.model),await this.sendAllBreakpoints()),this.debugStorage.storeBreakpoints(this.model)}async addBreakpoints(e,t,i=!0){const s=this.model.addBreakpoints(e,t);return i&&s.forEach((t=>r.i7(w.NC("breakpointAdded","Added breakpoint, line {0}, file {1}",t.lineNumber,e.fsPath)))),this.debugStorage.storeBreakpoints(this.model),await this.sendBreakpoints(e),this.debugStorage.storeBreakpoints(this.model),s}async updateBreakpoints(e,t,i){this.model.updateBreakpoints(t),this.debugStorage.storeBreakpoints(this.model),i?this.breakpointsToSendOnResourceSaved.add(e):(await this.sendBreakpoints(e),this.debugStorage.storeBreakpoints(this.model))}async removeBreakpoints(e){const t=this.model.getBreakpoints().filter((t=>!e||t.getId()===e));t.forEach((e=>r.i7(w.NC("breakpointRemoved","Removed breakpoint, line {0}, file {1}",e.lineNumber,e.uri.fsPath))));const i=(0,c.EB)(t,(e=>e.originalUri.toString())).map((e=>e.originalUri));this.model.removeBreakpoints(t),this.debugStorage.storeBreakpoints(this.model),await Promise.all(i.map((e=>this.sendBreakpoints(e))))}setBreakpointsActivated(e){return this.model.setBreakpointsActivated(e),this.sendAllBreakpoints()}addFunctionBreakpoint(e,t){this.model.addFunctionBreakpoint(e||"",t)}async updateFunctionBreakpoint(e,t){this.model.updateFunctionBreakpoint(e,t),this.debugStorage.storeBreakpoints(this.model),await this.sendFunctionBreakpoints()}async removeFunctionBreakpoints(e){this.model.removeFunctionBreakpoints(e),this.debugStorage.storeBreakpoints(this.model),await this.sendFunctionBreakpoints()}async addDataBreakpoint(e,t,i,s,n){this.model.addDataBreakpoint(e,t,i,s,n),this.debugStorage.storeBreakpoints(this.model),await this.sendDataBreakpoints(),this.debugStorage.storeBreakpoints(this.model)}async removeDataBreakpoints(e){this.model.removeDataBreakpoints(e),this.debugStorage.storeBreakpoints(this.model),await this.sendDataBreakpoints()}async addInstructionBreakpoint(e,t,i,s){this.model.addInstructionBreakpoint(e,t,i,s),this.debugStorage.storeBreakpoints(this.model),await this.sendInstructionBreakpoints(),this.debugStorage.storeBreakpoints(this.model)}async removeInstructionBreakpoints(e){this.model.removeInstructionBreakpoints(e),this.debugStorage.storeBreakpoints(this.model),await this.sendInstructionBreakpoints()}setExceptionBreakpointFallbackSession(e){this.model.setExceptionBreakpointFallbackSession(e),this.debugStorage.storeBreakpoints(this.model)}setExceptionBreakpointsForSession(e,t){this.model.setExceptionBreakpointsForSession(e.getId(),t),this.debugStorage.storeBreakpoints(this.model)}async setExceptionBreakpointCondition(e,t){this.model.setExceptionBreakpointCondition(e,t),this.debugStorage.storeBreakpoints(this.model),await this.sendExceptionBreakpoints()}async sendAllBreakpoints(e){const t=(0,c.EB)(this.model.getBreakpoints(),(e=>e.originalUri.toString())).map((t=>this.sendBreakpoints(t.originalUri,!1,e)));e?.capabilities.supportsConfigurationDoneRequest?await Promise.all([...t,this.sendFunctionBreakpoints(e),this.sendDataBreakpoints(e),this.sendInstructionBreakpoints(e),this.sendExceptionBreakpoints(e)]):(await Promise.all(t),await this.sendFunctionBreakpoints(e),await this.sendDataBreakpoints(e),await this.sendInstructionBreakpoints(e),await this.sendExceptionBreakpoints(e))}async sendBreakpoints(e,t=!1,i){const s=this.model.getBreakpoints({originalUri:e,enabledOnly:!0});await It(this.model,i,(async i=>{i.configuration.noDebug||await i.sendBreakpoints(e,s,t)}))}async sendFunctionBreakpoints(e){const t=this.model.getFunctionBreakpoints().filter((e=>e.enabled&&this.model.areBreakpointsActivated()));await It(this.model,e,(async e=>{e.capabilities.supportsFunctionBreakpoints&&!e.configuration.noDebug&&await e.sendFunctionBreakpoints(t)}))}async sendDataBreakpoints(e){const t=this.model.getDataBreakpoints().filter((e=>e.enabled&&this.model.areBreakpointsActivated()));await It(this.model,e,(async e=>{e.capabilities.supportsDataBreakpoints&&!e.configuration.noDebug&&await e.sendDataBreakpoints(t)}))}async sendInstructionBreakpoints(e){const t=this.model.getInstructionBreakpoints().filter((e=>e.enabled&&this.model.areBreakpointsActivated()));await It(this.model,e,(async e=>{e.capabilities.supportsInstructionBreakpoints&&!e.configuration.noDebug&&await e.sendInstructionBreakpoints(t)}))}sendExceptionBreakpoints(e){return It(this.model,e,(async e=>{const t=this.model.getExceptionBreakpointsForSession(e.getId()).filter((e=>e.enabled));(!e.capabilities.supportsConfigurationDoneRequest||e.capabilities.exceptionBreakpointFilters&&0!==e.capabilities.exceptionBreakpointFilters.length)&&(e.configuration.noDebug||await e.sendExceptionBreakpoints(t))}))}onFileChanges(e){const t=this.model.getBreakpoints().filter((t=>e.contains(t.originalUri,2)));t.length&&this.model.removeBreakpoints(t);const i=[];for(const t of this.breakpointsToSendOnResourceSaved)e.contains(t,0)&&i.push(t);for(const e of i)this.breakpointsToSendOnResourceSaved.delete(e),this.sendBreakpoints(e,!0)}async runTo(e,t,i){let s,n=this.getViewModel().focusedThread;const o=e=>(2===e||0===e)&&(s&&this.removeBreakpoints(s.getId()),!0);if(await(async()=>{if(!this.getModel().getBreakpoints({column:i,lineNumber:t,uri:e}).length){const o=await this.addAndValidateBreakpoints(e,t,i);o.thread&&(n=o.thread),o.breakpoint&&(s=o.breakpoint)}return{threadToContinue:n,breakpointToRemove:s}})(),0===this.state){const{launch:e,name:t,getConfig:i}=this.getConfigurationManager().selectedConfiguration,s=await i(),n=s?Object.assign((0,b.I8)(s),{}):t,r=this.onDidChangeState((e=>{o(e)&&r.dispose()}));await this.startDebugging(e,n,void 0,!0)}if(2===this.state){const e=this.getViewModel().focusedSession;if(!e||!n)return;const t=n.session.onDidChangeState((()=>{o(e.state)&&t.dispose()}));await n.continue()}}async addAndValidateBreakpoints(e,t,i){const s=this.getModel(),n=this.getViewModel(),o=await this.addBreakpoints(e,[{lineNumber:t,column:i}],!1),r=o?.[0];if(!r)return{breakpoint:void 0,thread:n.focusedThread};if(!r.verified){let e;await(0,d.ek)(new Promise((t=>{e=s.onDidChangeBreakpoints((()=>{r.verified&&t()}))})),2e3),e.dispose()}let a=n.focusedThread,c=0;for(const t of r.sessionsThatVerified){const i=s.getSession(t);if(!i)continue;const o=i.getAllThreads().filter((e=>e.stopped));if(c<3&&n.focusedThread&&o.includes(n.focusedThread)&&(a=n.focusedThread,c=3),c<2){const t=o.find((t=>{const i=t.getTopStackFrame();return i&&this.uriIdentityService.extUri.isEqual(i.source.uri,e)}));t&&(a=t,c=2)}c<1&&(a=o[0],c=2)}return{thread:a,breakpoint:r}}};function xt(e,t,i,s,n){if(!s)if(t||i)s=t?t.thread.session:i.session;else{const t=e.getSessions();s=t.find((e=>2===e.state))||t.find((e=>e!==n&&e!==n?.parentSession))||(t.length?t[0]:void 0)}if(!i)if(t)i=t.thread;else{const e=s?s.getAllThreads():void 0;i=e&&e.find((e=>e.stopped))||(e&&e.length?e[0]:void 0)}return!t&&i&&(t=i.getTopStackFrame()),{session:s,thread:i,stackFrame:t}}async function It(e,t,i){t?await i(t):await Promise.all(e.getSessions().map((e=>i(e))))}Dt=(0,o.g)([(0,o.f)(0,oe.AR),(0,o.f)(1,tt.c),(0,o.f)(2,_.qC),(0,o.f)(3,_.XH),(0,o.f)(4,I.lT),(0,o.f)(5,ce.Ss),(0,o.f)(6,yt.ze),(0,o.f)(7,T.ec),(0,o.f)(8,k.i6),(0,o.f)(9,ae.g),(0,o.f)(10,x.TG),(0,o.f)(11,re.QS),(0,o.f)(12,D.sn),(0,o.f)(13,C.Ui),(0,o.f)(14,y.Q),(0,o.f)(15,kt.By),(0,o.f)(16,S.H),(0,o.f)(17,E.eJ),(0,o.f)(18,L.N2),(0,o.f)(19,N.v)],Dt);var Et=i(96364);class Nt{constructor(){this.referenceProvider=new Et.c(this._score.bind(this)),this.renameProvider=new Et.c(this._score.bind(this)),this.codeActionProvider=new Et.c(this._score.bind(this)),this.definitionProvider=new Et.c(this._score.bind(this)),this.typeDefinitionProvider=new Et.c(this._score.bind(this)),this.declarationProvider=new Et.c(this._score.bind(this)),this.implementationProvider=new Et.c(this._score.bind(this)),this.documentSymbolProvider=new Et.c(this._score.bind(this)),this.inlayHintsProvider=new Et.c(this._score.bind(this)),this.colorProvider=new Et.c(this._score.bind(this)),this.codeLensProvider=new Et.c(this._score.bind(this)),this.documentFormattingEditProvider=new Et.c(this._score.bind(this)),this.documentRangeFormattingEditProvider=new Et.c(this._score.bind(this)),this.onTypeFormattingEditProvider=new Et.c(this._score.bind(this)),this.signatureHelpProvider=new Et.c(this._score.bind(this)),this.hoverProvider=new Et.c(this._score.bind(this)),this.documentHighlightProvider=new Et.c(this._score.bind(this)),this.selectionRangeProvider=new Et.c(this._score.bind(this)),this.foldingRangeProvider=new Et.c(this._score.bind(this)),this.linkProvider=new Et.c(this._score.bind(this)),this.inlineCompletionsProvider=new Et.c(this._score.bind(this)),this.completionProvider=new Et.c(this._score.bind(this)),this.linkedEditingRangeProvider=new Et.c(this._score.bind(this)),this.inlineValuesProvider=new Et.c(this._score.bind(this)),this.evaluatableExpressionProvider=new Et.c(this._score.bind(this)),this.documentRangeSemanticTokensProvider=new Et.c(this._score.bind(this)),this.documentSemanticTokensProvider=new Et.c(this._score.bind(this)),this.documentOnDropEditProvider=new Et.c(this._score.bind(this)),this.documentPasteEditProvider=new Et.c(this._score.bind(this))}setNotebookTypeResolver(e){this._notebookTypeResolver=e}_score(e){return this._notebookTypeResolver?.(e)}}var Tt=i(71922),Lt=i(44349),_t=i(41122),At=i(40093);class Mt extends At.N{static{this.INPUT_OR_COMMAND_VARIABLES_PATTERN=/\${((input|command):(.*?))}/g}constructor(e,t,i,s,n,o,r,a,c,l){super({getFolderUri:e=>{const t=o.getWorkspace().folders.filter((t=>t.name===e)).pop();return t?t.uri:void 0},getWorkspaceFolderCount:()=>o.getWorkspace().folders.length,getConfigurationValue:(e,t)=>s.getValue(t,e?{resource:e}:{}),getAppRoot:()=>e.getAppRoot(),getExecPath:()=>e.getExecPath(),getFilePath:()=>{const e=_t.zK.getOriginalUri(i.activeEditor,{supportSideBySide:_t.YX.PRIMARY,filterByScheme:[H.lg.file,H.lg.vscodeUserData,this.pathService.defaultUriScheme]});if(e)return this.labelService.getUriLabel(e,{noPrefix:!0})},getWorkspaceFolderPathForFile:()=>{const e=_t.zK.getOriginalUri(i.activeEditor,{supportSideBySide:_t.YX.PRIMARY,filterByScheme:[H.lg.file,H.lg.vscodeUserData,this.pathService.defaultUriScheme]});if(!e)return;const t=o.getWorkspaceFolder(e);return t?this.labelService.getUriLabel(t.uri,{noPrefix:!0}):void 0},getSelectedText:()=>{const e=i.activeTextEditorControl;let t=null;if((0,v.CL)(e))t=e;else if((0,v.QI)(e)){const i=e.getOriginalEditor(),s=e.getModifiedEditor();t=i.hasWidgetFocus()?i:s}const s=t?.getModel(),n=t?.getSelection();if(s&&n)return s.getValueInRange(n)},getLineNumber:()=>{const e=i.activeTextEditorControl;if((0,v.CL)(e)){const t=e.getSelection();if(t){const e=t.positionLineNumber;return String(e)}}},getExtension:e=>l.getExtension(e)},a,c.userHome().then((e=>e.path)),t),this.configurationService=s,this.commandService=n,this.workspaceContextService=o,this.quickInputService=r,this.labelService=a,this.pathService=c,this.userInputAccessQueue=new d.ci}async resolveWithInteractionReplace(e,t,i,s,n){return t=await this.resolveAnyAsync(e,t),this.resolveWithInteraction(e,t,i,s,n).then((i=>i?i.size>0?this.resolveAnyAsync(e,t,Object.fromEntries(i)):t:null))}async resolveWithInteraction(e,t,i,s,n){const o=await this.resolveAnyMap(e,t);t=o.newConfig;const r=o.resolvedVariables;return this.resolveWithInputAndCommands(e,t,s,i,n).then((e=>{if(this.updateMapping(e,r))return r}))}updateMapping(e,t){if(!e)return!1;for(const[i,s]of Object.entries(e))t.set(i,s);return!0}async resolveWithInputAndCommands(e,t,i,s,n){if(!t)return Promise.resolve(void 0);let o=[];if(1!==this.workspaceContextService.getWorkbenchState()&&s){const t=e?{resource:e.uri}:{},i=this.configurationService.inspect(s,t);if(i&&(i.userValue||i.workspaceValue||i.workspaceFolderValue))switch(n){case 2:o=i.userValue?.inputs;break;case 5:o=i.workspaceValue?.inputs;break;default:o=i.workspaceFolderValue?.inputs}else{const e=this.configurationService.getValue(s,t);e&&(o=e.inputs)}}const r=[];this.findVariables(t,r);const a=Object.create(null);for(const e of r){const[s,n]=e.split(":",2);let r;switch(s){case"input":r=await this.showUserInput(n,o);break;case"command":{const e=(i?i[n]:void 0)||n;if(r=await this.commandService.executeCommand(e,t),"string"!=typeof r&&!V.Jp(r))throw new Error(w.NC("commandVariable.noStringType","Cannot substitute command variable '{0}' because command did not return a result of type string.",e));break}default:this._contributedVariables.has(e)&&(r=await this._contributedVariables.get(e)())}if("string"!=typeof r)return;a[e]=r}return a}findVariables(e,t){if("string"==typeof e){let i;for(;null!==(i=Mt.INPUT_OR_COMMAND_VARIABLES_PATTERN.exec(e));)if(4===i.length){const e=i[1];t.indexOf(e)<0&&t.push(e)}for(const i of this._contributedVariables.keys())t.indexOf(i)<0&&e.indexOf("${"+i+"}")>=0&&t.push(i)}else if(Array.isArray(e))for(const i of e)this.findVariables(i,t);else if(e)for(const i of Object.values(e))this.findVariables(i,t)}showUserInput(e,t){if(!t)return Promise.reject(new Error(w.NC("inputVariable.noInputSection","Variable '{0}' must be defined in an '{1}' section of the debug or task configuration.",e,"input")));const i=t.filter((t=>t.id===e)).pop();if(i){const t=t=>{throw new Error(w.NC("inputVariable.missingAttribute","Input variable '{0}' is of type '{1}' and must include '{2}'.",e,i.type,t))};switch(i.type){case"promptString":{V.HD(i.description)||t("description");const e={prompt:i.description,ignoreFocusLost:!0};return i.default&&(e.value=i.default),i.password&&(e.password=i.password),this.userInputAccessQueue.queue((()=>this.quickInputService.input(e))).then((e=>e))}case"pickString":{if(V.HD(i.description)||t("description"),Array.isArray(i.options))for(const e of i.options)V.HD(e)||V.HD(e.value)||t("value");else t("options");const e=new Array;for(const t of i.options){const s=V.HD(t)?t:t.value,n=V.HD(t)?void 0:t.label,o={label:n?`${n}: ${s}`:s,value:s};s===i.default?(o.description=w.NC("inputVariable.defaultInputValue","(Default)"),e.unshift(o)):e.push(o)}const s={placeHolder:i.description,matchOnDetail:!0,ignoreFocusLost:!0};return this.userInputAccessQueue.queue((()=>this.quickInputService.pick(e,s,void 0))).then((e=>{if(e)return e.value}))}case"command":return V.HD(i.command)||t("command"),this.userInputAccessQueue.queue((()=>this.commandService.executeCommand(i.command,i.args))).then((t=>{if("string"==typeof t||V.Jp(t))return t;throw new Error(w.NC("inputVariable.command.noStringType","Cannot substitute input variable '{0}' because command '{1}' did not return a result of type string.",e,i.command))}));default:throw new Error(w.NC("inputVariable.unknownType","Input variable '{0}' can only be of type 'promptString', 'pickString', or 'command'.",e))}}return Promise.reject(new Error(w.NC("inputVariable.undefinedVariable","Undefined input variable '{0}' encountered. Remove or define '{0}' to continue.",e)))}}var Bt=i(51858);let Rt=class extends Mt{constructor(e,t,i,s,n,o,r,a){super({getAppRoot:()=>{},getExecPath:()=>{}},Promise.resolve(Object.create(null)),e,t,i,s,n,o,r,a)}};Rt=(0,o.g)([(0,o.f)(0,oe.AR),(0,o.f)(1,C.Ui),(0,o.f)(2,S.H),(0,o.f)(3,T.ec),(0,o.f)(4,E.eJ),(0,o.f)(5,Lt.e),(0,o.f)(6,Bt.a),(0,o.f)(7,re.QS)],Rt);var Ft=i(76779),Vt=i(3277);(0,Vt.Z)('.codicon-debug-hint{cursor:pointer}.codicon-debug-hint:not([class*=codicon-debug-breakpoint]):not([class*=codicon-debug-stackframe]){opacity:.4!important}.inline-breakpoint-widget.codicon{align-items:center;display:flex!important}.inline-breakpoint-widget.codicon-debug-breakpoint-disabled{opacity:.7}.monaco-editor .inline-breakpoint-widget.line-start{left:-8px!important}.monaco-editor .debug-breakpoint-placeholder{display:inline-flex;margin-top:-1px;vertical-align:middle;width:.9em}.codicon-debug-breakpoint.codicon-debug-stackframe-focused:after,.codicon-debug-breakpoint.codicon-debug-stackframe:after{content:"\\eb8a";position:absolute}.monaco-editor .debug-top-stack-frame-column{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;align-items:center;display:inline-flex;font:normal normal normal 16px/1 codicon;margin-left:0;margin-right:4px;margin-top:-1px;text-rendering:auto;vertical-align:middle;width:.9em}.monaco-editor .debug-top-stack-frame-column.start-of-line{margin-top:0;position:absolute;top:50%;transform:translate(-17px,-50%)}.monaco-editor .inline-breakpoint-widget{cursor:pointer}.monaco-workbench .debug-view-content .monaco-list-row .monaco-tl-contents{overflow:hidden;text-overflow:ellipsis}.monaco-workbench .monaco-list-row .expression{display:flex}.monaco-workbench .debug-hover-widget .monaco-list-row .expression,.monaco-workbench .debug-pane .monaco-list-row .expression{font-family:var(--monaco-monospace-font);font-size:13px;overflow:hidden;text-overflow:ellipsis;white-space:pre}.monaco-workbench.mac .debug-hover-widget .monaco-list-row .expression,.monaco-workbench.mac .debug-pane .monaco-list-row .expression{font-size:11px}.monaco-workbench .monaco-list-row .expression .value{margin-left:6px}.monaco-workbench .monaco-list-row .expression .lazy-button{align-self:center;border-radius:5px;display:none;margin-left:3px}.monaco-workbench .monaco-list-row .expression.lazy .lazy-button{display:inline}.monaco-workbench .monaco-list-row .expression .value a.link:hover{text-decoration:underline}.monaco-workbench .monaco-list-row .expression .value a.link.pointer{cursor:pointer}.monaco-workbench .monaco-list:focus .monaco-list-row.selected .expression .name,.monaco-workbench .monaco-list:focus .monaco-list-row.selected .expression .value{color:inherit}.monaco-workbench .monaco-list-row .expression .name.internal,.monaco-workbench .monaco-list-row .expression .name.virtual{opacity:.5}.monaco-workbench .monaco-list-row .expression .unavailable{font-style:italic}.monaco-workbench .debug-inline-value{background-color:var(--vscode-editor-inlineValuesBackground);color:var(--vscode-editor-inlineValuesForeground)}',{}),(0,Vt.Z)(".monaco-editor .debug-hover-widget{animation-duration:.15s;animation-name:fadeIn;position:absolute;user-select:text;-webkit-user-select:text;white-space:pre;word-break:break-all;z-index:50}.monaco-editor .debug-hover-widget .complex-value{max-width:550px}.monaco-editor .debug-hover-widget .complex-value .tip,.monaco-editor .debug-hover-widget .complex-value .title{font-size:11px;height:18px;line-height:18px;overflow:hidden;padding-left:15px;padding-right:2px;text-overflow:ellipsis;white-space:pre;word-break:normal}.monaco-editor .debug-hover-widget .complex-value .title{border-bottom:1px solid hsla(0,0%,50%,.35)}.monaco-editor .debug-hover-widget .complex-value .tip{border-top:1px solid hsla(0,0%,50%,.35);opacity:.5}.monaco-editor .debug-hover-widget .debug-hover-tree{cursor:pointer;line-height:18px}.monaco-editor .debug-hover-widget .debug-hover-tree .monaco-list-row .monaco-tl-contents{user-select:text;-webkit-user-select:text;white-space:pre}.monaco-editor .debug-hover-widget .debug-hover-tree .monaco-list-rows .monaco-list-row:hover:not(.highlighted):not(.selected):not(.focused){background-color:inherit}.monaco-editor .debug-hover-widget pre{margin-bottom:0;margin-top:0}.monaco-editor .debugHoverHighlight{background-color:rgba(173,214,255,.15)}.monaco-editor .debug-hover-widget>.monaco-scrollable-element>.value{color:hsla(0,0%,42%,.8);font-family:var(--monaco-monospace-font);max-height:500px;overflow:auto;padding:4px 5px;white-space:pre-wrap}.monaco-editor.hc-theme .debugHoverHighlight,.monaco-editor.vs-dark .debugHoverHighlight{background-color:rgba(38,79,120,.25)}",{});var Pt=i(16830),Ot=i(84144),Wt=i(23193),Ht=i(90725),$t=i(83240),Ut=i(28194),qt=i(63809),zt=i(16268),jt=i(10161),Kt=i(65321),Gt=i(7448),Qt=i(49898),Jt=i(59365),Xt=i(24314),Zt=i(84973),Yt=i(5606),ei=i(73910),ti=i(97781);R.B.add("gutterActionsRegistry",new class{constructor(){this._registeredGutterActionsGenerators=new Set}registerGutterActionsGenerator(e){return this._registeredGutterActionsGenerators.add(e),{dispose:()=>{this._registeredGutterActionsGenerators.delete(e)}}}getGutterActionsGenerators(){return Array.from(this._registeredGutterActionsGenerators.values())}});const ii=R.B.as("gutterActionsRegistry");let si=class extends p.JT{static{this.ID="workbench.contrib.editorLineNumberContextMenu"}constructor(e,t,i,s,n){super(),this.editor=e,this.contextMenuService=t,this.menuService=i,this.contextKeyService=s,this.instantiationService=n,this._register(this.editor.onMouseDown((e=>this.doShow(e,!1))))}show(e){this.doShow(e,!0)}doShow(e,t){const i=this.editor.getModel();if(!e.event.rightButton&&!(Ve.dz&&e.event.leftButton&&e.event.ctrlKey)&&!t||3!==e.target.type&&2!==e.target.type||!e.target.position||!i)return;const s=e.target.position.lineNumber,n=this.contextKeyService.createOverlay([["editorLineNumber",s]]),o=this.menuService.createMenu(Ot.eH.EditorLineNumberContext,n),r=[];this.instantiationService.invokeFunction((t=>{for(const e of ii.getGutterActionsGenerators()){const i=new Map;e({lineNumber:s,editor:this.editor,accessor:t},{push:(e,t="navigation")=>{const s=i.get(t)??[];s.push(e),i.set(t,s)}});for(const[e,t]of i.entries())r.push([e,t])}r.sort(((e,t)=>e[0].localeCompare(t[0])));const n=o.getActions({arg:{lineNumber:s,uri:i.uri},shouldForwardArgs:!0});if(r.push(...n),3===e.target.type){const e=this.editor.getSelections(),t={startLineNumber:s,endLineNumber:s,startColumn:1,endColumn:i.getLineLength(s)+1},n=e?.some((e=>!e.isEmpty()&&null!==e.intersectRanges(t)));n||this.editor.setSelection(t,"api")}this.contextMenuService.showContextMenu({getAnchor:()=>e.event,getActions:()=>a.Z0.join(...r.map((e=>e[1]))),onHide:()=>o.dispose()})}))}};si=(0,o.g)([(0,o.f)(1,Yt.i),(0,o.f)(2,Ot.co),(0,o.f)(3,k.i6),(0,o.f)(4,x.TG)],si),(0,Pt._K)(si.ID,si,1);var ni=i(64306);(0,Vt.Z)(".monaco-editor .zone-widget .zone-widget-container.breakpoint-widget{border-color:#007acc;display:flex}.monaco-editor .zone-widget .zone-widget-container.breakpoint-widget .breakpoint-select-container{display:flex;flex-direction:column;flex-shrink:0;justify-content:center;padding:0 10px}.monaco-editor .zone-widget .zone-widget-container.breakpoint-widget .breakpoint-select-container .monaco-select-box{min-height:18px;min-width:100px;padding:2px 20px 2px 8px}.monaco-editor .zone-widget .zone-widget-container.breakpoint-widget .breakpoint-select-container:after{right:14px}.monaco-editor .zone-widget .zone-widget-container.breakpoint-widget .inputContainer{flex:1}",{});var oi=i(27874),ri=i(50187),ai=i(57303),ci=i(29102),di=i(73733),li=i(55621),ui=i(11640),hi=i(60972),gi=i(95099),pi=i(91526),bi=i(68801),mi=i(86253),fi=i(91847);const vi=Kt.$,wi=(0,x.yh)("privateBreakpointWidgetService"),Si="breakpointwidgetdecoration";let Ci=class extends ai.I{constructor(e,t,i,s,n,o,r,a,c,d,l,u,h,g){super(e,{showFrame:!0,showArrow:!1,frameWidth:1,isAccessible:!0}),this.lineNumber=t,this.column=i,this.contextViewService=n,this.debugService=o,this.themeService=r,this.contextKeyService=a,this.instantiationService=c,this.modelService=d,this.codeEditorService=l,this._configurationService=u,this.languageFeaturesService=h,this.keybindingService=g,this.conditionInput="",this.hitCountInput="",this.logMessageInput="",this.toDispose=[];const p=this.editor.getModel();if(p){const e=p.uri,t=this.debugService.getModel().getBreakpoints({lineNumber:this.lineNumber,column:this.column,uri:e});this.breakpoint=t.length?t[0]:void 0}void 0===s?this.breakpoint&&!this.breakpoint.condition&&!this.breakpoint.hitCondition&&this.breakpoint.logMessage?this.context=2:this.breakpoint&&!this.breakpoint.condition&&this.breakpoint.hitCondition?this.context=1:this.context=0:this.context=s,this.toDispose.push(this.debugService.getModel().onDidChangeBreakpoints((e=>{this.breakpoint&&e&&e.removed&&e.removed.indexOf(this.breakpoint)>=0&&this.dispose()}))),this.codeEditorService.registerDecorationType("breakpoint-widget",Si,{}),this.create()}get placeholder(){const e=this.keybindingService.lookupKeybinding(ki.ID)?.getLabel()||"Enter",t=this.keybindingService.lookupKeybinding(yi.ID)?.getLabel()||"Escape";switch(this.context){case 2:return w.NC("breakpointWidgetLogMessagePlaceholder","Message to log when breakpoint is hit. Expressions within {} are interpolated. '{0}' to accept, '{1}' to cancel.",e,t);case 1:return w.NC("breakpointWidgetHitCountPlaceholder","Break when hit count condition is met. '{0}' to accept, '{1}' to cancel.",e,t);default:return w.NC("breakpointWidgetExpressionPlaceholder","Break when expression evaluates to true. '{0}' to accept, '{1}' to cancel.",e,t)}}getInputValue(e){switch(this.context){case 2:return e&&e.logMessage?e.logMessage:this.logMessageInput;case 1:return e&&e.hitCondition?e.hitCondition:this.hitCountInput;default:return e&&e.condition?e.condition:this.conditionInput}}rememberInput(){const e=this.input.getModel().getValue();switch(this.context){case 2:this.logMessageInput=e;break;case 1:this.hitCountInput=e;break;default:this.conditionInput=e}}setInputMode(){if(this.editor.hasModel()){const e=2===this.context?bi.bd:this.editor.getModel().getLanguageId();this.input.getModel().setLanguage(e)}}show(e){const t=this.input.getModel().getLineCount();super.show(e,t+1)}fitHeightToContent(){const e=this.input.getModel().getLineCount();this._relayout(e+1)}_fillContainer(e){this.setCssClass("breakpoint-widget");const t=new oi.j([{text:w.NC("expression","Expression")},{text:w.NC("hitCount","Hit Count")},{text:w.NC("logMessage","Log Message")}],this.context,this.contextViewService,mi.BM,{ariaLabel:w.NC("breakpointType","Breakpoint Type")});this.selectContainer=vi(".breakpoint-select-container"),t.render(Kt.R3(e,this.selectContainer)),t.onDidSelect((e=>{this.rememberInput(),this.context=e.index,this.setInputMode();const t=this.getInputValue(this.breakpoint);this.input.getModel().setValue(t),this.input.focus()})),this.inputContainer=vi(".inputContainer"),this.createBreakpointInput(Kt.R3(e,this.inputContainer)),this.input.getModel().setValue(this.getInputValue(this.breakpoint)),this.toDispose.push(this.input.getModel().onDidChangeContent((()=>{this.fitHeightToContent()}))),this.input.setPosition({lineNumber:1,column:this.input.getModel().getLineMaxColumn(1)}),setTimeout((()=>this.input.focus()),150)}_doLayout(e,t){this.heightInPx=e,this.input.layout({height:e,width:t-113}),this.centerInputVertically()}_onWidth(e){"number"==typeof this.heightInPx&&this._doLayout(this.heightInPx,e)}createBreakpointInput(e){const t=this.contextKeyService.createScoped(e);this.toDispose.push(t);const i=this.instantiationService.createChild(new hi.y([k.i6,t],[wi,this])),s=this.createEditorOptions(),o=(0,pi.q)();this.input=i.createInstance(gi.Gm,e,s,o),n.BG.bindTo(t).set(!0);const r=this.modelService.createModel("",null,W.ov.parse(`${n.lR}:${this.editor.getId()}:breakpointinput`),!0);this.editor.hasModel()&&r.setLanguage(this.editor.getModel().getLanguageId()),this.input.setModel(r),this.setInputMode(),this.toDispose.push(r);const a=()=>{const e=this.input.getModel().getValue()?[]:function(e,t){const i=e.getColor(ei.NOs)?.transparent(.4);return[{range:{startLineNumber:0,endLineNumber:0,startColumn:0,endColumn:1},renderOptions:{after:{contentText:t,color:i?i.toString():void 0}}}]}(this.themeService.getColorTheme(),this.placeholder);this.input.setDecorationsByType("breakpoint-widget",Si,e)};this.input.getModel().onDidChangeContent((()=>a())),this.themeService.onDidColorThemeChange((()=>a())),this.toDispose.push(this.languageFeaturesService.completionProvider.register({scheme:n.lR,hasAccessToAllModels:!0},{_debugDisplayName:"breakpointWidget",provideCompletionItems:(e,t,i,s)=>{let n;const o=this.editor.getModel();var r;return n=o&&(0===this.context||2===this.context&&(r=this.input).getModel().bracketPairs.getBracketPairsInRange(Xt.e.fromPositions(r.getPosition())).some((e=>"{"===e.openingBracketInfo.bracketText)))?(0,li.kL)(this.languageFeaturesService.completionProvider,o,new ri.L(this.lineNumber,1),new li.A9(void 0,(new Set).add(27)),i,s).then((e=>{let i=0;if(0===this.context)i=t.column-1;else{const e=this.input.getModel().getValue();for(;t.column-2-i>=0&&"{"!==e[t.column-2-i]&&" "!==e[t.column-2-i];)i++}return{suggestions:e.items.map((e=>(e.completion.range=Xt.e.fromPositions(t.delta(0,-i),t),e.completion)))}})):Promise.resolve({suggestions:[]}),n}})),this.toDispose.push(this._configurationService.onDidChangeConfiguration((e=>{(e.affectsConfiguration("editor.fontSize")||e.affectsConfiguration("editor.lineHeight"))&&(this.input.updateOptions(this.createEditorOptions()),this.centerInputVertically())})))}createEditorOptions(){const e=this._configurationService.getValue("editor"),t=(0,pi.e)(this._configurationService);return t.fontSize=e.fontSize,t.fontFamily=e.fontFamily,t.lineHeight=e.lineHeight,t.fontLigatures=e.fontLigatures,t.ariaLabel=this.placeholder,t}centerInputVertically(){if(this.container&&"number"==typeof this.heightInPx){const e=this.input.getOption(65),t=this.input.getModel().getLineCount(),i=(this.heightInPx-t*e)/2;this.inputContainer.style.marginTop=i+"px"}}close(e){if(e){let e=this.breakpoint&&this.breakpoint.condition,t=this.breakpoint&&this.breakpoint.hitCondition,i=this.breakpoint&&this.breakpoint.logMessage;if(this.rememberInput(),(this.conditionInput||0===this.context)&&(e=this.conditionInput),(this.hitCountInput||1===this.context)&&(t=this.hitCountInput),(this.logMessageInput||2===this.context)&&(i=this.logMessageInput),this.breakpoint){const s=new Map;s.set(this.breakpoint.getId(),{condition:e,hitCondition:t,logMessage:i}),this.debugService.updateBreakpoints(this.breakpoint.originalUri,s,!1).then(void 0,h.dL)}else{const s=this.editor.getModel();s&&this.debugService.addBreakpoints(s.uri,[{lineNumber:this.lineNumber,column:this.column,enabled:!0,condition:e,hitCondition:t,logMessage:i}])}}this.dispose()}dispose(){super.dispose(),this.input.dispose(),p.B9(this.toDispose),setTimeout((()=>this.editor.focus()),0)}};Ci=(0,o.g)([(0,o.f)(4,Yt.u),(0,o.f)(5,n.tn),(0,o.f)(6,ti.XE),(0,o.f)(7,k.i6),(0,o.f)(8,x.TG),(0,o.f)(9,di.q),(0,o.f)(10,ui.$),(0,o.f)(11,C.Ui),(0,o.f)(12,Tt.p),(0,o.f)(13,fi.d)],Ci);class ki extends Pt._l{static{this.ID="breakpointWidget.action.acceptInput"}constructor(){super({id:ki.ID,precondition:n.pR,kbOpts:{kbExpr:n.BG,primary:3,weight:100}})}runEditorCommand(e,t){e.get(wi).close(!0)}}class yi extends Pt._l{static{this.ID="closeBreakpointWidget"}constructor(){super({id:yi.ID,precondition:n.pR,kbOpts:{kbExpr:ci.u.textInputFocus,primary:9,secondary:[1033],weight:100}})}runEditorCommand(e,t,i){const s=t.getContribution(n.KI);if(s)return s.closeBreakpointWidget();e.get(wi).close(!1)}}(0,Pt.fK)(new ki),(0,Pt.fK)(new yi);const Di=Kt.$,xi={description:"breakpoint-helper-decoration",glyphMarginClassName:be.kS.asClassName(me.os),glyphMargin:{position:Zt.U.Right},stickiness:1};function Ii(e,t,i,s,o,r,a){const c=e.get(n.tn),d=e.get(M.O),{icon:l,message:u,showAdapterUnverifiedMessage:h}=(0,ni.CK)(s,o,i,void 0);let g,p;if(h){let e;p=c.getModel().getSessions().map((t=>{const s=c.getAdapterManager().getDebugger(t.configuration.type),o=s?.strings?.[n.hN.UnverifiedBreakpoints];if(o)return e||(e=(0,V.f6)(d.guessLanguageIdByFilepathOrFirstLine(i.uri))),e&&s.interestedInLanguage(e)?o:void 0})).find((e=>!!e))}if(u)if(g=new Jt.W5(void 0,{isTrusted:!0,supportThemeIcons:!0}),i.condition||i.hitCondition){const e=t.getLanguageId();g.appendCodeblock(e,u),p&&g.appendMarkdown("$(warning) "+p)}else g.appendText(u),p&&g.appendMarkdown("\n\n$(warning) "+p);else p&&(g=new Jt.W5(void 0,{isTrusted:!0,supportThemeIcons:!0}).appendMarkdown(p));let b=null;r&&(b={color:(0,ti.EN)(Ti),position:Zt.sh.Left});const m=i.column&&(a||i.column>t.getLineFirstNonWhitespaceColumn(i.lineNumber));return{description:"breakpoint-decoration",glyphMargin:{position:Zt.U.Right},glyphMarginClassName:be.kS.asClassName(l),glyphMarginHoverMessage:g,stickiness:1,before:m?{content:A.B4,inlineClassName:"debug-breakpoint-placeholder",inlineClassNameAffectsLetterSpacing:!0}:void 0,overviewRuler:b,zIndex:9999}}let Ei=class{constructor(e,t,i,s,o,r,a,c){this.editor=e,this.debugService=t,this.contextMenuService=i,this.instantiationService=s,this.dialogService=r,this.configurationService=a,this.labelService=c,this.breakpointHintDecoration=null,this.toDispose=[],this.ignoreDecorationsChangedEvent=!1,this.ignoreBreakpointsChangeEvent=!1,this.breakpointDecorations=[],this.candidateDecorations=[],this.breakpointWidgetVisible=n.pR.bindTo(o),this.setDecorationsScheduler=new d.pY((()=>this.setDecorations()),30),this.setDecorationsScheduler.schedule(),this.registerListeners()}getContextMenuActionsAtPosition(e,t){if(!this.debugService.getAdapterManager().hasEnabledDebuggers())return[];if(!this.debugService.canSetBreakpointsIn(t))return[];const i=this.debugService.getModel().getBreakpoints({lineNumber:e,uri:t.uri});return this.getContextMenuActions(i,t.uri,e)}registerListeners(){this.toDispose.push(this.editor.onMouseDown((async e=>{if(!this.debugService.getAdapterManager().hasEnabledDebuggers())return;const t=this.editor.getModel();if(!e.target.position||!t||2!==e.target.type||e.target.detail.isAfterLines||!this.marginFreeFromNonDebugDecorations(e.target.position.lineNumber)&&!e.target.element?.className.includes("breakpoint"))return;const i=this.debugService.canSetBreakpointsIn(t),s=e.target.position.lineNumber,n=t.uri;if(!(e.event.rightButton||Ve.dz&&e.event.leftButton&&e.event.ctrlKey)){const t=this.debugService.getModel().getBreakpoints({uri:n,lineNumber:s});if(t.length){const i=e.event.shiftKey,s=t.some((e=>e.enabled));if(i)t.forEach((e=>this.debugService.enableOrDisableBreakpoints(!s,e)));else if(!Ve.IJ&&t.some((e=>!!e.condition||!!e.logMessage||!!e.hitCondition))){const e=t.every((e=>!!e.logMessage)),i=e?w.NC("logPoint","Logpoint"):w.NC("breakpoint","Breakpoint"),n=w.NC("breakpointHasConditionDisabled","This {0} has a {1} that will get lost on remove. Consider enabling the {0} instead.",i.toLowerCase(),e?w.NC("message","message"):w.NC("condition","condition")),o=w.NC("breakpointHasConditionEnabled","This {0} has a {1} that will get lost on remove. Consider disabling the {0} instead.",i.toLowerCase(),e?w.NC("message","message"):w.NC("condition","condition"));await this.dialogService.prompt({type:m.Z.Info,message:s?o:n,buttons:[{label:w.NC({key:"removeLogPoint",comment:["&& denotes a mnemonic"]},"&&Remove {0}",i),run:()=>t.forEach((e=>this.debugService.removeBreakpoints(e.getId())))},{label:w.NC("disableLogPoint","{0} {1}",s?w.NC({key:"disable",comment:["&& denotes a mnemonic"]},"&&Disable"):w.NC({key:"enable",comment:["&& denotes a mnemonic"]},"&&Enable"),i),run:()=>t.forEach((e=>this.debugService.enableOrDisableBreakpoints(!s,e)))}],cancelButton:!0})}else s?t.forEach((e=>this.debugService.removeBreakpoints(e.getId()))):t.forEach((e=>this.debugService.enableOrDisableBreakpoints(!s,e)))}else i&&this.debugService.addBreakpoints(n,[{lineNumber:s}])}}))),jt.D.pointerEvents&&zt.G6||(this.toDispose.push(this.editor.onMouseMove((e=>{if(!this.debugService.getAdapterManager().hasEnabledDebuggers())return;let t=-1;const i=this.editor.getModel();i&&e.target.position&&(2===e.target.type||3===e.target.type)&&this.debugService.canSetBreakpointsIn(i)&&this.marginFreeFromNonDebugDecorations(e.target.position.lineNumber)&&(e.target.detail.isAfterLines||(t=e.target.position.lineNumber)),this.ensureBreakpointHintDecoration(t)}))),this.toDispose.push(this.editor.onMouseLeave((()=>{this.ensureBreakpointHintDecoration(-1)})))),this.toDispose.push(this.editor.onDidChangeModel((async()=>{this.closeBreakpointWidget(),await this.setDecorations()}))),this.toDispose.push(this.debugService.getModel().onDidChangeBreakpoints((()=>{this.ignoreBreakpointsChangeEvent||this.setDecorationsScheduler.isScheduled()||this.setDecorationsScheduler.schedule()}))),this.toDispose.push(this.debugService.onDidChangeState((()=>{this.setDecorationsScheduler.isScheduled()||this.setDecorationsScheduler.schedule()}))),this.toDispose.push(this.editor.onDidChangeModelDecorations((()=>this.onModelDecorationsChanged()))),this.toDispose.push(this.configurationService.onDidChangeConfiguration((async e=>{(e.affectsConfiguration("debug.showBreakpointsInOverviewRuler")||e.affectsConfiguration("debug.showInlineBreakpointCandidates"))&&await this.setDecorations()})))}getContextMenuActions(e,t,i,s){const n=[];if(1===e.length){const t=e[0].logMessage?w.NC("logPoint","Logpoint"):w.NC("breakpoint","Breakpoint");n.push(new a.aU("debug.removeBreakpoint",w.NC("removeBreakpoint","Remove {0}",t),void 0,!0,(async()=>{await this.debugService.removeBreakpoints(e[0].getId())}))),n.push(new a.aU("workbench.debug.action.editBreakpointAction",w.NC("editBreakpoint","Edit {0}...",t),void 0,!0,(()=>Promise.resolve(this.showBreakpointWidget(e[0].lineNumber,e[0].column))))),n.push(new a.aU("workbench.debug.viewlet.action.toggleBreakpoint",e[0].enabled?w.NC("disableBreakpoint","Disable {0}",t):w.NC("enableBreakpoint","Enable {0}",t),void 0,!0,(()=>this.debugService.enableOrDisableBreakpoints(!e[0].enabled,e[0]))))}else if(e.length>1){const t=e.slice().sort(((e,t)=>e.column&&t.column?e.column-t.column:1));n.push(new a.wY("debug.removeBreakpoints",w.NC("removeBreakpoints","Remove Breakpoints"),t.map((e=>new a.aU("removeInlineBreakpoint",e.column?w.NC("removeInlineBreakpointOnColumn","Remove Inline Breakpoint on Column {0}",e.column):w.NC("removeLineBreakpoint","Remove Line Breakpoint"),void 0,!0,(()=>this.debugService.removeBreakpoints(e.getId()))))))),n.push(new a.wY("debug.editBreakpoints",w.NC("editBreakpoints","Edit Breakpoints"),t.map((e=>new a.aU("editBreakpoint",e.column?w.NC("editInlineBreakpointOnColumn","Edit Inline Breakpoint on Column {0}",e.column):w.NC("editLineBreakpoint","Edit Line Breakpoint"),void 0,!0,(()=>Promise.resolve(this.showBreakpointWidget(e.lineNumber,e.column)))))))),n.push(new a.wY("debug.enableDisableBreakpoints",w.NC("enableDisableBreakpoints","Enable/Disable Breakpoints"),t.map((e=>new a.aU(e.enabled?"disableColumnBreakpoint":"enableColumnBreakpoint",e.enabled?e.column?w.NC("disableInlineColumnBreakpoint","Disable Inline Breakpoint on Column {0}",e.column):w.NC("disableBreakpointOnLine","Disable Line Breakpoint"):e.column?w.NC("enableBreakpoints","Enable Inline Breakpoint on Column {0}",e.column):w.NC("enableBreakpointOnLine","Enable Line Breakpoint"),void 0,!0,(()=>this.debugService.enableOrDisableBreakpoints(!e.enabled,e)))))))}else n.push(new a.aU("addBreakpoint",w.NC("addBreakpoint","Add Breakpoint"),void 0,!0,(()=>this.debugService.addBreakpoints(t,[{lineNumber:i,column:s}])))),n.push(new a.aU("addConditionalBreakpoint",w.NC("addConditionalBreakpoint","Add Conditional Breakpoint..."),void 0,!0,(()=>Promise.resolve(this.showBreakpointWidget(i,s,0))))),n.push(new a.aU("addLogPoint",w.NC("addLogPoint","Add Logpoint..."),void 0,!0,(()=>Promise.resolve(this.showBreakpointWidget(i,s,2)))));return 2===this.debugService.state&&(n.push(new a.Z0),n.push(new a.aU("runToLine",w.NC("runToLine","Run to Line"),void 0,!0,(()=>this.debugService.runTo(t,i).catch(h.dL))))),n}marginFreeFromNonDebugDecorations(e){const t=this.editor.getLineDecorations(e);if(t)for(const{options:e}of t){const t=e.glyphMarginClassName;if(t&&(!t.includes("codicon-")||t.includes("codicon-testing-")||t.includes("codicon-merge-")||t.includes("codicon-arrow-")||t.includes("codicon-loading")||t.includes("codicon-fold")))return!1}return!0}ensureBreakpointHintDecoration(e){this.editor.changeDecorations((t=>{this.breakpointHintDecoration&&(t.removeDecoration(this.breakpointHintDecoration),this.breakpointHintDecoration=null),-1!==e&&(this.breakpointHintDecoration=t.addDecoration({startLineNumber:e,startColumn:1,endLineNumber:e,endColumn:1},xi))}))}async setDecorations(){if(!this.editor.hasModel())return;const e=(e,s)=>{const n=function(e,t,i){const s=[];for(const{positions:n,lineNumber:o}of i){if(0===n.length)continue;const i=e.getLineFirstNonWhitespaceColumn(o),r=e.getLineLastNonWhitespaceColumn(o);n.forEach((e=>{const n=new Xt.e(e.lineNumber,e.column,e.lineNumber,e.column+1);if(e.column<=i&&!t.some((t=>t.range.startColumn>i&&t.range.startLineNumber===e.lineNumber))||e.column>r)return;const o=t.find((e=>e.range.equalsRange(n)));o&&o.inlineWidget||s.push({range:n,options:{description:"breakpoint-placeholder-decoration",stickiness:1,before:o?void 0:{content:A.B4,inlineClassName:"debug-breakpoint-placeholder",inlineClassNameAffectsLetterSpacing:!0}},breakpoint:o?o.breakpoint:void 0})}))}return s}(i,this.breakpointDecorations,s),o=e.deltaDecorations(this.candidateDecorations.map((e=>e.decorationId)),n);this.candidateDecorations.forEach((e=>{e.inlineWidget.dispose()})),this.candidateDecorations=o.map(((e,i)=>{const s=n[i],o=s.breakpoint?(0,ni.CK)(this.debugService.state,this.debugService.getModel().areBreakpointsActivated(),s.breakpoint,this.labelService).icon:me.eq.disabled;return{decorationId:e,inlineWidget:new Ni(t,e,be.kS.asClassName(o),s.breakpoint,this.debugService,this.contextMenuService,(()=>this.getContextMenuActions(s.breakpoint?[s.breakpoint]:[],t.getModel().uri,s.range.startLineNumber,s.range.startColumn)))}}))},t=this.editor,i=t.getModel(),s=this.debugService.getModel().getBreakpoints({uri:i.uri}),n=this.configurationService.getValue("debug"),o=this.instantiationService.invokeFunction((e=>function(e,t,i,s,n,o){const r=[];return i.forEach((a=>{if(a.lineNumber>t.getLineCount())return;const c=i.some((e=>e!==a&&e.lineNumber===a.lineNumber)),d=t.getLineFirstNonWhitespaceColumn(a.lineNumber),l=t.validateRange(a.column?new Xt.e(a.lineNumber,a.column,a.lineNumber,a.column+1):new Xt.e(a.lineNumber,d,a.lineNumber,d+1));r.push({options:Ii(e,t,a,s,n,o,c),range:l})})),r}(e,i,s,this.debugService.state,this.debugService.getModel().areBreakpointsActivated(),n.showBreakpointsInOverviewRuler))),r=this.debugService.getViewModel().focusedSession,a=n.showInlineBreakpointCandidates&&r?async function(e,t,i){return i.capabilities.supportsBreakpointLocationsRequest?await Promise.all((0,c.EB)(t,(e=>e)).map((async t=>{try{return{lineNumber:t,positions:await i.breakpointsLocations(e.uri,t)}}catch{return{lineNumber:t,positions:[]}}}))):[]}(this.editor.getModel(),o.map((e=>e.range.startLineNumber)),r):Promise.resolve([]),l=await Promise.race([a,(0,d.Vs)(500).then((()=>{}))]);void 0===l&&a.then((i=>t.changeDecorations((t=>e(t,i)))));try{this.ignoreDecorationsChangedEvent=!0,t.changeDecorations((i=>{const n=i.deltaDecorations(this.breakpointDecorations.map((e=>e.decorationId)),o);this.breakpointDecorations.forEach((e=>{e.inlineWidget?.dispose()})),this.breakpointDecorations=n.map(((e,i)=>{let n;const r=s[i];if(o[i].options.before){const s=()=>this.getContextMenuActions([r],t.getModel().uri,r.lineNumber,r.column);n=new Ni(t,e,o[i].options.glyphMarginClassName,r,this.debugService,this.contextMenuService,s)}return{decorationId:e,breakpoint:r,range:o[i].range,inlineWidget:n}})),l&&e(i,l)}))}finally{this.ignoreDecorationsChangedEvent=!1}for(const e of this.breakpointDecorations)e.inlineWidget&&this.editor.layoutContentWidget(e.inlineWidget)}async onModelDecorationsChanged(){if(0===this.breakpointDecorations.length||this.ignoreDecorationsChangedEvent||!this.editor.hasModel())return;let e=!1;const t=this.editor.getModel();if(this.breakpointDecorations.forEach((i=>{if(e)return;const s=t.getDecorationRange(i.decorationId);s&&!i.range.equalsRange(s)&&(e=!0,i.range=s)})),!e)return;const i=new Map;for(let e=0,s=this.breakpointDecorations.length;e<s;e++){const s=this.breakpointDecorations[e],n=t.getDecorationRange(s.decorationId);n&&s.breakpoint&&i.set(s.breakpoint.getId(),{lineNumber:n.startLineNumber,column:s.breakpoint.column?n.startColumn:void 0})}try{this.ignoreBreakpointsChangeEvent=!0,await this.debugService.updateBreakpoints(t.uri,i,!0)}finally{this.ignoreBreakpointsChangeEvent=!1}}showBreakpointWidget(e,t,i){this.breakpointWidget?.dispose(),this.breakpointWidget=this.instantiationService.createInstance(Ci,this.editor,e,t,i),this.breakpointWidget.show({lineNumber:e,column:1}),this.breakpointWidgetVisible.set(!0)}closeBreakpointWidget(){this.breakpointWidget&&(this.breakpointWidget.dispose(),this.breakpointWidget=void 0,this.breakpointWidgetVisible.reset(),this.editor.focus())}dispose(){this.breakpointWidget?.dispose(),this.editor.removeDecorations(this.breakpointDecorations.map((e=>e.decorationId))),(0,p.B9)(this.toDispose)}};Ei=(0,o.g)([(0,o.f)(1,n.tn),(0,o.f)(2,Yt.i),(0,o.f)(3,x.TG),(0,o.f)(4,k.i6),(0,o.f)(5,ce.Ss),(0,o.f)(6,C.Ui),(0,o.f)(7,Lt.e)],Ei),ii.registerGutterActionsGenerator((({lineNumber:e,editor:t,accessor:i},s)=>{const o=t.getModel(),r=i.get(n.tn);if(!o||!r.getAdapterManager().hasEnabledDebuggers()||!r.canSetBreakpointsIn(o))return;const a=t.getContribution(n.KI);if(!a)return;const c=a.getContextMenuActionsAtPosition(e,o);for(const e of c)s.push(e,"2_debug")}));class Ni{constructor(e,t,i,s,n,o,r){this.editor=e,this.decorationId=t,this.breakpoint=s,this.debugService=n,this.contextMenuService=o,this.getContextMenuActions=r,this.allowEditorOverflow=!1,this.suppressMouseDown=!0,this.toDispose=[],this.range=this.editor.getModel().getDecorationRange(t),this.toDispose.push(this.editor.onDidChangeModelDecorations((()=>{const e=this.editor.getModel().getDecorationRange(this.decorationId);this.range&&!this.range.equalsRange(e)&&(this.range=e,this.editor.layoutContentWidget(this))}))),this.create(i),this.editor.addContentWidget(this),this.editor.layoutContentWidget(this)}create(e){this.domNode=Di(".inline-breakpoint-widget"),e&&this.domNode.classList.add(...e.split(" ")),this.toDispose.push(Kt.nm(this.domNode,Kt.tw.CLICK,(async e=>{switch(this.breakpoint?.enabled){case void 0:await this.debugService.addBreakpoints(this.editor.getModel().uri,[{lineNumber:this.range.startLineNumber,column:this.range.startColumn}]);break;case!0:await this.debugService.removeBreakpoints(this.breakpoint.getId());break;case!1:this.debugService.enableOrDisableBreakpoints(!0,this.breakpoint)}}))),this.toDispose.push(Kt.nm(this.domNode,Kt.tw.CONTEXT_MENU,(e=>{const t=new Gt.nV(e),i=this.getContextMenuActions();this.contextMenuService.showContextMenu({getAnchor:()=>t,getActions:()=>i,getActionsContext:()=>this.breakpoint,onHide:()=>(0,p.ex)(i)})})));const t=()=>{const e=this.editor.getOption(65);this.domNode.style.height=`${e}px`,this.domNode.style.width=`${Math.ceil(.8*e)}px`,this.domNode.style.marginLeft="4px"};t(),this.toDispose.push(this.editor.onDidChangeConfiguration((e=>{(e.hasChanged(51)||e.hasChanged(65))&&t()})))}getId(){return(0,f.R)()}getDomNode(){return this.domNode}getPosition(){return this.range?(this.domNode.classList.toggle("line-start",1===this.range.startColumn),{position:{lineNumber:this.range.startLineNumber,column:this.range.startColumn-1},preference:[0]}):null}dispose(){this.editor.removeContentWidget(this),(0,p.B9)(this.toDispose)}}Ni.__decorator=(0,o.g)([Qt.HP],Ni.prototype,"getId",null),(0,ti.Ic)(((e,t)=>{const i=e.getColor(Ti);i&&t.addRule(`\n\t\t${me._i.map((e=>`.monaco-workbench ${be.kS.asCSSSelector(e.regular)}`)).join(",\n\t\t")},\n\t\t.monaco-workbench ${be.kS.asCSSSelector(me.CI)},\n\t\t.monaco-workbench ${be.kS.asCSSSelector(me.os)}:not([class*='codicon-debug-breakpoint']):not([class*='codicon-debug-stackframe']),\n\t\t.monaco-workbench ${be.kS.asCSSSelector(me.eq.regular)}${be.kS.asCSSSelector(me.Ws)}::after,\n\t\t.monaco-workbench ${be.kS.asCSSSelector(me.eq.regular)}${be.kS.asCSSSelector(me.Qx)}::after {\n\t\t\tcolor: ${i} !important;\n\t\t}\n\t\t`);const s=e.getColor(Li);s&&t.addRule(`\n\t\t${me._i.map((e=>`.monaco-workbench ${be.kS.asCSSSelector(e.disabled)}`)).join(",\n\t\t")} {\n\t\t\tcolor: ${s};\n\t\t}\n\t\t`);const n=e.getColor(_i);n&&t.addRule(`\n\t\t${me._i.map((e=>`.monaco-workbench ${be.kS.asCSSSelector(e.unverified)}`)).join(",\n\t\t")} {\n\t\t\tcolor: ${n};\n\t\t}\n\t\t`);const o=e.getColor(Ai);o&&t.addRule(`\n\t\t.monaco-workbench ${be.kS.asCSSSelector(me.Qx)},\n\t\t.monaco-editor .debug-top-stack-frame-column {\n\t\t\tcolor: ${o} !important;\n\t\t}\n\t\t`);const r=e.getColor(Mi);r&&t.addRule(`\n\t\t.monaco-workbench ${be.kS.asCSSSelector(me.Ws)} {\n\t\t\tcolor: ${r} !important;\n\t\t}\n\t\t`)}));const Ti=(0,ei.P6G)("debugIcon.breakpointForeground",{dark:"#E51400",light:"#E51400",hcDark:"#E51400",hcLight:"#E51400"},w.NC("debugIcon.breakpointForeground","Icon color for breakpoints.")),Li=(0,ei.P6G)("debugIcon.breakpointDisabledForeground",{dark:"#848484",light:"#848484",hcDark:"#848484",hcLight:"#848484"},w.NC("debugIcon.breakpointDisabledForeground","Icon color for disabled breakpoints.")),_i=(0,ei.P6G)("debugIcon.breakpointUnverifiedForeground",{dark:"#848484",light:"#848484",hcDark:"#848484",hcLight:"#848484"},w.NC("debugIcon.breakpointUnverifiedForeground","Icon color for unverified breakpoints.")),Ai=(0,ei.P6G)("debugIcon.breakpointCurrentStackframeForeground",{dark:"#FFCC00",light:"#BE8700",hcDark:"#FFCC00",hcLight:"#BE8700"},w.NC("debugIcon.breakpointCurrentStackframeForeground","Icon color for the current breakpoint stack frame.")),Mi=(0,ei.P6G)("debugIcon.breakpointStackframeForeground",{dark:"#89D185",light:"#89D185",hcDark:"#89D185",hcLight:"#89D185"},w.NC("debugIcon.breakpointStackframeForeground","Icon color for all breakpoint stack frames."));(0,Vt.Z)(".monaco-editor .view-overlays .debug-top-stack-frame-line{background-color:var(--vscode-editor-stackFrameHighlightBackground)}.monaco-editor .view-overlays .debug-focused-stack-frame-line{background-color:var(--vscode-editor-focusedStackFrameHighlightBackground)}",{});const Bi=(0,ei.P6G)("editor.stackFrameHighlightBackground",{dark:"#ffff0033",light:"#ffff6673",hcDark:"#ffff0033",hcLight:"#ffff6673"},(0,w.NC)("topStackFrameLineHighlight","Background color for the highlight of line at the top stack frame position.")),Ri=(0,ei.P6G)("editor.focusedStackFrameHighlightBackground",{dark:"#7abd7a4d",light:"#cee7ce73",hcDark:"#7abd7a4d",hcLight:"#cee7ce73"},(0,w.NC)("focusedStackFrameLineHighlight","Background color for the highlight of line at focused stack frame position.")),Fi={description:"top-stack-frame-margin",glyphMarginClassName:be.kS.asClassName(me.Qx),glyphMargin:{position:Zt.U.Right},zIndex:9999,stickiness:1,overviewRuler:{position:Zt.sh.Full,color:(0,ti.EN)(Bi)}},Vi={description:"focused-stack-frame-margin",glyphMarginClassName:be.kS.asClassName(me.Ws),glyphMargin:{position:Zt.U.Right},zIndex:9999,stickiness:1,overviewRuler:{position:Zt.sh.Full,color:(0,ti.EN)(Ri)}},Pi={description:"top-stack-frame-decoration",isWholeLine:!0,className:"debug-top-stack-frame-line",stickiness:1},Oi={description:"focused-stack-frame-decoration",isWholeLine:!0,className:"debug-focused-stack-frame-line",stickiness:1};let Wi=class extends p.JT{constructor(e,t,i,s){super(),this.editor=e,this.debugService=t,this.uriIdentityService=i,this.logService=s,this.decorations=this.editor.createDecorationsCollection();const n=()=>this.decorations.set(this.createCallStackDecorations());this._register(g.ju.any(this.debugService.getViewModel().onDidFocusStackFrame,this.debugService.getModel().onDidChangeCallStack)((()=>{n()}))),this._register(this.editor.onDidChangeModel((e=>{e.newModelUrl&&n()}))),n()}createCallStackDecorations(){const e=this.editor;if(!e.hasModel())return[];const t=this.debugService.getViewModel().focusedStackFrame,i=[];return this.debugService.getModel().getSessions().forEach((s=>{const n=s===t?.thread.session;s.getAllThreads().forEach((s=>{if(s.stopped){const o=s.getCallStack(),r=[];o.length>0&&(t&&!t.equals(o[0])&&r.push(t),r.push(o[0])),r.forEach((t=>{if(t&&this.uriIdentityService.extUri.isEqual(t.source.uri,e.getModel()?.uri)){if(t.range.startLineNumber>e.getModel()?.getLineCount()||t.range.startLineNumber<1)return void this.logService.warn(`CallStackEditorContribution: invalid stack frame line number: ${t.range.startLineNumber}`);const s=e.getModel().getLineFirstNonWhitespaceColumn(t.range.startLineNumber)>=t.range.startColumn;i.push(...function(e,t,i){const s=[],n=new Xt.e(e.range.startLineNumber,e.range.startColumn,e.range.startLineNumber,1073741824),o=new Xt.e(e.range.startLineNumber,e.range.startColumn,e.range.startLineNumber,e.range.startColumn+1),r=e.thread.getTopStackFrame();return e.getId()===r?.getId()?(t&&s.push({options:Fi,range:o}),s.push({options:Pi,range:n}),e.range.startColumn>1&&s.push({options:{description:"top-stack-frame-inline-decoration",before:{content:"",inlineClassName:i?"debug-top-stack-frame-column start-of-line":"debug-top-stack-frame-column",inlineClassNameAffectsLetterSpacing:!0}},range:n})):(t&&s.push({options:Vi,range:o}),s.push({options:Oi,range:n})),s}(t,n,s))}}))}}))})),(0,c.EB)(i,(e=>`${e.options.className} ${e.options.glyphMarginClassName} ${e.range.startLineNumber} ${e.range.startColumn}`))}dispose(){super.dispose(),this.decorations.clear()}};Wi=(0,o.g)([(0,o.f)(1,n.tn),(0,o.f)(2,N.v),(0,o.f)(3,Pe.VZ)],Wi);var Hi=i(90317),$i=i(34650),Ui=i(73046),qi=i(75392),zi=i(82663),ji=i(60961),Ki=i(32414),Gi=i(70590),Qi=i(90573),Ji=i(88289);const Xi=/^(true|false)$/i,Zi=/^(['"]).*\1$/,Yi=Kt.$;function es(e){const t=Yi(".");return t.classList.add("debug-view-content"),e.appendChild(t),t}function ts(e,t,i){let s="string"==typeof e?e:e.value;if(t.className="value",null===s||(e instanceof Ue.A2||e instanceof Ue._w||e instanceof Xe)&&!e.available?(t.classList.add("unavailable"),s!==Ue.A2.DEFAULT_VALUE&&t.classList.add("error")):(e instanceof Ue.Ly&&i.showChanged&&e.valueChanged&&s!==Ue.A2.DEFAULT_VALUE&&(t.className="value changed",e.valueChanged=!1),i.colorize&&"string"!=typeof e&&("number"===e.type||"boolean"===e.type||"string"===e.type?t.classList.add(e.type):isNaN(+s)?Xi.test(s)?t.classList.add("boolean"):Zi.test(s)&&t.classList.add("string"):t.classList.add("number"))),i.maxValueLength&&s&&s.length>i.maxValueLength&&(s=s.substring(0,i.maxValueLength)+"..."),s||(s=""),i.linkDetector){t.textContent="";const n=e instanceof Ue.Ly?e.getSession():void 0;t.appendChild(i.linkDetector.linkify(s,!1,n?n.root:void 0,!0))}else t.textContent=s;i.showHover&&(t.title=s||"")}function is(e,t,i,s,n){if(e.available){let i=e.name;e.value&&"string"==typeof e.name&&(i+=":"),t.label.set(i,s,e.type?e.type:e.name),t.name.classList.toggle("virtual","virtual"===e.presentationHint?.kind),t.name.classList.toggle("internal","internal"===e.presentationHint?.visibility)}else e.value&&"string"==typeof e.name&&e.name&&t.label.set(":");t.expression.classList.toggle("lazy",!!e.presentationHint?.lazy),ts(e,t.value,{showChanged:i,maxValueLength:1024,showHover:!0,colorize:!0,linkDetector:n})}let ss=class{constructor(e,t){this.debugService=e,this.contextViewService=t}renderTemplate(e){const t=Kt.R3(e,Yi(".expression")),i=Kt.R3(t,Yi("span.name")),s=Kt.R3(t,Yi("span.lazy-button"));s.classList.add(...be.kS.asClassNameArray(Ui.lA.eye)),s.title=(0,w.NC)("debug.lazyButton.tooltip","Click to expand");const n=Kt.R3(t,Yi("span.value")),o=new $i.q(i),r=Kt.R3(t,Yi(".inputBoxContainer")),a=new p.SL;let c;this.renderActionBar&&(Kt.R3(t,Yi(".span.actionbar-spacer")),c=a.add(new Hi.o(t)));const d={expression:t,name:i,value:n,label:o,inputBoxContainer:r,actionBar:c,elementDisposable:[],templateDisposable:a,lazyButton:s,currentElement:void 0};return a.add(Kt.nm(s,Kt.tw.CLICK,(()=>{d.currentElement&&this.debugService.getViewModel().evaluateLazyExpression(d.currentElement)}))),d}renderExpressionElement(e,t,i){i.currentElement=e,this.renderExpression(t.element,i,(0,qi.mB)(t.filterData)),i.actionBar&&this.renderActionBar(i.actionBar,e,i);const s=this.debugService.getViewModel().getSelectedExpression();if(e===s?.expression||e instanceof Ue._w&&e.errorMessage){const t=this.getInputBoxOptions(e,!!s?.settingWatch);t&&i.elementDisposable.push(this.renderInputBox(i.name,i.value,i.inputBoxContainer,t))}}renderInputBox(e,t,i,s){e.style.display="none",t.style.display="none",i.style.display="initial",Kt.PO(i);const n=new Qi.Wz(i,this.contextViewService,{...s,inputBoxStyles:mi.Hc});n.value=s.initialValue,n.focus(),n.select();const o=(0,Ji.I)(((o,a)=>{e.style.display="",t.style.display="",i.style.display="none";const c=n.value;(0,p.B9)(r),a&&(this.debugService.getViewModel().setSelectedExpression(void 0,!1),s.onFinish(c,o))})),r=[n,Kt.mu(n.inputElement,Kt.tw.KEY_DOWN,(e=>{const t=e.equals(9),i=e.equals(3);(t||i)&&(e.preventDefault(),e.stopPropagation(),o(i,!0))})),Kt.nm(n.inputElement,Kt.tw.BLUR,(()=>{o(!0,!0)})),Kt.nm(n.inputElement,Kt.tw.CLICK,(e=>{e.preventDefault(),e.stopPropagation()}))];return(0,p.OF)((()=>{o(!1,!1)}))}disposeElement(e,t,i){(0,p.B9)(i.elementDisposable),i.elementDisposable=[]}disposeTemplate(e){(0,p.B9)(e.elementDisposable),e.templateDisposable.dispose()}};ss=(0,o.g)([(0,o.f)(0,n.tn),(0,o.f)(1,Yt.u)],ss),(0,Vt.Z)(".monaco-workbench .debug-toolbar{border-radius:4px;display:flex;height:32px;padding-left:7px;position:absolute;z-index:39}.monaco-workbench .debug-toolbar .monaco-action-bar .action-item{margin-right:4px}.monaco-workbench .debug-toolbar .monaco-action-bar .action-item.select-container{margin-right:7px}.monaco-workbench .debug-toolbar .monaco-action-bar .action-item.select-container .monaco-select-box,.monaco-workbench .start-debug-action-item .select-container .monaco-select-box{padding:0 22px 0 6px}.monaco-workbench .debug-toolbar .drag-area{align-items:center;cursor:grab;display:flex;justify-content:center;opacity:.5;width:16px}.monaco-workbench .debug-toolbar .drag-area.dragged{cursor:grabbing}.monaco-workbench .debug-toolbar .monaco-action-bar .action-item .action-label{align-items:center;background-position:50%;background-repeat:no-repeat;background-size:16px;display:flex;justify-content:center;margin-right:0}",{});var ns=i(92846),os=i(59069),rs=i(76033);const as=Kt.$;let cs=class e extends rs.YH{static{this.SEPARATOR=""}constructor(e,t,i,s,n,o,r,a){super(e,t),this.context=e,this.debugService=i,this.configurationService=s,this.commandService=n,this.contextService=o,this.keybindingService=a,this.debugOptions=[],this.selected=0,this.providers=[],this.toDispose=[],this.selectBox=new oi.j([],-1,r,mi.BM,{ariaLabel:w.NC("debugLaunchConfigurations","Debug Launch Configurations")}),this.selectBox.setFocusable(!1),this.toDispose.push(this.selectBox),this.registerListeners()}registerListeners(){this.toDispose.push(this.configurationService.onDidChangeConfiguration((e=>{e.affectsConfiguration("launch")&&this.updateOptions()}))),this.toDispose.push(this.debugService.getConfigurationManager().onDidSelectConfiguration((()=>{this.updateOptions()})))}render(e){this.container=e,e.classList.add("start-debug-action-item"),this.start=Kt.R3(e,as(be.kS.asCSSSelector(me.NA)));const t=this.keybindingService.lookupKeybinding(this.action.id)?.getLabel(),i=t?` (${t})`:"";this.start.title=this.action.label+i,this.start.setAttribute("role","button"),this.start.ariaLabel=this.start.title,this.toDispose.push(Kt.nm(this.start,Kt.tw.CLICK,(()=>{this.start.blur(),1!==this.debugService.state&&this.actionRunner.run(this.action,this.context)}))),this.toDispose.push(Kt.nm(this.start,Kt.tw.MOUSE_DOWN,(e=>{this.action.enabled&&0===e.button&&this.start.classList.add("active")}))),this.toDispose.push(Kt.nm(this.start,Kt.tw.MOUSE_UP,(()=>{this.start.classList.remove("active")}))),this.toDispose.push(Kt.nm(this.start,Kt.tw.MOUSE_OUT,(()=>{this.start.classList.remove("active")}))),this.toDispose.push(Kt.nm(this.start,Kt.tw.KEY_DOWN,(e=>{const t=new os.y1(e);t.equals(17)&&(this.start.tabIndex=-1,this.selectBox.focus(),t.stopPropagation())}))),this.toDispose.push(this.selectBox.onDidSelect((async e=>{const t=this.debugOptions[e.index];t.handler&&await t.handler()?this.selected=e.index:this.selectBox.select(this.selected)})));const s=as(".configuration");this.selectBox.render(Kt.R3(e,s)),this.toDispose.push(Kt.nm(s,Kt.tw.KEY_DOWN,(e=>{const t=new os.y1(e);t.equals(15)&&(this.selectBox.setFocusable(!1),this.start.tabIndex=0,this.start.focus(),t.stopPropagation())}))),this.container.style.border=`1px solid ${(0,ei.n_1)(ei.a9O)}`,s.style.borderLeft=`1px solid ${(0,ei.n_1)(ei.a9O)}`,this.container.style.backgroundColor=(0,ei.n_1)(ei.XV0),this.debugService.getConfigurationManager().getDynamicProviders().then((e=>{this.providers=e,this.providers.length>0&&this.updateOptions()})),this.updateOptions()}setActionContext(e){this.context=e}isEnabled(){return!0}focus(e){e?this.selectBox.focus():(this.start.tabIndex=0,this.start.focus())}blur(){this.start.tabIndex=-1,this.selectBox.blur(),this.container.blur()}setFocusable(e){e?this.start.tabIndex=0:(this.start.tabIndex=-1,this.selectBox.setFocusable(!1))}dispose(){this.toDispose=(0,p.B9)(this.toDispose)}updateOptions(){this.selected=0,this.debugOptions=[];const t=this.debugService.getConfigurationManager(),i=3===this.contextService.getWorkbenchState();let s;const n=[];t.getAllConfigurations().forEach((({launch:o,name:r,presentation:a})=>{s!==a?.group&&(s=a?.group,this.debugOptions.length&&(this.debugOptions.push({label:e.SEPARATOR,handler:()=>Promise.resolve(!1)}),n.push(this.debugOptions.length-1))),r===t.selectedConfiguration.name&&o===t.selectedConfiguration.launch&&(this.selected=this.debugOptions.length);const c=i?`${r} (${o.name})`:r;this.debugOptions.push({label:c,handler:async()=>(await t.selectConfiguration(o,r),!0)})})),t.getRecentDynamicConfigurations().slice(0,3).forEach((({name:e,type:i})=>{i===t.selectedConfiguration.type&&t.selectedConfiguration.name===e&&(this.selected=this.debugOptions.length),this.debugOptions.push({label:e,handler:async()=>(await t.selectConfiguration(void 0,e,void 0,{type:i}),!0)})})),0===this.debugOptions.length&&this.debugOptions.push({label:w.NC("noConfigurations","No Configurations"),handler:async()=>!1}),this.debugOptions.push({label:e.SEPARATOR,handler:()=>Promise.resolve(!1)}),n.push(this.debugOptions.length-1),this.providers.forEach((e=>{this.debugOptions.push({label:`${e.label}...`,handler:async()=>{const i=await e.pick();return!!i&&(await t.selectConfiguration(i.launch,i.config.name,i.config,{type:e.type}),!0)}})})),t.getLaunches().filter((e=>!e.hidden)).forEach((e=>{const t=i?w.NC("addConfigTo","Add Config ({0})...",e.name):w.NC("addConfiguration","Add Configuration...");this.debugOptions.push({label:t,handler:async()=>(await this.commandService.executeCommand(ue.Ee,e.uri.toString()),!1)})})),this.selectBox.setOptions(this.debugOptions.map(((e,t)=>({text:e.label,isDisabled:-1!==n.indexOf(t)}))),this.selected)}};cs=(0,o.g)([(0,o.f)(2,n.tn),(0,o.f)(3,C.Ui),(0,o.f)(4,S.H),(0,o.f)(5,T.ec),(0,o.f)(6,Yt.u),(0,o.f)(7,fi.d)],cs);let ds=class extends rs.Lc{constructor(e,t,i,s,n){super(null,e,[],-1,s,mi.BM,{ariaLabel:w.NC("debugSession","Debug Session")}),this.debugService=i,this.configurationService=n,this._register(this.debugService.getViewModel().onDidFocusSession((()=>{const e=this.getSelectedSession();if(e){const t=this.getSessions().indexOf(e);this.select(t)}}))),this._register(this.debugService.onDidNewSession((e=>{const t=[];t.push(e.onDidChangeName((()=>this.update()))),t.push(e.onDidEndAdapter((()=>(0,p.B9)(t)))),this.update()}))),this.getSessions().forEach((e=>{this._register(e.onDidChangeName((()=>this.update())))})),this._register(this.debugService.onDidEndSession((()=>this.update())));const o=t?this.mapFocusedSessionToSelected(t):void 0;this.update(o)}getActionContext(e,t){return this.getSessions()[t]}update(e){e||(e=this.getSelectedSession());const t=this.getSessions(),i=t.map((e=>{const t=e.getLabel();return e.parentSession?`${t}`:t}));this.setOptions(i.map((e=>({text:e}))),e?t.indexOf(e):void 0)}getSelectedSession(){const e=this.debugService.getViewModel().focusedSession;return e?this.mapFocusedSessionToSelected(e):void 0}getSessions(){const e=this.configurationService.getValue("debug").showSubSessionsInToolBar,t=this.debugService.getModel().getSessions();return e?t:t.filter((e=>!e.parentSession))}mapFocusedSessionToSelected(e){const t=this.configurationService.getValue("debug").showSubSessionsInToolBar;for(;e.parentSession&&!t;)e=e.parentSession;return e}};ds=(0,o.g)([(0,o.f)(2,n.tn),(0,o.f)(3,Yt.u),(0,o.f)(4,C.Ui)],ds);var ls=i(41264),us=i(92321);const hs=(0,ei.P6G)("debugToolBar.background",{dark:"#333333",light:"#F3F3F3",hcDark:"#000000",hcLight:"#FFFFFF"},(0,w.NC)("debugToolBarBackground","Debug toolbar background color.")),gs=(0,ei.P6G)("debugToolBar.border",{dark:null,light:null,hcDark:null,hcLight:null},(0,w.NC)("debugToolBarBorder","Debug toolbar border color.")),ps=(0,ei.P6G)("debugIcon.startForeground",{dark:"#89D185",light:"#388A34",hcDark:"#89D185",hcLight:"#388A34"},(0,w.NC)("debugIcon.startForeground","Debug toolbar icon for start debugging.")),bs="debug.actionswidgetposition",ms="debug.actionswidgety";let fs=class extends ti.bB{constructor(e,t,i,s,n,o,r,a,l,u){super(r),this.notificationService=e,this.telemetryService=t,this.debugService=i,this.layoutService=s,this.storageService=n,this.configurationService=o,this.instantiationService=a,this.yCoordinate=0,this.isVisible=!1,this.isBuilt=!1,this.stopActionViewItemDisposables=this._register(new p.SL),this.$el=Kt.$("div.debug-toolbar"),this.$el.style.top=`${s.offset.top}px`,this.dragArea=Kt.R3(this.$el,Kt.$("div.drag-area"+be.kS.asCSSSelector(me.kc)));const h=Kt.R3(this.$el,Kt.$("div.action-bar-container"));this.debugToolBarMenu=l.createMenu(Ot.eH.DebugToolBar,u),this._register(this.debugToolBarMenu),this.activeActions=[],this.actionBar=this._register(new Hi.o(h,{orientation:0,actionViewItemProvider:e=>{if(e.id===ue.or)return this.instantiationService.createInstance(ds,e,void 0);if(e.id===ue.De||e.id===ue.Sb){this.stopActionViewItemDisposables.clear();const t=this.instantiationService.invokeFunction((t=>vs(e,this.stopActionViewItemDisposables,t)));if(t)return t}return(0,ji.Id)(this.instantiationService,e)}})),this.updateScheduler=this._register(new d.pY((()=>{const e=this.debugService.state,t=this.configurationService.getValue("debug").toolBarLocation;if(0===e||"docked"===t||"hidden"===t||this.debugService.getModel().getSessions().every((e=>e.suppressDebugToolbar))||1===e&&this.debugService.initializingOptions?.suppressDebugToolbar)return this.hide();const i=[];(0,ji.vr)(this.debugToolBarMenu,{shouldForwardArgs:!0},i),c.fS(i,this.activeActions,((e,t)=>e.id===t.id&&e.enabled===t.enabled))||(this.actionBar.clear(),this.actionBar.push(i,{icon:!0,label:!1}),this.activeActions=i),this.show()}),20)),this.updateStyles(),this.registerListeners(),this.hide()}registerListeners(){this._register(this.debugService.onDidChangeState((()=>this.updateScheduler.schedule()))),this._register(this.configurationService.onDidChangeConfiguration((e=>{e.affectsConfiguration("debug.toolBarLocation")&&this.updateScheduler.schedule()}))),this._register(this.debugToolBarMenu.onDidChange((()=>this.updateScheduler.schedule()))),this._register(this.actionBar.actionRunner.onDidRun((e=>{e.error&&!h.n2(e.error)&&this.notificationService.error(e.error),this.telemetryService.publicLog2("workbenchActionExecuted",{id:e.action.id,from:"debugActionsWidget"})}))),this._register(Kt.nm(window,Kt.tw.RESIZE,(()=>this.setCoordinates()))),this._register(Kt.q6(this.dragArea,(e=>{if(2===new Gt.nV(e).detail){const e=this.$el.clientWidth;this.setCoordinates(.5*window.innerWidth-.5*e,0),this.storePosition()}}))),this._register(Kt.u0(this.dragArea,(e=>{this.dragArea.classList.add("dragged");const t=Kt.lB(window,(e=>{const t=new Gt.nV(e);t.preventDefault(),this.setCoordinates(t.posx-14,t.posy-this.layoutService.offset.top)})),i=Kt.q6(window,(e=>{this.storePosition(),this.dragArea.classList.remove("dragged"),t.dispose(),i.dispose()}))}))),this._register(this.layoutService.onDidChangePartVisibility((()=>this.setYCoordinate()))),this._register(zt.Tz.onDidChange((()=>this.setYCoordinate())))}storePosition(){const e=Kt.Dx(this.$el).left;if(e){const t=parseFloat(e)/window.innerWidth;this.storageService.store(bs,t,0,1)}}updateStyles(){if(super.updateStyles(),this.$el){this.$el.style.backgroundColor=this.getColor(hs)||"";const e=this.getColor(ei.rh);this.$el.style.boxShadow=e?`0 0 8px 2px ${e}`:"";const t=this.getColor(ei.A42),i=this.getColor(gs);t?this.$el.style.border=`1px solid ${t}`:(this.$el.style.border=i?`solid ${i}`:"none",this.$el.style.border="1px 0")}}setYCoordinate(e=this.yCoordinate){const t=this.layoutService.offset.top;this.$el.style.top=`${t+e}px`,this.yCoordinate=e}setCoordinates(e,t){if(!this.isVisible)return;const i=this.$el.clientWidth;if(void 0===e){const t=this.storageService.get(bs,0);e=void 0!==t?parseFloat(t)*window.innerWidth:.5*window.innerWidth-.5*i}e=Math.max(0,Math.min(e,window.innerWidth-i)),this.$el.style.left=`${e}px`,void 0===t&&(t=this.storageService.getNumber(ms,0,0));if(t<17.5||t>52.5){const e=t<35;this.setYCoordinate(e?0:35),this.storageService.store(ms,e?0:70,0,1)}}show(){this.isVisible||(this.isBuilt||(this.isBuilt=!0,this.layoutService.container.appendChild(this.$el)),this.isVisible=!0,Kt.$Z(this.$el)),this.setCoordinates()}hide(){this.isVisible=!1,Kt.Cp(this.$el)}dispose(){super.dispose(),this.$el?.remove()}};function vs(e,t,i){const s=i.get(Ot.co),n=i.get(k.i6),o=i.get(x.TG),r=i.get(Yt.i),c=s.createMenu(Ot.eH.DebugToolBarStop,n),d=[];if((0,ji.vr)(c,{shouldForwardArgs:!0},d),!d.length)return;const l=t.add(new a.aU("notebook.moreRunActions",(0,w.NC)("notebook.moreRunActionsLabel","More..."),"codicon-chevron-down",!0));return o.createInstance(ns.C,e,l,d,"debug-stop-actions",r,{})}fs=(0,o.g)([(0,o.f)(0,I.lT),(0,o.f)(1,We.bU),(0,o.f)(2,n.tn),(0,o.f)(3,yt.ze),(0,o.f)(4,pe.Uy),(0,o.f)(5,C.Ui),(0,o.f)(6,ti.XE),(0,o.f)(7,x.TG),(0,o.f)(8,Ot.co),(0,o.f)(9,k.i6)],fs);const ws=[],Ss=(e,t,i,s,o,r,a)=>{Ot.BH.appendMenuItem(Ot.eH.DebugToolBar,{group:"navigation",when:o,order:i,command:{id:e,title:t,icon:s,precondition:r},alt:a}),ws.push(Ot.BH.appendMenuItem(Ot.eH.ViewContainerTitle,{group:"navigation",when:k.Ao.and(o,k.Ao.equals("viewContainer",n.f3),n.KA.notEqualsTo("inactive"),k.Ao.equals("config.debug.toolBarLocation","docked")),order:i,command:{id:e,title:t,icon:s,precondition:r}}))};Ot.BH.onDidChangeMenu((e=>{if(e.has(Ot.eH.DebugToolBar)){(0,p.B9)(ws);const e=Ot.BH.getMenuItems(Ot.eH.DebugToolBar);for(const t of e)ws.push(Ot.BH.appendMenuItem(Ot.eH.ViewContainerTitle,{...t,when:k.Ao.and(t.when,k.Ao.equals("viewContainer",n.f3),n.KA.notEqualsTo("inactive"),k.Ao.equals("config.debug.toolBarLocation","docked"))}))}})),Ss(ue.ZI,ue.pl,10,me.Tl,n.KA.isEqualTo("stopped")),Ss(ue.rd,ue.eW,10,me.cJ,n.KA.notEqualsTo("stopped"),n.KA.isEqualTo("running")),Ss(ue.De,ue.yk,70,me.fR,n.dU.toNegated(),void 0,{id:ue.Sb,title:ue.XV,icon:me.DI,precondition:k.Ao.and(n.dU.toNegated(),n.rv)}),Ss(ue.Sb,ue.XV,70,me.DI,n.dU,void 0,{id:ue.De,title:ue.yk,icon:me.fR,precondition:k.Ao.and(n.dU,n.rv)}),Ss(ue.xw,ue.kj,20,me.xv,void 0,n.KA.isEqualTo("stopped")),Ss(ue.Xs,ue.DP,30,me.Z5,void 0,n.KA.isEqualTo("stopped")),Ss(ue.GL,ue.lG,40,me.Hp,void 0,n.KA.isEqualTo("stopped")),Ss(ue._M,ue.Yl,60,me.gv),Ss(ue.rY,(0,w.NC)("stepBackDebug","Step Back"),50,me.oF,n.RX,n.KA.isEqualTo("stopped")),Ss(ue.YD,(0,w.NC)("reverseContinue","Reverse"),55,me.IO,n.RX,n.KA.isEqualTo("stopped")),Ss(ue.or,ue.M2,100,void 0,n.d5),Ot.BH.appendMenuItem(Ot.eH.DebugToolBarStop,{group:"navigation",when:k.Ao.and(n.dU.toNegated(),n.rv),order:0,command:{id:ue.Sb,title:ue.XV,icon:me.DI}}),Ot.BH.appendMenuItem(Ot.eH.DebugToolBarStop,{group:"navigation",when:k.Ao.and(n.dU,n.rv),order:0,command:{id:ue.De,title:ue.yk,icon:me.fR}}),Ot.BH.appendMenuItem(Ot.eH.DebugToolBarStop,{group:"navigation",when:k.Ao.or(k.Ao.and(n.dU.toNegated(),n.uz,n.rv),k.Ao.and(n.dU,n.uz)),order:0,command:{id:ue.O0,title:ue.SI,icon:me.DI}});const Cs=Kt.$;function ks(e,t){return t.sessionId=e.getId(),t}function ys(e,t){return t.threadId=e.getId(),ks(e.session,t),t}function Ds(e){return e instanceof Ue.Di?function(e,t){return t.frameId=e.getId(),t.frameName=e.name,t.frameLocation={range:e.range,source:e.source.raw},ys(e.thread,t),t}(e,{}):e instanceof Ue.jz?ys(e,{}):Hs(e)?ks(e,{}):void 0}function xs(e){return e instanceof Ue.Di?e.source.inMemory?e.source.raw.path||e.source.reference||e.source.name:e.source.uri.toString():e instanceof Ue.jz?e.threadId:Hs(e)?e.getId():""}function Is(e){let t=e.thread.getStaleCallStack();t=t.length>0?t:e.thread.getCallStack();const i=t.map((e=>e.source)).filter((t=>t!==e.source));let s=0;if(i.forEach((t=>{t.name===e.source.name&&(s=Math.max(s,(0,A.P1)(e.source.uri.path,t.uri.path)))})),0===s)return e.source.name;const n=Math.max(0,e.source.uri.path.lastIndexOf(zi.KR.sep,e.source.uri.path.length-s-1));return(n>0?"...":"")+e.source.uri.path.substring(n)}async function Es(e,t){e.parentSession&&await Es(e.parentSession,t),await t.expand(e)}let Ns=class extends Gi.qV{constructor(e,t,i,s,n,o,r,a,c,l,u,h){super(e,s,t,r,a,o,n,c,l,u),this.options=e,this.debugService=i,this.menuService=h,this.needsRefresh=!1,this.ignoreSelectionChangedEvent=!1,this.ignoreFocusStackFrameEvent=!1,this.autoExpandedSessions=new Set,this.selectionNeedsUpdate=!1,this.onCallStackChangeScheduler=this._register(new d.pY((async()=>{const e=this.debugService.getModel().getSessions();0===e.length&&this.autoExpandedSessions.clear();const t=1===e.length&&1===e[0].getAllThreads().length?e[0].getAllThreads()[0]:void 0,i=1===e.length?e[0].getStoppedDetails():void 0;i&&(t||"number"!=typeof i.threadId)?(this.stateMessageLabel.textContent=Os(i),this.stateMessageLabel.title=Ps(i),this.stateMessageLabel.classList.toggle("exception","exception"===i.reason),this.stateMessage.hidden=!1):1===e.length&&3===e[0].state?(this.stateMessageLabel.textContent=(0,w.NC)({key:"running",comment:["indicates state"]},"Running"),this.stateMessageLabel.title=e[0].getLabel(),this.stateMessageLabel.classList.remove("exception"),this.stateMessage.hidden=!1):this.stateMessage.hidden=!0,this.updateActions(),this.needsRefresh=!1,this.dataSource.deemphasizedStackFramesToShow=[],await this.tree.updateChildren();try{const t=new Set;e.forEach((e=>{e.parentSession&&!this.autoExpandedSessions.has(e.parentSession)&&t.add(e.parentSession)}));for(const e of t)await Es(e,this.tree),this.autoExpandedSessions.add(e)}catch(e){}this.selectionNeedsUpdate&&(this.selectionNeedsUpdate=!1,await this.updateTreeSelection())}),50))}renderHeaderTitle(e){super.renderHeaderTitle(e,this.options.title),this.stateMessage=Kt.R3(e,Cs("span.call-stack-state-message")),this.stateMessage.hidden=!0,this.stateMessageLabel=Kt.R3(this.stateMessage,Cs("span.label"))}renderBody(e){super.renderBody(e),this.element.classList.add("debug-pane"),e.classList.add("debug-call-stack");const t=es(e);this.dataSource=new Us(this.debugService),this.tree=this.instantiationService.createInstance(Ki.ZI,"CallStackView",t,new Vs,new zs(this.debugService),[this.instantiationService.createInstance(Ls),this.instantiationService.createInstance(As),this.instantiationService.createInstance(Ms),new Bs,new Rs,new Fs],this.dataSource,{accessibilityProvider:new qs,compressionEnabled:!0,autoExpandSingleChildren:!0,identityProvider:{getId:e=>"string"==typeof e?e:e instanceof Array?`showMore ${e[0].getId()}`:e.getId()},keyboardNavigationLabelProvider:{getKeyboardNavigationLabel:e=>Hs(e)?e.getLabel():e instanceof Ue.jz?`${e.name} ${e.stateLabel}`:e instanceof Ue.Di||"string"==typeof e?e:e instanceof Ue.l_?Rs.LABEL:(0,w.NC)("showMoreStackFrames2","Show More Stack Frames"),getCompressedNodeKeyboardNavigationLabel:e=>{const t=e[0];return Hs(t)?t.getLabel():""}},expandOnlyOnTwistieClick:!0,overrideStyles:{listBackground:this.getBackgroundColor()}}),this.tree.setInput(this.debugService.getModel()),this._register(this.tree.onDidOpen((async e=>{if(this.ignoreSelectionChangedEvent)return;const t=(e,t,i,s={})=>{this.ignoreFocusStackFrameEvent=!0;try{this.debugService.focusStackFrame(e,t,i,{...s,explicit:!0})}finally{this.ignoreFocusStackFrameEvent=!1}},i=e.element;if(i instanceof Ue.Di){const s={preserveFocus:e.editorOptions.preserveFocus,sideBySide:e.sideBySide,pinned:e.editorOptions.pinned};t(i,i.thread,i.thread.session,s)}if(i instanceof Ue.jz&&t(void 0,i,i.session),Hs(i)&&t(void 0,void 0,i),i instanceof Ue.l_){const e=this.debugService.getModel().getSession(i.sessionId),t=e&&e.getThread(i.threadId);if(t){const e=t.stoppedDetails?.totalFrames,i="number"==typeof e?e-t.getCallStack().length:void 0;await t.fetchCallStack(i),await this.tree.updateChildren()}}i instanceof Array&&(this.dataSource.deemphasizedStackFramesToShow.push(...i),this.tree.updateChildren())}))),this._register(this.debugService.getModel().onDidChangeCallStack((()=>{this.isBodyVisible()?this.onCallStackChangeScheduler.isScheduled()||this.onCallStackChangeScheduler.schedule():this.needsRefresh=!0})));const i=g.ju.any(this.debugService.getViewModel().onDidFocusStackFrame,this.debugService.getViewModel().onDidFocusSession);this._register(i((async()=>{this.ignoreFocusStackFrameEvent||(this.isBodyVisible()?this.onCallStackChangeScheduler.isScheduled()?this.selectionNeedsUpdate=!0:await this.updateTreeSelection():this.needsRefresh=!0)}))),this._register(this.tree.onContextMenu((e=>this.onContextMenu(e)))),2===this.debugService.state&&this.onCallStackChangeScheduler.schedule(0),this._register(this.onDidChangeBodyVisibility((e=>{e&&this.needsRefresh&&this.onCallStackChangeScheduler.schedule()}))),this._register(this.debugService.onDidNewSession((e=>{const t=[];t.push(e.onDidChangeName((()=>{this.tree.hasNode(e)&&this.tree.rerender(e)}))),t.push(e.onDidEndAdapter((()=>(0,p.B9)(t)))),e.parentSession&&this.autoExpandedSessions.delete(e.parentSession)})))}layoutBody(e,t){super.layoutBody(e,t),this.tree.layout(e,t)}focus(){this.tree.domFocus()}collapseAll(){this.tree.collapseAll()}async updateTreeSelection(){if(!this.tree||!this.tree.getInput())return;const e=e=>{this.ignoreSelectionChangedEvent=!0;try{this.tree.setSelection([e]),null===this.tree.getRelativeTop(e)?this.tree.reveal(e,.5):this.tree.reveal(e)}catch(e){}finally{this.ignoreSelectionChangedEvent=!1}},t=this.debugService.getViewModel().focusedThread,i=this.debugService.getViewModel().focusedSession,s=this.debugService.getViewModel().focusedStackFrame;if(t){try{await Es(t.session,this.tree)}catch(e){}try{await this.tree.expand(t)}catch(e){}const n=s||i;n&&e(n)}else i?e(i):this.tree.setSelection([])}onContextMenu(e){const t=e.element;let i=[];var s;Hs(t)?i=Ts(t):t instanceof Ue.jz?i=_s(t):t instanceof Ue.Di&&(s=t,i=[[n.fj.key,"stackFrame"],[n.ou.key,s.canRestart]]);const o={primary:[],secondary:[]},r=this.contextKeyService.createOverlay(i),a=this.menuService.createMenu(Ot.eH.DebugCallStackContext,r);(0,ji.LJ)(a,{arg:xs(t),shouldForwardArgs:!0},o,"inline"),this.contextMenuService.showContextMenu({getAnchor:()=>e.anchor,getActions:()=>o.secondary,getActionsContext:()=>Ds(t)})}};function Ts(e){return[[n.fj.key,"session"],[n.Xx.key,(0,$.Q5)(e)],[n.je.key,2===e.state],[n.xW.key,1===e.getAllThreads().length]]}Ns=(0,o.g)([(0,o.f)(1,Yt.i),(0,o.f)(2,n.tn),(0,o.f)(3,fi.d),(0,o.f)(4,x.TG),(0,o.f)(5,_.XH),(0,o.f)(6,C.Ui),(0,o.f)(7,k.i6),(0,o.f)(8,He.v4),(0,o.f)(9,ti.XE),(0,o.f)(10,We.bU),(0,o.f)(11,Ot.co)],Ns);let Ls=class e{static{this.ID="session"}constructor(e,t,i){this.instantiationService=e,this.contextKeyService=t,this.menuService=i}get templateId(){return e.ID}renderTemplate(e){const t=Kt.R3(e,Cs(".session"));Kt.R3(t,Cs(be.kS.asCSSSelector(me.K$)));const i=Kt.R3(t,Cs(".name")),s=Kt.R3(t,Cs("span.state.label.monaco-count-badge.long")),n=new $i.q(i),o=new p.SL,r=o.add(new p.SL);return{session:t,name:i,stateLabel:s,label:n,actionBar:o.add(new Hi.o(t,{actionViewItemProvider:e=>{if((e.id===ue.De||e.id===ue.Sb)&&e instanceof Ot.U8){r.clear();const t=this.instantiationService.invokeFunction((t=>vs(e,r,t)));if(t)return t}return e instanceof Ot.U8?this.instantiationService.createInstance(ji.Mm,e,void 0):e instanceof Ot.NZ?this.instantiationService.createInstance(ji.bi,e,void 0):void 0}})),elementDisposable:o.add(new p.SL),templateDisposable:o}}renderElement(e,t,i){this.doRenderElement(e.element,(0,qi.mB)(e.filterData),i)}renderCompressedElements(e,t,i){const s=e.element.elements[e.element.elements.length-1],n=(0,qi.mB)(e.filterData);this.doRenderElement(s,n,i)}doRenderElement(e,t,i){i.session.title=(0,w.NC)({key:"session",comment:["Session is a noun"]},"Session"),i.label.set(e.getLabel(),t);const s=e.getStoppedDetails(),n=e.getAllThreads().find((e=>e.stopped)),o=this.contextKeyService.createOverlay(Ts(e)),r=i.elementDisposable.add(this.menuService.createMenu(Ot.eH.DebugCallStackContext,o)),a=()=>{i.actionBar.clear();const t=[],s={primary:t,secondary:[]};(0,ji.vr)(r,{arg:xs(e),shouldForwardArgs:!0},s,"inline"),i.actionBar.push(t,{icon:!0,label:!1}),i.actionBar.context=Ds(e)};i.elementDisposable.add(r.onDidChange((()=>a()))),a(),i.stateLabel.style.display="",s?(i.stateLabel.textContent=Os(s),i.session.title=`${e.getLabel()}: ${Ps(s)}`,i.stateLabel.classList.toggle("exception","exception"===s.reason)):n&&n.stoppedDetails?(i.stateLabel.textContent=Os(n.stoppedDetails),i.session.title=`${e.getLabel()}: ${Ps(n.stoppedDetails)}`,i.stateLabel.classList.toggle("exception","exception"===n.stoppedDetails.reason)):(i.stateLabel.textContent=(0,w.NC)({key:"running",comment:["indicates state"]},"Running"),i.stateLabel.classList.remove("exception"))}disposeTemplate(e){e.templateDisposable.dispose()}disposeElement(e,t,i){i.elementDisposable.clear()}disposeCompressedElements(e,t,i,s){i.elementDisposable.clear()}};function _s(e){return[[n.fj.key,"thread"],[n.je.key,e.stopped]]}Ls=(0,o.g)([(0,o.f)(0,x.TG),(0,o.f)(1,k.i6),(0,o.f)(2,Ot.co)],Ls);let As=class e{static{this.ID="thread"}constructor(e,t){this.contextKeyService=e,this.menuService=t}get templateId(){return e.ID}renderTemplate(e){const t=Kt.R3(e,Cs(".thread")),i=Kt.R3(t,Cs(".name")),s=Kt.R3(t,Cs("span.state.label.monaco-count-badge.long")),n=new $i.q(i),o=new p.SL;return{thread:t,name:i,stateLabel:s,label:n,actionBar:o.add(new Hi.o(t)),elementDisposable:o.add(new p.SL),templateDisposable:o}}renderElement(e,t,i){const s=e.element;i.thread.title=s.name,i.label.set(s.name,(0,qi.mB)(e.filterData)),i.stateLabel.textContent=s.stateLabel,i.stateLabel.classList.toggle("exception","exception"===s.stoppedDetails?.reason);const n=this.contextKeyService.createOverlay(_s(s)),o=i.elementDisposable.add(this.menuService.createMenu(Ot.eH.DebugCallStackContext,n)),r=()=>{i.actionBar.clear();const e=[],t={primary:e,secondary:[]};(0,ji.vr)(o,{arg:xs(s),shouldForwardArgs:!0},t,"inline"),i.actionBar.push(e,{icon:!0,label:!1}),i.actionBar.context=Ds(s)};i.elementDisposable.add(o.onDidChange((()=>r()))),r()}renderCompressedElements(e,t,i,s){throw new Error("Method not implemented.")}disposeElement(e,t,i){i.elementDisposable.clear()}disposeTemplate(e){e.templateDisposable.dispose()}};As=(0,o.g)([(0,o.f)(0,k.i6),(0,o.f)(1,Ot.co)],As);let Ms=class e{static{this.ID="stackFrame"}constructor(e,t){this.labelService=e,this.notificationService=t}get templateId(){return e.ID}renderTemplate(e){const t=Kt.R3(e,Cs(".stack-frame")),i=Kt.R3(t,Cs("span.label.expression")),s=Kt.R3(t,Cs(".file")),n=Kt.R3(s,Cs("span.file-name")),o=Kt.R3(s,Cs("span.line-number-wrapper")),r=Kt.R3(o,Cs("span.line-number.monaco-count-badge")),a=new $i.q(i),c=new p.SL;return{file:s,fileName:n,label:a,lineNumber:r,stackFrame:t,actionBar:c.add(new Hi.o(t)),templateDisposable:c}}renderElement(e,t,i){const s=e.element;i.stackFrame.classList.toggle("disabled",!s.source||!s.source.available||$s(s)),i.stackFrame.classList.toggle("label","label"===s.presentationHint),i.stackFrame.classList.toggle("subtle","subtle"===s.presentationHint);const n=!!s.thread.session.capabilities.supportsRestartFrame&&"label"!==s.presentationHint&&"subtle"!==s.presentationHint&&s.canRestart;if(i.stackFrame.classList.toggle("has-actions",n),i.file.title=s.source.inMemory?s.source.uri.path:this.labelService.getUriLabel(s.source.uri),s.source.raw.origin&&(i.file.title+=`\n${s.source.raw.origin}`),i.label.set(s.name,(0,qi.mB)(e.filterData),s.name),i.fileName.textContent=Is(s),void 0!==s.range.startLineNumber?(i.lineNumber.textContent=`${s.range.startLineNumber}`,s.range.startColumn&&(i.lineNumber.textContent+=`:${s.range.startColumn}`),i.lineNumber.classList.remove("unavailable")):i.lineNumber.classList.add("unavailable"),i.actionBar.clear(),n){const e=new a.aU("debug.callStack.restartFrame",(0,w.NC)("restartFrame","Restart Frame"),be.kS.asClassName(me._d),!0,(async()=>{try{await s.restart()}catch(e){this.notificationService.error(e)}}));i.actionBar.push(e,{icon:!0,label:!1})}}renderCompressedElements(e,t,i,s){throw new Error("Method not implemented.")}disposeTemplate(e){e.actionBar.dispose()}};Ms=(0,o.g)([(0,o.f)(0,Lt.e),(0,o.f)(1,I.lT)],Ms);class Bs{static{this.ID="error"}get templateId(){return Bs.ID}renderTemplate(e){return{label:Kt.R3(e,Cs(".error"))}}renderElement(e,t,i){const s=e.element;i.label.textContent=s,i.label.title=s}renderCompressedElements(e,t,i,s){throw new Error("Method not implemented.")}disposeTemplate(e){}}class Rs{static{this.ID="loadMore"}static{this.LABEL=(0,w.NC)("loadAllStackFrames","Load More Stack Frames")}constructor(){}get templateId(){return Rs.ID}renderTemplate(e){const t=Kt.R3(e,Cs(".load-all"));return t.style.color=(0,ei.n_1)(ei.url),{label:t}}renderElement(e,t,i){i.label.textContent=Rs.LABEL}renderCompressedElements(e,t,i,s){throw new Error("Method not implemented.")}disposeTemplate(e){}}class Fs{static{this.ID="showMore"}constructor(){}get templateId(){return Fs.ID}renderTemplate(e){const t=Kt.R3(e,Cs(".show-more"));return t.style.color=(0,ei.n_1)(ei.url),{label:t}}renderElement(e,t,i){const s=e.element;s.every((e=>!(!e.source||!e.source.origin||e.source.origin!==s[0].source.origin)))?i.label.textContent=(0,w.NC)("showMoreAndOrigin","Show {0} More: {1}",s.length,s[0].source.origin):i.label.textContent=(0,w.NC)("showMoreStackFrames","Show {0} More Stack Frames",s.length)}renderCompressedElements(e,t,i,s){throw new Error("Method not implemented.")}disposeTemplate(e){}}class Vs{getHeight(e){return e instanceof Ue.Di&&"label"===e.presentationHint||e instanceof Ue.l_||e instanceof Array?16:22}getTemplateId(e){return Hs(e)?Ls.ID:e instanceof Ue.jz?As.ID:e instanceof Ue.Di?Ms.ID:"string"==typeof e?Bs.ID:e instanceof Ue.l_?Rs.ID:Fs.ID}}function Ps(e){return e.text??Os(e)}function Os(e){return e.description||(e.reason?(0,w.NC)({key:"pausedOn",comment:["indicates reason for program being paused"]},"Paused on {0}",e.reason):(0,w.NC)("paused","Paused"))}function Ws(e){return"function"==typeof e.getSessions}function Hs(e){return e&&"function"==typeof e.getAllThreads}function $s(e){return"deemphasize"===e.source.presentationHint||"deemphasize"===e.presentationHint}class Us{constructor(e){this.debugService=e,this.deemphasizedStackFramesToShow=[]}hasChildren(e){if(Hs(e)){const t=e.getAllThreads();return t.length>1||1===t.length&&t[0].stopped||!!this.debugService.getModel().getSessions().find((t=>t.parentSession===e))}return Ws(e)||e instanceof Ue.jz&&e.stopped}async getChildren(e){if(Ws(e)){const t=e.getSessions();if(0===t.length)return Promise.resolve([]);if(t.length>1||this.debugService.getViewModel().isMultiSessionView())return Promise.resolve(t.filter((e=>!e.parentSession)));const i=t[0].getAllThreads();return 1===i.length?this.getThreadChildren(i[0]):Promise.resolve(i)}if(Hs(e)){const t=this.debugService.getModel().getSessions().filter((t=>t.parentSession===e)),i=e.getAllThreads();return 1===i.length?(await this.getThreadChildren(i[0])).concat(t):Promise.resolve(i.concat(t))}return this.getThreadChildren(e)}getThreadChildren(e){return this.getThreadCallstack(e).then((e=>{const t=[];return e.forEach(((i,s)=>{if(i instanceof Ue.Di&&i.source&&$s(i)&&-1===this.deemphasizedStackFramesToShow.indexOf(i)){if(t.length){const e=t[t.length-1];if(e instanceof Array)return void e.push(i)}const n=s<e.length-1?e[s+1]:void 0;if(n instanceof Ue.Di&&n.source&&$s(n))return void t.push([i])}t.push(i)})),t}))}async getThreadCallstack(e){let t=e.getCallStack();return t&&t.length||(await e.fetchCallStack(),t=e.getCallStack()),1===t.length&&e.session.capabilities.supportsDelayedStackTraceLoading&&e.stoppedDetails&&e.stoppedDetails.totalFrames&&e.stoppedDetails.totalFrames>1&&(t=t.concat(e.getStaleCallStack().slice(1))),e.stoppedDetails&&e.stoppedDetails.framesErrorMessage&&(t=t.concat([e.stoppedDetails.framesErrorMessage])),!e.reachedEndOfCallStack&&e.stoppedDetails&&(t=t.concat([new Ue.l_(e.session.getId(),e.threadId)])),t}}class qs{getWidgetAriaLabel(){return(0,w.NC)({comment:["Debug is a noun in this context, not a verb."],key:"callStackAriaLabel"},"Debug Call Stack")}getWidgetRole(){return"treegrid"}getRole(e){return"row"}getAriaLabel(e){if(e instanceof Ue.jz)return(0,w.NC)({key:"threadAriaLabel",comment:['Placeholders stand for the thread name and the thread state.For example "Thread 1" and "Stopped']},"Thread {0} {1}",e.name,e.stateLabel);if(e instanceof Ue.Di)return(0,w.NC)("stackFrameAriaLabel","Stack Frame {0}, line {1}, {2}",e.name,e.range.startLineNumber,Is(e));if(Hs(e)){const t=e.getAllThreads().find((e=>e.stopped)),i=t?t.stateLabel:(0,w.NC)({key:"running",comment:["indicates state"]},"Running");return(0,w.NC)({key:"sessionLabel",comment:['Placeholders stand for the session name and the session state. For example "Launch Program" and "Running"']},"Session {0} {1}",e.getLabel(),i)}return"string"==typeof e?e:e instanceof Array?(0,w.NC)("showMoreStackFrames","Show {0} More Stack Frames",e.length):Rs.LABEL}}class zs{constructor(e){this.debugService=e}isIncompressible(e){return!Hs(e)||!e.compact&&!this.debugService.getModel().getSessions().some((t=>t.parentSession===e&&t.compact))}}function js(e,t,i,s,n,o){Ot.BH.appendMenuItem(Ot.eH.DebugCallStackContext,{group:"inline",order:n,when:s,command:{id:e,title:t,icon:i,precondition:o}})}(0,Ot.r1)(class extends Gi.Nx{constructor(){super({id:"callStack.collapse",viewId:n.Vw,title:(0,w.NC)("collapse","Collapse All"),f1:!1,icon:Ui.lA.collapseAll,precondition:n.KA.isEqualTo((0,n.wD)(2)),menu:{id:Ot.eH.ViewTitle,order:10,group:"navigation",when:k.Ao.equals("view",n.Vw)}})}runInView(e,t){t.collapseAll()}});const Ks=k.Ao.or(n.fj.isEqualTo("thread"),k.Ao.and(n.fj.isEqualTo("session"),n.xW));js(ue.rd,ue.eW,me.cJ,k.Ao.and(Ks,n.je.toNegated()),10),js(ue.ZI,ue.pl,me.Tl,k.Ao.and(Ks,n.je),10),js(ue.xw,ue.kj,me.xv,Ks,20,n.je),js(ue.Xs,ue.DP,me.Z5,Ks,30,n.je),js(ue.GL,ue.lG,me.Hp,Ks,40,n.je),js(ue._M,ue.Yl,me.gv,n.fj.isEqualTo("session"),50),js(ue.De,ue.yk,me.fR,k.Ao.and(n.Xx.toNegated(),n.fj.isEqualTo("session")),60),js(ue.Sb,ue.XV,me.DI,k.Ao.and(n.Xx,n.fj.isEqualTo("session")),60);var Gs=i(55061);let Qs=class extends Gs.${constructor(e,t,i){super(ue.OD,{canAcceptInBackground:!0}),this._debugService=e,this._viewsService=t,this._commandService=i}_getPicks(e,t,i){const s=[];this._debugService.getModel().getSessions(!0).filter((e=>e.hasSeparateRepl())).forEach(((t,i)=>{const n=this._createPick(t,i,e);n&&s.push(n)})),s.length>0&&s.push({type:"separator"});const n=(0,w.NC)("workbench.action.debug.startDebug","Start a New Debug Session");return s.push({label:`$(plus) ${n}`,ariaLabel:n,accept:()=>this._commandService.executeCommand(ue.w8)}),s}_createPick(e,t,i){const s=e.name,o=(0,qi.Oh)(i,s,!0);if(o)return{label:s,highlights:{label:o},accept:(t,i)=>{this._debugService.focusStackFrame(void 0,void 0,e,{explicit:!0}),this._viewsService.isViewVisible(n.FT)||this._viewsService.openView(n.FT,!0)}}}};Qs=(0,o.g)([(0,o.f)(0,n.tn),(0,o.f)(1,_.qC),(0,o.f)(2,S.H)],Qs);var Js=i(22258),Xs=i(39310),Zs=i(88813);class Ys extends Pt.R6{constructor(){super({id:"editor.debug.action.toggleBreakpoint",label:w.NC("toggleBreakpointAction","Debug: Toggle Breakpoint"),alias:"Debug: Toggle Breakpoint",precondition:n.Qe,kbOpts:{kbExpr:ci.u.editorTextFocus,primary:67,weight:100},menuOpts:{when:n.Qe,title:w.NC({key:"miToggleBreakpoint",comment:["&& denotes a mnemonic"]},"Toggle &&Breakpoint"),menuId:Ot.eH.MenubarDebugMenu,group:"4_new_breakpoint",order:1}})}async run(e,t){if(t.hasModel()){const i=e.get(n.tn),s=t.getModel().uri,o=i.canSetBreakpointsIn(t.getModel()),r=[...new Set(t.getSelections().map((e=>e.getPosition().lineNumber)))];await Promise.all(r.map((async e=>{const t=i.getModel().getBreakpoints({lineNumber:e,uri:s});t.length?await Promise.all(t.map((e=>i.removeBreakpoints(e.getId())))):o&&await i.addBreakpoints(s,[{lineNumber:e}])})))}}}class en extends Pt.R6{constructor(){super({id:"editor.debug.action.conditionalBreakpoint",label:w.NC("conditionalBreakpointEditorAction","Debug: Add Conditional Breakpoint..."),alias:"Debug: Add Conditional Breakpoint...",precondition:n.Qe,menuOpts:{menuId:Ot.eH.MenubarNewBreakpointMenu,title:w.NC({key:"miConditionalBreakpoint",comment:["&& denotes a mnemonic"]},"&&Conditional Breakpoint..."),group:"1_breakpoints",order:1,when:n.Qe}})}async run(e,t){const i=e.get(n.tn),s=t.getPosition();s&&t.hasModel()&&i.canSetBreakpointsIn(t.getModel())&&t.getContribution(n.KI)?.showBreakpointWidget(s.lineNumber,void 0,0)}}class tn extends Pt.R6{constructor(){super({id:"editor.debug.action.addLogPoint",label:w.NC("logPointEditorAction","Debug: Add Logpoint..."),precondition:n.Qe,alias:"Debug: Add Logpoint...",menuOpts:[{menuId:Ot.eH.MenubarNewBreakpointMenu,title:w.NC({key:"miLogPoint",comment:["&& denotes a mnemonic"]},"&&Logpoint..."),group:"1_breakpoints",order:4,when:n.Qe}]})}async run(e,t){const i=e.get(n.tn),s=t.getPosition();s&&t.hasModel()&&i.canSetBreakpointsIn(t.getModel())&&t.getContribution(n.KI)?.showBreakpointWidget(s.lineNumber,s.column,2)}}class sn extends Pt.R6{constructor(){super({id:"editor.debug.action.editBreakpoint",label:w.NC("EditBreakpointEditorAction","Debug: Edit Breakpoint"),alias:"Debug: Edit Existing Breakpoint",precondition:n.Qe,menuOpts:{menuId:Ot.eH.MenubarNewBreakpointMenu,title:w.NC({key:"miEditBreakpoint",comment:["&& denotes a mnemonic"]},"&&Edit Breakpoint"),group:"1_breakpoints",order:1,when:n.Qe}})}async run(e,t){const i=e.get(n.tn),s=t.getPosition(),o=i.getModel();if(!t.hasModel()||!s)return;const r=o.getBreakpoints({lineNumber:s.lineNumber});if(0===r.length)return;const a=r.map((e=>e.column?Math.abs(e.column-s.column):s.column)),c=r[a.indexOf(Math.min(...a))];t.getContribution(n.KI)?.showBreakpointWidget(c.lineNumber,c.column)}}class nn extends Pt.x1{static{this.ID="editor.debug.action.openDisassemblyView"}constructor(){super({id:nn.ID,title:{value:w.NC("openDisassemblyView","Open Disassembly View"),original:"Open Disassembly View",mnemonicTitle:w.NC({key:"miDisassemblyView",comment:["&& denotes a mnemonic"]},"&&DisassemblyView")},precondition:n.pL,menu:[{id:Ot.eH.EditorContext,group:"debug",order:5,when:k.Ao.and(n.hO,Zs.dX.toNegated(),n.KA.isEqualTo("stopped"),ci.u.editorTextFocus,n.Pt,n.gM)},{id:Ot.eH.DebugCallStackContext,group:"z_commands",order:50,when:k.Ao.and(n.hO,n.KA.isEqualTo("stopped"),n.fj.isEqualTo("stackFrame"),n.Pt)},{id:Ot.eH.CommandPalette,when:k.Ao.and(n.hO,n.KA.isEqualTo("stopped"),n.Pt)}]})}runEditorCommand(e,t,...i){t.hasModel()&&e.get(oe.AR).openEditor(St.n.instance,{pinned:!0})}}class on extends Ot.Ke{static{this.ID="debug.action.toggleDisassemblyViewSourceCode"}static{this.configID="debug.disassemblyView.showSourceCode"}constructor(){super({id:on.ID,title:{value:w.NC("toggleDisassemblyViewSourceCode","Toggle Source Code in Disassembly View"),original:"Toggle Source Code in Disassembly View",mnemonicTitle:w.NC({key:"mitogglesource",comment:["&& denotes a mnemonic"]},"&&ToggleSource")},f1:!0})}run(e,t,...i){const s=e.get(C.Ui);if(s){const e=s.getValue("debug").disassemblyView.showSourceCode;s.updateValue(on.configID,!e)}}}class rn extends Pt.R6{static{this.ID="editor.debug.action.runToCursor"}static{this.LABEL=w.NC("runToCursor","Run to Cursor")}constructor(){super({id:rn.ID,label:rn.LABEL,alias:"Debug: Run to Cursor",precondition:k.Ao.and(n.Qe,Zs.dX.toNegated(),ci.u.editorTextFocus),contextMenuOpts:{group:"debug",order:2,when:n.hO}})}async run(e,t){const i=t.getPosition();if(!t.hasModel()||!i)return;const s=t.getModel().uri,o=e.get(n.tn),r=o.getViewModel(),a=e.get(N.v);let c;const d=r.focusedStackFrame;d&&a.extUri.isEqual(d.source.uri,s)&&d.range.startLineNumber===i.lineNumber&&(c=i.column),await o.runTo(s,i.lineNumber,c)}}class an extends Pt.R6{static{this.ID="editor.debug.action.selectionToRepl"}static{this.LABEL=w.NC("evaluateInDebugConsole","Evaluate in Debug Console")}constructor(){super({id:an.ID,label:an.LABEL,alias:"Debug: Evaluate in Console",precondition:k.Ao.and(n.hO,ci.u.editorTextFocus),contextMenuOpts:{group:"debug",order:0}})}async run(e,t){const i=e.get(n.tn),s=e.get(_.qC),o=i.getViewModel(),r=o.focusedSession;if(!t.hasModel()||!r)return;const a=t.getSelection();let c;c=a.isEmpty()?t.getModel().getLineContent(a.selectionStartLineNumber).trim():t.getModel().getValueInRange(a),await r.addReplExpression(o.focusedStackFrame,c),await s.openView(n.FT,!1)}}class cn extends Pt.R6{static{this.ID="editor.debug.action.selectionToWatch"}static{this.LABEL=w.NC("addToWatch","Add to Watch")}constructor(){super({id:cn.ID,label:cn.LABEL,alias:"Debug: Add to Watch",precondition:k.Ao.and(n.hO,ci.u.editorTextFocus),contextMenuOpts:{group:"debug",order:1}})}async run(e,t){const i=e.get(n.tn),s=e.get(_.qC),o=e.get(Tt.p);if(!t.hasModel())return;let r;const a=t.getModel(),c=t.getSelection();if(c.isEmpty()){const e=t.getPosition(),i=await(0,$.Cc)(o,a,e);if(!i)return;r=i.matchingExpression}else r=a.getValueInRange(c);r&&(await s.openView(n.Vn),i.addWatchExpression(r))}}class dn extends Pt.R6{constructor(){super({id:"editor.debug.action.showDebugHover",label:w.NC("showDebugHover","Debug: Show Hover"),alias:"Debug: Show Hover",precondition:n.hO,kbOpts:{kbExpr:ci.u.editorTextFocus,primary:(0,Js.gx)(2089,2087),weight:100}})}async run(e,t){const i=t.getPosition();if(i&&t.hasModel())return t.getContribution(n.X)?.showHover(i,!0)}}const ln=w.NC("editor.debug.action.stepIntoTargets.notAvailable","Step targets are not available here");class un extends Pt.R6{static{this.ID="editor.debug.action.stepIntoTargets"}static{this.LABEL=w.NC({key:"stepIntoTargets",comment:["Step Into Targets lets the user step into an exact function he or she is interested in."]},"Step Into Target")}constructor(){super({id:un.ID,label:un.LABEL,alias:"Debug: Step Into Target",precondition:k.Ao.and(n.o8,n.hO,n.KA.isEqualTo("stopped"),ci.u.editorTextFocus),contextMenuOpts:{group:"debug",order:1.5}})}async run(e,t){const i=e.get(n.tn),s=e.get(Yt.i),o=e.get(N.v),r=i.getViewModel().focusedSession,c=i.getViewModel().focusedStackFrame,d=t.getSelection(),l=d?.getPosition()||c&&{lineNumber:c.range.startLineNumber,column:c.range.startColumn};if(!(r&&c&&t.hasModel()&&o.extUri.isEqual(t.getModel().uri,c.source.uri)))return void(l&&Xs.O.get(t)?.showMessage(ln,l));const u=await r.stepInTargets(c.frameId);if(!u?.length)return void Xs.O.get(t)?.showMessage(ln,l);if(d){const e=[];for(const t of u)t.line&&e.push({start:new ri.L(t.line,t.column||1),end:t.endLine?new ri.L(t.endLine,t.endColumn||1):void 0,target:t});e.sort(((e,t)=>t.start.lineNumber-e.start.lineNumber||t.start.column-e.start.column));const t=d.getPosition(),i=e.find((e=>e.end&&t.isBefore(e.end)&&e.start.isBeforeOrEqual(t)))||e.find((e=>void 0===e.end&&e.start.isBeforeOrEqual(t)));if(i)return void r.stepIn(c.thread.threadId,i.target.id)}t.revealLineInCenterIfOutsideViewport(c.range.startLineNumber);const h=t.getScrolledVisiblePosition(l),g=(0,Kt.i)(t.getDomNode()),p=g.left+h.left,b=g.top+h.top+h.height;s.showContextMenu({getAnchor:()=>({x:p,y:b}),getActions:()=>u.map((e=>new a.aU(`stepIntoTarget:${e.id}`,e.label,void 0,!0,(()=>r.stepIn(c.thread.threadId,e.id)))))})}}class hn extends Pt.R6{constructor(e,t){super(t),this.isNext=e}async run(e,t){const i=e.get(n.tn),s=e.get(oe.AR),o=e.get(N.v);if(t.hasModel()){const e=t.getModel().uri,n=t.getPosition().lineNumber,r=i.getModel().getBreakpoints({enabledOnly:!0});let a=this.isNext?r.filter((t=>o.extUri.isEqual(t.uri,e)&&t.lineNumber>n)).shift():r.filter((t=>o.extUri.isEqual(t.uri,e)&&t.lineNumber<n)).pop();if(a||(a=this.isNext?r.filter((t=>t.uri.toString()>e.toString())).shift():r.filter((t=>t.uri.toString()<e.toString())).pop()),!a&&r.length&&(a=this.isNext?r[0]:r[r.length-1]),a)return(0,ni.u6)(a,!1,!0,!1,i,s)}}}class gn extends Pt.R6{constructor(){super({id:"editor.debug.action.closeExceptionWidget",label:w.NC("closeExceptionWidget","Close Exception Widget"),alias:"Close Exception Widget",precondition:n.rh,kbOpts:{primary:9,weight:100}})}async run(e,t){const i=t.getContribution(n.X);i?.closeExceptionWidget()}}(0,Ot.r1)(nn),(0,Ot.r1)(on),(0,Pt.Qr)(Ys),(0,Pt.Qr)(en),(0,Pt.Qr)(tn),(0,Pt.Qr)(sn),(0,Pt.Qr)(rn),(0,Pt.Qr)(un),(0,Pt.Qr)(an),(0,Pt.Qr)(cn),(0,Pt.Qr)(dn),(0,Pt.Qr)(class extends hn{constructor(){super(!0,{id:"editor.debug.action.goToNextBreakpoint",label:w.NC("goToNextBreakpoint","Debug: Go to Next Breakpoint"),alias:"Debug: Go to Next Breakpoint",precondition:n.Qe})}}),(0,Pt.Qr)(class extends hn{constructor(){super(!1,{id:"editor.debug.action.goToPreviousBreakpoint",label:w.NC("goToPreviousBreakpoint","Debug: Go to Previous Breakpoint"),alias:"Debug: Go to Previous Breakpoint",precondition:n.Qe})}}),(0,Pt.Qr)(gn);var pn=i(4850),bn=i(60449),mn=i(69317),fn=i(69386),vn=i(270),wn=i(88191),Sn=i(23708),Cn=i(64117),kn=i(71083),yn=i(65914);const Dn="\\u0000-\\u0020\\u007f-\\u009f",xn=new RegExp("(?:[a-zA-Z][a-zA-Z0-9+.-]{2,}:\\/\\/|data:|www\\.)[^\\s"+Dn+'"]{2,}[^\\s'+Dn+"\"')}\\],:;.!?]","ug"),In=new RegExp(`(${/(?:[a-zA-Z]:(?:(?:\\|\/)[\w\.-]*)+)/.source}|${/(?:(?:\~|\.)(?:(?:\\|\/)[\w\.-]*)+)/.source})`),En=new RegExp(`${Ve.ED?In.source:/((?:\~|\.)?(?:\/[\w\.-]*)+)/.source}${/(?:\:([\d]+))?(?:\:([\d]+))?/.source}`,"g"),Nn=/:([\d]+)(?::([\d]+))?$/;let Tn=class{constructor(e,t,i,s,n,o,r){this.editorService=e,this.fileService=t,this.openerService=i,this.pathService=s,this.tunnelService=n,this.environmentService=o,this.configurationService=r}linkify(e,t,i,s){if(t){const t=e.split("\n");for(let e=0;e<t.length-1;e++)t[e]=t[e]+"\n";t[t.length-1]||t.pop();const n=t.map((e=>this.linkify(e,!1,i,s)));if(1===n.length)return n[0];const o=document.createElement("span");return n.forEach((e=>o.appendChild(e))),o}const n=document.createElement("span");for(const t of this.detectLinks(e))try{switch(t.kind){case"text":n.appendChild(document.createTextNode(t.value));break;case"web":n.appendChild(this.createWebLink(s?e:void 0,t.value));break;case"path":{const o=t.captures[0],r=t.captures[1]?Number(t.captures[1]):0,a=t.captures[2]?Number(t.captures[2]):0;n.appendChild(this.createPathLink(s?e:void 0,t.value,o,r,a,i));break}}}catch(e){n.appendChild(document.createTextNode(t.value))}return n}createWebLink(e,t){const i=this.createLink(t);let s=W.ov.parse(t);const n=Nn.exec(s.path);return n&&(s=s.with({path:s.path.slice(0,n.index),fragment:`L${n[0].slice(1)}`})),this.decorateLink(i,s,e,(async()=>{if(s.scheme!==H.lg.file)this.openerService.open(t,{allowTunneling:!!this.environmentService.remoteAuthority&&this.configurationService.getValue("remote.forwardOnOpen")});else{const e=s.fsPath,t=await this.pathService.path,i=zi.Fv(t.sep===zi.KR.sep&&Ve.ED?e.replace(/\\/g,zi.KR.sep):e),o=W.ov.parse(i);if(!await this.fileService.exists(o))return;await this.editorService.openEditor({resource:o,options:{pinned:!0,selection:n?{startLineNumber:+n[1],startColumn:+n[2]}:void 0}})}})),i}createPathLink(e,t,i,s,n,o){if("/"===i[0]&&"/"===i[1])return document.createTextNode(t);const r={selection:{startLineNumber:s,startColumn:n}};if("."===i[0]){if(!o)return document.createTextNode(t);const s=o.toResource(i),n=this.createLink(t);return this.decorateLink(n,s,e,(e=>this.editorService.openEditor({resource:s,options:{...r,preserveFocus:e}}))),n}if("~"===i[0]){const e=this.pathService.resolvedUserHome;e&&(i=zi.v_(e.fsPath,i.substring(1)))}const a=this.createLink(t);a.tabIndex=0;const c=W.ov.file(zi.Fv(i));return this.fileService.stat(c).then((t=>{t.isDirectory||this.decorateLink(a,c,e,(e=>this.editorService.openEditor({resource:c,options:{...r,preserveFocus:e}})))})).catch((()=>{})),a}createLink(e){const t=document.createElement("a");return t.textContent=e,t}decorateLink(e,t,i,s){e.classList.add("link");const n=this.tunnelService.canTunnel(t)?(0,w.NC)("followForwardedLink","follow link using forwarded port"):(0,w.NC)("followLink","follow link");e.title=i?Ve.dz?(0,w.NC)("fileLinkWithPathMac","Cmd + click to {0}\n{1}",n,i):(0,w.NC)("fileLinkWithPath","Ctrl + click to {0}\n{1}",n,i):Ve.dz?(0,w.NC)("fileLinkMac","Cmd + click to {0}",n):(0,w.NC)("fileLink","Ctrl + click to {0}",n),e.onmousemove=t=>{e.classList.toggle("pointer",Ve.dz?t.metaKey:t.ctrlKey)},e.onmouseleave=()=>e.classList.remove("pointer"),e.onclick=e=>{const t=window.getSelection();t&&"Range"!==t.type&&(Ve.dz?e.metaKey:e.ctrlKey)&&(e.preventDefault(),e.stopImmediatePropagation(),s(!1))},e.onkeydown=e=>{const t=new os.y1(e);3!==t.keyCode&&10!==t.keyCode||(t.preventDefault(),t.stopPropagation(),s(10===t.keyCode))}}detectLinks(e){if(e.length>2e3)return[{kind:"text",value:e,captures:[]}];const t=[xn,En],i=["web","path"],s=[],n=(e,o)=>{if(o>=t.length)return void s.push({value:e,kind:"text",captures:[]});const r=t[o];let a,c=0;for(r.lastIndex=0;null!==(a=r.exec(e));){const t=e.substring(c,a.index);t&&n(t,o+1);const r=a[0];s.push({value:r,kind:i[o],captures:a.slice(1)}),c=a.index+r.length}const d=e.substring(c);d&&n(d,o+1)};return n(e,0),s}};Tn=(0,o.g)([(0,o.f)(0,oe.AR),(0,o.f)(1,D.sn),(0,o.f)(2,He.v4),(0,o.f)(3,Bt.a),(0,o.f)(4,yn.XN),(0,o.f)(5,q.n),(0,o.f)(6,C.Ui)],Tn);var Ln=i(84972),_n=i(90535);const An=Kt.$;let Mn,Bn,Rn=!0,Fn=class extends Gi.qV{constructor(e,t,i,s,n,o,r,a,c,l,u,h){super(e,s,t,n,a,r,o,c,l,u),this.debugService=i,this.menuService=h,this.needsRefresh=!1,this.savedViewState=new Map,this.autoExpandedScopes=new Set,this.updateTreeScheduler=new d.pY((async()=>{const e=this.debugService.getViewModel().focusedStackFrame;this.needsRefresh=!1;const t=this.tree.getInput();if(t&&this.savedViewState.set(t.getId(),this.tree.getViewState()),!e)return void await this.tree.setInput(null);const i=this.savedViewState.get(e.getId());await this.tree.setInput(e,i);const s=(await e.getScopes()).find((e=>!e.expensive));s&&this.tree.hasNode(s)&&(this.autoExpandedScopes.add(s.getId()),await this.tree.expand(s))}),400)}renderBody(e){super.renderBody(e),this.element.classList.add("debug-pane"),e.classList.add("debug-variables");const t=es(e),i=this.instantiationService.createInstance(Tn);let s;this.tree=this.instantiationService.createInstance(Ki.ls,"VariablesView",t,new Hn,[this.instantiationService.createInstance(qn,i),new $n,new Un],new Wn,{accessibilityProvider:new zn,identityProvider:{getId:e=>e.getId()},keyboardNavigationLabelProvider:{getKeyboardNavigationLabel:e=>e.name},overrideStyles:{listBackground:this.getBackgroundColor()}}),this.tree.setInput((0,V.M2)(this.debugService.getViewModel().focusedStackFrame)),n.$l.bindTo(this.tree.contextKeyService),this._register(this.debugService.getViewModel().onDidFocusStackFrame((e=>{if(!this.isBodyVisible())return void(this.needsRefresh=!0);const t=e.explicit?0:void 0;this.updateTreeScheduler.schedule(t)}))),this._register(this.debugService.getViewModel().onWillUpdateViews((()=>{const e=this.debugService.getViewModel().focusedStackFrame;e&&Rn&&e.forgetScopes(),Rn=!0,this.tree.updateChildren()}))),this._register(this.tree.onMouseDblClick((e=>this.onMouseDblClick(e)))),this._register(this.tree.onContextMenu((async e=>await this.onContextMenu(e)))),this._register(this.onDidChangeBodyVisibility((e=>{e&&this.needsRefresh&&this.updateTreeScheduler.schedule()}))),this._register(this.debugService.getViewModel().onDidSelectExpression((e=>{const t=e?.expression;t instanceof Ue._w&&!e?.settingWatch?(s=this.tree.options.horizontalScrolling,s&&this.tree.updateOptions({horizontalScrolling:!1}),this.tree.rerender(t)):e||void 0===s||(this.tree.updateOptions({horizontalScrolling:s}),s=void 0)}))),this._register(this.debugService.getViewModel().onDidEvaluateLazyExpression((async e=>{e instanceof Ue._w&&this.tree.hasNode(e)&&(await this.tree.updateChildren(e,!1,!0),await this.tree.expand(e))}))),this._register(this.debugService.onDidEndSession((()=>{this.savedViewState.clear(),this.autoExpandedScopes.clear()})))}layoutBody(e,t){super.layoutBody(t,e),this.tree.layout(e,t)}focus(){this.tree.domFocus()}collapseAll(){this.tree.collapseAll()}onMouseDblClick(e){const t=this.debugService.getViewModel().focusedSession;t&&e.element instanceof Ue._w&&t.capabilities.supportsSetVariable&&!e.element.presentationHint?.attributes?.includes("readOnly")&&!e.element.presentationHint?.lazy&&this.debugService.getViewModel().setSelectedExpression(e.element,!1)}async onContextMenu(e){const t=e.element;if(!(t instanceof Ue._w&&t.value))return;const i=new p.SL;try{const s=await async function(e,t){const i=t.getSession();if(!i||!i.capabilities.supportsDataBreakpoints)return Pn(e,t);const s=[];Bn=await i.dataBreakpointInfo(t.name,t.parent.reference);const o=Bn?.dataId,r=Bn?.accessTypes;if(r)for(const e of r)switch(e){case"read":s.push([n.pP.key,!!o]);break;case"write":s.push([n.IA.key,!!o]);break;case"readWrite":s.push([n.DD.key,!!o])}else s.push([n.IA.key,!!o]);return Pn(e,t,s)}(this.contextKeyService,t),o=i.add(this.menuService.createMenu(Ot.eH.DebugVariablesContext,s)),r=Vn(t),a=[];(0,ji.LJ)(o,{arg:r,shouldForwardArgs:!1},{primary:[],secondary:a},"inline"),this.contextMenuService.showContextMenu({getAnchor:()=>e.anchor,getActions:()=>a})}finally{i.dispose()}}};Fn=(0,o.g)([(0,o.f)(1,Yt.i),(0,o.f)(2,n.tn),(0,o.f)(3,fi.d),(0,o.f)(4,C.Ui),(0,o.f)(5,x.TG),(0,o.f)(6,_.XH),(0,o.f)(7,k.i6),(0,o.f)(8,He.v4),(0,o.f)(9,ti.XE),(0,o.f)(10,We.bU),(0,o.f)(11,Ot.co)],Fn);const Vn=e=>({sessionId:e.getSession()?.getId(),container:e.parent instanceof Ue.A2?{expression:e.parent.name}:e.parent.toDebugProtocolObject(),variable:e.toDebugProtocolObject()});function Pn(e,t,i=[]){const s=t.getSession(),o=[[n.uD.key,t.variableMenuContext||""],[n.D7.key,!!t.evaluateName],[n.SC.key,!!s?.capabilities.supportsReadMemoryRequest&&void 0!==t.memoryReference],[n.hs.key,!!t.presentationHint?.attributes?.includes("readOnly")||t.presentationHint?.lazy],...i];return Mn=t,e.createOverlay(o)}function On(e){return e instanceof Ue.Di}class Wn{hasChildren(e){return!!e&&(!!On(e)||e.hasChildren)}getChildren(e){return On(e)?e.getScopes():e.getChildren()}}class Hn{getHeight(e){return 22}getTemplateId(e){return e instanceof Ue.FP?Un.ID:e instanceof Ue.sX?$n.ID:qn.ID}}class $n{static{this.ID="scope"}get templateId(){return $n.ID}renderTemplate(e){const t=Kt.R3(e,An(".scope"));return{name:t,label:new $i.q(t)}}renderElement(e,t,i){i.label.set(e.element.name,(0,qi.mB)(e.filterData))}disposeTemplate(e){}}class Un{static{this.ID="scopeError"}get templateId(){return Un.ID}renderTemplate(e){const t=Kt.R3(e,An(".scope"));return{error:Kt.R3(t,An(".error"))}}renderElement(e,t,i){i.error.innerText=e.element.name}disposeTemplate(){}}let qn=class e extends ss{static{this.ID="variable"}constructor(e,t,i,s,n){super(s,n),this.linkDetector=e,this.menuService=t,this.contextKeyService=i}get templateId(){return e.ID}renderExpression(e,t,i){is(e,t,!0,i,this.linkDetector)}renderElement(e,t,i){super.renderExpressionElement(e.element,e,i)}getInputBoxOptions(e){const t=e;return{initialValue:e.value,ariaLabel:(0,w.NC)("variableValueAriaLabel","Type new variable value"),validationOptions:{validation:()=>t.errorMessage?{content:t.errorMessage}:null},onFinish:(e,i)=>{t.errorMessage=void 0;const s=this.debugService.getViewModel().focusedStackFrame;i&&t.value!==e&&s&&t.setVariable(e,s).then((()=>{Rn=!1,this.debugService.getViewModel().updateViews()}))}}}renderActionBar(e,t){const i=t,s=Pn(this.contextKeyService,i),n=this.menuService.createMenu(Ot.eH.DebugVariablesContext,s),o=[],r=Vn(i);(0,ji.LJ)(n,{arg:r,shouldForwardArgs:!1},{primary:o,secondary:[]},"inline"),e.clear(),e.context=r,e.push(o,{icon:!0,label:!1})}};qn=(0,o.g)([(0,o.f)(1,Ot.co),(0,o.f)(2,k.i6),(0,o.f)(3,n.tn),(0,o.f)(4,Yt.u)],qn);class zn{getWidgetAriaLabel(){return(0,w.NC)("variablesAriaTreeLabel","Debug Variables")}getAriaLabel(e){return e instanceof Ue.sX?(0,w.NC)("variableScopeAriaLabel","Scope {0}",e.name):e instanceof Ue._w?(0,w.NC)({key:"variableAriaLabel",comment:["Placeholders are variable name and variable value respectivly. They should not be translated."]},"{0}, value {1}",e.name,e.value):null}}const jn="debug.setVariable";S.P.registerCommand({id:jn,handler:e=>{e.get(n.tn).getViewModel().setSelectedExpression(Mn,!1)}});const Kn="workbench.debug.viewlet.action.copyValue";S.P.registerCommand({id:Kn,handler:async(e,t,i)=>{const s=e.get(n.tn),o=e.get(Ln.p);let r,a="";t instanceof Ue._w||t instanceof Ue.A2?(a="watch",r=i||[]):(a="variables",r=Mn?[Mn]:[]);const d=s.getViewModel().focusedStackFrame,l=s.getViewModel().focusedSession;if(!d||!l||0===r.length)return;const u=l.capabilities.supportsClipboardContext?"clipboard":a,h=r.map((e=>e instanceof Ue._w?e.evaluateName||e.value:e.name));try{const e=await Promise.all(h.map((e=>l.evaluate(e,d.frameId,u)))),t=(0,c.kX)(e).map((e=>e.body.result));t.length&&o.writeText(t.join("\n"))}catch(e){const t=r.map((e=>e.value));o.writeText(t.join("\n"))}}});const Gn="workbench.debug.viewlet.action.viewMemory",Qn="ms-vscode.hexeditor";S.P.registerCommand({id:Gn,handler:async(e,t,i)=>{const s=e.get(n.tn);let o,r;if("sessionId"in t){if(!t.sessionId||!t.variable.memoryReference)return;o=t.sessionId,r=t.variable.memoryReference}else{if(!t.memoryReference)return;const e=s.getViewModel().focusedSession;if(!e)return;o=e.getId(),r=t.memoryReference}const a=e.get(S.H),c=e.get(oe.AR),l=e.get(I.lT),u=e.get(_n.R9),h=e.get(re.QS),g=e.get(We.bU);(await h.getExtension(Qn)||await function(e,t,i,s){return new Promise((n=>{let o=!1;e.prompt(I.zb.Info,(0,w.NC)("viewMemory.prompt","Inspecting binary data requires the Hex Editor extension. Would you like to install it now?"),[{label:(0,w.NC)("cancel","Cancel"),run:()=>n(!1)},{label:(0,w.NC)("install","Install"),run:async()=>{o=!0;try{await t.withProgress({location:15,title:(0,w.NC)("viewMemory.install.progress","Installing the Hex Editor...")},(async()=>{for(await s.executeCommand("workbench.extensions.installExtension",Qn);!await i.getExtension(Qn);)await(0,d.Vs)(30)})),n(!0)}catch(t){e.error(t),n(!1)}}}],{sticky:!0}).onDidClose((e=>{o||n(!1)}))}))}(l,u,h,a))&&(g.publicLog("debug/didViewMemory",{debugType:s.getModel().getSession(o)?.configuration.type}),await c.openEditor({resource:(0,Ue.ko)(o,r),options:{revealIfOpened:!0,override:"hexEditor.hexedit"}},oe.O3))}});const Jn="debug.breakWhenValueChanges";S.P.registerCommand({id:Jn,handler:async e=>{const t=e.get(n.tn);Bn&&await t.addDataBreakpoint(Bn.description,Bn.dataId,!!Bn.canPersist,Bn.accessTypes,"write")}});const Xn="debug.breakWhenValueIsAccessed";S.P.registerCommand({id:Xn,handler:async e=>{const t=e.get(n.tn);Bn&&await t.addDataBreakpoint(Bn.description,Bn.dataId,!!Bn.canPersist,Bn.accessTypes,"readWrite")}});const Zn="debug.breakWhenValueIsRead";S.P.registerCommand({id:Zn,handler:async e=>{const t=e.get(n.tn);Bn&&await t.addDataBreakpoint(Bn.description,Bn.dataId,!!Bn.canPersist,Bn.accessTypes,"read")}});const Yn="debug.copyEvaluatePath";S.P.registerCommand({id:Yn,handler:async(e,t)=>{const i=e.get(Ln.p);await i.writeText(t.variable.evaluateName)}});const eo="debug.addToWatchExpressions";S.P.registerCommand({id:eo,handler:async(e,t)=>{e.get(n.tn).addWatchExpression(t.variable.evaluateName)}}),(0,Ot.r1)(class extends Gi.Nx{constructor(){super({id:"variables.collapse",viewId:n.sk,title:(0,w.NC)("collapse","Collapse All"),f1:!1,icon:Ui.lA.collapseAll,menu:{id:Ot.eH.ViewTitle,group:"navigation",when:k.Ao.equals("view",n.sk)}})}runInView(e,t){t.collapseAll()}});const to=Kt.$;async function io(e,t){if(!e)return null;const i=(await e.getChildren()).filter((e=>t[0]===e.name));return 1!==i.length?null:1===t.length?i[0]:io(i[0],t.slice(1))}async function so(e,t){const i=(await e.getScopes()).filter((e=>!e.expensive)),s=(0,c.kX)(await Promise.all(i.map((e=>io(e,t)))));return s.length>0&&s.every((e=>e.value===s[0].value))?s[0]:void 0}let no=class e{static{this.ID="debug.hoverWidget"}constructor(e,t,i){this.editor=e,this.debugService=t,this.instantiationService=i,this.allowEditorOverflow=!0,this.highlightDecorations=this.editor.createDecorationsCollection(),this.isUpdatingTree=!1,this.toDispose=[],this._isVisible=!1,this.showAtPosition=null,this.positionPreference=[1,2],this.debugHoverComputer=this.instantiationService.createInstance(co,this.editor)}create(){this.domNode=to(".debug-hover-widget"),this.complexValueContainer=Kt.R3(this.domNode,to(".complex-value")),this.complexValueTitle=Kt.R3(this.complexValueContainer,to(".title")),this.treeContainer=Kt.R3(this.complexValueContainer,to(".debug-hover-tree")),this.treeContainer.setAttribute("role","tree"),Kt.R3(this.complexValueContainer,to(".tip")).textContent=w.NC({key:"quickTip",comment:['"switch to editor language hover" means to show the programming language hover widget instead of the debug hover']},"Hold {0} key to switch to editor language hover",Ve.dz?"Option":"Alt");const e=new ro,t=this.instantiationService.createInstance(Tn);this.tree=this.instantiationService.createInstance(Ki.ls,"DebugHover",this.treeContainer,new ao,[this.instantiationService.createInstance(qn,t)],e,{accessibilityProvider:new oo,mouseSupport:!1,horizontalScrolling:!0,useShadows:!1,keyboardNavigationLabelProvider:{getKeyboardNavigationLabel:e=>e.name},overrideStyles:{listBackground:ei.yJx}}),this.valueContainer=to(".value"),this.valueContainer.tabIndex=0,this.valueContainer.setAttribute("role","tooltip"),this.scrollbar=new Cn.s$(this.valueContainer,{horizontal:2}),this.domNode.appendChild(this.scrollbar.getDomNode()),this.toDispose.push(this.scrollbar),this.editor.applyFontInfo(this.domNode),this.domNode.style.backgroundColor=(0,ei.n_1)(ei.yJx),this.domNode.style.border=`1px solid ${(0,ei.n_1)(ei.CNo)}`,this.domNode.style.color=(0,ei.n_1)(ei.Sbf),this.toDispose.push(this.tree.onDidChangeContentHeight((()=>{this.isUpdatingTree||this.layoutTreeAndContainer()}))),this.toDispose.push(this.tree.onDidChangeContentWidth((()=>{this.isUpdatingTree||this.layoutTreeAndContainer()}))),this.registerListeners(),this.editor.addContentWidget(this)}registerListeners(){this.toDispose.push(Kt.mu(this.domNode,"keydown",(e=>{e.equals(9)&&this.hide()}))),this.toDispose.push(this.editor.onDidChangeConfiguration((e=>{e.hasChanged(49)&&this.editor.applyFontInfo(this.domNode)}))),this.toDispose.push(this.debugService.getViewModel().onDidEvaluateLazyExpression((async e=>{e instanceof Ue._w&&this.tree.hasNode(e)&&(await this.tree.updateChildren(e,!1,!0),await this.tree.expand(e))})))}isHovered(){return!!this.domNode?.matches(":hover")}isVisible(){return this._isVisible}willBeVisible(){return!!this.showCancellationSource}getId(){return e.ID}getDomNode(){return this.domNode}async showAt(t,i){this.showCancellationSource?.cancel();const s=this.showCancellationSource=new l.A,n=this.debugService.getViewModel().focusedSession;if(!n||!this.editor.hasModel())return this.hide(),1;const o=await this.debugHoverComputer.compute(t,s.token);if(s.token.isCancellationRequested)return this.hide(),2;if(!o.range)return this.hide(),1;if(this.isVisible()&&!o.rangeChanged)return 0;const r=await this.debugHoverComputer.evaluate(n);return s.token.isCancellationRequested?(this.hide(),2):!r||r instanceof Ue.A2&&!r.available?(this.hide(),1):(this.highlightDecorations.set([{range:o.range,options:e._HOVER_HIGHLIGHT_DECORATION_OPTIONS}]),this.doShow(o.range.getStartPosition(),r,i))}static{this._HOVER_HIGHLIGHT_DECORATION_OPTIONS=kn.qx.register({description:"bdebug-hover-highlight",className:"hoverHighlight"})}async doShow(e,t,i,s=!1){if(this.domNode||this.create(),this.showAtPosition=e,this._isVisible=!0,!t.hasChildren||s)return this.complexValueContainer.hidden=!0,this.valueContainer.hidden=!1,ts(t,this.valueContainer,{showChanged:!1,colorize:!0}),this.valueContainer.title="",this.editor.layoutContentWidget(this),this.scrollbar.scanDomNode(),void(i&&(this.editor.render(),this.valueContainer.focus()));this.valueContainer.hidden=!0,this.expressionToRender=t,this.complexValueTitle.textContent=t.value,this.complexValueTitle.title=t.value,this.editor.layoutContentWidget(this),this.tree.scrollTop=0,this.tree.scrollLeft=0,this.complexValueContainer.hidden=!1,i&&(this.editor.render(),this.tree.domFocus())}layoutTreeAndContainer(){this.layoutTree(),this.editor.layoutContentWidget(this)}layoutTree(){const e=Math.min(Math.max(266,.55*this.editor.getLayoutInfo().height),this.tree.contentHeight+10),t=this.tree.contentWidth,i=(0,_e.uZ)(t,400,550);this.tree.layout(e,i),this.treeContainer.style.height=`${e}px`,this.scrollbar.scanDomNode()}beforeRender(){if(this.expressionToRender){const e=this.expressionToRender;this.expressionToRender=void 0,this.isUpdatingTree=!0,this.tree.setInput(e).finally((()=>{this.isUpdatingTree=!1}))}return null}afterRender(e){e&&(this.positionPreference=[e])}hide(){this.showCancellationSource&&(this.showCancellationSource.cancel(),this.showCancellationSource=void 0),this._isVisible&&(Kt.jg(document.activeElement,this.domNode)&&this.editor.focus(),this._isVisible=!1,this.highlightDecorations.clear(),this.editor.layoutContentWidget(this),this.positionPreference=[1,2])}getPosition(){return this._isVisible?{position:this.showAtPosition,preference:this.positionPreference}:null}dispose(){this.toDispose=p.B9(this.toDispose)}};no=(0,o.g)([(0,o.f)(1,n.tn),(0,o.f)(2,x.TG)],no);class oo{getWidgetAriaLabel(){return w.NC("treeAriaLabel","Debug Hover")}getAriaLabel(e){return w.NC({key:"variableAriaLabel",comment:["Do not translate placeholders. Placeholders are name and value of a variable."]},"{0}, value {1}, variables, debug",e.name,e.value)}}class ro{hasChildren(e){return e.hasChildren}getChildren(e){return e.getChildren()}}class ao{getHeight(e){return 18}getTemplateId(e){return qn.ID}}let co=class{constructor(e,t,i,s){this.editor=e,this.debugService=t,this.languageFeaturesService=i,this.logService=s}async compute(e,t){if(!this.debugService.getViewModel().focusedSession||!this.editor.hasModel())return{rangeChanged:!1};const i=this.editor.getModel(),s=await(0,$.Cc)(this.languageFeaturesService,i,e,t);if(!s)return{rangeChanged:!1};const{range:n,matchingExpression:o}=s,r=!this._currentRange||!this._currentRange.equalsRange(n);return this._currentExpression=o,this._currentRange=Xt.e.lift(n),{rangeChanged:r,range:this._currentRange}}async evaluate(e){if(this._currentExpression){if(e.capabilities.supportsEvaluateForHovers){const t=new Ue.A2(this._currentExpression);return await t.evaluate(e,this.debugService.getViewModel().focusedStackFrame,"hover"),t}{const e=this.debugService.getViewModel().focusedStackFrame;if(e)return await so(e,(0,c.kX)(this._currentExpression.split(".").map((e=>e.trim()))))}}else this.logService.error("No expression to evaluate")}};co=(0,o.g)([(0,o.f)(1,n.tn),(0,o.f)(2,Tt.p),(0,o.f)(3,Pe.VZ)],co),(0,Vt.Z)(".monaco-editor .zone-widget.exception-widget-container{overflow:hidden}.monaco-editor .zone-widget .zone-widget-container.exception-widget{padding:6px 10px;user-select:text;-webkit-user-select:text;white-space:pre-wrap}.monaco-editor .zone-widget .zone-widget-container.exception-widget .title{display:flex}.monaco-editor .zone-widget .zone-widget-container.exception-widget .title .label{align-items:center;display:flex;font-weight:700}.monaco-editor .zone-widget .zone-widget-container.exception-widget .title .actions{flex:1}.monaco-editor .zone-widget .zone-widget-container.exception-widget .description,.monaco-editor .zone-widget .zone-widget-container.exception-widget .stack-trace{font-family:var(--monaco-monospace-font)}.monaco-editor .zone-widget .zone-widget-container.exception-widget .stack-trace{margin-top:.5em}.monaco-editor .zone-widget .zone-widget-container.exception-widget .stack-trace a{cursor:pointer;text-decoration:underline}.monaco-workbench.mac .zone-widget .zone-widget-container.exception-widget{font-size:11px}.monaco-workbench.linux .zone-widget .zone-widget-container.exception-widget,.monaco-workbench.windows .zone-widget .zone-widget-container.exception-widget{font-size:13px}",{});var lo=i(59554);const uo=Kt.$,ho=(0,ei.P6G)("debugExceptionWidget.border",{dark:"#a31515",light:"#a31515",hcDark:"#a31515",hcLight:"#a31515"},w.NC("debugExceptionWidgetBorder","Exception widget border color.")),go=(0,ei.P6G)("debugExceptionWidget.background",{dark:"#420b0d",light:"#f1dfde",hcDark:"#420b0d",hcLight:"#f1dfde"},w.NC("debugExceptionWidgetBackground","Exception widget background color."));let po=class extends ai.I{constructor(e,t,i,s,n){super(e,{showFrame:!0,showArrow:!0,isAccessible:!0,frameWidth:1,className:"exception-widget-container"}),this.exceptionInfo=t,this.debugSession=i,this.instantiationService=n,this.applyTheme(s.getColorTheme()),this._disposables.add(s.onDidColorThemeChange(this.applyTheme.bind(this))),this.create();const o=new d.pY((()=>this._doLayout(void 0,void 0)),50);this._disposables.add(this.editor.onDidLayoutChange((()=>o.schedule()))),this._disposables.add(o)}applyTheme(e){this.backgroundColor=e.getColor(go);const t=e.getColor(ho);this.style({arrowColor:t,frameColor:t})}_applyStyles(){this.container&&(this.container.style.backgroundColor=this.backgroundColor?this.backgroundColor.toString():""),super._applyStyles()}_fillContainer(e){this.setCssClass("exception-widget");const t=this.editor.getOption(49);e.style.fontSize=`${t.fontSize}px`,e.style.lineHeight=`${t.lineHeight}px`,e.tabIndex=0;const i=uo(".title"),s=uo(".label");Kt.R3(i,s);const o=uo(".actions");Kt.R3(i,o),s.textContent=this.exceptionInfo.id?w.NC("exceptionThrownWithId","Exception has occurred: {0}",this.exceptionInfo.id):w.NC("exceptionThrown","Exception has occurred.");let r=s.textContent;if(new Hi.o(o).push(new a.aU("editor.closeExceptionWidget",w.NC("close","Close"),be.kS.asClassName(lo.s_),!0,(async()=>{const e=this.editor.getContribution(n.X);e?.closeExceptionWidget()})),{label:!1,icon:!0}),Kt.R3(e,i),this.exceptionInfo.description){const t=uo(".description");t.textContent=this.exceptionInfo.description,r+=", "+this.exceptionInfo.description,Kt.R3(e,t)}if(this.exceptionInfo.details&&this.exceptionInfo.details.stackTrace){const t=uo(".stack-trace"),i=this.instantiationService.createInstance(Tn).linkify(this.exceptionInfo.details.stackTrace,!0,this.debugSession?this.debugSession.root:void 0);t.appendChild(i),Kt.R3(e,t),r+=", "+this.exceptionInfo.details.stackTrace}e.setAttribute("aria-label",r)}_doLayout(e,t){this.container.style.height="initial";const i=this.editor.getOption(65),s=Math.round(i/3),n=Math.ceil((this.container.offsetHeight+s)/i);this._relayout(n)}focus(){this.container?.focus()}hasFocus(){return Kt.jg(document.activeElement,this.container)}};po=(0,o.g)([(0,o.f)(3,ti.XE),(0,o.f)(4,x.TG)],po);(0,ei.P6G)("editor.inlineValuesForeground",{dark:"#ffffff80",light:"#00000080",hcDark:"#ffffff80",hcLight:"#00000080"},w.NC("editor.inlineValuesForeground","Color for the debug inline value text.")),(0,ei.P6G)("editor.inlineValuesBackground",{dark:"#ffc80033",light:"#ffc80033",hcDark:"#ffc80033",hcLight:"#ffc80033"},w.NC("editor.inlineValuesBackground","Color for the debug inline value background."));class bo{constructor(e,t){this.column=e,this.text=t}}function mo(e,t,i=1073741824){return t.length>150&&(t=t.substring(0,150)+"..."),[{range:{startLineNumber:e,endLineNumber:e,startColumn:i,endColumn:i},options:{description:"debug-inline-value-decoration-spacer",after:{content:A.B4,cursorStops:Zt.RM.None},showIfCollapsed:!0}},{range:{startLineNumber:e,endLineNumber:e,startColumn:i,endColumn:i},options:{description:"debug-inline-value-decoration",after:{content:(s=t,s.replace(/[ \t]/g,A.B4)),inlineClassName:"debug-inline-value",inlineClassNameAffectsLetterSpacing:!0,cursorStops:Zt.RM.None},showIfCollapsed:!0}}];var s}let fo=class{constructor(e,t,i,s,o,r,a,c,d,l){this.editor=e,this.debugService=t,this.instantiationService=i,this.commandService=s,this.configurationService=o,this.hostService=r,this.uriIdentityService=a,this.languageFeaturesService=d,this.hoverPosition=null,this.mouseDown=!1,this.gutterIsHovered=!1,this.altPressed=!1,this.oldDecorations=this.editor.createDecorationsCollection(),this._wordToLineNumbersMap=void 0,this.debounceInfo=l.for(d.inlineValuesProvider,"InlineValues",{min:200}),this.hoverWidget=this.instantiationService.createInstance(no,this.editor),this.toDispose=[],this.registerListeners(),this.exceptionWidgetVisible=n.rh.bindTo(c),this.toggleExceptionWidget()}registerListeners(){this.toDispose.push(this.debugService.getViewModel().onDidFocusStackFrame((e=>this.onFocusStackFrame(e.stackFrame)))),this.toDispose.push(this.editor.onMouseDown((e=>this.onEditorMouseDown(e)))),this.toDispose.push(this.editor.onMouseUp((()=>this.mouseDown=!1))),this.toDispose.push(this.editor.onMouseMove((e=>this.onEditorMouseMove(e)))),this.toDispose.push(this.editor.onMouseLeave((e=>{const t=this.hoverWidget.getDomNode();if(!t)return;const i=t.getBoundingClientRect();(e.event.posx<i.left||e.event.posx>i.right||e.event.posy<i.top||e.event.posy>i.bottom)&&this.hideHoverWidget()}))),this.toDispose.push(this.editor.onKeyDown((e=>this.onKeyDown(e)))),this.toDispose.push(this.editor.onDidChangeModelContent((()=>{this._wordToLineNumbersMap=void 0,this.updateInlineValuesScheduler.schedule()}))),this.toDispose.push(this.debugService.getViewModel().onWillUpdateViews((()=>this.updateInlineValuesScheduler.schedule()))),this.toDispose.push(this.debugService.getViewModel().onDidEvaluateLazyExpression((()=>this.updateInlineValuesScheduler.schedule()))),this.toDispose.push(this.editor.onDidChangeModel((async()=>{this.updateHoverConfiguration(),this.toggleExceptionWidget(),this.hideHoverWidget(),this._wordToLineNumbersMap=void 0;const e=this.debugService.getViewModel().focusedStackFrame;await this.updateInlineValueDecorations(e)}))),this.toDispose.push(this.editor.onDidScrollChange((()=>{this.hideHoverWidget();const e=this.editor.getModel();e&&this.languageFeaturesService.inlineValuesProvider.has(e)&&this.updateInlineValuesScheduler.schedule()}))),this.toDispose.push(this.debugService.onDidChangeState((e=>{2!==e&&this.toggleExceptionWidget()})))}get wordToLineNumbersMap(){return this._wordToLineNumbersMap||(this._wordToLineNumbersMap=function(e){const t=new Map;if(!e)return t;for(let i=1,s=e.getLineCount();i<=s;++i){const s=e.getLineContent(i);if(s.length>500)continue;e.tokenization.forceTokenization(i);const n=e.tokenization.getLineTokens(i);for(let e=0,o=n.getCount();e<o;e++)if(0===n.getStandardTokenType(e)){vn.Af.lastIndex=0;const o=n.getStartOffset(e),r=n.getEndOffset(e),a=s.substring(o,r),c=vn.Af.exec(a);if(c){const e=c[0];t.has(e)||t.set(e,[]),t.get(e).push(i)}}}return t}(this.editor.getModel())),this._wordToLineNumbersMap}updateHoverConfiguration(){const e=this.debugService.getViewModel().focusedStackFrame,t=this.editor.getModel();t&&this.applyHoverConfiguration(t,e)}applyHoverConfiguration(e,t){t&&this.uriIdentityService.extUri.isEqual(e.uri,t.source.uri)?(this.altListener&&this.altListener.dispose(),this.altListener=(0,Kt.nm)(document,"keydown",(e=>{if(6===new os.y1(e).keyCode){this.altPressed=!0;const e=this.hoverWidget.isVisible();this.hoverWidget.hide(),this.enableEditorHover(),e&&this.hoverPosition&&this.showEditorHover(this.hoverPosition,!1);const t=new pn.Y(document,"keyup"),i=g.ju.any(this.hostService.onDidChangeFocus,t.event)((e=>{let s;e instanceof KeyboardEvent&&(s=new os.y1(e)),s&&6!==s.keyCode||(this.altPressed=!1,this.editor.updateOptions({hover:{enabled:!1}}),i.dispose(),t.dispose())}))}})),this.editor.updateOptions({hover:{enabled:!1}})):(this.altListener?.dispose(),this.enableEditorHover())}enableEditorHover(){if(this.editor.hasModel()){const e=this.editor.getModel(),t={resource:e.uri,overrideIdentifier:e.getLanguageId()},i=this.configurationService.getValue("editor.hover",t);this.editor.updateOptions({hover:{enabled:i.enabled,delay:i.delay,sticky:i.sticky}})}}async showHover(e,t){const i=this.debugService.getViewModel().focusedStackFrame,s=this.editor.getModel();i&&s&&this.uriIdentityService.extUri.isEqual(i.source.uri,s.uri)?1===await this.hoverWidget.showAt(e,t)&&this.showEditorHover(e,t):this.showEditorHover(e,t)}showEditorHover(e,t){const i=this.editor.getContribution(Sn.E.ID),s=new Xt.e(e.lineNumber,e.column,e.lineNumber,e.column);i?.showContentHover(s,1,0,t)}async onFocusStackFrame(e){const t=this.editor.getModel();t&&(this.applyHoverConfiguration(t,e),e&&this.uriIdentityService.extUri.isEqual(e.source.uri,t.uri)?await this.toggleExceptionWidget():this.hideHoverWidget()),await this.updateInlineValueDecorations(e)}get showHoverScheduler(){const e=this.editor.getOption(59),t=new d.pY((()=>{this.hoverPosition&&!this.altPressed&&this.showHover(this.hoverPosition,!1)}),2*e.delay);return this.toDispose.push(t),t}get hideHoverScheduler(){const e=new d.pY((()=>{this.hoverWidget.isHovered()||this.hoverWidget.hide()}),0);return this.toDispose.push(e),e}hideHoverWidget(){!this.hideHoverScheduler.isScheduled()&&this.hoverWidget.willBeVisible()&&this.hideHoverScheduler.schedule(),this.showHoverScheduler.cancel()}onEditorMouseDown(e){this.mouseDown=!0,9===e.target.type&&e.target.detail===no.ID||this.hideHoverWidget()}onEditorMouseMove(e){if(2!==this.debugService.state)return;const t=e.target,i=Ve.dz?"metaKey":"ctrlKey";this.altPressed||(2===t.type?(this.editor.updateOptions({hover:{enabled:!0}}),this.gutterIsHovered=!0):this.gutterIsHovered&&(this.gutterIsHovered=!1,this.updateHoverConfiguration())),(9!==t.type||t.detail!==no.ID||e.event[i])&&(6===t.type?t.position&&!ri.L.equals(t.position,this.hoverPosition)&&(this.hoverPosition=t.position,this.hideHoverScheduler.cancel(),this.showHoverScheduler.schedule()):this.mouseDown||this.hideHoverWidget())}onKeyDown(e){const t=Ve.dz?57:5;e.keyCode!==t&&this.hideHoverWidget()}async toggleExceptionWidget(){const e=this.editor.getModel(),t=this.debugService.getViewModel().focusedStackFrame,i=t?t.thread.getCallStack():null;if(!e||!t||!i||0===i.length)return void this.closeExceptionWidget();const s=i.find((e=>!!(e&&e.source&&e.source.available&&"deemphasize"!==e.source.presentationHint)));if(!s||s!==t)return void this.closeExceptionWidget();const n=this.uriIdentityService.extUri.isEqual(s.source.uri,e.uri);if(this.exceptionWidget&&!n)this.closeExceptionWidget();else if(n){const e=await t.thread.exceptionInfo;e&&this.showExceptionWidget(e,this.debugService.getViewModel().focusedSession,s.range.startLineNumber,s.range.startColumn)}}showExceptionWidget(e,t,i,s){this.exceptionWidget&&this.exceptionWidget.dispose(),this.exceptionWidget=this.instantiationService.createInstance(po,this.editor,e,t),this.exceptionWidget.show({lineNumber:i,column:s},0),this.exceptionWidget.focus(),this.editor.revealRangeInCenter({startLineNumber:i,startColumn:s,endLineNumber:i,endColumn:s}),this.exceptionWidgetVisible.set(!0)}closeExceptionWidget(){if(this.exceptionWidget){const e=this.exceptionWidget.hasFocus();this.exceptionWidget.dispose(),this.exceptionWidget=void 0,this.exceptionWidgetVisible.set(!1),e&&this.editor.focus()}}async addLaunchConfiguration(){const e=this.editor.getModel();if(!e)return;let t,i;const s=()=>{let s=0;(0,he.Vn)(e.getValue(),{onObjectProperty:e=>{i=e},onArrayBegin:n=>{"configurations"===i&&0===s&&(t=e.getPositionAt(n+1)),s++},onArrayEnd:()=>{s--}})};if(s(),!t){const{tabSize:t,insertSpaces:i}=e.getOptions(),n=e.getEOL(),o="launch.json"===(0,zi.EZ)(e.uri.fsPath)?(0,bn.Hn)(e.getValue(),["configurations"],[],{tabSize:t,insertSpaces:i,eol:n})[0]:(0,bn.Hn)(e.getValue(),["launch"],{configurations:[]},{tabSize:t,insertSpaces:i,eol:n})[0],r=e.getPositionAt(o.offset),a=r.lineNumber,c=new Xt.e(a,r.column,a,e.getLineMaxColumn(a));e.pushEditOperations(null,[fn.h.replace(c,o.content)],(()=>null)),s()}t&&(this.editor.focus(),await(t=>(e.getLineLastNonWhitespaceColumn(t.lineNumber)>t.column&&(this.editor.setPosition(t),mn.wk.LineBreakInsert.runEditorCommand(null,this.editor,null)),this.editor.setPosition(t),this.commandService.executeCommand("editor.action.insertLineAfter")))(t),await this.commandService.executeCommand("editor.action.triggerSuggest"))}get removeInlineValuesScheduler(){return new d.pY((()=>{this.oldDecorations.clear()}),100)}get updateInlineValuesScheduler(){const e=this.editor.getModel();return new d.pY((async()=>await this.updateInlineValueDecorations(this.debugService.getViewModel().focusedStackFrame)),e?this.debounceInfo.get(e):200)}async updateInlineValueDecorations(e){const t="{0} = {1}",i=this.editor.getModel(),s=this.configurationService.getValue("debug").inlineValues;if(!(!0===s||"on"===s||"auto"===s&&i&&this.languageFeaturesService.inlineValuesProvider.has(i))||!i||!e||i.uri.toString()!==e.source.uri.toString())return void(this.removeInlineValuesScheduler.isScheduled()||this.removeInlineValuesScheduler.schedule());let n;if(this.removeInlineValuesScheduler.cancel(),this.languageFeaturesService.inlineValuesProvider.has(i)){const s=async(t,i)=>{const s=await e.getMostSpecificScopes(e.range),n=i?t:t.toLowerCase();for(const e of s){const t=(await e.getChildren()).find((e=>i?e.name===n:e.name.toLowerCase()===n));if(t)return t.value}},o={frameId:e.frameId,stoppedLocation:new Xt.e(e.range.startLineNumber,e.range.startColumn+1,e.range.endLineNumber,e.range.endColumn+1)},r=(new l.A).token,a=this.editor.getVisibleRangesPlusViewportAboveBelow(),d=this.languageFeaturesService.inlineValuesProvider.ordered(i).reverse();n=[];const u=new Map,g=(0,c.xH)(d.map((n=>a.map((a=>Promise.resolve(n.provideInlineValues(i,a,o,r)).then((async n=>{if(n)for(const o of n){let n;switch(o.type){case"text":n=o.text;break;case"variable":{let e=o.variableName;e||(e=i.getLineContent(o.range.startLineNumber).substring(o.range.startColumn-1,o.range.endColumn-1));const r=await s(e,o.caseSensitiveLookup);r&&(n=A.WU(t,e,r));break}case"expression":{let s=o.expression;if(s||(s=i.getLineContent(o.range.startLineNumber).substring(o.range.startColumn-1,o.range.endColumn-1)),s){const i=new Ue.A2(s);await i.evaluate(e.thread.session,e,"watch",!0),i.available&&(n=A.WU(t,s,i.value))}break}}if(n){const e=o.range.startLineNumber;let t=u.get(e);t||(t=[],u.set(e,t)),t.some((e=>e.text===n))||t.push(new bo(o.range.startColumn,n))}}}),(e=>{(0,h.Cp)(e)}))))))),p=Date.now();await Promise.all(g),this.updateInlineValuesScheduler.delay=this.debounceInfo.update(i,Date.now()-p),u.forEach(((e,t)=>{if(e.length>0){const i=(e=e.sort(((e,t)=>e.column-t.column))).map((e=>e.text)).join(", ");n.push(...mo(t,i))}}))}else{const t=await e.getMostSpecificScopes(e.range),s=await Promise.all(t.map((async t=>{const s=await t.getChildren();let n=new Xt.e(0,0,e.range.startLineNumber,e.range.startColumn);return t.range&&(n=n.setStartPosition(t.range.startLineNumber,t.range.startColumn)),function(e,t,i,s){const n=new Map;for(const t of e)if(n.set(t.name,t.value),n.size>=100)break;const o=new Map;n.forEach(((e,i)=>{const n=s.get(i);if(n)for(const e of n)t.containsPosition(new ri.L(e,0))&&(o.has(e)||o.set(e,[]),-1===o.get(e).indexOf(i)&&o.get(e).push(i))}));const r=[];return o.forEach(((e,t)=>{const s=e.sort(((e,s)=>{const n=i.getLineContent(t);return n.indexOf(e)-n.indexOf(s)})).map((e=>`${e} = ${n.get(e)}`)).join(", ");r.push(...mo(t,s))})),r}(s,n,i,this.wordToLineNumbersMap)})));n=(0,c.EB)(s.reduce(((e,t)=>e.concat(t)),[]),(e=>`${e.range.startLineNumber}:${e?.options.after?.content}`))}this.oldDecorations.set(n)}dispose(){this.hoverWidget&&this.hoverWidget.dispose(),this.configurationWidget&&this.configurationWidget.dispose(),this.toDispose=(0,p.B9)(this.toDispose),this.oldDecorations.clear()}};fo.__decorator=(0,o.g)([Qt.HP],fo.prototype,"showHoverScheduler",null),fo.__decorator=(0,o.g)([Qt.HP],fo.prototype,"hideHoverScheduler",null),fo.__decorator=(0,o.g)([Qt.HP],fo.prototype,"removeInlineValuesScheduler",null),fo.__decorator=(0,o.g)([Qt.HP],fo.prototype,"updateInlineValuesScheduler",null),fo=(0,o.g)([(0,o.f)(1,n.tn),(0,o.f)(2,x.TG),(0,o.f)(3,S.H),(0,o.f)(4,C.Ui),(0,o.f)(5,et.$),(0,o.f)(6,N.v),(0,o.f)(7,k.i6),(0,o.f)(8,Tt.p),(0,o.f)(9,wn.A)],fo);let vo=class{constructor(e,t,i){let s;this.toDispose=[];const o=o=>{s&&(s.dispose(),s=void 0),o&&(s=o.onDidProgressStart((async s=>{const r=new Promise((e=>{const t=g.ju.any(g.ju.filter(o.onDidProgressEnd,(e=>e.body.progressId===s.body.progressId)),o.onDidEndAdapter)((()=>{t.dispose(),e()}))}));i.isViewContainerVisible(n.f3)&&t.withProgress({location:n.f3},(()=>r));const a=e.getAdapterManager().getDebuggerLabel(o.configuration.type);t.withProgress({location:15,title:s.body.title,cancellable:s.body.cancellable,priority:I.RX.SILENT,source:a,delay:500},(e=>{let t=0;const i=i=>{let s;"number"==typeof i.percentage&&(s=i.percentage-t,t+=s),e.report({message:i.message,increment:s,total:"number"==typeof s?100:void 0})};s.body.message&&i(s.body);const n=o.onDidProgressUpdate((e=>{e.body.progressId===s.body.progressId&&i(e.body)}));return r.then((()=>n.dispose()))}),(()=>o.cancel(s.body.progressId)))})))};this.toDispose.push(e.getViewModel().onDidFocusSession(o)),o(e.getViewModel().focusedSession),this.toDispose.push(e.onWillNewSession((e=>{s||o(e)})))}dispose(){(0,p.B9)(this.toDispose)}};vo=(0,o.g)([(0,o.f)(0,n.tn),(0,o.f)(1,_n.R9),(0,o.f)(2,_.qC)],vo);let wo=class extends Gs.${constructor(e,t,i,s){super(ue.uT,{noResultsPick:{label:(0,w.NC)("noDebugResults","No matching launch configurations")}}),this.debugService=e,this.contextService=t,this.commandService=i,this.notificationService=s}async _getPicks(e){const t=[];if(!this.debugService.getAdapterManager().hasEnabledDebuggers())return[];t.push({type:"separator",label:"launch.json"});const i=this.debugService.getConfigurationManager();let s;for(const n of i.getAllConfigurations()){const o=(0,qi.Oh)(e,n.name,!0);o&&(s!==n.presentation?.group&&(t.push({type:"separator"}),s=n.presentation?.group),t.push({label:n.name,description:3===this.contextService.getWorkbenchState()?n.launch.name:"",highlights:{label:o},buttons:[{iconClass:be.kS.asClassName(me.us),tooltip:(0,w.NC)("customizeLaunchConfig","Configure Launch Configuration")}],trigger:()=>(n.launch.openConfigFile({preserveFocus:!1}),Gs.L.CLOSE_PICKER),accept:async()=>{await i.selectConfiguration(n.launch,n.name);try{await this.debugService.startDebugging(n.launch,void 0,{startedByUser:!0})}catch(e){this.notificationService.error(e)}}}))}const n=await i.getDynamicProviders();n.length>0&&t.push({type:"separator",label:(0,w.NC)({key:"contributed",comment:["contributed is lower case because it looks better like that in UI. Nothing preceeds it. It is a name of the grouping of debug configurations."]},"contributed")}),i.getRecentDynamicConfigurations().forEach((({name:s,type:n})=>{const o=(0,qi.Oh)(e,s,!0);o&&t.push({label:s,highlights:{label:o},buttons:[{iconClass:be.kS.asClassName(me.Lh),tooltip:(0,w.NC)("removeLaunchConfig","Remove Launch Configuration")}],trigger:()=>(i.removeRecentDynamicConfigurations(s,n),Gs.L.CLOSE_PICKER),accept:async()=>{await i.selectConfiguration(void 0,s,void 0,{type:n});try{const{launch:e,getConfig:t}=i.selectedConfiguration,s=await t();await this.debugService.startDebugging(e,s,{startedByUser:!0})}catch(e){this.notificationService.error(e)}}})})),n.forEach((e=>{t.push({label:`$(folder) ${e.label}...`,ariaLabel:(0,w.NC)({key:"providerAriaLabel",comment:['Placeholder stands for the provider label. For example "NodeJS".']},"{0} contributed configurations",e.label),accept:async()=>{const t=await e.pick();t&&(await i.selectConfiguration(t.launch,t.config.name,t.config,{type:e.type}),this.debugService.startDebugging(t.launch,t.config,{startedByUser:!0}))}})}));const o=i.getLaunches().filter((e=>!e.hidden));o.length>0&&t.push({type:"separator",label:(0,w.NC)("configure","configure")});for(const i of o){const s=3===this.contextService.getWorkbenchState()?(0,w.NC)("addConfigTo","Add Config ({0})...",i.name):(0,w.NC)("addConfiguration","Add Configuration...");t.push({label:s,description:3===this.contextService.getWorkbenchState()?i.name:"",highlights:{label:(0,V.f6)((0,qi.Oh)(e,s,!0))},accept:()=>this.commandService.executeCommand(ue.Ee,i.uri.toString())})}return t}};wo=(0,o.g)([(0,o.f)(0,n.tn),(0,o.f)(1,T.ec),(0,o.f)(2,S.H),(0,o.f)(3,I.lT)],wo),(0,Vt.Z)('.debug-pane,.debug-view-content{height:100%}.monaco-workbench .debug-action.notification:after{background-color:#c63;border:1px solid #fff;border-radius:10px;content:"";height:6px;position:absolute;right:6px;top:10px;width:6px}.monaco-workbench .part>.title>.title-actions .start-debug-action-item{align-items:center;display:flex;flex-shrink:1;line-height:20px}.monaco-workbench.mac .part>.title>.title-actions .start-debug-action-item{border-radius:4px}.monaco-workbench .part>.title>.title-actions .start-debug-action-item .codicon{flex-shrink:0;line-height:inherit}.monaco-workbench .part>.title>.title-actions .start-debug-action-item .codicon-debug-start{height:21px;padding-left:2px;width:18px}.monaco-workbench .monaco-action-bar .start-debug-action-item .configuration .monaco-select-box{border:none;cursor:pointer;line-height:inherit;margin-top:0;min-width:90px;padding-bottom:0;padding-top:0}.monaco-workbench.safari .monaco-action-bar .start-debug-action-item .configuration .monaco-select-box{margin-bottom:0}.monaco-workbench .monaco-action-bar .start-debug-action-item .configuration.disabled .monaco-select-box{cursor:auto;font-style:italic;opacity:.7}.debug-pane .line-number{padding-left:4px;padding-right:4px}.debug-pane .disabled{cursor:auto;opacity:.65}.debug-pane .monaco-list:focus .monaco-list-row.selected .load-all,.debug-pane .monaco-list:focus .monaco-list-row.selected .state.label,.debug-pane .monaco-list:focus .monaco-list-row.selected.focused .state.label{color:inherit}.debug-pane .call-stack-state-message{flex:1;margin:0 10px;overflow:hidden;text-align:right;text-overflow:ellipsis;white-space:nowrap}.debug-pane .call-stack-state-message>.label{border-radius:3px;font-size:9px;padding:1px 2px}.debug-pane .debug-call-stack .session,.debug-pane .debug-call-stack .thread{align-items:center;display:flex}.debug-pane .debug-call-stack .session>.name,.debug-pane .debug-call-stack .thread>.name{flex:1;overflow:hidden;text-overflow:ellipsis}.debug-pane .debug-call-stack .session>.state.label,.debug-pane .debug-call-stack .thread>.state.label{align-self:center;font-size:.8em;margin:0 10px;overflow:hidden;text-overflow:ellipsis;text-transform:uppercase}.debug-pane .debug-call-stack .monaco-list-row:hover .stack-frame.has-actions .file .line-number,.debug-pane .debug-call-stack .monaco-list-row:hover .state.label{display:none}.debug-pane .monaco-list-row .monaco-action-bar{display:none;flex-shrink:0;margin-right:6px}.debug-pane .monaco-list-row.focused .monaco-action-bar,.debug-pane .monaco-list-row:hover .monaco-action-bar{display:initial}.debug-pane .monaco-list-row .monaco-action-bar .action-label{padding:2px}.debug-pane .session .codicon{line-height:22px;margin-right:2px}.debug-pane .debug-call-stack .stack-frame{display:flex;overflow:hidden;padding-right:.8em;text-overflow:ellipsis}.debug-pane .debug-call-stack .stack-frame.label{font-style:italic;text-align:center}.debug-pane .debug-call-stack .stack-frame .label{flex:1;flex-shrink:0;min-width:fit-content}.debug-pane .debug-call-stack .stack-frame.subtle{font-style:italic}.debug-pane .debug-call-stack .stack-frame.label>.file{display:none}.debug-pane .debug-call-stack .stack-frame>.file{display:flex;flex-wrap:wrap;justify-content:flex-end;overflow:hidden}.debug-pane .debug-call-stack .stack-frame>.file>.line-number.unavailable{display:none}.debug-pane .debug-call-stack .stack-frame>.file>.file-name{margin-right:.8em;overflow:hidden;text-overflow:ellipsis}.debug-pane .debug-call-stack .stack-frame>.file:not(:first-child){margin-left:.8em}.debug-pane .debug-call-stack .load-all{text-align:center}.debug-pane .debug-call-stack .show-more{opacity:.5;text-align:center}.debug-pane .debug-call-stack .error{font-style:italic;overflow:hidden;text-overflow:ellipsis}.debug-pane .scope{font-size:11px;font-weight:700}.debug-pane .monaco-list-row .expression .actionbar-spacer{flex-grow:1}.debug-pane .monaco-list-row .expression .value{overflow:hidden;text-overflow:ellipsis;white-space:pre}.debug-pane .monaco-list-row .expression .value.changed{border-radius:4px}.debug-pane .monaco-inputbox{line-height:normal;width:100%}.debug-pane .inputBoxContainer{box-sizing:border-box;flex-grow:1}.debug-pane .debug-watch .monaco-inputbox{font-family:var(--monaco-monospace-font)}.debug-pane .monaco-inputbox>.ibwrapper{height:19px}.debug-pane .monaco-inputbox>.ibwrapper>.input{color:initial;padding:0}.debug-pane .watch-expression{display:flex}.debug-pane .watch-expression .expression{flex:1}.debug-pane .debug-variables .scope .error{font-family:var(--monaco-monospace-font);font-style:italic;font-weight:400;overflow:hidden;text-overflow:ellipsis}.debug-pane .monaco-list-row{line-height:22px}.debug-pane .debug-breakpoints .monaco-list-row .breakpoint{padding-left:2px}.debug-pane .debug-breakpoints .breakpoint.exception{padding-left:21px}.debug-pane .debug-breakpoints .breakpoint{align-items:center;display:flex;flex:1;padding-right:.8em}.debug-pane .debug-breakpoints .breakpoint input{flex-shrink:0}.debug-pane .debug-breakpoints .breakpoint>.codicon{align-items:center;display:flex;height:19px;justify-content:center;min-width:19px;width:19px}.debug-pane .debug-breakpoints .breakpoint>.access-type,.debug-pane .debug-breakpoints .breakpoint>.condition,.debug-pane .debug-breakpoints .breakpoint>.file-path{flex:1;margin-left:.9em;opacity:.7;overflow:hidden;text-overflow:ellipsis}.debug-pane .debug-breakpoints .breakpoint .name{overflow:hidden;text-overflow:ellipsis}.debug-pane .pane-header .breakpoint-warning{margin-left:3px}.debug-pane .pane-header .breakpoint-warning .monaco-icon-label .codicon{align-items:center;display:flex}',{});const So="debugStartLanguage",Co=new k.uy(So,void 0),ko=new k.uy("debuggerInterestedInActiveEditor",!1);let yo=class extends Gi.qV{static{this.ID="workbench.debug.welcome"}static{this.LABEL=(0,w.NC)("run","Run")}constructor(e,t,i,s,n,o,r,a,c,d,l,u,h){super(e,i,s,n,o,d,c,l,t,h),this.debugService=r,this.editorService=a,this.debugStartLanguageContext=Co.bindTo(o),this.debuggerInterestedContext=ko.bindTo(o);const g=u.get(So,1);this.debugStartLanguageContext.set(g);const b=()=>{const e=this.editorService.activeTextEditorControl;if((0,v.CL)(e)){const t=e.getModel(),i=t?t.getLanguageId():void 0;if(i&&this.debugService.getAdapterManager().someDebuggerInterestedInLanguage(i))return this.debugStartLanguageContext.set(i),this.debuggerInterestedContext.set(!0),void u.store(So,i,1,1)}this.debuggerInterestedContext.set(!1)},m=new p.SL;this._register(m),this._register(a.onDidActiveEditorChange((()=>{m.clear();const e=this.editorService.activeTextEditorControl;(0,v.CL)(e)&&m.add(e.onDidChangeModelLanguage(b)),b()}))),this._register(this.debugService.getAdapterManager().onDidRegisterDebugger(b)),this._register(this.onDidChangeBodyVisibility((e=>{e&&b()}))),b();const f=this.keybindingService.lookupKeybinding(ue.bj);xo=f?` (${f.getLabel()})`:""}shouldShowWelcome(){return!0}};yo=(0,o.g)([(0,o.f)(1,ti.XE),(0,o.f)(2,fi.d),(0,o.f)(3,Yt.i),(0,o.f)(4,C.Ui),(0,o.f)(5,k.i6),(0,o.f)(6,n.tn),(0,o.f)(7,oe.AR),(0,o.f)(8,x.TG),(0,o.f)(9,_.XH),(0,o.f)(10,He.v4),(0,o.f)(11,pe.Uy),(0,o.f)(12,We.bU)],yo);const Do=R.B.as(_.IP.ViewsRegistry);let xo="";Do.registerViewWelcomeContent(yo.ID,{content:`[${(0,w.NC)("runAndDebugAction","Run and Debug")}${xo}](command:${ue.bj})`,when:n.Qe,group:_.Uw.Debug,order:1}),Do.registerViewWelcomeContent(yo.ID,{content:`[${(0,w.NC)("detectThenRunAndDebug","Show all automatic debug configurations")}](command:${ue.w8}).`,when:n.Qe,group:_.Uw.Debug,order:10});let Io=class extends Ut.XV{constructor(e,t,i,s,o,r,a,c,d,l,u,h,g,b){super(n.f3,{mergeViewWithContainerWhenSingleView:!0},o,u,e,d,t,l,c,a,r,b),this.progressService=i,this.debugService=s,this.contextViewService=h,this.contextKeyService=g,this.paneListeners=new Map,this.stopActionViewItemDisposables=this._register(new p.SL),this._register(this.debugService.onDidChangeState((e=>this.onDebugServiceStateChange(e)))),this._register(this.contextKeyService.onDidChangeContext((e=>{e.affectsSome(new Set([n.sd]))&&this.updateTitleArea()}))),this._register(this.contextService.onDidChangeWorkbenchState((()=>this.updateTitleArea()))),this._register(this.configurationService.onDidChangeConfiguration((e=>{e.affectsConfiguration("debug.toolBarLocation")&&this.updateTitleArea()})))}create(e){super.create(e),e.classList.add("debug-viewlet")}focus(){super.focus(),this.startDebugActionViewItem?this.startDebugActionViewItem.focus():this.focusView(yo.ID)}getActionViewItem(e){if(e.id===ue.bj)return this.startDebugActionViewItem=this.instantiationService.createInstance(cs,null,e),this.startDebugActionViewItem;if(e.id===ue.or)return new ds(e,void 0,this.debugService,this.contextViewService,this.configurationService);if(e.id===ue.De||e.id===ue.Sb){this.stopActionViewItemDisposables.clear();const t=this.instantiationService.invokeFunction((t=>vs(e,this.stopActionViewItemDisposables,t)));if(t)return t}return(0,ji.Id)(this.instantiationService,e)}focusView(e){const t=this.getView(e);t&&t.focus()}onDebugServiceStateChange(e){this.progressResolve&&(this.progressResolve(),this.progressResolve=void 0),1===e&&this.progressService.withProgress({location:n.f3},(e=>new Promise((e=>this.progressResolve=e))))}addPanes(e){super.addPanes(e);for(const{pane:t}of e)t.id===n.Ww?(this.breakpointView=t,this.updateBreakpointsMaxSize()):this.paneListeners.set(t.id,t.onDidChange((()=>this.updateBreakpointsMaxSize())))}removePanes(e){super.removePanes(e);for(const t of e)(0,p.B9)(this.paneListeners.get(t.id)),this.paneListeners.delete(t.id)}updateBreakpointsMaxSize(){if(this.breakpointView){const e=this.panes.every((e=>!e.isExpanded()||e===this.breakpointView));this.breakpointView.maximumBodySize=e?Number.POSITIVE_INFINITY:this.breakpointView.minimumBodySize}}};Io=(0,o.g)([(0,o.f)(0,yt.ze),(0,o.f)(1,We.bU),(0,o.f)(2,_n.R9),(0,o.f)(3,n.tn),(0,o.f)(4,x.TG),(0,o.f)(5,T.ec),(0,o.f)(6,pe.Uy),(0,o.f)(7,ti.XE),(0,o.f)(8,Yt.i),(0,o.f)(9,re.QS),(0,o.f)(10,C.Ui),(0,o.f)(11,Yt.u),(0,o.f)(12,k.i6),(0,o.f)(13,_.XH)],Io),(0,Ot.r1)(class extends Ot.Ke{constructor(){super({id:"debug.toggleReplIgnoreFocus",title:w.NC("debugPanel","Debug Console"),toggled:k.Ao.has(`view.${n.FT}.visible`),menu:[{id:Ut.jc,group:"3_toggleRepl",order:30,when:k.Ao.and(k.Ao.equals("viewContainer",n.f3))}]})}async run(e){const t=e.get(_.qC);t.isViewVisible(n.FT)?t.closeView(n.FT):await t.openView(n.FT)}});var Eo=i(27374),No=i(23627),To=i(50072),Lo=i(88216),_o=i(52136);const Ao={allowBreakpoint:!1,isBreakpointSet:!1,isBreakpointEnabled:!1,instruction:{address:"-1",instruction:(0,w.NC)("instructionNotAvailable","Disassembly not available.")},instructionAddress:BigInt(-1)};let Mo=class e extends No.J{static{this.NUM_INSTRUCTIONS_TO_LOAD=50}constructor(e,t,i,s,o,r){super(n.xG,e,t,i),this._configurationService=s,this._instantiationService=o,this._debugService=r,this._instructionBpList=[],this._enableSourceCodeRender=!0,this._loadingLock=!1,this._disassembledInstructions=void 0,this._onDidChangeStackFrame=new g.Q5,this._previousDebuggingState=r.state,this._fontInfo=Eo.E4.createFromRawSettings(s.getValue("editor"),zt.Tz.value),this._register(s.onDidChangeConfiguration((e=>{if(e.affectsConfiguration("editor")&&(this._fontInfo=Eo.E4.createFromRawSettings(s.getValue("editor"),zt.Tz.value)),e.affectsConfiguration("debug")){const e=this._configurationService.getValue("debug").disassemblyView.showSourceCode;this._enableSourceCodeRender!==e?(this._enableSourceCodeRender=e,this.reloadDisassembly(void 0)):this._disassembledInstructions?.rerender()}})))}get fontInfo(){return this._fontInfo}get currentInstructionAddresses(){return this._debugService.getModel().getSessions(!1).map((e=>e.getAllThreads())).reduce(((e,t)=>e.concat(t)),[]).map((e=>e.getTopStackFrame())).map((e=>e?.instructionPointerReference))}get focusedCurrentInstructionAddress(){return this._debugService.getViewModel().focusedStackFrame?.thread.getTopStackFrame()?.instructionPointerReference}get focusedInstructionAddress(){return this._debugService.getViewModel().focusedStackFrame?.instructionPointerReference}get isSourceCodeRender(){return this._enableSourceCodeRender}get debugSession(){return this._debugService.getViewModel().focusedSession}get onDidChangeStackFrame(){return this._onDidChangeStackFrame.event}createEditor(t){this._enableSourceCodeRender=this._configurationService.getValue("debug").disassemblyView.showSourceCode;const i=this.fontInfo.lineHeight,s=this,n=new class{constructor(){this.headerRowHeight=0}getHeight(e){return s.isSourceCodeRender&&e.instruction.location?.path&&e.instruction.line?e.instruction.endLine?i*(e.instruction.endLine-e.instruction.line+2):2*i:i}},o=this._register(this._instantiationService.createInstance(Ro,this));this._disassembledInstructions=this._register(this._instantiationService.createInstance(Ki.On,"DisassemblyView",t,n,[{label:"",tooltip:"",weight:0,minimumWidth:this.fontInfo.lineHeight,maximumWidth:this.fontInfo.lineHeight,templateId:Bo.TEMPLATE_ID,project:e=>e},{label:(0,w.NC)("disassemblyTableColumnLabel","instructions"),tooltip:"",weight:.3,templateId:Ro.TEMPLATE_ID,project:e=>e}],[this._instantiationService.createInstance(Bo,this),o],{identityProvider:{getId:e=>e.instruction.address},horizontalScrolling:!1,overrideStyles:{listBackground:ei.cvW},multipleSelectionSupport:!1,setRowLineHeight:!1,openOnSingleClick:!1,accessibilityProvider:new Fo,mouseSupport:!1})),this.reloadDisassembly(),this._register(this._disassembledInstructions.onDidScroll((t=>{if(!this._loadingLock)if(t.oldScrollTop>t.scrollTop&&t.scrollTop<t.height){this._loadingLock=!0;const i=Math.floor(t.scrollTop/this.fontInfo.lineHeight)+e.NUM_INSTRUCTIONS_TO_LOAD;this.scrollUp_LoadDisassembledInstructions(e.NUM_INSTRUCTIONS_TO_LOAD).then((e=>{e&&this._disassembledInstructions.reveal(i,0),this._loadingLock=!1}))}else t.oldScrollTop<t.scrollTop&&t.scrollTop+t.height>t.scrollHeight-t.height&&(this._loadingLock=!0,this.scrollDown_LoadDisassembledInstructions(e.NUM_INSTRUCTIONS_TO_LOAD).then((()=>{this._loadingLock=!1})))}))),this._register(this._debugService.getViewModel().onDidFocusStackFrame((e=>{this._disassembledInstructions&&(this.goToAddress(),this._onDidChangeStackFrame.fire())}))),this._register(this._debugService.getModel().onDidChangeBreakpoints((e=>{if(e&&this._disassembledInstructions){let t=!1;e.added?.forEach((e=>{if(e instanceof Ue.k9){const i=this.getIndexFromAddress(e.instructionReference);i>=0&&(this._disassembledInstructions.row(i).isBreakpointSet=!0,this._disassembledInstructions.row(i).isBreakpointEnabled=e.enabled,t=!0)}})),e.removed?.forEach((e=>{if(e instanceof Ue.k9){const i=this.getIndexFromAddress(e.instructionReference);i>=0&&(this._disassembledInstructions.row(i).isBreakpointSet=!1,t=!0)}})),e.changed?.forEach((e=>{if(e instanceof Ue.k9){const i=this.getIndexFromAddress(e.instructionReference);i>=0&&this._disassembledInstructions.row(i).isBreakpointEnabled!==e.enabled&&(this._disassembledInstructions.row(i).isBreakpointEnabled=e.enabled,t=!0)}})),this._instructionBpList=this._debugService.getModel().getInstructionBreakpoints(),t&&this._onDidChangeStackFrame.fire()}}))),this._register(this._debugService.onDidChangeState((e=>{3!==e&&2!==e||3===this._previousDebuggingState||2===this._previousDebuggingState||(this._disassembledInstructions?.splice(0,this._disassembledInstructions.length,[Ao]),this._enableSourceCodeRender=this._configurationService.getValue("debug").disassemblyView.showSourceCode),this._previousDebuggingState=e})))}layout(e){this._disassembledInstructions?.layout(e.height)}goToAddress(e,t){if(!this._disassembledInstructions)return;if(e||(e=this.focusedInstructionAddress),!e)return;const i=this.getIndexFromAddress(e);i>=0?(this._disassembledInstructions.reveal(i),t&&(this._disassembledInstructions.domFocus(),this._disassembledInstructions.setFocus([i]))):2===this._debugService.state&&this.reloadDisassembly(e)}async scrollUp_LoadDisassembledInstructions(e){if(this._disassembledInstructions&&this._disassembledInstructions.length>0){const t=this._disassembledInstructions?.row(0).instruction.address;return this.loadDisassembledInstructions(t,-e,e)}return!1}async scrollDown_LoadDisassembledInstructions(e){if(this._disassembledInstructions&&this._disassembledInstructions.length>0){const t=this._disassembledInstructions?.row(this._disassembledInstructions?.length-1).instruction.address;return this.loadDisassembledInstructions(t,1,e)}return!1}async loadDisassembledInstructions(e,t,i){if(e&&"-1"!==e||(e=this.focusedInstructionAddress),!e)return!1;const s=this.debugSession,n=await(s?.disassemble(e,0,t,i));if(s&&n&&this._disassembledInstructions){const e=[];let i,s;for(let t=0;t<n.length;t++){const o=this._instructionBpList.find((e=>e.instructionReference===n[t].address)),r=n[t];if(r.location&&(i=r.location,s=void 0),r.line){const e={startLineNumber:r.line,startColumn:r.column??0,endLineNumber:r.endLine??r.line,endColumn:r.endColumn??0};Xt.e.equalsRange(e,s??null)||(s=e,r.location=i)}e.push({allowBreakpoint:!0,isBreakpointSet:void 0!==o,isBreakpointEnabled:!!o?.enabled,instruction:r})}const o=1===this._disassembledInstructions.length?1:0;return t>=0?this._disassembledInstructions.splice(this._disassembledInstructions.length,o,e):this._disassembledInstructions.splice(0,o,e),!0}return!1}getIndexFromAddress(e){const t=this._disassembledInstructions;if(t&&t.length>0){const i=BigInt(e);if(i)return(0,c.em)(t.length,(e=>{const s=t.row(e);return this.ensureAddressParsed(s),s.instructionAddress>i?1:s.instructionAddress<i?-1:0}))}return-1}ensureAddressParsed(e){void 0===e.instructionAddress&&(e.instructionAddress=BigInt(e.instruction.address))}reloadDisassembly(t){this._disassembledInstructions&&(this._loadingLock=!0,this._disassembledInstructions.splice(0,this._disassembledInstructions.length,[Ao]),this._instructionBpList=this._debugService.getModel().getInstructionBreakpoints(),this.loadDisassembledInstructions(t,4*-e.NUM_INSTRUCTIONS_TO_LOAD,8*e.NUM_INSTRUCTIONS_TO_LOAD).then((()=>{if(this._disassembledInstructions.length>0){const e=Math.floor(this._disassembledInstructions.length/2);this._disassembledInstructions.reveal(e,.5),this._disassembledInstructions.domFocus(),this._disassembledInstructions.setFocus([e])}this._loadingLock=!1})))}};Mo=(0,o.g)([(0,o.f)(0,We.bU),(0,o.f)(1,ti.XE),(0,o.f)(2,pe.Uy),(0,o.f)(3,C.Ui),(0,o.f)(4,x.TG),(0,o.f)(5,n.tn)],Mo);let Bo=class e{static{this.TEMPLATE_ID="breakpoint"}constructor(t,i){this._disassemblyView=t,this._debugService=i,this.templateId=e.TEMPLATE_ID,this._breakpointIcon="codicon-"+me.eq.regular.id,this._breakpointDisabledIcon="codicon-"+me.eq.disabled.id,this._breakpointHintIcon="codicon-"+me.os.id,this._debugStackframe="codicon-"+me.Qx.id,this._debugStackframeFocused="codicon-"+me.Ws.id}renderTemplate(e){e.style.alignSelf="flex-end";const t=(0,Kt.R3)(e,(0,Kt.$)(".disassembly-view"));t.classList.add("codicon"),t.style.display="flex",t.style.alignItems="center",t.style.justifyContent="center",t.style.height=this._disassemblyView.fontInfo.lineHeight+"px";const i={element:void 0},s=[this._disassemblyView.onDidChangeStackFrame((()=>this.rerenderDebugStackframe(t,i.element))),(0,Kt.mu)(e,"mouseover",(()=>{i.element?.allowBreakpoint&&t.classList.add(this._breakpointHintIcon)})),(0,Kt.mu)(e,"mouseout",(()=>{i.element?.allowBreakpoint&&t.classList.remove(this._breakpointHintIcon)})),(0,Kt.mu)(e,"click",(()=>{i.element?.allowBreakpoint&&(t.classList.add(this._breakpointHintIcon),i.element.isBreakpointSet?this._debugService.removeInstructionBreakpoints(i.element.instruction.address):i.element.allowBreakpoint&&!i.element.isBreakpointSet&&this._debugService.addInstructionBreakpoint(i.element.instruction.address,0))}))];return{currentElement:i,icon:t,disposables:s}}renderElement(e,t,i,s){i.currentElement.element=e,this.rerenderDebugStackframe(i.icon,e)}disposeTemplate(e){(0,p.B9)(e.disposables),e.disposables=[]}rerenderDebugStackframe(e,t){t?.instruction.address===this._disassemblyView.focusedCurrentInstructionAddress?e.classList.add(this._debugStackframe):t?.instruction.address===this._disassemblyView.focusedInstructionAddress?e.classList.add(this._debugStackframeFocused):(e.classList.remove(this._debugStackframe),e.classList.remove(this._debugStackframeFocused)),e.classList.remove(this._breakpointHintIcon),t?.isBreakpointSet?t.isBreakpointEnabled?(e.classList.add(this._breakpointIcon),e.classList.remove(this._breakpointDisabledIcon)):(e.classList.remove(this._breakpointIcon),e.classList.add(this._breakpointDisabledIcon)):(e.classList.remove(this._breakpointIcon),e.classList.remove(this._breakpointDisabledIcon))}};Bo=(0,o.g)([(0,o.f)(1,n.tn)],Bo);let Ro=class e extends p.JT{static{this.TEMPLATE_ID="instruction"}static{this.INSTRUCTION_ADDR_MIN_LENGTH=25}static{this.INSTRUCTION_BYTES_MIN_LENGTH=30}constructor(t,i,s,n,o,r){super(),this._disassemblyView=t,this.editorService=s,this.textModelService=n,this.uriService=o,this.logService=r,this.templateId=e.TEMPLATE_ID,this._topStackFrameColor=i.getColorTheme().getColor(Bi),this._focusedStackFrameColor=i.getColorTheme().getColor(Ri),this._register(i.onDidColorThemeChange((e=>{this._topStackFrameColor=e.getColor(Bi),this._focusedStackFrameColor=e.getColor(Ri)})))}renderTemplate(e){const t=(0,Kt.R3)(e,(0,Kt.$)(".sourcecode")),i=(0,Kt.R3)(e,(0,Kt.$)(".instruction"));this.applyFontInfo(t),this.applyFontInfo(i);const s={element:void 0},n=[this._disassemblyView.onDidChangeStackFrame((()=>this.rerenderBackground(i,t,s.element))),(0,Kt.mu)(t,"dblclick",(()=>this.openSourceCode(s.element?.instruction)))];return{currentElement:s,instruction:i,sourcecode:t,cellDisposable:[],disposables:n}}renderElement(e,t,i,s){this.renderElementInner(e,t,i,s)}async renderElementInner(t,i,s,n){s.currentElement.element=t;const o=t.instruction;s.sourcecode.innerText="";const r=new To.HT(1e3);if(this._disassemblyView.isSourceCodeRender&&o.location?.path&&o.line){const e=this.getUriFromSource(o);if(e){let i;const n=new To.HT(1e4),r=await this.textModelService.createModelReference(e);if(i=r.object.textEditorModel,s.cellDisposable.push(r),i&&s.currentElement.element===t){let e=o.line;for(;e&&e>=1&&e<=i.getLineCount();){const t=i.getLineContent(e);if(n.appendString(`  ${e}: `),n.appendString(t+"\n"),!(o.endLine&&e<o.endLine))break;e++}s.sourcecode.innerText=n.build()}}}let a=10;if("-1"!==o.address){r.appendString(o.address),o.address.length<e.INSTRUCTION_ADDR_MIN_LENGTH&&(a=e.INSTRUCTION_ADDR_MIN_LENGTH-o.address.length);for(let e=0;e<a;e++)r.appendString(" ")}if(o.instructionBytes){r.appendString(o.instructionBytes),a=10,o.instructionBytes.length<e.INSTRUCTION_BYTES_MIN_LENGTH&&(a=e.INSTRUCTION_BYTES_MIN_LENGTH-o.instructionBytes.length);for(let e=0;e<a;e++)r.appendString(" ")}r.appendString(o.instruction),s.instruction.innerText=r.build(),this.rerenderBackground(s.instruction,s.sourcecode,t)}disposeElement(e,t,i,s){(0,p.B9)(i.cellDisposable),i.cellDisposable=[]}disposeTemplate(e){(0,p.B9)(e.disposables),e.disposables=[]}rerenderBackground(e,t,i){i&&this._disassemblyView.currentInstructionAddresses.includes(i.instruction.address)?e.style.background=this._topStackFrameColor?.toString()||"transparent":i?.instruction.address===this._disassemblyView.focusedInstructionAddress?e.style.background=this._focusedStackFrameColor?.toString()||"transparent":e.style.background="transparent"}openSourceCode(e){if(e){const t=this.getUriFromSource(e),i=e.endLine?{startLineNumber:e.line,endLineNumber:e.endLine,startColumn:e.column||1,endColumn:e.endColumn||1073741824}:{startLineNumber:e.line,endLineNumber:e.line,startColumn:e.column||1,endColumn:e.endColumn||1073741824};this.editorService.openEditor({resource:t,description:(0,w.NC)("editorOpenedFromDisassemblyDescription","from disassembly"),options:{preserveFocus:!1,selection:i,revealIfOpened:!0,selectionRevealType:1,pinned:!1}})}}getUriFromSource(e){const t=e.location.path;return t&&(0,$.p3)(t)?this.uriService.asCanonicalUri(W.ov.parse(t)):t&&(0,zi.YP)(t)?this.uriService.asCanonicalUri(W.ov.file(t)):(0,qe.UQ)(e.location,e.location.path,this._disassemblyView.debugSession.getId(),this.uriService,this.logService)}applyFontInfo(e){(0,_o.N)(e,this._disassemblyView.fontInfo),e.style.whiteSpace="pre"}};Ro=(0,o.g)([(0,o.f)(1,ti.XE),(0,o.f)(2,oe.AR),(0,o.f)(3,Lo.S),(0,o.f)(4,N.v),(0,o.f)(5,Pe.VZ)],Ro);class Fo{getWidgetAriaLabel(){return(0,w.NC)("disassemblyView","Disassembly View")}getAriaLabel(e){let t="";const i=e.instruction;return"-1"!==i.address&&(t+=`${(0,w.NC)("instructionAddress","Address")}: ${i.address}`),i.instructionBytes&&(t+=`, ${(0,w.NC)("instructionBytes","Bytes")}: ${i.instructionBytes}`),t+=`, ${(0,w.NC)("instructionText","Instruction")}: ${i.instruction}`,t}}let Vo=class{constructor(e,t,i){i.bufferChangeEvents((()=>{this._languageSupportsDisassemleRequest=n.gM.bindTo(i)}));const s=()=>{this._onDidChangeModelLanguage&&(this._onDidChangeModelLanguage.dispose(),this._onDidChangeModelLanguage=void 0);const i=e.activeTextEditorControl;if((0,v.CL)(i)){const e=i.getModel()?.getLanguageId();this._languageSupportsDisassemleRequest?.set(!!e&&t.getAdapterManager().someDebuggerInterestedInLanguage(e)),this._onDidChangeModelLanguage=i.onDidChangeModelLanguage((e=>{this._languageSupportsDisassemleRequest?.set(t.getAdapterManager().someDebuggerInterestedInLanguage(e.newLanguage))}))}else this._languageSupportsDisassemleRequest?.set(!1)};s(),this._onDidActiveEditorChangeListener=e.onDidActiveEditorChange(s)}dispose(){this._onDidActiveEditorChangeListener.dispose(),this._onDidChangeModelLanguage?.dispose()}};Vo=(0,o.g)([(0,o.f)(0,oe.AR),(0,o.f)(1,n.tn),(0,o.f)(2,k.i6)],Vo);var Po=i(66307),Oo=i(73536),Wo=i(85215);let Ho=class e{constructor(t,i,s,o,r){this.debugService=i,this.modelService=s,this.languageService=o,this.editorWorkerService=r,this.pendingUpdates=new Map,t.registerTextModelContentProvider(n.lR,this),e.INSTANCE=this}dispose(){this.pendingUpdates.forEach((e=>e.dispose()))}provideTextContent(e){return this.createOrUpdateContentModel(e,!0)}static refreshDebugContent(t){e.INSTANCE?.createOrUpdateContentModel(t,!1)}createOrUpdateContentModel(e,t){const i=this.modelService.getModel(e);if(!i&&!t)return null;let s;if(e.query){const t=qe.Hw.getEncodedDebugData(e);s=this.debugService.getModel().getSession(t.sessionId)}if(s||(s=this.debugService.getViewModel().focusedSession),!s)return Promise.reject(new h.QD((0,w.NC)("unable","Unable to resolve the resource without a debug session")));const n=t=>{this.debugService.sourceIsNotAvailable(e);const i=this.languageService.createById(bi.bd),s=t?(0,w.NC)("canNotResolveSourceWithError","Could not load source '{0}': {1}.",e.path,t):(0,w.NC)("canNotResolveSource","Could not load source '{0}'.",e.path);return this.modelService.createModel(s,i,e)};return s.loadSource(e).then((t=>{if(t&&t.body){if(i){const e=t.body.content,s=this.pendingUpdates.get(i.id);s?.cancel();const n=new l.A;return this.pendingUpdates.set(i.id,n),this.editorWorkerService.computeMoreMinimalEdits(i.uri,[{text:e,range:i.getFullModelRange()}]).then((e=>(this.pendingUpdates.delete(i.id),!n.token.isCancellationRequested&&e&&e.length>0&&i.applyEdits(e.map((e=>fn.h.replace(Xt.e.lift(e.range),e.text)))),i)))}{const i=t.body.mimeType||(0,Oo.hm)(e)[0],s=this.languageService.createByMimeType(i);return this.modelService.createModel(t.body.content,s,e)}}return n()}),(e=>n(e.message)))}};Ho=(0,o.g)([(0,o.f)(0,Lo.S),(0,o.f)(1,n.tn),(0,o.f)(2,di.q),(0,o.f)(3,M.O),(0,o.f)(4,Wo.p)],Ho);var $o=i(4490);const Uo=/^[a-zA-Z][a-zA-Z0-9\+\-\.]+:/;class qo{constructor(e,t,i=!1){this._parent=e,this._label=t,this.isIncompressible=i,this._children=new Map,this._showedMoreThanOne=!1}updateLabel(e){this._label=e}isLeaf(){return 0===this._children.size}getSession(){if(this._parent)return this._parent.getSession()}setSource(e,t){if(this._source=t,this._children.clear(),t.raw&&t.raw.sources)for(const i of t.raw.sources)if(i.name&&i.path){const t=new qo(this,i.name);this._children.set(i.path,t);const s=e.getSource(i);t.setSource(e,s)}}createIfNeeded(e,t){let i=this._children.get(e);return i||(i=t(this,e),this._children.set(e,i)),i}getChild(e){return this._children.get(e)}remove(e){this._children.delete(e)}removeFromParent(){this._parent&&(this._parent.remove(this._label),0===this._parent._children.size&&this._parent.removeFromParent())}getTemplateId(){return"id"}getId(){const e=this.getParent();return e?`${e.getId()}/${this.getInternalId()}`:this.getInternalId()}getInternalId(){return this._label}getParent(){if(this._parent)return this._parent.isSkipped()?this._parent.getParent():this._parent}isSkipped(){return!this._parent||!!this._parent.oneChild()}hasChildren(){const e=this.oneChild();return e?e.hasChildren():this._children.size>0}getChildren(){const e=this.oneChild();if(e)return e.getChildren();const t=[];for(const e of this._children.values())t.push(e);return t.sort(((e,t)=>this.compare(e,t)))}getLabel(e=!0){const t=this.oneChild();if(t){const i=this instanceof zo&&e?"  ":zi.KR.sep;return`${this._label}${i}${t.getLabel()}`}return this._label}getHoverLabel(){if(this._source&&this._parent&&this._parent._source)return this._source.raw.path||this._source.raw.name;const e=this.getLabel(!1),t=this.getParent();if(t){const i=t.getHoverLabel();if(i)return`${i}/${e}`}return e}getSource(){const e=this.oneChild();return e?e.getSource():this._source}compare(e,t){return e._label&&t._label?e._label.localeCompare(t._label):0}oneChild(){if(!this._source&&!this._showedMoreThanOne&&this.skipOneChild()){if(1===this._children.size)return this._children.values().next().value;this._children.size>1&&(this._showedMoreThanOne=!0)}}skipOneChild(){return this instanceof jo}}class zo extends qo{constructor(e,t){super(e,t.name,!0),this.folder=t}}class jo extends qo{constructor(e,t,i){super(void 0,"Root"),this._pathService=e,this._contextService=t,this._labelService=i}add(e){return this.createIfNeeded(e.getId(),(()=>new Ko(this._labelService,this,e,this._pathService,this._contextService)))}find(e){return this.getChild(e.getId())}}class Ko extends qo{static{this.URL_REGEXP=/^(https?:\/\/[^/]+)(\/.*)$/}constructor(e,t,i,s,n){super(t,i.getLabel(),!0),this._pathService=s,this.rootProvider=n,this._map=new Map,this._labelService=e,this._session=i}getInternalId(){return this._session.getId()}getSession(){return this._session}getHoverLabel(){}hasChildren(){return!0}compare(e,t){const i=this.category(e),s=this.category(t);return i!==s?i-s:super.compare(e,t)}category(e){if(e instanceof zo)return e.folder.index;const t=e.getLabel();return t&&/^<.+>$/.test(t)?1e3:999}async addPath(e){let t,i,s=e.raw.path;if(!s)return;this._labelService&&Uo.test(s)&&(s=this._labelService.getUriLabel(W.ov.parse(s)));const n=Ko.URL_REGEXP.exec(s);if(n&&3===n.length)i=n[1],s=decodeURI(n[2]);else if((0,zi.YP)(s)){const e=W.ov.file(s);t=this.rootProvider?this.rootProvider.getWorkspaceFolder(e):null,t?(s=(0,zi.Fv)((0,A.j3)(e.path.substring(t.uri.path.length),zi.KR.sep)),this.rootProvider.getWorkspace().folders.length>1?s=zi.KR.sep+s:t=null):(s=(0,zi.Fv)(s),s=Ve.ED?(0,Fe.DT)(s):(0,Fe.Cn)(s,(await this._pathService.userHome()).fsPath))}let o=this;s.split(/[\/\\]/).forEach(((e,s)=>{if(0===s&&t){const e=t;o=o.createIfNeeded(t.name,(t=>new zo(t,e)))}else o=0===s&&i?o.createIfNeeded(i,(e=>new qo(e,i))):o.createIfNeeded(e,(t=>new qo(t,e)))})),o.setSource(this._session,e),e.raw.path&&this._map.set(e.raw.path,o)}removePath(e){if(e.raw.path){const t=this._map.get(e.raw.path);if(t)return t.removeFromParent(),!0}return!1}}function Go(e,t){const i=e.getChildren(),s=t?!t.expanded.has(e.getId()):!(e instanceof Ko);return{element:e,collapsed:s,collapsible:e.hasChildren(),children:i.map((e=>Go(e,t)))}}let Qo=class extends Gi.qV{constructor(e,t,i,s,o,r,a,c,d,l,u,h,g,p,b){super(e,i,t,r,c,o,s,g,p,b),this.editorService=a,this.contextService=d,this.debugService=l,this.labelService=u,this.pathService=h,this.treeNeedsRefreshOnVisible=!1,this.loadedScriptsItemType=n.gd.bindTo(c)}renderBody(e){super.renderBody(e),this.element.classList.add("debug-pane"),e.classList.add("debug-loaded-scripts"),e.classList.add("show-file-icons"),this.treeContainer=es(e),this.filter=new Yo;const t=new jo(this.pathService,this.contextService,this.labelService);this.treeLabels=this.instantiationService.createInstance(Po.RX,{onDidChangeVisibility:this.onDidChangeBodyVisibility}),this._register(this.treeLabels),this.tree=this.instantiationService.createInstance(Ki.J6,"LoadedScriptsView",this.treeContainer,new Jo,[new Xo(this.treeLabels)],{compressionEnabled:!0,collapseByDefault:!0,hideTwistiesOfChildlessElements:!0,identityProvider:{getId:e=>e.getId()},keyboardNavigationLabelProvider:{getKeyboardNavigationLabel:e=>e.getLabel(),getCompressedNodeKeyboardNavigationLabel:e=>e.map((e=>e.getLabel())).join("/")},filter:this.filter,accessibilityProvider:new Zo,overrideStyles:{listBackground:this.getBackgroundColor()}});const i=e=>this.tree.setChildren(null,Go(t,e).children);i(),this.changeScheduler=new d.pY((()=>{this.treeNeedsRefreshOnVisible=!1,this.tree&&i()}),300),this._register(this.changeScheduler),this._register(this.tree.onDidOpen((e=>{if(e.element instanceof qo){const t=e.element.getSource();if(t&&t.available){const i={startLineNumber:0,startColumn:0,endLineNumber:0,endColumn:0};t.openInEditor(this.editorService,i,e.editorOptions.preserveFocus,e.sideBySide,e.editorOptions.pinned)}}}))),this._register(this.tree.onDidChangeFocus((()=>{this.tree.getFocus()instanceof Ko?this.loadedScriptsItemType.set("session"):this.loadedScriptsItemType.reset()})));const s=()=>{this.isBodyVisible()?this.changeScheduler.schedule():this.treeNeedsRefreshOnVisible=!0},n=e=>{this._register(e.onDidChangeName((async()=>{const i=t.find(e);i&&(i.updateLabel(e.getLabel()),s())}))),this._register(e.onDidLoadedSource((async i=>{let n;switch(i.reason){case"new":case"changed":n=t.add(e),await n.addPath(i.source),s(),"changed"===i.reason&&Ho.refreshDebugContent(i.source.uri);break;case"removed":n=t.find(e),n&&n.removePath(i.source)&&s();break;default:this.filter.setFilter(i.source.name),this.tree.refilter()}})))};let o;this._register(this.debugService.onDidNewSession(n)),this.debugService.getModel().getSessions().forEach(n),this._register(this.debugService.onDidEndSession((e=>{t.remove(e.getId()),this.changeScheduler.schedule()}))),this.changeScheduler.schedule(0),this._register(this.onDidChangeBodyVisibility((e=>{e&&this.treeNeedsRefreshOnVisible&&this.changeScheduler.schedule()}))),this._register(this.tree.onDidChangeFindPattern((e=>{if(this.tree.findMode!==$o.sZ.Highlight)if(!o&&e){const e=new Set,t=i=>{i.element&&!i.collapsed&&e.add(i.element.getId());for(const e of i.children)t(e)};t(this.tree.getNode()),o={expanded:e},this.tree.expandAll()}else!e&&o&&(this.tree.setFocus([]),i(o),o=void 0)}))),this.debugService.getModel().getSessions().forEach((e=>(async e=>{if(e.capabilities.supportsLoadedSourcesRequest){const i=t.add(e),n=await e.getLoadedSources();for(const e of n)await i.addPath(e);s()}})(e)))}layoutBody(e,t){super.layoutBody(e,t),this.tree.layout(e,t)}dispose(){(0,p.B9)(this.tree),(0,p.B9)(this.treeLabels),super.dispose()}};Qo=(0,o.g)([(0,o.f)(1,Yt.i),(0,o.f)(2,fi.d),(0,o.f)(3,x.TG),(0,o.f)(4,_.XH),(0,o.f)(5,C.Ui),(0,o.f)(6,oe.AR),(0,o.f)(7,k.i6),(0,o.f)(8,T.ec),(0,o.f)(9,n.tn),(0,o.f)(10,Lt.e),(0,o.f)(11,Bt.a),(0,o.f)(12,He.v4),(0,o.f)(13,ti.XE),(0,o.f)(14,We.bU)],Qo);class Jo{getHeight(e){return 22}getTemplateId(e){return Xo.ID}}class Xo{static{this.ID="lsrenderer"}constructor(e){this.labels=e}get templateId(){return Xo.ID}renderTemplate(e){return{label:this.labels.create(e,{supportHighlights:!0})}}renderElement(e,t,i){const s=e.element,n=s.getLabel();this.render(s,n,i,e.filterData)}renderCompressedElements(e,t,i,s){const n=e.element.elements[e.element.elements.length-1],o=e.element.elements.map((e=>e.getLabel()));this.render(n,o,i,e.filterData)}render(e,t,i,s){const n={name:t},o={title:e.getHoverLabel()};if(e instanceof zo)o.fileKind=D.RR.ROOT_FOLDER;else if(e instanceof Ko)o.title=w.NC("loadedScriptsSession","Debug Session"),o.hideIcon=!0;else if(e instanceof qo){const t=e.getSource();t&&t.uri?(n.resource=t.uri,o.fileKind=D.RR.FILE):o.fileKind=D.RR.FOLDER}o.matches=(0,qi.mB)(s),i.label.setResource(n,o)}disposeTemplate(e){e.label.dispose()}}class Zo{getWidgetAriaLabel(){return w.NC({comment:["Debug is a noun in this context, not a verb."],key:"loadedScriptsAriaLabel"},"Debug Loaded Scripts")}getAriaLabel(e){return e instanceof zo?w.NC("loadedScriptsRootFolderAriaLabel","Workspace folder {0}, loaded script, debug",e.getLabel()):e instanceof Ko?w.NC("loadedScriptsSessionAriaLabel","Session {0}, loaded script, debug",e.getLabel()):e.hasChildren()?w.NC("loadedScriptsFolderAriaLabel","Folder {0}, loaded script, debug",e.getLabel()):w.NC("loadedScriptsSourceAriaLabel","{0}, loaded script, debug",e.getLabel())}}class Yo{setFilter(e){this.filterText=e}filter(e,t){return this.filterText?e.isLeaf()?e.getLabel().indexOf(this.filterText)>=0?1:0:2:1}}var er=i(31185),tr=i(42376);(0,Vt.Z)(".monaco-workbench .repl{box-sizing:border-box;height:100%;overflow:hidden}.monaco-workbench .repl .repl-tree .monaco-tl-contents{user-select:text;-webkit-user-select:text;white-space:pre}.monaco-workbench .repl .repl-tree .monaco-tl-contents .expression{font-family:var(--vscode-repl-font-family);font-size:var(--vscode-repl-font-size);line-height:var(--vscode-repl-line-height)}.monaco-workbench .repl .repl-tree .monaco-tl-contents .expression .lazy-button{cursor:pointer}.monaco-workbench .repl .repl-tree .monaco-tl-twistie{background-position-y:calc(100% - var(--vscode-repl-font-size-for-twistie))}.monaco-workbench .repl .repl-tree.word-wrap .monaco-tl-contents{word-wrap:break-word;white-space:pre-wrap;word-break:break-all}.monaco-workbench .repl .repl-tree.word-wrap .monaco-tl-contents .expression.nested-variable{white-space:pre}.monaco-workbench .repl .repl-tree .monaco-tl-twistie,.monaco-workbench .repl .repl-tree .monaco-tl-twistie.collapsible+.monaco-tl-contents{cursor:pointer}.monaco-workbench .repl .repl-tree .output.expression.value-and-source{display:flex}.monaco-workbench .repl .repl-tree .output.expression.value-and-source .count-badge-wrapper,.monaco-workbench .repl .repl-tree .output.expression.value-and-source .value{margin-right:4px}.monaco-workbench .repl .repl-tree .output.expression.value-and-source .count-badge-wrapper .monaco-count-badge{min-height:16px;word-break:keep-all}.monaco-workbench .repl .repl-tree .monaco-tl-contents .arrow{left:2px;position:absolute}.monaco-workbench .repl .repl-tree .output.expression.value-and-source .source{cursor:pointer;direction:rtl;margin-left:auto;margin-right:8px;max-width:400px;overflow:hidden;text-align:right;text-decoration:underline;text-overflow:ellipsis;white-space:nowrap}.monaco-workbench .repl .repl-tree .evaluation-result.expression>.value,.monaco-workbench .repl .repl-tree .output.expression>.value{margin-left:0}.monaco-workbench .repl .repl-tree .output.expression .name:not(:empty){margin-right:6px}.monaco-workbench .repl .repl-input-wrapper{align-items:center;display:flex}.monaco-workbench .repl .repl-input-wrapper .suggest-status-bar .monaco-action-bar.right{display:none}.monaco-workbench .repl .repl-input-wrapper .repl-input-chevron{display:flex;flex-shrink:0;font-weight:600;height:100%;justify-content:center;padding:0 6px 0 8px;width:16px}.monaco-workbench .repl .repl-tree .output.expression>.ignore{font-style:italic}.monaco-workbench .repl .repl-tree .output.expression .code-bold{font-weight:700}.monaco-workbench .repl .repl-tree .output.expression .code-italic{font-style:italic}.monaco-workbench .repl .repl-tree .output.expression .code-underline{text-decoration:underline;text-decoration-style:solid}.monaco-workbench .repl .repl-tree .output.expression .code-double-underline{text-decoration:underline;text-decoration-style:double}.monaco-workbench .repl .repl-tree .output.expression .code-strike-through{text-decoration:line-through;text-decoration-style:solid}.monaco-workbench .repl .repl-tree .output.expression .code-overline{text-decoration:overline;text-decoration-style:solid}.monaco-workbench .repl .repl-tree .output.expression .code-overline.code-underline.code-strike-through{text-decoration:overline underline line-through;text-decoration-style:solid}.monaco-workbench .repl .repl-tree .output.expression .code-overline.code-underline{text-decoration:overline underline;text-decoration-style:solid}.monaco-workbench .repl .repl-tree .output.expression .code-overline.code-strike-through{text-decoration:overline line-through;text-decoration-style:solid}.monaco-workbench .repl .repl-tree .output.expression .code-underline.code-strike-through{text-decoration:underline line-through;text-decoration-style:solid}.monaco-workbench .repl .repl-tree .output.expression .code-overline.code-double-underline.code-strike-through{text-decoration:overline underline line-through;text-decoration-style:double}.monaco-workbench .repl .repl-tree .output.expression .code-overline.code-double-underline{text-decoration:overline underline;text-decoration-style:double}.monaco-workbench .repl .repl-tree .output.expression .code-double-underline.code-strike-through{text-decoration:underline line-through;text-decoration-style:double}.monaco-workbench .repl .repl-tree .output.expression .code-dim{opacity:.4}.monaco-workbench .repl .repl-tree .output.expression .code-hidden{opacity:0}.monaco-workbench .repl .repl-tree .output.expression .code-blink{animation:code-blink-key 1s cubic-bezier(1,0,0,1) infinite alternate}.monaco-workbench .repl .repl-tree .output.expression .code-rapid-blink{animation:code-blink-key .3s cubic-bezier(1,0,0,1) infinite alternate}@keyframes code-blink-key{to{opacity:.4}}.monaco-workbench .repl .repl-tree .output.expression .code-subscript{font-size:smaller;line-height:normal;vertical-align:sub}.monaco-workbench .repl .repl-tree .output.expression .code-superscript{font-size:smaller;line-height:normal;vertical-align:super}",{});var ir=i(64141),sr=i(96887),nr=i(27733),or=i(22980),rr=i(14118);class ar{constructor(){this._parsedQueries=[]}static{this.matchQuery=qi.Oh}set filterQuery(e){if(this._parsedQueries=[],(e=e.trim())&&""!==e){const t=(0,rr.Eu)(e,",").map((e=>e.trim())).filter((e=>!!e.length));for(const e of t)e.startsWith("!")?this._parsedQueries.push({type:"exclude",query:e.slice(1)}):this._parsedQueries.push({type:"include",query:e})}}filter(e,t){if(e instanceof Je||e instanceof Xe||e instanceof Ue._w)return 1;let i=!1,s=!1;const n=e.toString(!0);for(const{type:e,query:t}of this._parsedQueries){if("exclude"===e&&ar.matchQuery(t,n))return!1;"include"===e&&(i=!0,ar.matchQuery(t,n)&&(s=!0))}return i?s:void 0!==t?t:1}}var cr=i(89162),dr=i(73516),lr=i(61036);function ur(e,t,i,s){const n=document.createElement("span"),o=e.length;let r,a,c,d=[],l=!1,u=0,h="";for(;u<o;){let i=!1;if(27===e.charCodeAt(u)&&"["===e.charAt(u+1)){const l=u;u+=2;let g="";for(;u<o;){const t=e.charAt(u);if(g+=t,u++,t.match(/^[ABCDHIJKfhmpsu]$/)){i=!0;break}}if(i){if(hr(n,h,d,t,s,r,a,c),h="",g.match(/^(?:[34][0-8]|9[0-7]|10[0-7]|[0-9]|2[1-5,7-9]|[34]9|5[8,9]|1[0-9])(?:;[349][0-7]|10[0-7]|[013]|[245]|[34]9)?(?:;[012]?[0-9]?[0-9])*;?m$/)){const e=g.slice(0,-1).split(";").filter((e=>""!==e)).map((e=>parseInt(e,10)));if(38===e[0]||48===e[0]||58===e[0]){const t=38===e[0]?"foreground":48===e[0]?"background":"underline";5===e[1]?f(e,t):2===e[1]&&m(e,t)}else b(e)}}else u=l}!1===i&&(h+=e.charAt(u),u++)}return h&&hr(n,h,d,t,s,r,a,c),n;function g(e,t){"foreground"===e?r=t:"background"===e?a=t:"underline"===e&&(c=t),d=d.filter((t=>t!==`code-${e}-colored`)),void 0!==t&&d.push(`code-${e}-colored`)}function p(){const e=r;g("foreground",a),g("background",e)}function b(e){for(const t of e)switch(t){case 0:d=[],r=void 0,a=void 0;break;case 1:d=d.filter((e=>"code-bold"!==e)),d.push("code-bold");break;case 2:d=d.filter((e=>"code-dim"!==e)),d.push("code-dim");break;case 3:d=d.filter((e=>"code-italic"!==e)),d.push("code-italic");break;case 4:d=d.filter((e=>"code-underline"!==e&&"code-double-underline"!==e)),d.push("code-underline");break;case 5:d=d.filter((e=>"code-blink"!==e)),d.push("code-blink");break;case 6:d=d.filter((e=>"code-rapid-blink"!==e)),d.push("code-rapid-blink");break;case 7:l||(l=!0,p());break;case 8:d=d.filter((e=>"code-hidden"!==e)),d.push("code-hidden");break;case 9:d=d.filter((e=>"code-strike-through"!==e)),d.push("code-strike-through");break;case 10:d=d.filter((e=>!e.startsWith("code-font")));break;case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:case 19:case 20:d=d.filter((e=>!e.startsWith("code-font"))),d.push("code-font-"+(t-10));break;case 21:d=d.filter((e=>"code-underline"!==e&&"code-double-underline"!==e)),d.push("code-double-underline");break;case 22:d=d.filter((e=>"code-bold"!==e&&"code-dim"!==e));break;case 23:d=d.filter((e=>"code-italic"!==e&&"code-font-10"!==e));break;case 24:d=d.filter((e=>"code-underline"!==e&&"code-double-underline"!==e));break;case 25:d=d.filter((e=>"code-blink"!==e&&"code-rapid-blink"!==e));break;case 27:l&&(l=!1,p());break;case 28:d=d.filter((e=>"code-hidden"!==e));break;case 29:d=d.filter((e=>"code-strike-through"!==e));break;case 53:d=d.filter((e=>"code-overline"!==e)),d.push("code-overline");break;case 55:d=d.filter((e=>"code-overline"!==e));break;case 39:g("foreground",void 0);break;case 49:g("background",void 0);break;case 59:g("underline",void 0);break;case 73:d=d.filter((e=>"code-superscript"!==e&&"code-subscript"!==e)),d.push("code-superscript");break;case 74:d=d.filter((e=>"code-superscript"!==e&&"code-subscript"!==e)),d.push("code-subscript");break;case 75:d=d.filter((e=>"code-superscript"!==e&&"code-subscript"!==e));break;default:v(t)}}function m(e,t){e.length>=5&&e[2]>=0&&e[2]<=255&&e[3]>=0&&e[3]<=255&&e[4]>=0&&e[4]<=255&&g(t,new ls.VS(e[2],e[3],e[4]))}function f(e,t){let s=e[2];const n=gr(s);if(n)g(t,n);else if(s>=0&&s<=15){if("underline"===t){const e=i.getColorTheme(),n=lr.D2[s],o=e.getColor(n);return void(o&&g(t,o.rgba))}s+=30,s>=38&&(s+=52),"background"===t&&(s+=10),v(s)}}function v(e){const t=i.getColorTheme();let s,n;if(e>=30&&e<=37?(n=e-30,s="foreground"):e>=90&&e<=97?(n=e-90+8,s="foreground"):e>=40&&e<=47?(n=e-40,s="background"):e>=100&&e<=107&&(n=e-100+8,s="background"),void 0!==n&&s){const e=lr.D2[n],i=t.getColor(e);i&&g(s,i.rgba)}}}function hr(e,t,i,s,n,o,r,a){if(!e||!t)return;const c=s.linkify(t,!0,n);c.className=i.join(" "),o&&(c.style.color=ls.Il.Format.CSS.formatRGB(new ls.Il(o))),r&&(c.style.backgroundColor=ls.Il.Format.CSS.formatRGB(new ls.Il(r))),a&&(c.style.textDecorationColor=ls.Il.Format.CSS.formatRGB(new ls.Il(a))),e.appendChild(c)}function gr(e){if(e%1==0){if(e>=16&&e<=231){let t=(e-=16)%6,i=(e=(e-t)/6)%6,s=e=(e-i)/6;const n=51;return t=Math.round(t*n),i=Math.round(i*n),s=Math.round(s*n),new ls.VS(s,i,t)}if(e>=232&&e<=255){e-=232;const t=Math.round(e/23*255);return new ls.VS(t,t,t)}}}const pr=Kt.$;class br{static{this.ID="replEvaluationInput"}get templateId(){return br.ID}renderTemplate(e){Kt.R3(e,pr("span.arrow"+be.kS.asCSSSelector(me.kd)));const t=Kt.R3(e,pr(".expression"));return{label:new $i.q(t)}}renderElement(e,t,i){const s=e.element;i.label.set(s.value,(0,qi.mB)(e.filterData))}disposeTemplate(e){}}let mr=class e{static{this.ID="replGroup"}constructor(e,t){this.linkDetector=e,this.themeService=t}get templateId(){return e.ID}renderTemplate(e){return{label:Kt.R3(e,pr(".expression"))}}renderElement(e,t,i){const s=e.element;Kt.PO(i.label);const n=ur(s.name,this.linkDetector,this.themeService,void 0);i.label.appendChild(n)}disposeTemplate(e){}};mr=(0,o.g)([(0,o.f)(1,ti.XE)],mr);class fr{static{this.ID="replEvaluationResult"}get templateId(){return fr.ID}constructor(e){this.linkDetector=e}renderTemplate(e){const t=Kt.R3(e,pr(".evaluation-result.expression"));return{value:Kt.R3(t,pr("span.value"))}}renderElement(e,t,i){ts(e.element,i.value,{showHover:!1,colorize:!0,linkDetector:this.linkDetector})}disposeTemplate(e){}}let vr=class e{static{this.ID="outputReplElement"}constructor(e,t,i,s){this.linkDetector=e,this.editorService=t,this.labelService=i,this.themeService=s}get templateId(){return e.ID}renderTemplate(e){const t=Object.create(null);e.classList.add("output");const i=Kt.R3(e,pr(".output.expression.value-and-source"));return t.container=e,t.countContainer=Kt.R3(i,pr(".count-badge-wrapper")),t.count=new cr.Z(t.countContainer,{},mi.ku),t.value=Kt.R3(i,pr("span.value")),t.source=Kt.R3(i,pr(".source")),t.toDispose=[],t.toDispose.push(Kt.nm(t.source,"click",(e=>{e.preventDefault(),e.stopPropagation();const i=t.getReplElementSource();i&&i.source.openInEditor(this.editorService,{startLineNumber:i.lineNumber,startColumn:i.column,endLineNumber:i.lineNumber,endColumn:i.column})}))),t}renderElement({element:e},t,i){this.setElementCount(e,i),i.elementListener=e.onDidChangeCount((()=>this.setElementCount(e,i))),Kt.PO(i.value),i.value.className="value",i.value.appendChild(ur(e.value,this.linkDetector,this.themeService,e.session.root)),i.value.classList.add(e.severity===m.Z.Warning?"warn":e.severity===m.Z.Error?"error":e.severity===m.Z.Ignore?"ignore":"info"),i.source.textContent=e.sourceData?`${(0,zi.EZ)(e.sourceData.source.name)}:${e.sourceData.lineNumber}`:"",i.source.title=e.sourceData?`${this.labelService.getUriLabel(e.sourceData.source.uri)}:${e.sourceData.lineNumber}`:"",i.getReplElementSource=()=>e.sourceData}setElementCount(e,t){e.count>=2?(t.count.setCount(e.count),t.countContainer.hidden=!1):t.countContainer.hidden=!0}disposeTemplate(e){(0,p.B9)(e.toDispose)}disposeElement(e,t,i){i.elementListener.dispose()}};vr=(0,o.g)([(0,o.f)(1,oe.AR),(0,o.f)(2,Lt.e),(0,o.f)(3,ti.XE)],vr);let wr=class e extends ss{static{this.ID="replVariable"}get templateId(){return e.ID}constructor(e,t,i){super(t,i),this.linkDetector=e}renderElement(e,t,i){const s=e.element;super.renderExpressionElement(s instanceof Ge?s.expression:s,e,i)}renderExpression(e,t,i){const s=e instanceof Ge;s||!e.name?(t.label.set(""),ts(s?e.expression:e,t.value,{showHover:!1,colorize:!0,linkDetector:this.linkDetector}),t.expression.classList.remove("nested-variable")):(is(e,t,!0,i,this.linkDetector),t.expression.classList.toggle("nested-variable",Cr(e)))}getInputBoxOptions(e){}};wr=(0,o.g)([(0,o.f)(1,n.tn),(0,o.f)(2,Yt.u)],wr);class Sr{static{this.ID="rawObject"}constructor(e){this.linkDetector=e}get templateId(){return Sr.ID}renderTemplate(e){e.classList.add("output");const t=Kt.R3(e,pr(".output.expression")),i=Kt.R3(t,pr("span.name"));return{container:e,expression:t,name:i,label:new $i.q(i),value:Kt.R3(t,pr("span.value"))}}renderElement(e,t,i){const s=e.element;i.label.set(s.name?`${s.name}:`:"",(0,qi.mB)(e.filterData)),s.name?i.name.textContent=`${s.name}:`:i.name.textContent="",ts(s.value,i.value,{showHover:!1,linkDetector:this.linkDetector})}disposeTemplate(e){}}function Cr(e){return e instanceof Ue._w&&(e.parent instanceof Xe||e.parent instanceof Ue._w)}class kr extends dr.Vj{constructor(e,t){super(),this.configurationService=e,this.replOptions=t}getHeight(e){return this.configurationService.getValue("debug").console.wordWrap?super.getHeight(e):this.estimateHeight(e,!0)}estimateHeight(e,t=!1){const i=this.replOptions.replConfiguration.lineHeight;if("string"==typeof e.value&&!Cr(e)){const n=e.value,o=(s=n,(s.match(/\n/g)?.length??0)+(t?0:Math.floor(n.length/70))+(e instanceof Ke?0:1));return Math.max(o,1)*i}var s;return i}getTemplateId(e){return e instanceof Ue._w||e instanceof Ge?wr.ID:e instanceof Xe?fr.ID:e instanceof Je?br.ID:e instanceof Ke?vr.ID:e instanceof Ze?mr.ID:Sr.ID}hasDynamicHeight(e){return!Cr(e)&&e.toString().length>0}}function yr(e){return"function"==typeof e.getReplElements}class Dr{hasChildren(e){return!!yr(e)||!!e.hasChildren}getChildren(e){return yr(e)?Promise.resolve(e.getReplElements()):Promise.resolve(e.getChildren())}}class xr{getWidgetAriaLabel(){return(0,w.NC)("debugConsole","Debug Console")}getAriaLabel(e){return e instanceof Ue._w?(0,w.NC)("replVariableAriaLabel","Variable {0}, value {1}",e.name,e.value):e instanceof Ke||e instanceof Je||e instanceof Xe?e.value+(e instanceof Ke&&e.count>1?(0,w.NC)({key:"occurred",comment:["Front will the value of the debug console element. Placeholder will be replaced by a number which represents occurrance count."]},", occurred {0} times",e.count):""):e instanceof Qe?(0,w.NC)("replRawObjectAriaLabel","Debug console variable {0}, value {1}",e.name,e.value):e instanceof Ze?(0,w.NC)("replGroup","Debug console group {0}",e.name):""}}var Ir=i(20539);const Er=Kt.$,Nr="debug.repl.history",Tr="debug.repl.filterHistory",Lr="debug.repl.filterValue",_r="replinputdecoration";function Ar(e){e.scrollTop=e.scrollHeight-e.renderHeight}const Mr=new Set,Br={getId:e=>e.getId()};let Rr=class e extends Gi.S_{static{this.REFRESH_DELAY=50}static{this.URI=W.ov.parse(`${n.lR}:replinput`)}constructor(e,t,i,s,o,r,a,c,d,l,u,h,g,b,m,f,v,S,C){const k=s.get(Lr,1,"");super({...e,filterOptions:{placeholder:(0,w.NC)({key:"workbench.debug.filter.placeholder",comment:["Text in the brackets after e.g. is not localizable"]},"Filter (e.g. text, !exclude)"),text:k,history:JSON.parse(s.get(Tr,1,"[]"))}},b,l,u,a,d,i,m,o,f),this.debugService=t,this.storageService=s,this.modelService=r,this.textResourcePropertiesService=h,this.editorService=g,this.languageFeaturesService=S,this.logService=C,this.previousTreeScrollHeight=0,this.replInputLineCount=1,this.modelChangeListener=p.JT.None,this.menu=v.createMenu(Ot.eH.DebugConsoleContext,a),this._register(this.menu),this.history=new tr.L(JSON.parse(this.storageService.get(Nr,1,"[]")),50),this.filter=new ar,this.filter.filterQuery=k,this.multiSessionRepl=n.h4.bindTo(a),this.replOptions=this._register(this.instantiationService.createInstance(Fr,this.id,(()=>this.getBackgroundColor()))),this._register(this.replOptions.onDidChange((()=>this.onDidStyleChange()))),c.registerDecorationType("repl-decoration",_r,{}),this.multiSessionRepl.set(this.isMultiSessionView),this.registerListeners()}registerListeners(){this.debugService.getViewModel().focusedSession&&this.onDidFocusSession(this.debugService.getViewModel().focusedSession),this._register(this.debugService.getViewModel().onDidFocusSession((async e=>this.onDidFocusSession(e)))),this._register(this.debugService.getViewModel().onDidEvaluateLazyExpression((async e=>{e instanceof Ue._w&&this.tree?.hasNode(e)&&(await this.tree.updateChildren(e,!1,!0),await this.tree.expand(e))}))),this._register(this.debugService.onWillNewSession((async e=>{const t=this.tree?.getInput();t&&0!==t.state||await this.selectSession(e),this.multiSessionRepl.set(this.isMultiSessionView)}))),this._register(this.debugService.onDidEndSession((async e=>{await Promise.resolve(),this.multiSessionRepl.set(this.isMultiSessionView)}))),this._register(this.themeService.onDidColorThemeChange((()=>{this.refreshReplElements(!1),this.isVisible()&&this.updateInputDecoration()}))),this._register(this.onDidChangeBodyVisibility((t=>{t&&(this.model||(this.model=this.modelService.getModel(e.URI)||this.modelService.createModel("",null,e.URI,!0)),this.setMode(),this.replInput.setModel(this.model),this.updateInputDecoration(),this.refreshReplElements(!0))}))),this._register(this.configurationService.onDidChangeConfiguration((e=>{if(e.affectsConfiguration("debug.console.wordWrap")&&this.tree&&(this.tree.dispose(),this.treeContainer.innerText="",Kt.PO(this.treeContainer),this.createReplTree()),e.affectsConfiguration("debug.console.acceptSuggestionOnEnter")){const e=this.configurationService.getValue("debug");this.replInput.updateOptions({acceptSuggestionOnEnter:"on"===e.console.acceptSuggestionOnEnter?"on":"off"})}}))),this._register(this.editorService.onDidActiveEditorChange((()=>{this.setMode()}))),this._register(this.filterWidget.onDidChangeFilterText((()=>{this.filter.filterQuery=this.filterWidget.getFilterText(),this.tree&&(this.tree.refilter(),Ar(this.tree))})))}async onDidFocusSession(e){e&&(Mr.delete(e),this.completionItemProvider?.dispose(),e.capabilities.supportsCompletionsRequest&&(this.completionItemProvider=this.languageFeaturesService.completionProvider.register({scheme:n.lR,pattern:"**/replinput",hasAccessToAllModels:!0},{_debugDisplayName:"debugConsole",triggerCharacters:e.capabilities.completionTriggerCharacters||["."],provideCompletionItems:async(t,i,s,n)=>{this.setHistoryNavigationEnablement(!1);const o=this.replInput.getModel();if(o){const t=o.getWordAtPosition(i),s=t?t.word.length:0,r=o.getValue(),a=this.debugService.getViewModel().focusedStackFrame,c=a?a.frameId:void 0,d=await e.completions(c,a?.thread.threadId||0,r,i,s,n),l=[],u=e=>Xt.e.fromPositions(i.delta(0,-e),i);if(d&&d.body&&d.body.targets&&d.body.targets.forEach((e=>{if(e&&e.label){let t,i=e.text||e.label;if("number"==typeof e.selectionStart){t=4;const s="number"==typeof e.selectionLength?e.selectionLength:0,n=s>0?"${1:"+i.substring(e.selectionStart,e.selectionStart+s)+"}$0":"$0";i=i.substring(0,e.selectionStart)+n+i.substring(e.selectionStart+s)}l.push({label:e.label,insertText:i,detail:e.detail,kind:sr.gX.fromString(e.type||"property"),filterText:e.start&&e.length?r.substring(e.start,e.start+e.length).concat(e.label):void 0,range:u(e.length||s),sortText:e.sortText,insertTextRules:t})}})),this.configurationService.getValue("debug").console.historySuggestions){const e=this.history.getHistory(),t=String(e.length).length;e.forEach(((i,s)=>l.push({label:i,insertText:i,kind:18,range:u(i.length),sortText:"ZZZ"+String(e.length-s).padStart(t,"0")})))}return{suggestions:l}}return Promise.resolve({suggestions:[]})}}))),await this.selectSession()}getFilterStats(){return{total:this.tree?.getNode().children.length??0,filtered:this.tree?.getNode().children.filter((e=>e.visible)).length??0}}get isReadonly(){const e=this.tree?.getInput();return!e||0===e.state}showPreviousValue(){this.isReadonly||this.navigateHistory(!0)}showNextValue(){this.isReadonly||this.navigateHistory(!1)}focusFilter(){this.filterWidget.focus()}setMode(){if(!this.isVisible())return;const e=this.editorService.activeTextEditorControl;(0,v.CL)(e)&&(this.modelChangeListener.dispose(),this.modelChangeListener=e.onDidChangeModelLanguage((()=>this.setMode())),this.model&&e.hasModel()&&this.model.setLanguage(e.getModel().getLanguageId()))}onDidStyleChange(){if(this.styleElement){this.replInput.updateOptions({fontSize:this.replOptions.replConfiguration.fontSize,lineHeight:this.replOptions.replConfiguration.lineHeight,fontFamily:"default"===this.replOptions.replConfiguration.fontFamily?ir.hL.fontFamily:this.replOptions.replConfiguration.fontFamily});const e=this.replInput.getOption(65);this.styleElement.textContent=`\n\t\t\t\t.repl .repl-input-wrapper .repl-input-chevron {\n\t\t\t\t\tline-height: ${e}px\n\t\t\t\t}\n\n\t\t\t\t.repl .repl-input-wrapper .monaco-editor .lines-content {\n\t\t\t\t\tbackground-color: ${this.replOptions.replConfiguration.backgroundColor};\n\t\t\t\t}\n\t\t\t`;const t="default"===this.replOptions.replConfiguration.fontFamily?"var(--monaco-monospace-font)":this.replOptions.replConfiguration.fontFamily;this.container.style.setProperty("--vscode-repl-font-family",t),this.container.style.setProperty("--vscode-repl-font-size",`${this.replOptions.replConfiguration.fontSize}px`),this.container.style.setProperty("--vscode-repl-font-size-for-twistie",`${this.replOptions.replConfiguration.fontSizeForTwistie}px`),this.container.style.setProperty("--vscode-repl-line-height",this.replOptions.replConfiguration.cssLineHeight),this.tree?.rerender(),this.bodyContentDimension&&this.layoutBodyContent(this.bodyContentDimension.height,this.bodyContentDimension.width)}}navigateHistory(e){const t=(e?this.history.previous()??this.history.first():this.history.next())??"";this.replInput.setValue(t),r.i7(t),this.replInput.setPosition({lineNumber:1,column:t.length+1}),this.setHistoryNavigationEnablement(!0)}async selectSession(e){const t=this.tree?.getInput();if(!e){const i=this.debugService.getViewModel().focusedSession;i?e=i:t&&!Mr.has(t)||(e=this.debugService.getModel().getSessions(!0).find((e=>!Mr.has(e))))}if(e&&(this.replElementsChangeListener?.dispose(),this.replElementsChangeListener=e.onDidChangeReplElements((()=>{this.refreshReplElements(0===e.getReplElements().length)})),this.tree&&t!==e)){try{await this.tree.setInput(e)}catch(e){this.logService.error(e)}Ar(this.tree)}this.replInput?.updateOptions({readOnly:this.isReadonly}),this.updateInputDecoration()}async clearRepl(){const e=this.tree?.getInput();e&&(e.removeReplExpressions(),0===e.state&&(Mr.add(e),await this.selectSession(),this.multiSessionRepl.set(this.isMultiSessionView))),this.replInput.focus()}acceptReplInput(){const e=this.tree?.getInput();if(e&&!this.isReadonly){e.addReplExpression(this.debugService.getViewModel().focusedStackFrame,this.replInput.getValue()),Ar(this.tree),this.history.add(this.replInput.getValue()),this.replInput.setValue("");const t=this.replInputLineCount>1;this.replInputLineCount=1,t&&this.bodyContentDimension&&this.layoutBodyContent(this.bodyContentDimension.height,this.bodyContentDimension.width)}}getVisibleContent(){let e="";if(this.model&&this.tree){const t=this.textResourcePropertiesService.getEOL(this.model.uri),i=s=>{s.children.forEach((s=>{s.visible&&(e+=s.element.toString().trimRight()+t,!s.collapsed&&s.children.length&&i(s))}))};i(this.tree.getNode())}return(0,A.Yd)(e)}layoutBodyContent(e,t){this.bodyContentDimension=new Kt.Ro(t,e);const i=Math.min(this.replInput.getContentHeight(),e);if(this.tree){const s=this.tree.scrollTop+this.tree.renderHeight>=this.tree.scrollHeight,n=e-i;this.tree.getHTMLElement().style.height=`${n}px`,this.tree.layout(n,t),s&&Ar(this.tree)}this.replInputContainer.style.height=`${i}px`,this.replInput.layout({width:t-30,height:i})}collapseAll(){this.tree?.collapseAll()}getReplInput(){return this.replInput}focus(){setTimeout((()=>this.replInput.focus()),0)}getActionViewItem(e){if(e.id===$r){const t=(this.tree?this.tree.getInput():void 0)??this.debugService.getViewModel().focusedSession;return this.instantiationService.createInstance(Wr,e,t)}return super.getActionViewItem(e)}get isMultiSessionView(){return this.debugService.getModel().getSessions(!0).filter((e=>e.hasSeparateRepl()&&!Mr.has(e))).length>1}get refreshScheduler(){const t=new Set;return new d.pY((async()=>{if(!this.tree)return;if(!this.tree.getInput())return;await this.tree.updateChildren(void 0,!0,!1,{diffIdentityProvider:Br});const e=this.tree.getInput();if(e){const i=async e=>{for(const s of e)s instanceof Ze&&(s.autoExpand&&!t.has(s.getId())&&(t.add(s.getId()),await this.tree.expand(s)),this.tree.isCollapsed(s)||await i(s.getChildren()))};await i(e.getReplElements())}const{total:i,filtered:s}=this.getFilterStats();this.filterWidget.updateBadge(i===s||0===i?void 0:(0,w.NC)("showing filtered repl lines","Showing {0} of {1}",s,i))}),e.REFRESH_DELAY)}render(){super.render(),this._register((0,Ir.g)({focusNotifiers:[this,this.filterWidget],focusNextWidget:()=>{this.filterWidget.hasFocus()?this.tree?.domFocus():this.tree?.getHTMLElement()===document.activeElement&&this.focus()},focusPreviousWidget:()=>{this.replInput.hasTextFocus()?this.tree?.domFocus():this.tree?.getHTMLElement()===document.activeElement&&this.focusFilter()}}))}renderBody(e){super.renderBody(e),this.container=Kt.R3(e,Er(".repl")),this.treeContainer=Kt.R3(this.container,Er(`.repl-tree.${er.S}`)),this.createReplInput(this.container),this.createReplTree()}createReplTree(){this.replDelegate=new kr(this.configurationService,this.replOptions);const e=this.configurationService.getValue("debug").console.wordWrap;this.treeContainer.classList.toggle("word-wrap",e);const t=this.instantiationService.createInstance(Tn),i=this.tree=this.instantiationService.createInstance(Ki.ls,"DebugRepl",this.treeContainer,this.replDelegate,[this.instantiationService.createInstance(wr,t),this.instantiationService.createInstance(vr,t),new br,this.instantiationService.createInstance(mr,t),new fr(t),new Sr(t)],new Dr,{filter:this.filter,accessibilityProvider:new xr,identityProvider:Br,mouseSupport:!1,findWidgetEnabled:!1,keyboardNavigationLabelProvider:{getKeyboardNavigationLabel:e=>e.toString(!0)},horizontalScrolling:!e,setRowLineHeight:!1,supportDynamicHeights:e,overrideStyles:{listBackground:this.getBackgroundColor()}});let s;this._register(i.onDidChangeContentHeight((()=>{i.scrollHeight!==this.previousTreeScrollHeight&&i.scrollTop+i.renderHeight>=this.previousTreeScrollHeight-2&&setTimeout((()=>{Ar(i)}),0),this.previousTreeScrollHeight=i.scrollHeight}))),this._register(i.onContextMenu((e=>this.onContextMenu(e)))),this._register(i.onMouseClick((()=>{const e=window.getSelection();e&&"Range"===e.type&&s!==e.toString()||this.replInput.focus(),s=e?e.toString():""}))),this.selectSession(),this.styleElement=Kt.dS(this.container),this.onDidStyleChange()}createReplInput(e){this.replInputContainer=Kt.R3(e,Er(".repl-input-wrapper")),Kt.R3(this.replInputContainer,Er(".repl-input-chevron"+be.kS.asCSSSelector(me.l5)));const{historyNavigationBackwardsEnablement:t,historyNavigationForwardsEnablement:i}=this._register((0,or.iY)(this.scopedContextKeyService,this));this.setHistoryNavigationEnablement=e=>{t.set(e),i.set(e)},n.AN.bindTo(this.scopedContextKeyService).set(!0),this.scopedInstantiationService=this.instantiationService.createChild(new hi.y([k.i6,this.scopedContextKeyService]));const s=(0,pi.e)(this.configurationService);s.readOnly=!0,s.suggest={showStatusBar:!0};const o=this.configurationService.getValue("debug");s.acceptSuggestionOnEnter="on"===o.console.acceptSuggestionOnEnter?"on":"off",s.ariaLabel=(0,w.NC)("debugConsole","Debug Console"),this.replInput=this.scopedInstantiationService.createInstance(gi.Gm,this.replInputContainer,s,(0,pi.q)()),this._register(this.replInput.onDidChangeModelContent((()=>{const e=this.replInput.getModel();this.setHistoryNavigationEnablement(!!e&&""===e.getValue());const t=e?Math.min(10,e.getLineCount()):1;t!==this.replInputLineCount&&(this.replInputLineCount=t,this.bodyContentDimension&&this.layoutBodyContent(this.bodyContentDimension.height,this.bodyContentDimension.width))}))),this._register(this.replInput.onDidFocusEditorText((()=>this.updateInputDecoration()))),this._register(this.replInput.onDidBlurEditorText((()=>this.updateInputDecoration()))),this._register(Kt.mu(this.replInputContainer,Kt.tw.FOCUS,(()=>this.replInputContainer.classList.add("synthetic-focus")))),this._register(Kt.mu(this.replInputContainer,Kt.tw.BLUR,(()=>this.replInputContainer.classList.remove("synthetic-focus"))))}onContextMenu(e){const t=[];(0,ji.LJ)(this.menu,{arg:e.element,shouldForwardArgs:!1},t),this.contextMenuService.showContextMenu({getAnchor:()=>e.anchor,getActions:()=>t,getActionsContext:()=>e.element})}refreshReplElements(e){if(this.tree&&this.isVisible()){if(this.refreshScheduler.isScheduled())return;this.refreshScheduler.schedule(e?0:void 0)}}updateInputDecoration(){if(!this.replInput)return;const e=[];if(this.isReadonly&&this.replInput.hasTextFocus()&&!this.replInput.getValue()){const t=(0,ei.Snq)(ei.NOs,this.themeService.getColorTheme())?.transparent(.4);e.push({range:{startLineNumber:0,endLineNumber:0,startColumn:0,endColumn:1},renderOptions:{after:{contentText:(0,w.NC)("startDebugFirst","Please start a debug session to evaluate expressions"),color:t?t.toString():void 0}}})}this.replInput.setDecorationsByType("repl-decoration",_r,e)}saveState(){const e=this.history.getHistory();e.length?this.storageService.store(Nr,JSON.stringify(e),1,1):this.storageService.remove(Nr,1);const t=this.filterWidget.getHistory();t.length?this.storageService.store(Tr,JSON.stringify(t),1,1):this.storageService.remove(Tr,1);const i=this.filterWidget.getFilterText();i?this.storageService.store(Lr,i,1,1):this.storageService.remove(Lr,1),super.saveState()}dispose(){this.replInput?.dispose(),this.replElementsChangeListener?.dispose(),this.refreshScheduler.dispose(),this.modelChangeListener.dispose(),super.dispose()}};Rr.__decorator=(0,o.g)([Qt.HP],Rr.prototype,"refreshScheduler",null),Rr=(0,o.g)([(0,o.f)(1,n.tn),(0,o.f)(2,x.TG),(0,o.f)(3,pe.Uy),(0,o.f)(4,ti.XE),(0,o.f)(5,di.q),(0,o.f)(6,k.i6),(0,o.f)(7,ui.$),(0,o.f)(8,_.XH),(0,o.f)(9,Yt.i),(0,o.f)(10,C.Ui),(0,o.f)(11,O.y),(0,o.f)(12,oe.AR),(0,o.f)(13,fi.d),(0,o.f)(14,He.v4),(0,o.f)(15,We.bU),(0,o.f)(16,Ot.co),(0,o.f)(17,Tt.p),(0,o.f)(18,Pe.VZ)],Rr);let Fr=class e extends p.JT{static{this.lineHeightEm=1.4}get replConfiguration(){return this._replConfig}constructor(e,t,i,s,n){super(),this.backgroundColorDelegate=t,this.configurationService=i,this.themeService=s,this.viewDescriptorService=n,this._onDidChange=this._register(new g.Q5),this.onDidChange=this._onDidChange.event,this._register(this.themeService.onDidColorThemeChange((e=>this.update()))),this._register(this.viewDescriptorService.onDidChangeLocation((t=>{t.views.some((t=>t.id===e))&&this.update()}))),this._register(this.configurationService.onDidChangeConfiguration((e=>{(e.affectsConfiguration("debug.console.lineHeight")||e.affectsConfiguration("debug.console.fontSize")||e.affectsConfiguration("debug.console.fontFamily"))&&this.update()}))),this.update()}update(){const t=this.configurationService.getValue("debug").console;this._replConfig={fontSize:t.fontSize,fontFamily:t.fontFamily,lineHeight:t.lineHeight?t.lineHeight:e.lineHeightEm*t.fontSize,cssLineHeight:t.lineHeight?`${t.lineHeight}px`:`${e.lineHeightEm}em`,backgroundColor:this.themeService.getColorTheme().getColor(this.backgroundColorDelegate()),fontSizeForTwistie:t.fontSize*e.lineHeightEm/2-8},this._onDidChange.fire()}};Fr=(0,o.g)([(0,o.f)(2,C.Ui),(0,o.f)(3,ti.XE),(0,o.f)(4,_.XH)],Fr);class Vr extends Pt.R6{constructor(){super({id:"repl.action.acceptInput",label:(0,w.NC)({key:"actions.repl.acceptInput",comment:["Apply input from the debug console input box"]},"REPL Accept Input"),alias:"REPL Accept Input",precondition:n.AN,kbOpts:{kbExpr:ci.u.textInputFocus,primary:3,weight:100}})}run(e,t){nr.n.get(t)?.cancelSuggestWidget();const i=Hr(e.get(_.qC));i?.acceptReplInput()}}class Pr extends Pt.R6{constructor(){super({id:"repl.action.filter",label:(0,w.NC)("repl.action.filter","REPL Focus Content to Filter"),alias:"REPL Filter",precondition:n.AN,kbOpts:{kbExpr:ci.u.textInputFocus,primary:2084,weight:100}})}run(e,t){const i=Hr(e.get(_.qC));i?.focusFilter()}}class Or extends Pt.R6{constructor(){super({id:"repl.action.copyAll",label:(0,w.NC)("actions.repl.copyAll","Debug: Console Copy All"),alias:"Debug Console Copy All",precondition:n.AN})}run(e,t){const i=e.get(Ln.p),s=Hr(e.get(_.qC));if(s)return i.writeText(s.getVisibleContent())}}(0,Pt.Qr)(Vr),(0,Pt.Qr)(Or),(0,Pt.Qr)(Pr);class Wr extends ds{getSessions(){return this.debugService.getModel().getSessions(!0).filter((e=>e.hasSeparateRepl()&&!Mr.has(e)))}mapFocusedSessionToSelected(e){for(;e.parentSession&&!e.hasSeparateRepl();)e=e.parentSession;return e}}function Hr(e){return e.getActiveViewWithId(n.FT)??void 0}const $r="workbench.action.debug.selectRepl";(0,Ot.r1)(class extends Gi.Nx{constructor(){super({id:$r,viewId:n.FT,title:(0,w.NC)("selectRepl","Select Debug Console"),f1:!1,menu:{id:Ot.eH.ViewTitle,group:"navigation",when:k.Ao.and(k.Ao.equals("view",n.FT),n.h4),order:20}})}async runInView(e,t,i){const s=e.get(n.tn);if(i&&0!==i.state&&i!==s.getViewModel().focusedSession){if(2!==i.state){const e=s.getModel().getSessions().find((e=>e.parentSession===i&&2===e.state));e&&(i=e)}await s.focusStackFrame(void 0,void 0,i,{explicit:!0})}await t.selectSession(i)}}),(0,Ot.r1)(class extends Gi.Nx{constructor(){super({id:"workbench.debug.panel.action.clearReplAction",viewId:n.FT,title:{value:(0,w.NC)("clearRepl","Clear Console"),original:"Clear Console"},f1:!0,icon:me.BU,menu:[{id:Ot.eH.ViewTitle,group:"navigation",when:k.Ao.equals("view",n.FT),order:30},{id:Ot.eH.DebugConsoleContext,group:"z_commands",order:20}]})}runInView(e,t){t.clearRepl(),r.i7((0,w.NC)("debugConsoleCleared","Debug console was cleared"))}}),(0,Ot.r1)(class extends Gi.Nx{constructor(){super({id:"debug.collapseRepl",title:(0,w.NC)("collapse","Collapse All"),viewId:n.FT,menu:{id:Ot.eH.DebugConsoleContext,group:"z_commands",order:10}})}runInView(e,t){t.collapseAll(),t.focus()}}),(0,Ot.r1)(class extends Gi.Nx{constructor(){super({id:"debug.replPaste",title:(0,w.NC)("paste","Paste"),viewId:n.FT,precondition:n.KA.notEqualsTo((0,n.wD)(0)),menu:{id:Ot.eH.DebugConsoleContext,group:"2_cutcopypaste",order:30}})}async runInView(e,t){const i=e.get(Ln.p),s=await i.readText();if(s){const e=t.getReplInput();e.setValue(e.getValue().concat(s)),t.focus();const i=e.getModel(),n=i?i.getLineCount():0,o=i?.getLineMaxColumn(n);"number"==typeof n&&"number"==typeof o&&e.setPosition({lineNumber:n,column:o})}}}),(0,Ot.r1)(class extends Gi.Nx{constructor(){super({id:"workbench.debug.action.copyAll",title:(0,w.NC)("copyAll","Copy All"),viewId:n.FT,menu:{id:Ot.eH.DebugConsoleContext,group:"2_cutcopypaste",order:20}})}async runInView(e,t){const i=e.get(Ln.p);await i.writeText(t.getVisibleContent())}}),(0,Ot.r1)(class extends Ot.Ke{constructor(){super({id:"debug.replCopy",title:(0,w.NC)("copy","Copy"),menu:{id:Ot.eH.DebugConsoleContext,group:"2_cutcopypaste",order:10}})}async run(e,t){const i=e.get(Ln.p),s=e.get(n.tn),o=window.getSelection(),r=o?.toString();return r&&r.length>0?i.writeText(r):t?i.writeText(await this.tryEvaluateAndCopy(s,t)||t.toString()):void 0}async tryEvaluateAndCopy(e,t){if(!(t instanceof Xe))return;const i=e.getViewModel().focusedStackFrame,s=e.getViewModel().focusedSession;if(i&&s&&s.capabilities.supportsClipboardContext)try{const e=await s.evaluate(t.originalExpression,i.frameId,"clipboard");return e?.body.result}catch(e){return}}});var Ur=i(88550),qr=i(29918);const zr=(0,ei.P6G)("statusBar.debuggingBackground",{dark:"#CC6633",light:"#CC6633",hcDark:"#BA592C",hcLight:"#B5200D"},(0,w.NC)("statusBarDebuggingBackground","Status bar background color when a program is being debugged. The status bar is shown in the bottom of the window")),jr=(0,ei.P6G)("statusBar.debuggingForeground",{dark:Ur.he,light:Ur.he,hcDark:Ur.he,hcLight:"#FFFFFF"},(0,w.NC)("statusBarDebuggingForeground","Status bar foreground color when a program is being debugged. The status bar is shown in the bottom of the window")),Kr=(0,ei.P6G)("statusBar.debuggingBorder",{dark:Ur.g4,light:Ur.g4,hcDark:Ur.g4,hcLight:Ur.g4},(0,w.NC)("statusBarDebuggingBorder","Status bar border color separating to the sidebar and editor when a program is being debugged. The status bar is shown in the bottom of the window"));let Gr=class{set enabled(e){e!==!!this.disposable&&(e?this.disposable=this.statusbarService.overrideStyle({priority:10,foreground:jr,background:zr,border:Kr}):(this.disposable.dispose(),this.disposable=void 0))}constructor(e,t,i,s){this.debugService=e,this.contextService=t,this.statusbarService=i,this.configurationService=s,this.disposables=new p.SL,this.debugService.onDidChangeState(this.update,this,this.disposables),this.contextService.onDidChangeWorkbenchState(this.update,this,this.disposables),this.configurationService.onDidChangeConfiguration((e=>{e.affectsConfiguration("debug.enableStatusBarColor")&&this.update()})),this.update()}update(){const e=this.configurationService.getValue("debug").enableStatusBarColor;var t,i;this.enabled=!!e&&(t=this.debugService.state,i=this.debugService.getModel().getSessions(),0!==t&&1!==t&&!i.every((e=>e.suppressDebugStatusbar||e.configuration?.noDebug)))}dispose(){this.disposable?.dispose(),this.disposables.dispose()}};Gr=(0,o.g)([(0,o.f)(0,n.tn),(0,o.f)(1,T.ec),(0,o.f)(2,qr.iq),(0,o.f)(3,C.Ui)],Gr);var Qr=i(25707);let Jr=!1,Xr=!1,Zr=class extends Gi.qV{constructor(e,t,i,s,o,r,a,c,l,u,h,g){super(e,s,t,a,c,r,o,l,u,h),this.debugService=i,this.needsRefresh=!1,this.menu=g.createMenu(Ot.eH.DebugWatchContext,c),this._register(this.menu),this.watchExpressionsUpdatedScheduler=new d.pY((()=>{this.needsRefresh=!1,this.tree.updateChildren()}),50),this.watchExpressionsExist=n.Lh.bindTo(c),this.variableReadonly=n.hs.bindTo(c),this.watchExpressionsExist.set(this.debugService.getModel().getWatchExpressions().length>0),this.watchItemType=n.kJ.bindTo(c)}renderBody(e){super.renderBody(e),this.element.classList.add("debug-pane"),e.classList.add("debug-watch");const t=es(e),i=this.instantiationService.createInstance(ia),s=this.instantiationService.createInstance(Tn);let o;this.tree=this.instantiationService.createInstance(Ki.ls,"WatchExpressions",t,new Yr,[i,this.instantiationService.createInstance(qn,s)],new ta,{accessibilityProvider:new sa,identityProvider:{getId:e=>e.getId()},keyboardNavigationLabelProvider:{getKeyboardNavigationLabel:e=>{if(e!==this.debugService.getViewModel().getSelectedExpression()?.expression)return e.name}},dnd:new na(this.debugService),overrideStyles:{listBackground:this.getBackgroundColor()}}),this.tree.setInput(this.debugService),n.D5.bindTo(this.tree.contextKeyService),this._register(this.tree.onContextMenu((e=>this.onContextMenu(e)))),this._register(this.tree.onMouseDblClick((e=>this.onMouseDblClick(e)))),this._register(this.debugService.getModel().onDidChangeWatchExpressions((async e=>{this.watchExpressionsExist.set(this.debugService.getModel().getWatchExpressions().length>0),this.isBodyVisible()?(e&&!e.name&&(Xr=!0),await this.tree.updateChildren(),Xr=!1,e instanceof Ue.A2&&this.tree.reveal(e)):this.needsRefresh=!0}))),this._register(this.debugService.getViewModel().onDidFocusStackFrame((()=>{this.isBodyVisible()?this.watchExpressionsUpdatedScheduler.isScheduled()||this.watchExpressionsUpdatedScheduler.schedule():this.needsRefresh=!0}))),this._register(this.debugService.getViewModel().onWillUpdateViews((()=>{Jr||this.tree.updateChildren()}))),this._register(this.onDidChangeBodyVisibility((e=>{e&&this.needsRefresh&&this.watchExpressionsUpdatedScheduler.schedule()}))),this._register(this.debugService.getViewModel().onDidSelectExpression((e=>{const t=e?.expression;t instanceof Ue.A2||t instanceof Ue._w&&e?.settingWatch?(o=this.tree.options.horizontalScrolling,o&&this.tree.updateOptions({horizontalScrolling:!1}),t.name&&this.tree.rerender(t)):t||void 0===o||(this.tree.updateOptions({horizontalScrolling:o}),o=void 0)}))),this._register(this.debugService.getViewModel().onDidEvaluateLazyExpression((async e=>{e instanceof Ue._w&&this.tree.hasNode(e)&&(await this.tree.updateChildren(e,!1,!0),await this.tree.expand(e))})))}layoutBody(e,t){super.layoutBody(e,t),this.tree.layout(e,t)}focus(){this.tree.domFocus()}collapseAll(){this.tree.collapseAll()}onMouseDblClick(e){if(e.browserEvent.target.className.indexOf("twistie")>=0)return;const t=e.element,i=this.debugService.getViewModel().getSelectedExpression();t instanceof Ue.A2&&t!==i?.expression?this.debugService.getViewModel().setSelectedExpression(t,!1):t||this.debugService.addWatchExpression()}onContextMenu(e){const t=e.element,i=this.tree.getSelection();this.watchItemType.set(t instanceof Ue.A2?"expression":t instanceof Ue._w?"variable":void 0);const s=[],n=t instanceof Ue._w?t.presentationHint?.attributes:void 0;this.variableReadonly.set(!!n&&n.indexOf("readOnly")>=0||!!t?.presentationHint?.lazy),(0,ji.LJ)(this.menu,{arg:t,shouldForwardArgs:!0},s),this.contextMenuService.showContextMenu({getAnchor:()=>e.anchor,getActions:()=>s,getActionsContext:()=>t&&i.includes(t)?i:t?[t]:[]})}};Zr=(0,o.g)([(0,o.f)(1,Yt.i),(0,o.f)(2,n.tn),(0,o.f)(3,fi.d),(0,o.f)(4,x.TG),(0,o.f)(5,_.XH),(0,o.f)(6,C.Ui),(0,o.f)(7,k.i6),(0,o.f)(8,He.v4),(0,o.f)(9,ti.XE),(0,o.f)(10,We.bU),(0,o.f)(11,Ot.co)],Zr);class Yr{getHeight(e){return 22}getTemplateId(e){return e instanceof Ue.A2?ia.ID:qn.ID}}function ea(e){return"function"==typeof e.getConfigurationManager}class ta{hasChildren(e){return ea(e)||e.hasChildren}getChildren(e){if(ea(e)){const t=e,i=t.getModel().getWatchExpressions(),s=t.getViewModel();return Promise.all(i.map((e=>e.name&&!Xr?e.evaluate(s.focusedSession,s.focusedStackFrame,"watch").then((()=>e)):Promise.resolve(e))))}return e.getChildren()}}let ia=class e extends ss{static{this.ID="watchexpression"}constructor(e,t,i,s){super(i,s),this.menuService=e,this.contextKeyService=t}get templateId(){return e.ID}renderElement(e,t,i){super.renderExpressionElement(e.element,e,i)}renderExpression(e,t,i){const s="string"==typeof e.value?`${e.name}:`:e.name;let n;n=e.type?e.type===e.value?e.type:`${e.type}: ${e.value}`:e.value,t.label.set(s,i,n),ts(e,t.value,{showChanged:!0,maxValueLength:1024,showHover:!0,colorize:!0})}getInputBoxOptions(e,t){return t?{initialValue:e.value,ariaLabel:(0,w.NC)("typeNewValue","Type new value"),onFinish:async(t,i)=>{if(i&&t){const i=this.debugService.getViewModel().focusedStackFrame;i&&(e instanceof Ue._w||e instanceof Ue.A2)&&(await e.setExpression(t,i),this.debugService.getViewModel().updateViews())}}}:{initialValue:e.name?e.name:"",ariaLabel:(0,w.NC)("watchExpressionInputAriaLabel","Type watch expression"),placeholder:(0,w.NC)("watchExpressionPlaceholder","Expression to watch"),onFinish:(t,i)=>{i&&t?(this.debugService.renameWatchExpression(e.getId(),t),Jr=!0,this.debugService.getViewModel().updateViews(),Jr=!1):e.name||this.debugService.removeWatchExpressions(e.getId())}}}renderActionBar(e,t){const i=function(e,t){return e.createOverlay([[n.SC.key,void 0!==t.memoryReference],[n.kJ.key,"expression"]])}(this.contextKeyService,t),s=this.menuService.createMenu(Ot.eH.DebugWatchContext,i),o=[],r=t;(0,ji.LJ)(s,{arg:r,shouldForwardArgs:!1},{primary:o,secondary:[]},"inline"),e.clear(),e.context=r,e.push(o,{icon:!0,label:!1})}};ia=(0,o.g)([(0,o.f)(0,Ot.co),(0,o.f)(1,k.i6),(0,o.f)(2,n.tn),(0,o.f)(3,Yt.u)],ia);class sa{getWidgetAriaLabel(){return(0,w.NC)({comment:["Debug is a noun in this context, not a verb."],key:"watchAriaTreeLabel"},"Debug Watch Expressions")}getAriaLabel(e){return e instanceof Ue.A2?(0,w.NC)("watchExpressionAriaLabel","{0}, value {1}",e.name,e.value):(0,w.NC)("watchVariableAriaLabel","{0}, value {1}",e.name,e.value)}}class na{constructor(e){this.debugService=e}onDragOver(e){if(!(e instanceof Qr.kX))return!1;const t=e.elements;return t.length>0&&t[0]instanceof Ue.A2}getDragURI(e){return e instanceof Ue.A2&&e!==this.debugService.getViewModel().getSelectedExpression()?.expression?e.getId():null}getDragLabel(e){if(1===e.length)return e[0].name}drop(e,t){if(!(e instanceof Qr.kX))return;const i=e.elements[0],s=this.debugService.getModel().getWatchExpressions(),n=t instanceof Ue.A2?s.indexOf(t):s.length-1;this.debugService.moveWatchExpression(i.getId(),n)}}(0,Ot.r1)(class extends Gi.Nx{constructor(){super({id:"watch.collapse",viewId:n.Vn,title:(0,w.NC)("collapse","Collapse All"),f1:!1,icon:Ui.lA.collapseAll,precondition:n.Lh,menu:{id:Ot.eH.ViewTitle,order:30,group:"navigation",when:k.Ao.equals("view",n.Vn)}})}runInView(e,t){t.collapseAll()}});const oa="workbench.debug.viewlet.action.addWatchExpression",ra=(0,w.NC)("addWatchExpression","Add Expression");(0,Ot.r1)(class extends Ot.Ke{constructor(){super({id:oa,title:ra,f1:!1,icon:me._L,menu:{id:Ot.eH.ViewTitle,group:"navigation",when:k.Ao.equals("view",n.Vn)}})}run(e){e.get(n.tn).addWatchExpression()}});const aa="workbench.debug.viewlet.action.removeAllWatchExpressions",ca=(0,w.NC)("removeAllWatchExpressions","Remove All Expressions");(0,Ot.r1)(class extends Ot.Ke{constructor(){super({id:aa,title:ca,f1:!1,icon:me.eC,precondition:n.Lh,menu:{id:Ot.eH.ViewTitle,order:20,group:"navigation",when:k.Ao.equals("view",n.Vn)}})}run(e){e.get(n.tn).removeWatchExpressions()}});let da=class{constructor(e,t,i,s){this.debugService=t,this.configurationService=i,this.dialogService=s,e.onBeforeShutdown((async e=>e.veto(this.shouldVetoShutdown(e.reason),"veto.debug")))}shouldVetoShutdown(e){const t=this.debugService.getModel().getSessions().filter((e=>void 0===e.parentSession));return 0!==t.length&&("never"!==this.configurationService.getValue("debug").confirmOnExit&&this.showWindowCloseConfirmation(t.length))}async showWindowCloseConfirmation(e){let t;return t=1===e?w.NC("debug.debugSessionCloseConfirmationSingular","There is an active debug session, are you sure you want to stop it?"):w.NC("debug.debugSessionCloseConfirmationPlural","There are active debug sessions, are you sure you want to stop them?"),!(await this.dialogService.confirm({message:t,type:"warning",primaryButton:w.NC({key:"debug.stop",comment:["&& denotes a mnemonic"]},"&&Stop Debugging")})).confirmed}};da=(0,o.g)([(0,o.f)(0,ae.g),(0,o.f)(1,n.tn),(0,o.f)(2,C.Ui),(0,o.f)(3,ce.Ss)],da);const la=w.NC("debugCategory","Debug");!function(){const e=(0,ei.P6G)("debugTokenExpression.name",{dark:"#c586c0",light:"#9b46b0",hcDark:ei.dRz,hcLight:ei.dRz},"Foreground color for the token names shown in the debug views (ie. the Variables or Watch view)."),t=(0,ei.P6G)("debugTokenExpression.value",{dark:"#cccccc99",light:"#6c6c6ccc",hcDark:ei.dRz,hcLight:ei.dRz},"Foreground color for the token values shown in the debug views (ie. the Variables or Watch view)."),i=(0,ei.P6G)("debugTokenExpression.string",{dark:"#ce9178",light:"#a31515",hcDark:"#f48771",hcLight:"#a31515"},"Foreground color for strings in the debug views (ie. the Variables or Watch view)."),s=(0,ei.P6G)("debugTokenExpression.boolean",{dark:"#4e94ce",light:"#0000ff",hcDark:"#75bdfe",hcLight:"#0000ff"},"Foreground color for booleans in the debug views (ie. the Variables or Watch view)."),n=(0,ei.P6G)("debugTokenExpression.number",{dark:"#b5cea8",light:"#098658",hcDark:"#89d185",hcLight:"#098658"},"Foreground color for numbers in the debug views (ie. the Variables or Watch view)."),o=(0,ei.P6G)("debugTokenExpression.error",{dark:"#f48771",light:"#e51400",hcDark:"#f48771",hcLight:"#e51400"},"Foreground color for expression errors in the debug views (ie. the Variables or Watch view) and for error logs shown in the debug console."),r=(0,ei.P6G)("debugView.exceptionLabelForeground",{dark:ei.dRz,light:"#FFF",hcDark:ei.dRz,hcLight:ei.dRz},"Foreground color for a label shown in the CALL STACK view when the debugger breaks on an exception."),a=(0,ei.P6G)("debugView.exceptionLabelBackground",{dark:"#6C2022",light:"#A31515",hcDark:"#6C2022",hcLight:"#A31515"},"Background color for a label shown in the CALL STACK view when the debugger breaks on an exception."),c=(0,ei.P6G)("debugView.stateLabelForeground",{dark:ei.dRz,light:ei.dRz,hcDark:ei.dRz,hcLight:ei.dRz},"Foreground color for a label in the CALL STACK view showing the current session's or thread's state."),d=(0,ei.P6G)("debugView.stateLabelBackground",{dark:"#88888844",light:"#88888844",hcDark:"#88888844",hcLight:"#88888844"},"Background color for a label in the CALL STACK view showing the current session's or thread's state."),l=(0,ei.P6G)("debugView.valueChangedHighlight",{dark:"#569CD6",light:"#569CD6",hcDark:"#569CD6",hcLight:"#569CD6"},"Color used to highlight value changes in the debug views (ie. in the Variables view)."),u=(0,ei.P6G)("debugConsole.infoForeground",{dark:ei.c63,light:ei.c63,hcDark:ei.dRz,hcLight:ei.dRz},"Foreground color for info messages in debug REPL console."),h=(0,ei.P6G)("debugConsole.warningForeground",{dark:ei.uoC,light:ei.uoC,hcDark:"#008000",hcLight:ei.uoC},"Foreground color for warning messages in debug REPL console."),g=(0,ei.P6G)("debugConsole.errorForeground",{dark:ei.Ido,light:ei.Ido,hcDark:ei.Ido,hcLight:ei.Ido},"Foreground color for error messages in debug REPL console."),p=(0,ei.P6G)("debugConsole.sourceForeground",{dark:ei.dRz,light:ei.dRz,hcDark:ei.dRz,hcLight:ei.dRz},"Foreground color for source filenames in debug REPL console."),b=(0,ei.P6G)("debugConsoleInputIcon.foreground",{dark:ei.dRz,light:ei.dRz,hcDark:ei.dRz,hcLight:ei.dRz},"Foreground color for debug console input marker icon."),m=(0,ei.P6G)("debugIcon.pauseForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},(0,w.NC)("debugIcon.pauseForeground","Debug toolbar icon for pause.")),f=(0,ei.P6G)("debugIcon.stopForeground",{dark:"#F48771",light:"#A1260D",hcDark:"#F48771",hcLight:"#A1260D"},(0,w.NC)("debugIcon.stopForeground","Debug toolbar icon for stop.")),v=(0,ei.P6G)("debugIcon.disconnectForeground",{dark:"#F48771",light:"#A1260D",hcDark:"#F48771",hcLight:"#A1260D"},(0,w.NC)("debugIcon.disconnectForeground","Debug toolbar icon for disconnect.")),S=(0,ei.P6G)("debugIcon.restartForeground",{dark:"#89D185",light:"#388A34",hcDark:"#89D185",hcLight:"#388A34"},(0,w.NC)("debugIcon.restartForeground","Debug toolbar icon for restart.")),C=(0,ei.P6G)("debugIcon.stepOverForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},(0,w.NC)("debugIcon.stepOverForeground","Debug toolbar icon for step over.")),k=(0,ei.P6G)("debugIcon.stepIntoForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},(0,w.NC)("debugIcon.stepIntoForeground","Debug toolbar icon for step into.")),y=(0,ei.P6G)("debugIcon.stepOutForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},(0,w.NC)("debugIcon.stepOutForeground","Debug toolbar icon for step over.")),D=(0,ei.P6G)("debugIcon.continueForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},(0,w.NC)("debugIcon.continueForeground","Debug toolbar icon for continue.")),x=(0,ei.P6G)("debugIcon.stepBackForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},(0,w.NC)("debugIcon.stepBackForeground","Debug toolbar icon for step back."));(0,ti.Ic)(((w,I)=>{const E=w.getColor(ei.g8u),N=w.getColor(ei.qeD),T=w.getColor(ei.Rqy),L=w.getColor(r),_=w.getColor(a),A=w.getColor(c),M=w.getColor(d),B=w.getColor(l),R=w.getColor(ei.lUq);I.addRule(`\n\t\t\t/* Text colour of the call stack row's filename */\n\t\t\t.debug-pane .debug-call-stack .monaco-list-row:not(.selected) .stack-frame > .file .file-name {\n\t\t\t\tcolor: ${T}\n\t\t\t}\n\n\t\t\t/* Line & column number "badge" for selected call stack row */\n\t\t\t.debug-pane .monaco-list-row.selected .line-number {\n\t\t\t\tbackground-color: ${E};\n\t\t\t\tcolor: ${N};\n\t\t\t}\n\n\t\t\t/* Line & column number "badge" for unselected call stack row (basically all other rows) */\n\t\t\t.debug-pane .line-number {\n\t\t\t\tbackground-color: ${E.transparent(.6)};\n\t\t\t\tcolor: ${N.transparent(.6)};\n\t\t\t}\n\n\t\t\t/* State "badge" displaying the active session's current state.\n\t\t\t* Only visible when there are more active debug sessions/threads running.\n\t\t\t*/\n\t\t\t.debug-pane .debug-call-stack .thread > .state.label,\n\t\t\t.debug-pane .debug-call-stack .session > .state.label {\n\t\t\t\tbackground-color: ${M};\n\t\t\t\tcolor: ${A};\n\t\t\t}\n\n\t\t\t/* State "badge" displaying the active session's current state.\n\t\t\t* Only visible when there are more active debug sessions/threads running\n\t\t\t* and thread paused due to a thrown exception.\n\t\t\t*/\n\t\t\t.debug-pane .debug-call-stack .thread > .state.label.exception,\n\t\t\t.debug-pane .debug-call-stack .session > .state.label.exception {\n\t\t\t\tbackground-color: ${_};\n\t\t\t\tcolor: ${L};\n\t\t\t}\n\n\t\t\t/* Info "badge" shown when the debugger pauses due to a thrown exception. */\n\t\t\t.debug-pane .call-stack-state-message > .label.exception {\n\t\t\t\tbackground-color: ${_};\n\t\t\t\tcolor: ${L};\n\t\t\t}\n\n\t\t\t/* Animation of changed values in Debug viewlet */\n\t\t\t@keyframes debugViewletValueChanged {\n\t\t\t\t0%   { background-color: ${B.transparent(0)} }\n\t\t\t\t5%   { background-color: ${B.transparent(.9)} }\n\t\t\t\t100% { background-color: ${B.transparent(.3)} }\n\t\t\t}\n\n\t\t\t.debug-pane .monaco-list-row .expression .value.changed {\n\t\t\t\tbackground-color: ${B.transparent(.3)};\n\t\t\t\tanimation-name: debugViewletValueChanged;\n\t\t\t\tanimation-duration: 1s;\n\t\t\t\tanimation-fill-mode: forwards;\n\t\t\t}\n\n\t\t\t.monaco-list-row .expression .lazy-button:hover {\n\t\t\t\tbackground-color: ${R}\n\t\t\t}\n\t\t`);const F=w.getColor(ei.lRK);F&&I.addRule(`\n\t\t\t.debug-pane .line-number {\n\t\t\t\tborder: 1px solid ${F};\n\t\t\t}\n\t\t\t`),(0,us.c3)(w.type)&&I.addRule(`\n\t\t\t.debug-pane .line-number {\n\t\t\t\tbackground-color: ${E};\n\t\t\t\tcolor: ${N};\n\t\t\t}`);const V=w.getColor(e),P=w.getColor(t),O=w.getColor(i),W=w.getColor(s),H=w.getColor(o),$=w.getColor(n);I.addRule(`\n\t\t\t.monaco-workbench .monaco-list-row .expression .name {\n\t\t\t\tcolor: ${V};\n\t\t\t}\n\n\t\t\t.monaco-workbench .monaco-list-row .expression .value,\n\t\t\t.monaco-workbench .debug-hover-widget .value {\n\t\t\t\tcolor: ${P};\n\t\t\t}\n\n\t\t\t.monaco-workbench .monaco-list-row .expression .value.string,\n\t\t\t.monaco-workbench .debug-hover-widget .value.string {\n\t\t\t\tcolor: ${O};\n\t\t\t}\n\n\t\t\t.monaco-workbench .monaco-list-row .expression .value.boolean,\n\t\t\t.monaco-workbench .debug-hover-widget .value.boolean {\n\t\t\t\tcolor: ${W};\n\t\t\t}\n\n\t\t\t.monaco-workbench .monaco-list-row .expression .error,\n\t\t\t.monaco-workbench .debug-hover-widget .error,\n\t\t\t.monaco-workbench .debug-pane .debug-variables .scope .error {\n\t\t\t\tcolor: ${H};\n\t\t\t}\n\n\t\t\t.monaco-workbench .monaco-list-row .expression .value.number,\n\t\t\t.monaco-workbench .debug-hover-widget .value.number {\n\t\t\t\tcolor: ${$};\n\t\t\t}\n\t\t`);const U=w.getColor(ei.dt_)||ls.Il.fromHex("#80808060"),q=w.getColor(u),z=w.getColor(h),j=w.getColor(g),K=w.getColor(p),G=w.getColor(b);I.addRule(`\n\t\t\t.repl .repl-input-wrapper {\n\t\t\t\tborder-top: 1px solid ${U};\n\t\t\t}\n\n\t\t\t.monaco-workbench .repl .repl-tree .output .expression .value.info {\n\t\t\t\tcolor: ${q};\n\t\t\t}\n\n\t\t\t.monaco-workbench .repl .repl-tree .output .expression .value.warn {\n\t\t\t\tcolor: ${z};\n\t\t\t}\n\n\t\t\t.monaco-workbench .repl .repl-tree .output .expression .value.error {\n\t\t\t\tcolor: ${j};\n\t\t\t}\n\n\t\t\t.monaco-workbench .repl .repl-tree .output .expression .source {\n\t\t\t\tcolor: ${K};\n\t\t\t}\n\n\t\t\t.monaco-workbench .repl .repl-tree .monaco-tl-contents .arrow {\n\t\t\t\tcolor: ${G};\n\t\t\t}\n\t\t`),w.defines(b)||I.addRule("\n\t\t\t\t.monaco-workbench.vs .repl .repl-tree .monaco-tl-contents .arrow {\n\t\t\t\t\topacity: 0.25;\n\t\t\t\t}\n\n\t\t\t\t.monaco-workbench.vs-dark .repl .repl-tree .monaco-tl-contents .arrow {\n\t\t\t\t\topacity: 0.4;\n\t\t\t\t}\n\n\t\t\t\t.monaco-workbench.hc-black .repl .repl-tree .monaco-tl-contents .arrow,\n\t\t\t\t.monaco-workbench.hc-light .repl .repl-tree .monaco-tl-contents .arrow {\n\t\t\t\t\topacity: 1;\n\t\t\t\t}\n\t\t\t");const Q=w.getColor(ps);Q&&I.addRule(`.monaco-workbench ${be.kS.asCSSSelector(me.NA)} { color: ${Q}; }`);const J=w.getColor(m);J&&I.addRule(`.monaco-workbench .part > .title > .title-actions .action-label${be.kS.asCSSSelector(me.cJ)}, .monaco-workbench ${be.kS.asCSSSelector(me.cJ)} { color: ${J}; }`);const X=w.getColor(f);X&&I.addRule(`.monaco-workbench .part > .title > .title-actions .action-label${be.kS.asCSSSelector(me.fR)},.monaco-workbench ${be.kS.asCSSSelector(me.fR)} { color: ${X}; }`);const Z=w.getColor(v);Z&&I.addRule(`.monaco-workbench .part > .title > .title-actions .action-label${be.kS.asCSSSelector(me.DI)},.monaco-workbench .debug-view-content ${be.kS.asCSSSelector(me.DI)}, .monaco-workbench .debug-toolbar ${be.kS.asCSSSelector(me.DI)} { color: ${Z}; }`);const Y=w.getColor(S);Y&&I.addRule(`.monaco-workbench ${be.kS.asCSSSelector(me.gv)}, .monaco-workbench ${be.kS.asCSSSelector(me._d)}, .monaco-workbench .part > .title > .title-actions .action-label${be.kS.asCSSSelector(me.gv)}, .monaco-workbench .part > .title > .title-actions .action-label${be.kS.asCSSSelector(me._d)} { color: ${Y}; }`);const ee=w.getColor(C);ee&&I.addRule(`.monaco-workbench .part > .title > .title-actions .action-label${be.kS.asCSSSelector(me.xv)}, .monaco-workbench ${be.kS.asCSSSelector(me.xv)} { color: ${ee}; }`);const te=w.getColor(k);te&&I.addRule(`.monaco-workbench .part > .title > .title-actions .action-label${be.kS.asCSSSelector(me.Z5)}, .monaco-workbench .part > .title > .title-actions .action-label${be.kS.asCSSSelector(me.Z5)}, .monaco-workbench ${be.kS.asCSSSelector(me.Z5)} { color: ${te}; }`);const ie=w.getColor(y);ie&&I.addRule(`.monaco-workbench .part > .title > .title-actions .action-label${be.kS.asCSSSelector(me.Hp)}, .monaco-workbench .part > .title > .title-actions .action-label${be.kS.asCSSSelector(me.Hp)}, .monaco-workbench ${be.kS.asCSSSelector(me.Hp)} { color: ${ie}; }`);const se=w.getColor(D);se&&I.addRule(`.monaco-workbench .part > .title > .title-actions .action-label${be.kS.asCSSSelector(me.Tl)}, .monaco-workbench ${be.kS.asCSSSelector(me.Tl)}, .monaco-workbench .part > .title > .title-actions .action-label${be.kS.asCSSSelector(me.IO)}, .monaco-workbench ${be.kS.asCSSSelector(me.IO)} { color: ${se}; }`);const ne=w.getColor(x);ne&&I.addRule(`.monaco-workbench .part > .title > .title-actions .action-label${be.kS.asCSSSelector(me.oF)}, .monaco-workbench ${be.kS.asCSSSelector(me.oF)} { color: ${ne}; }`)}))}(),R.B.as(qt.I.Workbench).registerWorkbenchContribution(vo,4),R.B.as(qt.I.Workbench).registerWorkbenchContribution(fs,3),R.B.as(qt.I.Workbench).registerWorkbenchContribution(Ho,4),R.B.as(qt.I.Workbench).registerWorkbenchContribution(Gr,4),R.B.as(qt.I.Workbench).registerWorkbenchContribution(Vo,4),R.B.as(qt.I.Workbench).registerWorkbenchContribution(da,4),R.B.as(Ht.IP.Quickaccess).registerQuickAccessProvider({ctor:wo,prefix:ue.uT,contextKey:"inLaunchConfigurationsPicker",placeholder:w.NC("startDebugPlaceholder","Type the name of a launch configuration to run."),helpEntries:[{description:w.NC("startDebuggingHelp","Start Debugging"),commandId:ue.w8}]}),R.B.as(Ht.IP.Quickaccess).registerQuickAccessProvider({ctor:Qs,prefix:ue.OD,contextKey:"inDebugConsolePicker",placeholder:w.NC("tasksQuickAccessPlaceholder","Type the name of a debug console to open."),helpEntries:[{description:w.NC("tasksQuickAccessHelp","Show All Debug Consoles"),commandId:ue.QE}]}),(0,Pt._K)("editor.contrib.callStack",Wi,1),(0,Pt._K)(n.KI,Ei,1),(0,Pt._K)(n.X,fo,2);const ua=(e,t,i,s)=>{Ot.BH.appendMenuItem(Ot.eH.CommandPalette,{when:k.Ao.and(n.Qe,i),group:la,command:{id:e,title:t,category:ue.w1,precondition:s}})};ua(ue.ST,{value:w.NC("terminateThread","Terminate Thread"),original:"Terminate Thread"},n.hO),ua(ue.xw,ue.kj,n.hO,n.KA.isEqualTo("stopped")),ua(ue.Xs,ue.DP,n.hO,n.KA.isEqualTo("stopped")),ua(ue.WW,ue.Sf,n.hO,k.Ao.and(n.o8,n.hO,n.KA.isEqualTo("stopped"))),ua(ue.GL,ue.lG,n.hO,n.KA.isEqualTo("stopped")),ua(ue.rd,ue.eW,n.hO,n.KA.isEqualTo("running")),ua(ue.De,ue.yk,n.hO,k.Ao.or(n.dU.toNegated(),n.rv)),ua(ue.ZI,ue.pl,n.hO,n.KA.isEqualTo("stopped")),ua(ue.Hn,{value:w.NC({comment:["Debug is a noun in this context, not a verb."],key:"debugFocusConsole"},"Focus on Debug Console View"),original:"Focus on Debug Console View"}),ua(ue.rg,{value:w.NC("jumpToCursor","Jump to Cursor"),original:"Jump to Cursor"},n.dr),ua(ue.rg,{value:w.NC("SetNextStatement","Set Next Statement"),original:"Set Next Statement"},n.dr),ua(rn.ID,{value:rn.LABEL,original:"Run to Cursor"},n.Qe),ua(an.ID,{value:an.LABEL,original:"Evaluate in Debug Console"},n.hO),ua(cn.ID,{value:cn.LABEL,original:"Add to Watch"}),ua(ue.NT,{value:w.NC("inlineBreakpoint","Inline Breakpoint"),original:"Inline Breakpoint"}),ua(ue.w8,ue.xn,k.Ao.and(n.Qe,n.KA.notEqualsTo((0,n.wD)(1)))),ua(ue.Ob,ue.zr),ua(ue.fH,ue.vJ),ua(ue.Re,ue.ss,n.hO),ua(ue.QE,ue.I4),ua(ue.G,ue.Ox),ua(ue.M1,ue.fD,n.hO,n.KA.isEqualTo("stopped")),ua(ue.Py,ue.W4,n.hO,n.KA.isEqualTo("stopped")),ua(ue.QY,ue.SX,n.hO,n.KA.isEqualTo("stopped")),ua(ue.IW,ue.Hp,n.hO,n.KA.isEqualTo("stopped"));const ha=(e,t,i,s,n,o,r="navigation",a)=>{Ot.BH.appendMenuItem(e,{group:r,when:n,order:s,icon:a,command:{id:t,title:i,icon:a,precondition:o}})};ha(Ot.eH.DebugCallStackContext,ue._M,ue.Yl,10,n.fj.isEqualTo("session"),void 0,"3_modification"),ha(Ot.eH.DebugCallStackContext,ue.Sb,ue.XV,20,n.fj.isEqualTo("session"),void 0,"3_modification"),ha(Ot.eH.DebugCallStackContext,ue.O0,ue.SI,21,k.Ao.and(n.fj.isEqualTo("session"),n.uz,n.rv),void 0,"3_modification"),ha(Ot.eH.DebugCallStackContext,ue.De,ue.yk,30,n.fj.isEqualTo("session"),void 0,"3_modification"),ha(Ot.eH.DebugCallStackContext,ue.rd,ue.eW,10,k.Ao.and(n.fj.isEqualTo("thread"),n.KA.isEqualTo("running"))),ha(Ot.eH.DebugCallStackContext,ue.ZI,ue.pl,10,k.Ao.and(n.fj.isEqualTo("thread"),n.KA.isEqualTo("stopped"))),ha(Ot.eH.DebugCallStackContext,ue.xw,ue.kj,20,n.fj.isEqualTo("thread"),n.KA.isEqualTo("stopped")),ha(Ot.eH.DebugCallStackContext,ue.Xs,ue.DP,30,n.fj.isEqualTo("thread"),n.KA.isEqualTo("stopped")),ha(Ot.eH.DebugCallStackContext,ue.GL,ue.lG,40,n.fj.isEqualTo("thread"),n.KA.isEqualTo("stopped")),ha(Ot.eH.DebugCallStackContext,ue.ST,w.NC("terminateThread","Terminate Thread"),10,n.fj.isEqualTo("thread"),void 0,"termination"),ha(Ot.eH.DebugCallStackContext,ue.U8,w.NC("restartFrame","Restart Frame"),10,k.Ao.and(n.fj.isEqualTo("stackFrame"),n.wx),n.ou),ha(Ot.eH.DebugCallStackContext,ue.p3,w.NC("copyStackTrace","Copy Call Stack"),20,n.fj.isEqualTo("stackFrame"),void 0,"3_modification"),ha(Ot.eH.DebugVariablesContext,Gn,w.NC("viewMemory","View Binary Data"),15,n.SC,n.hO,"inline",me.Yi),ha(Ot.eH.DebugVariablesContext,jn,w.NC("setValue","Set Value"),10,k.Ao.or(n.jA,k.Ao.and(n.D7,n.Wx)),n.hs.toNegated(),"3_modification"),ha(Ot.eH.DebugVariablesContext,Kn,w.NC("copyValue","Copy Value"),10,void 0,void 0,"5_cutcopypaste"),ha(Ot.eH.DebugVariablesContext,Yn,w.NC("copyAsExpression","Copy as Expression"),20,n.D7,void 0,"5_cutcopypaste"),ha(Ot.eH.DebugVariablesContext,eo,w.NC("addToWatchExpressions","Add to Watch"),100,n.D7,void 0,"z_commands"),ha(Ot.eH.DebugVariablesContext,Zn,w.NC("breakWhenValueIsRead","Break on Value Read"),200,n.pP,void 0,"z_commands"),ha(Ot.eH.DebugVariablesContext,Jn,w.NC("breakWhenValueChanges","Break on Value Change"),210,n.IA,void 0,"z_commands"),ha(Ot.eH.DebugVariablesContext,Xn,w.NC("breakWhenValueIsAccessed","Break on Value Access"),220,n.DD,void 0,"z_commands"),ha(Ot.eH.DebugWatchContext,oa,ra,10,void 0,void 0,"3_modification"),ha(Ot.eH.DebugWatchContext,ue.jg,w.NC("editWatchExpression","Edit Expression"),20,n.kJ.isEqualTo("expression"),void 0,"3_modification"),ha(Ot.eH.DebugWatchContext,ue.Xg,w.NC("setValue","Set Value"),30,k.Ao.or(k.Ao.and(n.kJ.isEqualTo("expression"),n.Wx),k.Ao.and(n.kJ.isEqualTo("variable"),n.jA)),n.hs.toNegated(),"3_modification"),ha(Ot.eH.DebugWatchContext,Kn,w.NC("copyValue","Copy Value"),40,k.Ao.or(n.kJ.isEqualTo("expression"),n.kJ.isEqualTo("variable")),n.hO,"3_modification"),ha(Ot.eH.DebugWatchContext,Gn,w.NC("viewMemory","View Binary Data"),10,n.SC,void 0,"inline",me.Yi),ha(Ot.eH.DebugWatchContext,ue.Vf,w.NC("removeWatchExpression","Remove Expression"),20,n.kJ.isEqualTo("expression"),void 0,"inline",me.iO),ha(Ot.eH.DebugWatchContext,aa,ca,20,void 0,void 0,"z_commands"),Ot.BH.appendMenuItem(Ot.eH.EditorTitle,{submenu:Ot.eH.EditorTitleRun,rememberDefaultAction:!0,title:{value:w.NC("run","Run or Debug..."),original:"Run or Debug..."},icon:me.xc,group:"navigation",order:-1}),Ot.BH.appendMenuItem(Ot.eH.MenubarMainMenu,{submenu:Ot.eH.MenubarDebugMenu,title:{value:"Run",original:"Run",mnemonicTitle:w.NC({key:"mRun",comment:["&& denotes a mnemonic"]},"&&Run")},order:6}),Ot.BH.appendMenuItem(Ot.eH.MenubarNewBreakpointMenu,{group:"1_breakpoints",command:{id:ue.NT,title:w.NC({key:"miInlineBreakpoint",comment:["&& denotes a mnemonic"]},"Inline Breakp&&oint")},order:2,when:n.Qe});const ga=R.B.as(_.IP.ViewContainersRegistry).registerViewContainer({id:n.Os,title:w.NC({comment:["Debug is a noun in this context, not a verb."],key:"debugPanel"},"Debug Console"),icon:me.v1,ctorDescriptor:new s.M(Ut.XV,[n.Os,{mergeViewWithContainerWhenSingleView:!0}]),storageId:n.Os,hideIfEmpty:!0,order:2},1,{doNotRegisterOpenCommand:!0});R.B.as(_.IP.ViewsRegistry).registerViews([{id:n.FT,name:w.NC({comment:["Debug is a noun in this context, not a verb."],key:"debugPanel"},"Debug Console"),containerIcon:me.v1,canToggleVisibility:!1,canMoveView:!0,when:n.Qe,ctorDescriptor:new s.M(Rr),openCommandActionDescriptor:{id:"workbench.debug.action.toggleRepl",mnemonicTitle:w.NC({key:"miToggleDebugConsole",comment:["&& denotes a mnemonic"]},"De&&bug Console"),keybindings:{primary:3127},order:2}}],ga);const pa=R.B.as(_.IP.ViewContainersRegistry).registerViewContainer({id:n.f3,title:{value:w.NC("run and debug","Run and Debug"),original:"Run and Debug"},openCommandActionDescriptor:{id:n.f3,mnemonicTitle:w.NC({key:"miViewRun",comment:["&& denotes a mnemonic"]},"&&Run"),keybindings:{primary:3106},order:3},ctorDescriptor:new s.M(Io),icon:me.Wd,alwaysUseContainerInfo:!0,order:3},0),ba=R.B.as(_.IP.ViewsRegistry);ba.registerViews([{id:n.sk,name:w.NC("variables","Variables"),containerIcon:me.fC,ctorDescriptor:new s.M(Fn),order:10,weight:40,canToggleVisibility:!0,canMoveView:!0,focusCommand:{id:"workbench.debug.action.focusVariablesView"},when:n.Kw.isEqualTo("default")}],pa),ba.registerViews([{id:n.Vn,name:w.NC("watch","Watch"),containerIcon:me.WF,ctorDescriptor:new s.M(Zr),order:20,weight:10,canToggleVisibility:!0,canMoveView:!0,focusCommand:{id:"workbench.debug.action.focusWatchView"},when:n.Kw.isEqualTo("default")}],pa),ba.registerViews([{id:n.Vw,name:w.NC("callStack","Call Stack"),containerIcon:me.Dt,ctorDescriptor:new s.M(Ns),order:30,weight:30,canToggleVisibility:!0,canMoveView:!0,focusCommand:{id:"workbench.debug.action.focusCallStackView"},when:n.Kw.isEqualTo("default")}],pa),ba.registerViews([{id:n.Ww,name:w.NC("breakpoints","Breakpoints"),containerIcon:me.UO,ctorDescriptor:new s.M(ni.xY),order:40,weight:20,canToggleVisibility:!0,canMoveView:!0,focusCommand:{id:"workbench.debug.action.focusBreakpointsView"},when:k.Ao.or(n.LK,n.Kw.isEqualTo("default"),n.$N)}],pa),ba.registerViews([{id:n.Vm,name:w.NC("loadedScripts","Loaded Scripts"),containerIcon:me.Gx,ctorDescriptor:new s.M(Qo),order:35,weight:5,canToggleVisibility:!0,canMoveView:!0,collapsed:!0,when:k.Ao.and(n.NJ,n.Kw.isEqualTo("default"))}],pa),R.B.as(_t.bS.EditorPane).registerEditorPane($t.gS.create(Mo,n.xG,w.NC("disassembly","Disassembly")),[new s.M(St.n)]),R.B.as(Wt.IP.Configuration).registerConfiguration({id:"debug",order:20,title:w.NC("debugConfigurationTitle","Debug"),type:"object",properties:{"debug.allowBreakpointsEverywhere":{type:"boolean",description:w.NC({comment:["This is the description for a setting"],key:"allowBreakpointsEverywhere"},"Allow setting breakpoints in any file."),default:!1},"debug.openExplorerOnEnd":{type:"boolean",description:w.NC({comment:["This is the description for a setting"],key:"openExplorerOnEnd"},"Automatically open the explorer view at the end of a debug session."),default:!1},"debug.inlineValues":{type:"string",enum:["on","off","auto"],description:w.NC({comment:["This is the description for a setting"],key:"inlineValues"},"Show variable values inline in editor while debugging."),enumDescriptions:[w.NC("inlineValues.on","Always show variable values inline in editor while debugging."),w.NC("inlineValues.off","Never show variable values inline in editor while debugging."),w.NC("inlineValues.focusNoScroll","Show variable values inline in editor while debugging when the language supports inline value locations.")],default:"auto"},"debug.toolBarLocation":{enum:["floating","docked","hidden"],markdownDescription:w.NC({comment:["This is the description for a setting"],key:"toolBarLocation"},"Controls the location of the debug toolbar. Either `floating` in all views, `docked` in the debug view, or `hidden`."),default:"floating"},"debug.showInStatusBar":{enum:["never","always","onFirstSessionStart"],enumDescriptions:[w.NC("never","Never show debug in Status bar"),w.NC("always","Always show debug in Status bar"),w.NC("onFirstSessionStart","Show debug in Status bar only after debug was started for the first time")],description:w.NC({comment:["This is the description for a setting"],key:"showInStatusBar"},"Controls when the debug Status bar should be visible."),default:"onFirstSessionStart"},"debug.internalConsoleOptions":n._u,"debug.console.closeOnEnd":{type:"boolean",description:w.NC("debug.console.closeOnEnd","Controls if the Debug Console should be automatically closed when the debug session ends."),default:!1},"debug.terminal.clearBeforeReusing":{type:"boolean",description:w.NC({comment:["This is the description for a setting"],key:"debug.terminal.clearBeforeReusing"},"Before starting a new debug session in an integrated or external terminal, clear the terminal."),default:!1},"debug.openDebug":{enum:["neverOpen","openOnSessionStart","openOnFirstSessionStart","openOnDebugBreak"],default:"openOnDebugBreak",description:w.NC("openDebug","Controls when the debug view should open.")},"debug.showSubSessionsInToolBar":{type:"boolean",description:w.NC({comment:["This is the description for a setting"],key:"showSubSessionsInToolBar"},"Controls whether the debug sub-sessions are shown in the debug tool bar. When this setting is false the stop command on a sub-session will also stop the parent session."),default:!1},"debug.console.fontSize":{type:"number",description:w.NC("debug.console.fontSize","Controls the font size in pixels in the Debug Console."),default:Ve.dz?12:14},"debug.console.fontFamily":{type:"string",description:w.NC("debug.console.fontFamily","Controls the font family in the Debug Console."),default:"default"},"debug.console.lineHeight":{type:"number",description:w.NC("debug.console.lineHeight","Controls the line height in pixels in the Debug Console. Use 0 to compute the line height from the font size."),default:0},"debug.console.wordWrap":{type:"boolean",description:w.NC("debug.console.wordWrap","Controls if the lines should wrap in the Debug Console."),default:!0},"debug.console.historySuggestions":{type:"boolean",description:w.NC("debug.console.historySuggestions","Controls if the Debug Console should suggest previously typed input."),default:!0},"debug.console.collapseIdenticalLines":{type:"boolean",description:w.NC("debug.console.collapseIdenticalLines","Controls if the Debug Console should collapse identical lines and show a number of occurrences with a badge."),default:!0},"debug.console.acceptSuggestionOnEnter":{enum:["off","on"],description:w.NC("debug.console.acceptSuggestionOnEnter","Controls whether suggestions should be accepted on Enter in the Debug Console. Enter is also used to evaluate whatever is typed in the Debug Console."),default:"off"},launch:{type:"object",description:w.NC({comment:["This is the description for a setting"],key:"launch"},"Global debug launch configuration. Should be used as an alternative to 'launch.json' that is shared across workspaces."),default:{configurations:[],compounds:[]},$ref:K.yY},"debug.focusWindowOnBreak":{type:"boolean",description:w.NC("debug.focusWindowOnBreak","Controls whether the workbench window should be focused when the debugger breaks."),default:!0},"debug.focusEditorOnBreak":{type:"boolean",description:w.NC("debug.focusEditorOnBreak","Controls whether the editor should be focused when the debugger breaks."),default:!0},"debug.onTaskErrors":{enum:["debugAnyway","showErrors","prompt","abort"],enumDescriptions:[w.NC("debugAnyway","Ignore task errors and start debugging."),w.NC("showErrors","Show the Problems view and do not start debugging."),w.NC("prompt","Prompt user."),w.NC("cancel","Cancel debugging.")],description:w.NC("debug.onTaskErrors","Controls what to do when errors are encountered after running a preLaunchTask."),default:"prompt"},"debug.showBreakpointsInOverviewRuler":{type:"boolean",description:w.NC({comment:["This is the description for a setting"],key:"showBreakpointsInOverviewRuler"},"Controls whether breakpoints should be shown in the overview ruler."),default:!1},"debug.showInlineBreakpointCandidates":{type:"boolean",description:w.NC({comment:["This is the description for a setting"],key:"showInlineBreakpointCandidates"},"Controls whether inline breakpoints candidate decorations should be shown in the editor while debugging."),default:!0},"debug.saveBeforeStart":{description:w.NC("debug.saveBeforeStart","Controls what editors to save before starting a debug session."),enum:["allEditorsInActiveGroup","nonUntitledEditorsInActiveGroup","none"],enumDescriptions:[w.NC("debug.saveBeforeStart.allEditorsInActiveGroup","Save all editors in the active group before starting a debug session."),w.NC("debug.saveBeforeStart.nonUntitledEditorsInActiveGroup","Save all editors in the active group except untitled ones before starting a debug session."),w.NC("debug.saveBeforeStart.none","Don't save any editors before starting a debug session.")],default:"allEditorsInActiveGroup",scope:5},"debug.confirmOnExit":{description:w.NC("debug.confirmOnExit","Controls whether to confirm when the window closes if there are active debug sessions."),type:"string",enum:["never","always"],enumDescriptions:[w.NC("debug.confirmOnExit.never","Never confirm."),w.NC("debug.confirmOnExit.always","Always confirm if there are debug sessions.")],default:"never"},"debug.disassemblyView.showSourceCode":{type:"boolean",default:!0,description:w.NC("debug.disassemblyView.showSourceCode","Show Source Code in Disassembly View.")},"debug.autoExpandLazyVariables":{type:"boolean",default:!1,description:w.NC("debug.autoExpandLazyVariables","Automatically show values for variables that are lazily resolved by the debugger, such as getters.")},"debug.enableStatusBarColor":{type:"boolean",description:w.NC("debug.enableStatusBarColor","Color status bar when debugger is active"),default:!0}}});const ma=Dt.prototype.showError;function fa(){return{...(0,Ft.Z)(),[Tt.p.toString()]:new s.M(Nt,[],!0),[n.tn.toString()]:new s.M(Dt,[],!0),[P.qb.toString()]:new s.M(Rt,[],!0)}}Dt.prototype.showError=function(e,t){return ma.call(this,e,t,!1)}},92846:(e,t,i)=>{i.d(t,{C:()=>p});var s=i(80855),n=i(65321),o=i(59069),r=i(76033),a=i(98324),c=i(60961),d=i(93983),l=i(91847),u=i(59422),h=i(97781),g=i(31106);let p=class extends r.YH{get onDidChangeDropdownVisibility(){return this._dropdown.onDidChangeVisibility}constructor(e,t,i,s,n,o,r,d,l,u,h){super(null,e),this._contextMenuProvider=n,this._options=o,this._container=null,this._dropdownContainer=null,this._primaryAction=new c.Mm(e,void 0,r,d,l,u,n,h),this._dropdown=new a.C(t,i,this._contextMenuProvider,{menuAsChild:!0,classNames:s?["codicon","codicon-chevron-down",s]:["codicon","codicon-chevron-down"],keybindingProvider:this._options?.getKeyBinding})}setActionContext(e){super.setActionContext(e),this._primaryAction.setActionContext(e),this._dropdown.setActionContext(e)}render(e){this._container=e,super.render(this._container),this._container.classList.add("monaco-dropdown-with-primary");const t=n.$(".action-container");this._primaryAction.render(n.R3(this._container,t)),this._dropdownContainer=n.$(".dropdown-action-container"),this._dropdown.render(n.R3(this._container,this._dropdownContainer)),this._register(n.nm(t,n.tw.KEY_DOWN,(e=>{const t=new o.y1(e);t.equals(17)&&(this._primaryAction.element.tabIndex=-1,this._dropdown.focus(),t.stopPropagation())}))),this._register(n.nm(this._dropdownContainer,n.tw.KEY_DOWN,(e=>{const t=new o.y1(e);t.equals(15)&&(this._primaryAction.element.tabIndex=0,this._dropdown.setFocusable(!1),this._primaryAction.element?.focus(),t.stopPropagation())})))}focus(e){e?this._dropdown.focus():(this._primaryAction.element.tabIndex=0,this._primaryAction.element.focus())}blur(){this._primaryAction.element.tabIndex=-1,this._dropdown.blur(),this._container.blur()}setFocusable(e){e?this._primaryAction.element.tabIndex=0:(this._primaryAction.element.tabIndex=-1,this._dropdown.setFocusable(!1))}update(e,t,i){this._dropdown.dispose(),this._dropdown=new a.C(e,t,this._contextMenuProvider,{menuAsChild:!0,classNames:["codicon",i||"codicon-chevron-down"]}),this._dropdownContainer&&this._dropdown.render(this._dropdownContainer)}dispose(){this._primaryAction.dispose(),this._dropdown.dispose(),super.dispose()}};p=(0,s.g)([(0,s.f)(6,l.d),(0,s.f)(7,u.lT),(0,s.f)(8,d.i6),(0,s.f)(9,h.XE),(0,s.f)(10,g.F7)],p)},49594:(e,t,i)=>{i.d(t,{G:()=>n,s:()=>s});var s,n,o=i(93983);!function(e){e.MARKERS_CONTAINER_ID="workbench.panel.markers",e.MARKERS_VIEW_ID="workbench.panel.markers.view",e.MARKERS_VIEW_STORAGE_ID="workbench.panel.markers",e.MARKER_COPY_ACTION_ID="problems.action.copy",e.MARKER_COPY_MESSAGE_ACTION_ID="problems.action.copyMessage",e.RELATED_INFORMATION_COPY_MESSAGE_ACTION_ID="problems.action.copyRelatedInformationMessage",e.FOCUS_PROBLEMS_FROM_FILTER="problems.action.focusProblemsFromFilter",e.MARKERS_VIEW_FOCUS_FILTER="problems.action.focusFilter",e.MARKERS_VIEW_CLEAR_FILTER_TEXT="problems.action.clearFilterText",e.MARKERS_VIEW_SHOW_MULTILINE_MESSAGE="problems.action.showMultilineMessage",e.MARKERS_VIEW_SHOW_SINGLELINE_MESSAGE="problems.action.showSinglelineMessage",e.MARKER_OPEN_ACTION_ID="problems.action.open",e.MARKER_OPEN_SIDE_ACTION_ID="problems.action.openToSide",e.MARKER_SHOW_PANEL_ID="workbench.action.showErrorsWarnings",e.MARKER_SHOW_QUICK_FIX="problems.action.showQuickFixes",e.TOGGLE_MARKERS_VIEW_ACTION_ID="workbench.actions.view.toggleProblems"}(s||(s={})),function(e){e.MarkersViewModeContextKey=new o.uy("problemsViewMode","tree"),e.MarkersTreeVisibilityContextKey=new o.uy("problemsVisibility",!1),e.MarkerFocusContextKey=new o.uy("problemFocus",!1),e.MarkerViewFilterFocusContextKey=new o.uy("problemsFilterFocus",!1),e.RelatedInformationFocusContextKey=new o.uy("relatedInformationFocus",!1),e.ShowErrorsFilterContextKey=new o.uy("problems.filter.errors",!0),e.ShowWarningsFilterContextKey=new o.uy("problems.filter.warnings",!0),e.ShowInfoFilterContextKey=new o.uy("problems.filter.info",!0),e.ShowActiveFileFilterContextKey=new o.uy("problems.filter.activeFile",!1),e.ShowExcludedFilesFilterContextKey=new o.uy("problems.filter.excludedFiles",!0)}(n||(n={}))},10469:(e,t,i)=>{i.d(t,{$S:()=>c,A6:()=>x,Bf:()=>D,FG:()=>E,G:()=>C,Nj:()=>o,Nr:()=>m,QN:()=>y,ao:()=>k,at:()=>u,eS:()=>f,eZ:()=>w,ec:()=>S,ek:()=>T,el:()=>I,iF:()=>N,kd:()=>a,l3:()=>r,li:()=>b,nT:()=>l,oL:()=>h,p7:()=>g,qz:()=>v,v7:()=>d,yY:()=>p});var s=i(33108),n=i(72065);const o=".vscode",r="settings",a=`${o}/${r}.json`,c="vscode://schemas/settings/default",d="vscode://schemas/settings/user",l="vscode://schemas/settings/profile",u="vscode://schemas/settings/machine",h="vscode://schemas/settings/workspace",g="vscode://schemas/settings/folder",p="vscode://schemas/launch",b="vscode://schemas/tasks",m=[1],f=[2,3,4,5,6],v=[3,4,5],w=[1,...v],S=[2,3,4,5,6],C=[3,4,5,6],k=[4,5,6],y="tasks",D="launch",x=Object.create(null);x[y]=`${o}/${y}.json`,x[D]=`${o}/${D}.json`;const I=Object.create(null);I[y]=`${y}.json`;const E=(0,n.LO)(s.Ui),N='{\n\t"version": "2.0.0",\n\t"tasks": []\n}',T="workbench.settings.applyToAllProfiles"}}]);
//# sourceMappingURL=109.bundle.js.map