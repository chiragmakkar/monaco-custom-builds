(self.webpackChunkmonaco_custom_bundle=self.webpackChunkmonaco_custom_bundle||[]).push([[685],{12320:e=>{var t;self,t=()=>(()=>{"use strict";var e={4567:function(e,t,i){var n=this&&this.__decorate||function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},s=this&&this.__param||function(e,t){return function(i,n){t(i,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.AccessibilityManager=void 0;const r=i(9042),o=i(6114),a=i(9924),c=i(844),l=i(5596),h=i(4725),d=i(3656);let u=class extends c.Disposable{constructor(e,t){super(),this._terminal=e,this._renderService=t,this._liveRegionLineCount=0,this._charsToConsume=[],this._charsToAnnounce="",this._accessibilityContainer=document.createElement("div"),this._accessibilityContainer.classList.add("xterm-accessibility"),this._rowContainer=document.createElement("div"),this._rowContainer.setAttribute("role","list"),this._rowContainer.classList.add("xterm-accessibility-tree"),this._rowElements=[];for(let e=0;e<this._terminal.rows;e++)this._rowElements[e]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[e]);if(this._topBoundaryFocusListener=e=>this._handleBoundaryFocus(e,0),this._bottomBoundaryFocusListener=e=>this._handleBoundaryFocus(e,1),this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions(),this._accessibilityContainer.appendChild(this._rowContainer),this._liveRegion=document.createElement("div"),this._liveRegion.classList.add("live-region"),this._liveRegion.setAttribute("aria-live","assertive"),this._accessibilityContainer.appendChild(this._liveRegion),this._liveRegionDebouncer=this.register(new a.TimeBasedDebouncer(this._announceCharacters.bind(this))),!this._terminal.element)throw new Error("Cannot enable accessibility before Terminal.open");this._terminal.element.insertAdjacentElement("afterbegin",this._accessibilityContainer),this.register(this._liveRegionDebouncer),this.register(this._terminal.onResize((e=>this._handleResize(e.rows)))),this.register(this._terminal.onRender((e=>this._refreshRows(e.start,e.end)))),this.register(this._terminal.onScroll((()=>this._refreshRows()))),this.register(this._terminal.onA11yChar((e=>this._handleChar(e)))),this.register(this._terminal.onLineFeed((()=>this._handleChar("\n")))),this.register(this._terminal.onA11yTab((e=>this._handleTab(e)))),this.register(this._terminal.onKey((e=>this._handleKey(e.key)))),this.register(this._terminal.onBlur((()=>this._clearLiveRegion()))),this.register(this._renderService.onDimensionsChange((()=>this._refreshRowsDimensions()))),this._screenDprMonitor=new l.ScreenDprMonitor(window),this.register(this._screenDprMonitor),this._screenDprMonitor.setListener((()=>this._refreshRowsDimensions())),this.register((0,d.addDisposableDomListener)(window,"resize",(()=>this._refreshRowsDimensions()))),this._refreshRows(),this.register((0,c.toDisposable)((()=>{this._accessibilityContainer.remove(),this._rowElements.length=0})))}_handleTab(e){for(let t=0;t<e;t++)this._handleChar(" ")}_handleChar(e){this._liveRegionLineCount<21&&(this._charsToConsume.length>0?this._charsToConsume.shift()!==e&&(this._charsToAnnounce+=e):this._charsToAnnounce+=e,"\n"===e&&(this._liveRegionLineCount++,21===this._liveRegionLineCount&&(this._liveRegion.textContent+=r.tooMuchOutput)),o.isMac&&this._liveRegion.textContent&&this._liveRegion.textContent.length>0&&!this._liveRegion.parentNode&&setTimeout((()=>{this._accessibilityContainer.appendChild(this._liveRegion)}),0))}_clearLiveRegion(){this._liveRegion.textContent="",this._liveRegionLineCount=0,o.isMac&&this._liveRegion.remove()}_handleKey(e){this._clearLiveRegion(),/\p{Control}/u.test(e)||this._charsToConsume.push(e)}_refreshRows(e,t){this._liveRegionDebouncer.refresh(e,t,this._terminal.rows)}_announceCharacters(){0!==this._charsToAnnounce.length&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")}_handleBoundaryFocus(e,t){const i=e.target,n=this._rowElements[0===t?1:this._rowElements.length-2];if(i.getAttribute("aria-posinset")===(0===t?"1":`${this._terminal.buffer.lines.length}`))return;if(e.relatedTarget!==n)return;let s,r;if(0===t?(s=i,r=this._rowElements.pop(),this._rowContainer.removeChild(r)):(s=this._rowElements.shift(),r=i,this._rowContainer.removeChild(s)),s.removeEventListener("focus",this._topBoundaryFocusListener),r.removeEventListener("focus",this._bottomBoundaryFocusListener),0===t){const e=this._createAccessibilityTreeNode();this._rowElements.unshift(e),this._rowContainer.insertAdjacentElement("afterbegin",e)}else{const e=this._createAccessibilityTreeNode();this._rowElements.push(e),this._rowContainer.appendChild(e)}this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(0===t?-1:1),this._rowElements[0===t?1:this._rowElements.length-2].focus(),e.preventDefault(),e.stopImmediatePropagation()}_handleResize(e){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(let e=this._rowContainer.children.length;e<this._terminal.rows;e++)this._rowElements[e]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[e]);for(;this._rowElements.length>e;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()}_createAccessibilityTreeNode(){const e=document.createElement("div");return e.setAttribute("role","listitem"),e.tabIndex=-1,this._refreshRowDimensions(e),e}_refreshRowsDimensions(){if(this._renderService.dimensions.css.cell.height){this._accessibilityContainer.style.width=`${this._renderService.dimensions.css.canvas.width}px`,this._rowElements.length!==this._terminal.rows&&this._handleResize(this._terminal.rows);for(let e=0;e<this._terminal.rows;e++)this._refreshRowDimensions(this._rowElements[e])}}_refreshRowDimensions(e){e.style.height=`${this._renderService.dimensions.css.cell.height}px`}};u=n([s(1,h.IRenderService)],u),t.AccessibilityManager=u},3614:(e,t)=>{function i(e){return e.replace(/\r?\n/g,"\r")}function n(e,t){return t?"[200~"+e+"[201~":e}function s(e,t,s){e=n(e=i(e),s.decPrivateModes.bracketedPasteMode),s.triggerDataEvent(e,!0),t.value=""}function r(e,t,i){const n=i.getBoundingClientRect(),s=e.clientX-n.left-10,r=e.clientY-n.top-10;t.style.width="20px",t.style.height="20px",t.style.left=`${s}px`,t.style.top=`${r}px`,t.style.zIndex="1000",t.focus()}Object.defineProperty(t,"__esModule",{value:!0}),t.rightClickHandler=t.moveTextAreaUnderMouseCursor=t.paste=t.handlePasteEvent=t.copyHandler=t.bracketTextForPaste=t.prepareTextForTerminal=void 0,t.prepareTextForTerminal=i,t.bracketTextForPaste=n,t.copyHandler=function(e,t){e.clipboardData&&e.clipboardData.setData("text/plain",t.selectionText),e.preventDefault()},t.handlePasteEvent=function(e,t,i){e.stopPropagation(),e.clipboardData&&s(e.clipboardData.getData("text/plain"),t,i)},t.paste=s,t.moveTextAreaUnderMouseCursor=r,t.rightClickHandler=function(e,t,i,n,s){r(e,t,i),s&&n.rightClickSelect(e),t.value=n.selectionText,t.select()}},7239:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ColorContrastCache=void 0;const n=i(1505);t.ColorContrastCache=class{constructor(){this._color=new n.TwoKeyMap,this._css=new n.TwoKeyMap}setCss(e,t,i){this._css.set(e,t,i)}getCss(e,t){return this._css.get(e,t)}setColor(e,t,i){this._color.set(e,t,i)}getColor(e,t){return this._color.get(e,t)}clear(){this._color.clear(),this._css.clear()}}},3656:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addDisposableDomListener=void 0,t.addDisposableDomListener=function(e,t,i,n){e.addEventListener(t,i,n);let s=!1;return{dispose:()=>{s||(s=!0,e.removeEventListener(t,i,n))}}}},6465:function(e,t,i){var n=this&&this.__decorate||function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},s=this&&this.__param||function(e,t){return function(i,n){t(i,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.Linkifier2=void 0;const r=i(2585),o=i(8460),a=i(844),c=i(3656);let l=class extends a.Disposable{constructor(e){super(),this._bufferService=e,this._linkProviders=[],this._linkCacheDisposables=[],this._isMouseOut=!0,this._wasResized=!1,this._activeLine=-1,this._onShowLinkUnderline=this.register(new o.EventEmitter),this.onShowLinkUnderline=this._onShowLinkUnderline.event,this._onHideLinkUnderline=this.register(new o.EventEmitter),this.onHideLinkUnderline=this._onHideLinkUnderline.event,this.register((0,a.getDisposeArrayDisposable)(this._linkCacheDisposables)),this.register((0,a.toDisposable)((()=>{this._lastMouseEvent=void 0}))),this.register(this._bufferService.onResize((()=>{this._clearCurrentLink(),this._wasResized=!0})))}get currentLink(){return this._currentLink}registerLinkProvider(e){return this._linkProviders.push(e),{dispose:()=>{const t=this._linkProviders.indexOf(e);-1!==t&&this._linkProviders.splice(t,1)}}}attachToDom(e,t,i){this._element=e,this._mouseService=t,this._renderService=i,this.register((0,c.addDisposableDomListener)(this._element,"mouseleave",(()=>{this._isMouseOut=!0,this._clearCurrentLink()}))),this.register((0,c.addDisposableDomListener)(this._element,"mousemove",this._handleMouseMove.bind(this))),this.register((0,c.addDisposableDomListener)(this._element,"mousedown",this._handleMouseDown.bind(this))),this.register((0,c.addDisposableDomListener)(this._element,"mouseup",this._handleMouseUp.bind(this)))}_handleMouseMove(e){if(this._lastMouseEvent=e,!this._element||!this._mouseService)return;const t=this._positionFromMouseEvent(e,this._element,this._mouseService);if(!t)return;this._isMouseOut=!1;const i=e.composedPath();for(let e=0;e<i.length;e++){const t=i[e];if(t.classList.contains("xterm"))break;if(t.classList.contains("xterm-hover"))return}this._lastBufferCell&&t.x===this._lastBufferCell.x&&t.y===this._lastBufferCell.y||(this._handleHover(t),this._lastBufferCell=t)}_handleHover(e){if(this._activeLine!==e.y||this._wasResized)return this._clearCurrentLink(),this._askForLink(e,!1),void(this._wasResized=!1);this._currentLink&&this._linkAtPosition(this._currentLink.link,e)||(this._clearCurrentLink(),this._askForLink(e,!0))}_askForLink(e,t){var i,n;this._activeProviderReplies&&t||(null===(i=this._activeProviderReplies)||void 0===i||i.forEach((e=>{null==e||e.forEach((e=>{e.link.dispose&&e.link.dispose()}))})),this._activeProviderReplies=new Map,this._activeLine=e.y);let s=!1;for(const[i,r]of this._linkProviders.entries())t?(null===(n=this._activeProviderReplies)||void 0===n?void 0:n.get(i))&&(s=this._checkLinkProviderResult(i,e,s)):r.provideLinks(e.y,(t=>{var n,r;if(this._isMouseOut)return;const o=null==t?void 0:t.map((e=>({link:e})));null===(n=this._activeProviderReplies)||void 0===n||n.set(i,o),s=this._checkLinkProviderResult(i,e,s),(null===(r=this._activeProviderReplies)||void 0===r?void 0:r.size)===this._linkProviders.length&&this._removeIntersectingLinks(e.y,this._activeProviderReplies)}))}_removeIntersectingLinks(e,t){const i=new Set;for(let n=0;n<t.size;n++){const s=t.get(n);if(s)for(let t=0;t<s.length;t++){const n=s[t],r=n.link.range.start.y<e?0:n.link.range.start.x,o=n.link.range.end.y>e?this._bufferService.cols:n.link.range.end.x;for(let e=r;e<=o;e++){if(i.has(e)){s.splice(t--,1);break}i.add(e)}}}}_checkLinkProviderResult(e,t,i){var n;if(!this._activeProviderReplies)return i;const s=this._activeProviderReplies.get(e);let r=!1;for(let t=0;t<e;t++)this._activeProviderReplies.has(t)&&!this._activeProviderReplies.get(t)||(r=!0);if(!r&&s){const e=s.find((e=>this._linkAtPosition(e.link,t)));e&&(i=!0,this._handleNewLink(e))}if(this._activeProviderReplies.size===this._linkProviders.length&&!i)for(let e=0;e<this._activeProviderReplies.size;e++){const s=null===(n=this._activeProviderReplies.get(e))||void 0===n?void 0:n.find((e=>this._linkAtPosition(e.link,t)));if(s){i=!0,this._handleNewLink(s);break}}return i}_handleMouseDown(){this._mouseDownLink=this._currentLink}_handleMouseUp(e){if(!this._element||!this._mouseService||!this._currentLink)return;const t=this._positionFromMouseEvent(e,this._element,this._mouseService);t&&this._mouseDownLink===this._currentLink&&this._linkAtPosition(this._currentLink.link,t)&&this._currentLink.link.activate(e,this._currentLink.link.text)}_clearCurrentLink(e,t){this._element&&this._currentLink&&this._lastMouseEvent&&(!e||!t||this._currentLink.link.range.start.y>=e&&this._currentLink.link.range.end.y<=t)&&(this._linkLeave(this._element,this._currentLink.link,this._lastMouseEvent),this._currentLink=void 0,(0,a.disposeArray)(this._linkCacheDisposables))}_handleNewLink(e){if(!this._element||!this._lastMouseEvent||!this._mouseService)return;const t=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);t&&this._linkAtPosition(e.link,t)&&(this._currentLink=e,this._currentLink.state={decorations:{underline:void 0===e.link.decorations||e.link.decorations.underline,pointerCursor:void 0===e.link.decorations||e.link.decorations.pointerCursor},isHovered:!0},this._linkHover(this._element,e.link,this._lastMouseEvent),e.link.decorations={},Object.defineProperties(e.link.decorations,{pointerCursor:{get:()=>{var e,t;return null===(t=null===(e=this._currentLink)||void 0===e?void 0:e.state)||void 0===t?void 0:t.decorations.pointerCursor},set:e=>{var t,i;(null===(t=this._currentLink)||void 0===t?void 0:t.state)&&this._currentLink.state.decorations.pointerCursor!==e&&(this._currentLink.state.decorations.pointerCursor=e,this._currentLink.state.isHovered&&(null===(i=this._element)||void 0===i||i.classList.toggle("xterm-cursor-pointer",e)))}},underline:{get:()=>{var e,t;return null===(t=null===(e=this._currentLink)||void 0===e?void 0:e.state)||void 0===t?void 0:t.decorations.underline},set:t=>{var i,n,s;(null===(i=this._currentLink)||void 0===i?void 0:i.state)&&(null===(s=null===(n=this._currentLink)||void 0===n?void 0:n.state)||void 0===s?void 0:s.decorations.underline)!==t&&(this._currentLink.state.decorations.underline=t,this._currentLink.state.isHovered&&this._fireUnderlineEvent(e.link,t))}}}),this._renderService&&this._linkCacheDisposables.push(this._renderService.onRenderedViewportChange((e=>{if(!this._currentLink)return;const t=0===e.start?0:e.start+1+this._bufferService.buffer.ydisp,i=this._bufferService.buffer.ydisp+1+e.end;if(this._currentLink.link.range.start.y>=t&&this._currentLink.link.range.end.y<=i&&(this._clearCurrentLink(t,i),this._lastMouseEvent&&this._element)){const e=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);e&&this._askForLink(e,!1)}}))))}_linkHover(e,t,i){var n;(null===(n=this._currentLink)||void 0===n?void 0:n.state)&&(this._currentLink.state.isHovered=!0,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(t,!0),this._currentLink.state.decorations.pointerCursor&&e.classList.add("xterm-cursor-pointer")),t.hover&&t.hover(i,t.text)}_fireUnderlineEvent(e,t){const i=e.range,n=this._bufferService.buffer.ydisp,s=this._createLinkUnderlineEvent(i.start.x-1,i.start.y-n-1,i.end.x,i.end.y-n-1,void 0);(t?this._onShowLinkUnderline:this._onHideLinkUnderline).fire(s)}_linkLeave(e,t,i){var n;(null===(n=this._currentLink)||void 0===n?void 0:n.state)&&(this._currentLink.state.isHovered=!1,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(t,!1),this._currentLink.state.decorations.pointerCursor&&e.classList.remove("xterm-cursor-pointer")),t.leave&&t.leave(i,t.text)}_linkAtPosition(e,t){const i=e.range.start.y*this._bufferService.cols+e.range.start.x,n=e.range.end.y*this._bufferService.cols+e.range.end.x,s=t.y*this._bufferService.cols+t.x;return i<=s&&s<=n}_positionFromMouseEvent(e,t,i){const n=i.getCoords(e,t,this._bufferService.cols,this._bufferService.rows);if(n)return{x:n[0],y:n[1]+this._bufferService.buffer.ydisp}}_createLinkUnderlineEvent(e,t,i,n,s){return{x1:e,y1:t,x2:i,y2:n,cols:this._bufferService.cols,fg:s}}};l=n([s(0,r.IBufferService)],l),t.Linkifier2=l},9042:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.tooMuchOutput=t.promptLabel=void 0,t.promptLabel="Terminal input",t.tooMuchOutput="Too much output to announce, navigate to rows manually to read"},3730:function(e,t,i){var n=this&&this.__decorate||function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},s=this&&this.__param||function(e,t){return function(i,n){t(i,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.OscLinkProvider=void 0;const r=i(511),o=i(2585);let a=class{constructor(e,t,i){this._bufferService=e,this._optionsService=t,this._oscLinkService=i}provideLinks(e,t){var i;const n=this._bufferService.buffer.lines.get(e-1);if(!n)return void t(void 0);const s=[],o=this._optionsService.rawOptions.linkHandler,a=new r.CellData,l=n.getTrimmedLength();let h=-1,d=-1,u=!1;for(let t=0;t<l;t++)if(-1!==d||n.hasContent(t)){if(n.loadCell(t,a),a.hasExtendedAttrs()&&a.extended.urlId){if(-1===d){d=t,h=a.extended.urlId;continue}u=a.extended.urlId!==h}else-1!==d&&(u=!0);if(u||-1!==d&&t===l-1){const n=null===(i=this._oscLinkService.getLinkData(h))||void 0===i?void 0:i.uri;if(n){const i={start:{x:d+1,y:e},end:{x:t+(u||t!==l-1?0:1),y:e}};let r=!1;if(!(null==o?void 0:o.allowNonHttpProtocols))try{const e=new URL(n);["http:","https:"].includes(e.protocol)||(r=!0)}catch(e){r=!0}r||s.push({text:n,range:i,activate:(e,t)=>o?o.activate(e,t,i):c(0,t),hover:(e,t)=>{var n;return null===(n=null==o?void 0:o.hover)||void 0===n?void 0:n.call(o,e,t,i)},leave:(e,t)=>{var n;return null===(n=null==o?void 0:o.leave)||void 0===n?void 0:n.call(o,e,t,i)}})}u=!1,a.hasExtendedAttrs()&&a.extended.urlId?(d=t,h=a.extended.urlId):(d=-1,h=-1)}}t(s)}};function c(e,t){if(confirm(`Do you want to navigate to ${t}?\n\nWARNING: This link could potentially be dangerous`)){const i=window.open();if(i){try{i.opener=null}catch(e){}i.location.href=t}else console.warn("Opening link blocked as opener could not be cleared")}}a=n([s(0,o.IBufferService),s(1,o.IOptionsService),s(2,o.IOscLinkService)],a),t.OscLinkProvider=a},6193:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RenderDebouncer=void 0,t.RenderDebouncer=class{constructor(e,t){this._parentWindow=e,this._renderCallback=t,this._refreshCallbacks=[]}dispose(){this._animationFrame&&(this._parentWindow.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}addRefreshCallback(e){return this._refreshCallbacks.push(e),this._animationFrame||(this._animationFrame=this._parentWindow.requestAnimationFrame((()=>this._innerRefresh()))),this._animationFrame}refresh(e,t,i){this._rowCount=i,e=void 0!==e?e:0,t=void 0!==t?t:this._rowCount-1,this._rowStart=void 0!==this._rowStart?Math.min(this._rowStart,e):e,this._rowEnd=void 0!==this._rowEnd?Math.max(this._rowEnd,t):t,this._animationFrame||(this._animationFrame=this._parentWindow.requestAnimationFrame((()=>this._innerRefresh())))}_innerRefresh(){if(this._animationFrame=void 0,void 0===this._rowStart||void 0===this._rowEnd||void 0===this._rowCount)return void this._runRefreshCallbacks();const e=Math.max(this._rowStart,0),t=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(e,t),this._runRefreshCallbacks()}_runRefreshCallbacks(){for(const e of this._refreshCallbacks)e(0);this._refreshCallbacks=[]}}},5596:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ScreenDprMonitor=void 0;const n=i(844);class s extends n.Disposable{constructor(e){super(),this._parentWindow=e,this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this.register((0,n.toDisposable)((()=>{this.clearListener()})))}setListener(e){this._listener&&this.clearListener(),this._listener=e,this._outerListener=()=>{this._listener&&(this._listener(this._parentWindow.devicePixelRatio,this._currentDevicePixelRatio),this._updateDpr())},this._updateDpr()}_updateDpr(){var e;this._outerListener&&(null===(e=this._resolutionMediaMatchList)||void 0===e||e.removeListener(this._outerListener),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._resolutionMediaMatchList=this._parentWindow.matchMedia(`screen and (resolution: ${this._parentWindow.devicePixelRatio}dppx)`),this._resolutionMediaMatchList.addListener(this._outerListener))}clearListener(){this._resolutionMediaMatchList&&this._listener&&this._outerListener&&(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._listener=void 0,this._outerListener=void 0)}}t.ScreenDprMonitor=s},3236:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Terminal=void 0;const n=i(2950),s=i(1680),r=i(3614),o=i(2584),a=i(5435),c=i(9312),l=i(6114),h=i(3656),d=i(9042),u=i(4567),m=i(1296),_=i(7399),g=i(8460),p=i(8437),f=i(3230),v=i(4725),b=i(428),S=i(8934),w=i(6465),C=i(5114),y=i(8969),x=i(8055),k=i(4269),I=i(5941),D=i(3107),T=i(5744),E=i(9074),A=i(2585),L=i(3730),P=i(844),R=i(6731),M="undefined"!=typeof window?window.document:null;class B extends y.CoreTerminal{constructor(e={}){super(e),this.browser=l,this._keyDownHandled=!1,this._keyDownSeen=!1,this._keyPressHandled=!1,this._unprocessedDeadKey=!1,this._onCursorMove=this.register(new g.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onKey=this.register(new g.EventEmitter),this.onKey=this._onKey.event,this._onRender=this.register(new g.EventEmitter),this.onRender=this._onRender.event,this._onSelectionChange=this.register(new g.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onTitleChange=this.register(new g.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onBell=this.register(new g.EventEmitter),this.onBell=this._onBell.event,this._onFocus=this.register(new g.EventEmitter),this._onBlur=this.register(new g.EventEmitter),this._onA11yCharEmitter=this.register(new g.EventEmitter),this._onA11yTabEmitter=this.register(new g.EventEmitter),this._onWillOpen=this.register(new g.EventEmitter),this._setup(),this.linkifier2=this.register(this._instantiationService.createInstance(w.Linkifier2)),this.linkifier2.registerLinkProvider(this._instantiationService.createInstance(L.OscLinkProvider)),this._decorationService=this._instantiationService.createInstance(E.DecorationService),this._instantiationService.setService(A.IDecorationService,this._decorationService),this.register(this._inputHandler.onRequestBell((()=>this._onBell.fire()))),this.register(this._inputHandler.onRequestRefreshRows(((e,t)=>this.refresh(e,t)))),this.register(this._inputHandler.onRequestSendFocus((()=>this._reportFocus()))),this.register(this._inputHandler.onRequestReset((()=>this.reset()))),this.register(this._inputHandler.onRequestWindowsOptionsReport((e=>this._reportWindowsOptions(e)))),this.register(this._inputHandler.onColor((e=>this._handleColorEvent(e)))),this.register((0,g.forwardEvent)(this._inputHandler.onCursorMove,this._onCursorMove)),this.register((0,g.forwardEvent)(this._inputHandler.onTitleChange,this._onTitleChange)),this.register((0,g.forwardEvent)(this._inputHandler.onA11yChar,this._onA11yCharEmitter)),this.register((0,g.forwardEvent)(this._inputHandler.onA11yTab,this._onA11yTabEmitter)),this.register(this._bufferService.onResize((e=>this._afterResize(e.cols,e.rows)))),this.register((0,P.toDisposable)((()=>{var e,t;this._customKeyEventHandler=void 0,null===(t=null===(e=this.element)||void 0===e?void 0:e.parentNode)||void 0===t||t.removeChild(this.element)})))}get onFocus(){return this._onFocus.event}get onBlur(){return this._onBlur.event}get onA11yChar(){return this._onA11yCharEmitter.event}get onA11yTab(){return this._onA11yTabEmitter.event}get onWillOpen(){return this._onWillOpen.event}_handleColorEvent(e){if(this._themeService)for(const t of e){let e,i="";switch(t.index){case 256:e="foreground",i="10";break;case 257:e="background",i="11";break;case 258:e="cursor",i="12";break;default:e="ansi",i="4;"+t.index}switch(t.type){case 0:const n=x.color.toColorRGB("ansi"===e?this._themeService.colors.ansi[t.index]:this._themeService.colors[e]);this.coreService.triggerDataEvent(`${o.C0.ESC}]${i};${(0,I.toRgbString)(n)}${o.C1_ESCAPED.ST}`);break;case 1:if("ansi"===e)this._themeService.modifyColors((e=>e.ansi[t.index]=x.rgba.toColor(...t.color)));else{const i=e;this._themeService.modifyColors((e=>e[i]=x.rgba.toColor(...t.color)))}break;case 2:this._themeService.restoreColor(t.index)}}}_setup(){super._setup(),this._customKeyEventHandler=void 0}get buffer(){return this.buffers.active}focus(){this.textarea&&this.textarea.focus({preventScroll:!0})}_handleScreenReaderModeOptionChange(e){var t;e?!this._accessibilityManager&&this._renderService&&(this._accessibilityManager=this._instantiationService.createInstance(u.AccessibilityManager,this)):(null===(t=this._accessibilityManager)||void 0===t||t.dispose(),this._accessibilityManager=void 0)}_handleTextAreaFocus(e){this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(o.C0.ESC+"[I"),this.updateCursorStyle(e),this.element.classList.add("focus"),this._showCursor(),this._onFocus.fire()}blur(){var e;return null===(e=this.textarea)||void 0===e?void 0:e.blur()}_handleTextAreaBlur(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(o.C0.ESC+"[O"),this.element.classList.remove("focus"),this._onBlur.fire()}_syncTextArea(){if(!this.textarea||!this.buffer.isCursorInViewport||this._compositionHelper.isComposing||!this._renderService)return;const e=this.buffer.ybase+this.buffer.y,t=this.buffer.lines.get(e);if(!t)return;const i=Math.min(this.buffer.x,this.cols-1),n=this._renderService.dimensions.css.cell.height,s=t.getWidth(i),r=this._renderService.dimensions.css.cell.width*s,o=this.buffer.y*this._renderService.dimensions.css.cell.height,a=i*this._renderService.dimensions.css.cell.width;this.textarea.style.left=a+"px",this.textarea.style.top=o+"px",this.textarea.style.width=r+"px",this.textarea.style.height=n+"px",this.textarea.style.lineHeight=n+"px",this.textarea.style.zIndex="-5"}_initGlobal(){this._bindKeys(),this.register((0,h.addDisposableDomListener)(this.element,"copy",(e=>{this.hasSelection()&&(0,r.copyHandler)(e,this._selectionService)})));const e=e=>(0,r.handlePasteEvent)(e,this.textarea,this.coreService);this.register((0,h.addDisposableDomListener)(this.textarea,"paste",e)),this.register((0,h.addDisposableDomListener)(this.element,"paste",e)),l.isFirefox?this.register((0,h.addDisposableDomListener)(this.element,"mousedown",(e=>{2===e.button&&(0,r.rightClickHandler)(e,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)}))):this.register((0,h.addDisposableDomListener)(this.element,"contextmenu",(e=>{(0,r.rightClickHandler)(e,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)}))),l.isLinux&&this.register((0,h.addDisposableDomListener)(this.element,"auxclick",(e=>{1===e.button&&(0,r.moveTextAreaUnderMouseCursor)(e,this.textarea,this.screenElement)})))}_bindKeys(){this.register((0,h.addDisposableDomListener)(this.textarea,"keyup",(e=>this._keyUp(e)),!0)),this.register((0,h.addDisposableDomListener)(this.textarea,"keydown",(e=>this._keyDown(e)),!0)),this.register((0,h.addDisposableDomListener)(this.textarea,"keypress",(e=>this._keyPress(e)),!0)),this.register((0,h.addDisposableDomListener)(this.textarea,"compositionstart",(()=>this._compositionHelper.compositionstart()))),this.register((0,h.addDisposableDomListener)(this.textarea,"compositionupdate",(e=>this._compositionHelper.compositionupdate(e)))),this.register((0,h.addDisposableDomListener)(this.textarea,"compositionend",(()=>this._compositionHelper.compositionend()))),this.register((0,h.addDisposableDomListener)(this.textarea,"input",(e=>this._inputEvent(e)),!0)),this.register(this.onRender((()=>this._compositionHelper.updateCompositionElements())))}open(e){var t;if(!e)throw new Error("Terminal requires a parent element.");e.isConnected||this._logService.debug("Terminal.open was called on an element that was not attached to the DOM"),this._document=e.ownerDocument,this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),e.appendChild(this.element);const i=M.createDocumentFragment();this._viewportElement=M.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),i.appendChild(this._viewportElement),this._viewportScrollArea=M.createElement("div"),this._viewportScrollArea.classList.add("xterm-scroll-area"),this._viewportElement.appendChild(this._viewportScrollArea),this.screenElement=M.createElement("div"),this.screenElement.classList.add("xterm-screen"),this._helperContainer=M.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),i.appendChild(this.screenElement),this.textarea=M.createElement("textarea"),this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",d.promptLabel),l.isChromeOS||this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this._coreBrowserService=this._instantiationService.createInstance(C.CoreBrowserService,this.textarea,null!==(t=this._document.defaultView)&&void 0!==t?t:window),this._instantiationService.setService(v.ICoreBrowserService,this._coreBrowserService),this.register((0,h.addDisposableDomListener)(this.textarea,"focus",(e=>this._handleTextAreaFocus(e)))),this.register((0,h.addDisposableDomListener)(this.textarea,"blur",(()=>this._handleTextAreaBlur()))),this._helperContainer.appendChild(this.textarea),this._charSizeService=this._instantiationService.createInstance(b.CharSizeService,this._document,this._helperContainer),this._instantiationService.setService(v.ICharSizeService,this._charSizeService),this._themeService=this._instantiationService.createInstance(R.ThemeService),this._instantiationService.setService(v.IThemeService,this._themeService),this._characterJoinerService=this._instantiationService.createInstance(k.CharacterJoinerService),this._instantiationService.setService(v.ICharacterJoinerService,this._characterJoinerService),this._renderService=this.register(this._instantiationService.createInstance(f.RenderService,this.rows,this.screenElement)),this._instantiationService.setService(v.IRenderService,this._renderService),this.register(this._renderService.onRenderedViewportChange((e=>this._onRender.fire(e)))),this.onResize((e=>this._renderService.resize(e.cols,e.rows))),this._compositionView=M.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=this._instantiationService.createInstance(n.CompositionHelper,this.textarea,this._compositionView),this._helperContainer.appendChild(this._compositionView),this.element.appendChild(i);try{this._onWillOpen.fire(this.element)}catch(e){}this._renderService.hasRenderer()||this._renderService.setRenderer(this._createRenderer()),this._mouseService=this._instantiationService.createInstance(S.MouseService),this._instantiationService.setService(v.IMouseService,this._mouseService),this.viewport=this._instantiationService.createInstance(s.Viewport,(e=>this.scrollLines(e,!0,1)),this._viewportElement,this._viewportScrollArea),this.register(this._inputHandler.onRequestSyncScrollBar((()=>this.viewport.syncScrollArea()))),this.register(this.viewport),this.register(this.onCursorMove((()=>{this._renderService.handleCursorMove(),this._syncTextArea()}))),this.register(this.onResize((()=>this._renderService.handleResize(this.cols,this.rows)))),this.register(this.onBlur((()=>this._renderService.handleBlur()))),this.register(this.onFocus((()=>this._renderService.handleFocus()))),this.register(this._renderService.onDimensionsChange((()=>this.viewport.syncScrollArea()))),this._selectionService=this.register(this._instantiationService.createInstance(c.SelectionService,this.element,this.screenElement,this.linkifier2)),this._instantiationService.setService(v.ISelectionService,this._selectionService),this.register(this._selectionService.onRequestScrollLines((e=>this.scrollLines(e.amount,e.suppressScrollEvent)))),this.register(this._selectionService.onSelectionChange((()=>this._onSelectionChange.fire()))),this.register(this._selectionService.onRequestRedraw((e=>this._renderService.handleSelectionChanged(e.start,e.end,e.columnSelectMode)))),this.register(this._selectionService.onLinuxMouseSelection((e=>{this.textarea.value=e,this.textarea.focus(),this.textarea.select()}))),this.register(this._onScroll.event((e=>{this.viewport.syncScrollArea(),this._selectionService.refresh()}))),this.register((0,h.addDisposableDomListener)(this._viewportElement,"scroll",(()=>this._selectionService.refresh()))),this.linkifier2.attachToDom(this.screenElement,this._mouseService,this._renderService),this.register(this._instantiationService.createInstance(D.BufferDecorationRenderer,this.screenElement)),this.register((0,h.addDisposableDomListener)(this.element,"mousedown",(e=>this._selectionService.handleMouseDown(e)))),this.coreMouseService.areMouseEventsActive?(this._selectionService.disable(),this.element.classList.add("enable-mouse-events")):this._selectionService.enable(),this.options.screenReaderMode&&(this._accessibilityManager=this._instantiationService.createInstance(u.AccessibilityManager,this)),this.register(this.optionsService.onSpecificOptionChange("screenReaderMode",(e=>this._handleScreenReaderModeOptionChange(e)))),this.options.overviewRulerWidth&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(T.OverviewRulerRenderer,this._viewportElement,this.screenElement))),this.optionsService.onSpecificOptionChange("overviewRulerWidth",(e=>{!this._overviewRulerRenderer&&e&&this._viewportElement&&this.screenElement&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(T.OverviewRulerRenderer,this._viewportElement,this.screenElement)))})),this._charSizeService.measure(),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()}_createRenderer(){return this._instantiationService.createInstance(m.DomRenderer,this.element,this.screenElement,this._viewportElement,this.linkifier2)}bindMouse(){const e=this,t=this.element;function i(t){const i=e._mouseService.getMouseReportCoords(t,e.screenElement);if(!i)return!1;let n,s;switch(t.overrideType||t.type){case"mousemove":s=32,void 0===t.buttons?(n=3,void 0!==t.button&&(n=t.button<3?t.button:3)):n=1&t.buttons?0:4&t.buttons?1:2&t.buttons?2:3;break;case"mouseup":s=0,n=t.button<3?t.button:3;break;case"mousedown":s=1,n=t.button<3?t.button:3;break;case"wheel":if(0===e.viewport.getLinesScrolled(t))return!1;s=t.deltaY<0?0:1,n=4;break;default:return!1}return!(void 0===s||void 0===n||n>4)&&e.coreMouseService.triggerMouseEvent({col:i.col,row:i.row,x:i.x,y:i.y,button:n,action:s,ctrl:t.ctrlKey,alt:t.altKey,shift:t.shiftKey})}const n={mouseup:null,wheel:null,mousedrag:null,mousemove:null},s={mouseup:e=>(i(e),e.buttons||(this._document.removeEventListener("mouseup",n.mouseup),n.mousedrag&&this._document.removeEventListener("mousemove",n.mousedrag)),this.cancel(e)),wheel:e=>(i(e),this.cancel(e,!0)),mousedrag:e=>{e.buttons&&i(e)},mousemove:e=>{e.buttons||i(e)}};this.register(this.coreMouseService.onProtocolChange((e=>{e?("debug"===this.optionsService.rawOptions.logLevel&&this._logService.debug("Binding to mouse events:",this.coreMouseService.explainEvents(e)),this.element.classList.add("enable-mouse-events"),this._selectionService.disable()):(this._logService.debug("Unbinding from mouse events."),this.element.classList.remove("enable-mouse-events"),this._selectionService.enable()),8&e?n.mousemove||(t.addEventListener("mousemove",s.mousemove),n.mousemove=s.mousemove):(t.removeEventListener("mousemove",n.mousemove),n.mousemove=null),16&e?n.wheel||(t.addEventListener("wheel",s.wheel,{passive:!1}),n.wheel=s.wheel):(t.removeEventListener("wheel",n.wheel),n.wheel=null),2&e?n.mouseup||(n.mouseup=s.mouseup):(this._document.removeEventListener("mouseup",n.mouseup),n.mouseup=null),4&e?n.mousedrag||(n.mousedrag=s.mousedrag):(this._document.removeEventListener("mousemove",n.mousedrag),n.mousedrag=null)}))),this.coreMouseService.activeProtocol=this.coreMouseService.activeProtocol,this.register((0,h.addDisposableDomListener)(t,"mousedown",(e=>{if(e.preventDefault(),this.focus(),this.coreMouseService.areMouseEventsActive&&!this._selectionService.shouldForceSelection(e))return i(e),n.mouseup&&this._document.addEventListener("mouseup",n.mouseup),n.mousedrag&&this._document.addEventListener("mousemove",n.mousedrag),this.cancel(e)}))),this.register((0,h.addDisposableDomListener)(t,"wheel",(e=>{if(!n.wheel){if(!this.buffer.hasScrollback){const t=this.viewport.getLinesScrolled(e);if(0===t)return;const i=o.C0.ESC+(this.coreService.decPrivateModes.applicationCursorKeys?"O":"[")+(e.deltaY<0?"A":"B");let n="";for(let e=0;e<Math.abs(t);e++)n+=i;return this.coreService.triggerDataEvent(n,!0),this.cancel(e,!0)}return this.viewport.handleWheel(e)?this.cancel(e):void 0}}),{passive:!1})),this.register((0,h.addDisposableDomListener)(t,"touchstart",(e=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchStart(e),this.cancel(e)}),{passive:!0})),this.register((0,h.addDisposableDomListener)(t,"touchmove",(e=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchMove(e)?void 0:this.cancel(e)}),{passive:!1}))}refresh(e,t){var i;null===(i=this._renderService)||void 0===i||i.refreshRows(e,t)}updateCursorStyle(e){var t;(null===(t=this._selectionService)||void 0===t?void 0:t.shouldColumnSelect(e))?this.element.classList.add("column-select"):this.element.classList.remove("column-select")}_showCursor(){this.coreService.isCursorInitialized||(this.coreService.isCursorInitialized=!0,this.refresh(this.buffer.y,this.buffer.y))}scrollLines(e,t,i=0){super.scrollLines(e,t,i),this.refresh(0,this.rows-1)}paste(e){(0,r.paste)(e,this.textarea,this.coreService)}attachCustomKeyEventHandler(e){this._customKeyEventHandler=e}registerLinkProvider(e){return this.linkifier2.registerLinkProvider(e)}registerCharacterJoiner(e){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");const t=this._characterJoinerService.register(e);return this.refresh(0,this.rows-1),t}deregisterCharacterJoiner(e){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");this._characterJoinerService.deregister(e)&&this.refresh(0,this.rows-1)}get markers(){return this.buffer.markers}addMarker(e){return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+e)}registerDecoration(e){return this._decorationService.registerDecoration(e)}hasSelection(){return!!this._selectionService&&this._selectionService.hasSelection}select(e,t,i){this._selectionService.setSelection(e,t,i)}getSelection(){return this._selectionService?this._selectionService.selectionText:""}getSelectionPosition(){if(this._selectionService&&this._selectionService.hasSelection)return{start:{x:this._selectionService.selectionStart[0],y:this._selectionService.selectionStart[1]},end:{x:this._selectionService.selectionEnd[0],y:this._selectionService.selectionEnd[1]}}}clearSelection(){var e;null===(e=this._selectionService)||void 0===e||e.clearSelection()}selectAll(){var e;null===(e=this._selectionService)||void 0===e||e.selectAll()}selectLines(e,t){var i;null===(i=this._selectionService)||void 0===i||i.selectLines(e,t)}_keyDown(e){if(this._keyDownHandled=!1,this._keyDownSeen=!0,this._customKeyEventHandler&&!1===this._customKeyEventHandler(e))return!1;const t=this.browser.isMac&&this.options.macOptionIsMeta&&e.altKey;if(!t&&!this._compositionHelper.keydown(e))return this.options.scrollOnUserInput&&this.buffer.ybase!==this.buffer.ydisp&&this._bufferService.scrollToBottom(),!1;t||"Dead"!==e.key&&"AltGraph"!==e.key||(this._unprocessedDeadKey=!0);const i=(0,_.evaluateKeyboardEvent)(e,this.coreService.decPrivateModes.applicationCursorKeys,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(e),3===i.type||2===i.type){const t=this.rows-1;return this.scrollLines(2===i.type?-t:t),this.cancel(e,!0)}return 1===i.type&&this.selectAll(),!!this._isThirdLevelShift(this.browser,e)||(i.cancel&&this.cancel(e,!0),!i.key||!!(e.key&&!e.ctrlKey&&!e.altKey&&!e.metaKey&&1===e.key.length&&e.key.charCodeAt(0)>=65&&e.key.charCodeAt(0)<=90)||(this._unprocessedDeadKey?(this._unprocessedDeadKey=!1,!0):(i.key!==o.C0.ETX&&i.key!==o.C0.CR||(this.textarea.value=""),this._onKey.fire({key:i.key,domEvent:e}),this._showCursor(),this.coreService.triggerDataEvent(i.key,!0),!this.optionsService.rawOptions.screenReaderMode||e.altKey||e.ctrlKey?this.cancel(e,!0):void(this._keyDownHandled=!0))))}_isThirdLevelShift(e,t){const i=e.isMac&&!this.options.macOptionIsMeta&&t.altKey&&!t.ctrlKey&&!t.metaKey||e.isWindows&&t.altKey&&t.ctrlKey&&!t.metaKey||e.isWindows&&t.getModifierState("AltGraph");return"keypress"===t.type?i:i&&(!t.keyCode||t.keyCode>47)}_keyUp(e){this._keyDownSeen=!1,this._customKeyEventHandler&&!1===this._customKeyEventHandler(e)||(function(e){return 16===e.keyCode||17===e.keyCode||18===e.keyCode}(e)||this.focus(),this.updateCursorStyle(e),this._keyPressHandled=!1)}_keyPress(e){let t;if(this._keyPressHandled=!1,this._keyDownHandled)return!1;if(this._customKeyEventHandler&&!1===this._customKeyEventHandler(e))return!1;if(this.cancel(e),e.charCode)t=e.charCode;else if(null===e.which||void 0===e.which)t=e.keyCode;else{if(0===e.which||0===e.charCode)return!1;t=e.which}return!(!t||(e.altKey||e.ctrlKey||e.metaKey)&&!this._isThirdLevelShift(this.browser,e)||(t=String.fromCharCode(t),this._onKey.fire({key:t,domEvent:e}),this._showCursor(),this.coreService.triggerDataEvent(t,!0),this._keyPressHandled=!0,this._unprocessedDeadKey=!1,0))}_inputEvent(e){if(e.data&&"insertText"===e.inputType&&(!e.composed||!this._keyDownSeen)&&!this.optionsService.rawOptions.screenReaderMode){if(this._keyPressHandled)return!1;this._unprocessedDeadKey=!1;const t=e.data;return this.coreService.triggerDataEvent(t,!0),this.cancel(e),!0}return!1}resize(e,t){e!==this.cols||t!==this.rows?super.resize(e,t):this._charSizeService&&!this._charSizeService.hasValidSize&&this._charSizeService.measure()}_afterResize(e,t){var i,n;null===(i=this._charSizeService)||void 0===i||i.measure(),null===(n=this.viewport)||void 0===n||n.syncScrollArea(!0)}clear(){if(0!==this.buffer.ybase||0!==this.buffer.y){this.buffer.clearAllMarkers(),this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(let e=1;e<this.rows;e++)this.buffer.lines.push(this.buffer.getBlankLine(p.DEFAULT_ATTR_DATA));this.refresh(0,this.rows-1),this._onScroll.fire({position:this.buffer.ydisp,source:0})}}reset(){var e,t;this.options.rows=this.rows,this.options.cols=this.cols;const i=this._customKeyEventHandler;this._setup(),super.reset(),null===(e=this._selectionService)||void 0===e||e.reset(),this._decorationService.reset(),this._customKeyEventHandler=i,this.refresh(0,this.rows-1),null===(t=this.viewport)||void 0===t||t.syncScrollArea()}clearTextureAtlas(){var e;null===(e=this._renderService)||void 0===e||e.clearTextureAtlas()}_reportFocus(){var e;(null===(e=this.element)||void 0===e?void 0:e.classList.contains("focus"))?this.coreService.triggerDataEvent(o.C0.ESC+"[I"):this.coreService.triggerDataEvent(o.C0.ESC+"[O")}_reportWindowsOptions(e){if(this._renderService)switch(e){case a.WindowsOptionsReportType.GET_WIN_SIZE_PIXELS:const e=this._renderService.dimensions.css.canvas.width.toFixed(0),t=this._renderService.dimensions.css.canvas.height.toFixed(0);this.coreService.triggerDataEvent(`${o.C0.ESC}[4;${t};${e}t`);break;case a.WindowsOptionsReportType.GET_CELL_SIZE_PIXELS:const i=this._renderService.dimensions.css.cell.width.toFixed(0),n=this._renderService.dimensions.css.cell.height.toFixed(0);this.coreService.triggerDataEvent(`${o.C0.ESC}[6;${n};${i}t`)}}cancel(e,t){if(this.options.cancelEvents||t)return e.preventDefault(),e.stopPropagation(),!1}}t.Terminal=B},9924:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TimeBasedDebouncer=void 0,t.TimeBasedDebouncer=class{constructor(e,t=1e3){this._renderCallback=e,this._debounceThresholdMS=t,this._lastRefreshMs=0,this._additionalRefreshRequested=!1}dispose(){this._refreshTimeoutID&&clearTimeout(this._refreshTimeoutID)}refresh(e,t,i){this._rowCount=i,e=void 0!==e?e:0,t=void 0!==t?t:this._rowCount-1,this._rowStart=void 0!==this._rowStart?Math.min(this._rowStart,e):e,this._rowEnd=void 0!==this._rowEnd?Math.max(this._rowEnd,t):t;const n=Date.now();if(n-this._lastRefreshMs>=this._debounceThresholdMS)this._lastRefreshMs=n,this._innerRefresh();else if(!this._additionalRefreshRequested){const e=n-this._lastRefreshMs,t=this._debounceThresholdMS-e;this._additionalRefreshRequested=!0,this._refreshTimeoutID=window.setTimeout((()=>{this._lastRefreshMs=Date.now(),this._innerRefresh(),this._additionalRefreshRequested=!1,this._refreshTimeoutID=void 0}),t)}}_innerRefresh(){if(void 0===this._rowStart||void 0===this._rowEnd||void 0===this._rowCount)return;const e=Math.max(this._rowStart,0),t=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(e,t)}}},1680:function(e,t,i){var n=this&&this.__decorate||function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},s=this&&this.__param||function(e,t){return function(i,n){t(i,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.Viewport=void 0;const r=i(844),o=i(3656),a=i(4725),c=i(2585);let l=class extends r.Disposable{constructor(e,t,i,n,s,r,a,c,l){super(),this._scrollLines=e,this._viewportElement=t,this._scrollArea=i,this._bufferService=n,this._optionsService=s,this._charSizeService=r,this._renderService=a,this._coreBrowserService=c,this.scrollBarWidth=0,this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._wheelPartialScroll=0,this._refreshAnimationFrame=null,this._ignoreNextScrollEvent=!1,this._smoothScrollState={startTime:0,origin:-1,target:-1},this.scrollBarWidth=this._viewportElement.offsetWidth-this._scrollArea.offsetWidth||15,this.register((0,o.addDisposableDomListener)(this._viewportElement,"scroll",this._handleScroll.bind(this))),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate((e=>this._activeBuffer=e.activeBuffer))),this._renderDimensions=this._renderService.dimensions,this.register(this._renderService.onDimensionsChange((e=>this._renderDimensions=e))),this._handleThemeChange(l.colors),this.register(l.onChangeColors((e=>this._handleThemeChange(e)))),this.register(this._optionsService.onSpecificOptionChange("scrollback",(()=>this.syncScrollArea()))),setTimeout((()=>this.syncScrollArea()),0)}_handleThemeChange(e){this._viewportElement.style.backgroundColor=e.background.css}_refresh(e){if(e)return this._innerRefresh(),void(null!==this._refreshAnimationFrame&&this._coreBrowserService.window.cancelAnimationFrame(this._refreshAnimationFrame));null===this._refreshAnimationFrame&&(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame((()=>this._innerRefresh())))}_innerRefresh(){if(this._charSizeService.height>0){this._currentRowHeight=this._renderService.dimensions.device.cell.height/this._coreBrowserService.dpr,this._currentDeviceCellHeight=this._renderService.dimensions.device.cell.height,this._lastRecordedViewportHeight=this._viewportElement.offsetHeight;const e=Math.round(this._currentRowHeight*this._lastRecordedBufferLength)+(this._lastRecordedViewportHeight-this._renderService.dimensions.css.canvas.height);this._lastRecordedBufferHeight!==e&&(this._lastRecordedBufferHeight=e,this._scrollArea.style.height=this._lastRecordedBufferHeight+"px")}const e=this._bufferService.buffer.ydisp*this._currentRowHeight;this._viewportElement.scrollTop!==e&&(this._ignoreNextScrollEvent=!0,this._viewportElement.scrollTop=e),this._refreshAnimationFrame=null}syncScrollArea(e=!1){if(this._lastRecordedBufferLength!==this._bufferService.buffer.lines.length)return this._lastRecordedBufferLength=this._bufferService.buffer.lines.length,void this._refresh(e);this._lastRecordedViewportHeight===this._renderService.dimensions.css.canvas.height&&this._lastScrollTop===this._activeBuffer.ydisp*this._currentRowHeight&&this._renderDimensions.device.cell.height===this._currentDeviceCellHeight||this._refresh(e)}_handleScroll(e){if(this._lastScrollTop=this._viewportElement.scrollTop,!this._viewportElement.offsetParent)return;if(this._ignoreNextScrollEvent)return this._ignoreNextScrollEvent=!1,void this._scrollLines(0);const t=Math.round(this._lastScrollTop/this._currentRowHeight)-this._bufferService.buffer.ydisp;this._scrollLines(t)}_smoothScroll(){if(this._isDisposed||-1===this._smoothScrollState.origin||-1===this._smoothScrollState.target)return;const e=this._smoothScrollPercent();this._viewportElement.scrollTop=this._smoothScrollState.origin+Math.round(e*(this._smoothScrollState.target-this._smoothScrollState.origin)),e<1?this._coreBrowserService.window.requestAnimationFrame((()=>this._smoothScroll())):this._clearSmoothScrollState()}_smoothScrollPercent(){return this._optionsService.rawOptions.smoothScrollDuration&&this._smoothScrollState.startTime?Math.max(Math.min((Date.now()-this._smoothScrollState.startTime)/this._optionsService.rawOptions.smoothScrollDuration,1),0):1}_clearSmoothScrollState(){this._smoothScrollState.startTime=0,this._smoothScrollState.origin=-1,this._smoothScrollState.target=-1}_bubbleScroll(e,t){const i=this._viewportElement.scrollTop+this._lastRecordedViewportHeight;return!(t<0&&0!==this._viewportElement.scrollTop||t>0&&i<this._lastRecordedBufferHeight)||(e.cancelable&&e.preventDefault(),!1)}handleWheel(e){const t=this._getPixelsScrolled(e);return 0!==t&&(this._optionsService.rawOptions.smoothScrollDuration?(this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,-1===this._smoothScrollState.target?this._smoothScrollState.target=this._viewportElement.scrollTop+t:this._smoothScrollState.target+=t,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()):this._viewportElement.scrollTop+=t,this._bubbleScroll(e,t))}_getPixelsScrolled(e){if(0===e.deltaY||e.shiftKey)return 0;let t=this._applyScrollModifier(e.deltaY,e);return e.deltaMode===WheelEvent.DOM_DELTA_LINE?t*=this._currentRowHeight:e.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(t*=this._currentRowHeight*this._bufferService.rows),t}getBufferElements(e,t){var i;let n,s="";const r=[],o=null!=t?t:this._bufferService.buffer.lines.length,a=this._bufferService.buffer.lines;for(let t=e;t<o;t++){const e=a.get(t);if(!e)continue;const o=null===(i=a.get(t+1))||void 0===i?void 0:i.isWrapped;if(s+=e.translateToString(!o),!o||t===a.length-1){const e=document.createElement("div");e.textContent=s,r.push(e),s.length>0&&(n=e),s=""}}return{bufferElements:r,cursorElement:n}}getLinesScrolled(e){if(0===e.deltaY||e.shiftKey)return 0;let t=this._applyScrollModifier(e.deltaY,e);return e.deltaMode===WheelEvent.DOM_DELTA_PIXEL?(t/=this._currentRowHeight+0,this._wheelPartialScroll+=t,t=Math.floor(Math.abs(this._wheelPartialScroll))*(this._wheelPartialScroll>0?1:-1),this._wheelPartialScroll%=1):e.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(t*=this._bufferService.rows),t}_applyScrollModifier(e,t){const i=this._optionsService.rawOptions.fastScrollModifier;return"alt"===i&&t.altKey||"ctrl"===i&&t.ctrlKey||"shift"===i&&t.shiftKey?e*this._optionsService.rawOptions.fastScrollSensitivity*this._optionsService.rawOptions.scrollSensitivity:e*this._optionsService.rawOptions.scrollSensitivity}handleTouchStart(e){this._lastTouchY=e.touches[0].pageY}handleTouchMove(e){const t=this._lastTouchY-e.touches[0].pageY;return this._lastTouchY=e.touches[0].pageY,0!==t&&(this._viewportElement.scrollTop+=t,this._bubbleScroll(e,t))}};l=n([s(3,c.IBufferService),s(4,c.IOptionsService),s(5,a.ICharSizeService),s(6,a.IRenderService),s(7,a.ICoreBrowserService),s(8,a.IThemeService)],l),t.Viewport=l},3107:function(e,t,i){var n=this&&this.__decorate||function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},s=this&&this.__param||function(e,t){return function(i,n){t(i,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.BufferDecorationRenderer=void 0;const r=i(3656),o=i(4725),a=i(844),c=i(2585);let l=class extends a.Disposable{constructor(e,t,i,n){super(),this._screenElement=e,this._bufferService=t,this._decorationService=i,this._renderService=n,this._decorationElements=new Map,this._altBufferIsActive=!1,this._dimensionsChanged=!1,this._container=document.createElement("div"),this._container.classList.add("xterm-decoration-container"),this._screenElement.appendChild(this._container),this.register(this._renderService.onRenderedViewportChange((()=>this._doRefreshDecorations()))),this.register(this._renderService.onDimensionsChange((()=>{this._dimensionsChanged=!0,this._queueRefresh()}))),this.register((0,r.addDisposableDomListener)(window,"resize",(()=>this._queueRefresh()))),this.register(this._bufferService.buffers.onBufferActivate((()=>{this._altBufferIsActive=this._bufferService.buffer===this._bufferService.buffers.alt}))),this.register(this._decorationService.onDecorationRegistered((()=>this._queueRefresh()))),this.register(this._decorationService.onDecorationRemoved((e=>this._removeDecoration(e)))),this.register((0,a.toDisposable)((()=>{this._container.remove(),this._decorationElements.clear()})))}_queueRefresh(){void 0===this._animationFrame&&(this._animationFrame=this._renderService.addRefreshCallback((()=>{this._doRefreshDecorations(),this._animationFrame=void 0})))}_doRefreshDecorations(){for(const e of this._decorationService.decorations)this._renderDecoration(e);this._dimensionsChanged=!1}_renderDecoration(e){this._refreshStyle(e),this._dimensionsChanged&&this._refreshXPosition(e)}_createElement(e){var t,i;const n=document.createElement("div");n.classList.add("xterm-decoration"),n.classList.toggle("xterm-decoration-top-layer","top"===(null===(t=null==e?void 0:e.options)||void 0===t?void 0:t.layer)),n.style.width=`${Math.round((e.options.width||1)*this._renderService.dimensions.css.cell.width)}px`,n.style.height=(e.options.height||1)*this._renderService.dimensions.css.cell.height+"px",n.style.top=(e.marker.line-this._bufferService.buffers.active.ydisp)*this._renderService.dimensions.css.cell.height+"px",n.style.lineHeight=`${this._renderService.dimensions.css.cell.height}px`;const s=null!==(i=e.options.x)&&void 0!==i?i:0;return s&&s>this._bufferService.cols&&(n.style.display="none"),this._refreshXPosition(e,n),n}_refreshStyle(e){const t=e.marker.line-this._bufferService.buffers.active.ydisp;if(t<0||t>=this._bufferService.rows)e.element&&(e.element.style.display="none",e.onRenderEmitter.fire(e.element));else{let i=this._decorationElements.get(e);i||(i=this._createElement(e),e.element=i,this._decorationElements.set(e,i),this._container.appendChild(i)),i.style.top=t*this._renderService.dimensions.css.cell.height+"px",i.style.display=this._altBufferIsActive?"none":"block",e.onRenderEmitter.fire(i)}}_refreshXPosition(e,t=e.element){var i;if(!t)return;const n=null!==(i=e.options.x)&&void 0!==i?i:0;"right"===(e.options.anchor||"left")?t.style.right=n?n*this._renderService.dimensions.css.cell.width+"px":"":t.style.left=n?n*this._renderService.dimensions.css.cell.width+"px":""}_removeDecoration(e){var t;null===(t=this._decorationElements.get(e))||void 0===t||t.remove(),this._decorationElements.delete(e),e.dispose()}};l=n([s(1,c.IBufferService),s(2,c.IDecorationService),s(3,o.IRenderService)],l),t.BufferDecorationRenderer=l},5871:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ColorZoneStore=void 0,t.ColorZoneStore=class{constructor(){this._zones=[],this._zonePool=[],this._zonePoolIndex=0,this._linePadding={full:0,left:0,center:0,right:0}}get zones(){return this._zonePool.length=Math.min(this._zonePool.length,this._zones.length),this._zones}clear(){this._zones.length=0,this._zonePoolIndex=0}addDecoration(e){if(e.options.overviewRulerOptions){for(const t of this._zones)if(t.color===e.options.overviewRulerOptions.color&&t.position===e.options.overviewRulerOptions.position){if(this._lineIntersectsZone(t,e.marker.line))return;if(this._lineAdjacentToZone(t,e.marker.line,e.options.overviewRulerOptions.position))return void this._addLineToZone(t,e.marker.line)}if(this._zonePoolIndex<this._zonePool.length)return this._zonePool[this._zonePoolIndex].color=e.options.overviewRulerOptions.color,this._zonePool[this._zonePoolIndex].position=e.options.overviewRulerOptions.position,this._zonePool[this._zonePoolIndex].startBufferLine=e.marker.line,this._zonePool[this._zonePoolIndex].endBufferLine=e.marker.line,void this._zones.push(this._zonePool[this._zonePoolIndex++]);this._zones.push({color:e.options.overviewRulerOptions.color,position:e.options.overviewRulerOptions.position,startBufferLine:e.marker.line,endBufferLine:e.marker.line}),this._zonePool.push(this._zones[this._zones.length-1]),this._zonePoolIndex++}}setPadding(e){this._linePadding=e}_lineIntersectsZone(e,t){return t>=e.startBufferLine&&t<=e.endBufferLine}_lineAdjacentToZone(e,t,i){return t>=e.startBufferLine-this._linePadding[i||"full"]&&t<=e.endBufferLine+this._linePadding[i||"full"]}_addLineToZone(e,t){e.startBufferLine=Math.min(e.startBufferLine,t),e.endBufferLine=Math.max(e.endBufferLine,t)}}},5744:function(e,t,i){var n=this&&this.__decorate||function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},s=this&&this.__param||function(e,t){return function(i,n){t(i,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.OverviewRulerRenderer=void 0;const r=i(5871),o=i(3656),a=i(4725),c=i(844),l=i(2585),h={full:0,left:0,center:0,right:0},d={full:0,left:0,center:0,right:0},u={full:0,left:0,center:0,right:0};let m=class extends c.Disposable{constructor(e,t,i,n,s,o,a){var l;super(),this._viewportElement=e,this._screenElement=t,this._bufferService=i,this._decorationService=n,this._renderService=s,this._optionsService=o,this._coreBrowseService=a,this._colorZoneStore=new r.ColorZoneStore,this._shouldUpdateDimensions=!0,this._shouldUpdateAnchor=!0,this._lastKnownBufferLength=0,this._canvas=document.createElement("canvas"),this._canvas.classList.add("xterm-decoration-overview-ruler"),this._refreshCanvasDimensions(),null===(l=this._viewportElement.parentElement)||void 0===l||l.insertBefore(this._canvas,this._viewportElement);const h=this._canvas.getContext("2d");if(!h)throw new Error("Ctx cannot be null");this._ctx=h,this._registerDecorationListeners(),this._registerBufferChangeListeners(),this._registerDimensionChangeListeners(),this.register((0,c.toDisposable)((()=>{var e;null===(e=this._canvas)||void 0===e||e.remove()})))}get _width(){return this._optionsService.options.overviewRulerWidth||0}_registerDecorationListeners(){this.register(this._decorationService.onDecorationRegistered((()=>this._queueRefresh(void 0,!0)))),this.register(this._decorationService.onDecorationRemoved((()=>this._queueRefresh(void 0,!0))))}_registerBufferChangeListeners(){this.register(this._renderService.onRenderedViewportChange((()=>this._queueRefresh()))),this.register(this._bufferService.buffers.onBufferActivate((()=>{this._canvas.style.display=this._bufferService.buffer===this._bufferService.buffers.alt?"none":"block"}))),this.register(this._bufferService.onScroll((()=>{this._lastKnownBufferLength!==this._bufferService.buffers.normal.lines.length&&(this._refreshDrawHeightConstants(),this._refreshColorZonePadding())})))}_registerDimensionChangeListeners(){this.register(this._renderService.onRender((()=>{this._containerHeight&&this._containerHeight===this._screenElement.clientHeight||(this._queueRefresh(!0),this._containerHeight=this._screenElement.clientHeight)}))),this.register(this._optionsService.onSpecificOptionChange("overviewRulerWidth",(()=>this._queueRefresh(!0)))),this.register((0,o.addDisposableDomListener)(this._coreBrowseService.window,"resize",(()=>this._queueRefresh(!0)))),this._queueRefresh(!0)}_refreshDrawConstants(){const e=Math.floor(this._canvas.width/3),t=Math.ceil(this._canvas.width/3);d.full=this._canvas.width,d.left=e,d.center=t,d.right=e,this._refreshDrawHeightConstants(),u.full=0,u.left=0,u.center=d.left,u.right=d.left+d.center}_refreshDrawHeightConstants(){h.full=Math.round(2*this._coreBrowseService.dpr);const e=this._canvas.height/this._bufferService.buffer.lines.length,t=Math.round(Math.max(Math.min(e,12),6)*this._coreBrowseService.dpr);h.left=t,h.center=t,h.right=t}_refreshColorZonePadding(){this._colorZoneStore.setPadding({full:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*h.full),left:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*h.left),center:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*h.center),right:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*h.right)}),this._lastKnownBufferLength=this._bufferService.buffers.normal.lines.length}_refreshCanvasDimensions(){this._canvas.style.width=`${this._width}px`,this._canvas.width=Math.round(this._width*this._coreBrowseService.dpr),this._canvas.style.height=`${this._screenElement.clientHeight}px`,this._canvas.height=Math.round(this._screenElement.clientHeight*this._coreBrowseService.dpr),this._refreshDrawConstants(),this._refreshColorZonePadding()}_refreshDecorations(){this._shouldUpdateDimensions&&this._refreshCanvasDimensions(),this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._colorZoneStore.clear();for(const e of this._decorationService.decorations)this._colorZoneStore.addDecoration(e);this._ctx.lineWidth=1;const e=this._colorZoneStore.zones;for(const t of e)"full"!==t.position&&this._renderColorZone(t);for(const t of e)"full"===t.position&&this._renderColorZone(t);this._shouldUpdateDimensions=!1,this._shouldUpdateAnchor=!1}_renderColorZone(e){this._ctx.fillStyle=e.color,this._ctx.fillRect(u[e.position||"full"],Math.round((this._canvas.height-1)*(e.startBufferLine/this._bufferService.buffers.active.lines.length)-h[e.position||"full"]/2),d[e.position||"full"],Math.round((this._canvas.height-1)*((e.endBufferLine-e.startBufferLine)/this._bufferService.buffers.active.lines.length)+h[e.position||"full"]))}_queueRefresh(e,t){this._shouldUpdateDimensions=e||this._shouldUpdateDimensions,this._shouldUpdateAnchor=t||this._shouldUpdateAnchor,void 0===this._animationFrame&&(this._animationFrame=this._coreBrowseService.window.requestAnimationFrame((()=>{this._refreshDecorations(),this._animationFrame=void 0})))}};m=n([s(2,l.IBufferService),s(3,l.IDecorationService),s(4,a.IRenderService),s(5,l.IOptionsService),s(6,a.ICoreBrowserService)],m),t.OverviewRulerRenderer=m},2950:function(e,t,i){var n=this&&this.__decorate||function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},s=this&&this.__param||function(e,t){return function(i,n){t(i,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CompositionHelper=void 0;const r=i(4725),o=i(2585),a=i(2584);let c=class{constructor(e,t,i,n,s,r){this._textarea=e,this._compositionView=t,this._bufferService=i,this._optionsService=n,this._coreService=s,this._renderService=r,this._isComposing=!1,this._isSendingComposition=!1,this._compositionPosition={start:0,end:0},this._dataAlreadySent=""}get isComposing(){return this._isComposing}compositionstart(){this._isComposing=!0,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._dataAlreadySent="",this._compositionView.classList.add("active")}compositionupdate(e){this._compositionView.textContent=e.data,this.updateCompositionElements(),setTimeout((()=>{this._compositionPosition.end=this._textarea.value.length}),0)}compositionend(){this._finalizeComposition(!0)}keydown(e){if(this._isComposing||this._isSendingComposition){if(229===e.keyCode)return!1;if(16===e.keyCode||17===e.keyCode||18===e.keyCode)return!1;this._finalizeComposition(!1)}return 229!==e.keyCode||(this._handleAnyTextareaChanges(),!1)}_finalizeComposition(e){if(this._compositionView.classList.remove("active"),this._isComposing=!1,e){const e={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=!0,setTimeout((()=>{if(this._isSendingComposition){let t;this._isSendingComposition=!1,e.start+=this._dataAlreadySent.length,t=this._isComposing?this._textarea.value.substring(e.start,e.end):this._textarea.value.substring(e.start),t.length>0&&this._coreService.triggerDataEvent(t,!0)}}),0)}else{this._isSendingComposition=!1;const e=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._coreService.triggerDataEvent(e,!0)}}_handleAnyTextareaChanges(){const e=this._textarea.value;setTimeout((()=>{if(!this._isComposing){const t=this._textarea.value,i=t.replace(e,"");this._dataAlreadySent=i,t.length>e.length?this._coreService.triggerDataEvent(i,!0):t.length<e.length?this._coreService.triggerDataEvent(`${a.C0.DEL}`,!0):t.length===e.length&&t!==e&&this._coreService.triggerDataEvent(t,!0)}}),0)}updateCompositionElements(e){if(this._isComposing){if(this._bufferService.buffer.isCursorInViewport){const e=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),t=this._renderService.dimensions.css.cell.height,i=this._bufferService.buffer.y*this._renderService.dimensions.css.cell.height,n=e*this._renderService.dimensions.css.cell.width;this._compositionView.style.left=n+"px",this._compositionView.style.top=i+"px",this._compositionView.style.height=t+"px",this._compositionView.style.lineHeight=t+"px",this._compositionView.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._compositionView.style.fontSize=this._optionsService.rawOptions.fontSize+"px";const s=this._compositionView.getBoundingClientRect();this._textarea.style.left=n+"px",this._textarea.style.top=i+"px",this._textarea.style.width=Math.max(s.width,1)+"px",this._textarea.style.height=Math.max(s.height,1)+"px",this._textarea.style.lineHeight=s.height+"px"}e||setTimeout((()=>this.updateCompositionElements(!0)),0)}}};c=n([s(2,o.IBufferService),s(3,o.IOptionsService),s(4,o.ICoreService),s(5,r.IRenderService)],c),t.CompositionHelper=c},9806:(e,t)=>{function i(e,t,i){const n=i.getBoundingClientRect(),s=e.getComputedStyle(i),r=parseInt(s.getPropertyValue("padding-left")),o=parseInt(s.getPropertyValue("padding-top"));return[t.clientX-n.left-r,t.clientY-n.top-o]}Object.defineProperty(t,"__esModule",{value:!0}),t.getCoords=t.getCoordsRelativeToElement=void 0,t.getCoordsRelativeToElement=i,t.getCoords=function(e,t,n,s,r,o,a,c,l){if(!o)return;const h=i(e,t,n);return h?(h[0]=Math.ceil((h[0]+(l?a/2:0))/a),h[1]=Math.ceil(h[1]/c),h[0]=Math.min(Math.max(h[0],1),s+(l?1:0)),h[1]=Math.min(Math.max(h[1],1),r),h):void 0}},9504:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.moveToCellSequence=void 0;const n=i(2584);function s(e,t,i,n){const s=e-r(e,i),a=t-r(t,i),h=Math.abs(s-a)-function(e,t,i){let n=0;const s=e-r(e,i),a=t-r(t,i);for(let r=0;r<Math.abs(s-a);r++){const a="A"===o(e,t)?-1:1,c=i.buffer.lines.get(s+a*r);(null==c?void 0:c.isWrapped)&&n++}return n}(e,t,i);return l(h,c(o(e,t),n))}function r(e,t){let i=0,n=t.buffer.lines.get(e),s=null==n?void 0:n.isWrapped;for(;s&&e>=0&&e<t.rows;)i++,n=t.buffer.lines.get(--e),s=null==n?void 0:n.isWrapped;return i}function o(e,t){return e>t?"A":"B"}function a(e,t,i,n,s,r){let o=e,a=t,c="";for(;o!==i||a!==n;)o+=s?1:-1,s&&o>r.cols-1?(c+=r.buffer.translateBufferLineToString(a,!1,e,o),o=0,e=0,a++):!s&&o<0&&(c+=r.buffer.translateBufferLineToString(a,!1,0,e+1),o=r.cols-1,e=o,a--);return c+r.buffer.translateBufferLineToString(a,!1,e,o)}function c(e,t){const i=t?"O":"[";return n.C0.ESC+i+e}function l(e,t){e=Math.floor(e);let i="";for(let n=0;n<e;n++)i+=t;return i}t.moveToCellSequence=function(e,t,i,n){const o=i.buffer.x,h=i.buffer.y;if(!i.buffer.hasScrollback)return function(e,t,i,n,o,h){return 0===s(t,n,o,h).length?"":l(a(e,t,e,t-r(t,o),!1,o).length,c("D",h))}(o,h,0,t,i,n)+s(h,t,i,n)+function(e,t,i,n,o,h){let d;d=s(t,n,o,h).length>0?n-r(n,o):t;const u=n,m=function(e,t,i,n,o,a){let c;return c=s(i,n,o,a).length>0?n-r(n,o):t,e<i&&c<=n||e>=i&&c<n?"C":"D"}(e,t,i,n,o,h);return l(a(e,d,i,u,"C"===m,o).length,c(m,h))}(o,h,e,t,i,n);let d;if(h===t)return d=o>e?"D":"C",l(Math.abs(o-e),c(d,n));d=h>t?"D":"C";const u=Math.abs(h-t);return l(function(e,t){return t.cols-e}(h>t?e:o,i)+(u-1)*i.cols+1+((h>t?o:e)-1),c(d,n))}},1296:function(e,t,i){var n=this&&this.__decorate||function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},s=this&&this.__param||function(e,t){return function(i,n){t(i,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.DomRenderer=void 0;const r=i(3787),o=i(2223),a=i(6171),c=i(4725),l=i(8055),h=i(8460),d=i(844),u=i(2585),m="xterm-dom-renderer-owner-",_="xterm-focus";let g=1,p=class extends d.Disposable{constructor(e,t,i,n,s,o,c,l,u,_){super(),this._element=e,this._screenElement=t,this._viewportElement=i,this._linkifier2=n,this._charSizeService=o,this._optionsService=c,this._bufferService=l,this._coreBrowserService=u,this._themeService=_,this._terminalClass=g++,this._rowElements=[],this._cellToRowElements=[],this.onRequestRedraw=this.register(new h.EventEmitter).event,this._rowContainer=document.createElement("div"),this._rowContainer.classList.add("xterm-rows"),this._rowContainer.style.lineHeight="normal",this._rowContainer.setAttribute("aria-hidden","true"),this._refreshRowElements(this._bufferService.cols,this._bufferService.rows),this._selectionContainer=document.createElement("div"),this._selectionContainer.classList.add("xterm-selection"),this._selectionContainer.setAttribute("aria-hidden","true"),this.dimensions=(0,a.createRenderDimensions)(),this._updateDimensions(),this.register(this._optionsService.onOptionChange((()=>this._handleOptionsChanged()))),this.register(this._themeService.onChangeColors((e=>this._injectCss(e)))),this._injectCss(this._themeService.colors),this._rowFactory=s.createInstance(r.DomRendererRowFactory,document),this._element.classList.add(m+this._terminalClass),this._screenElement.appendChild(this._rowContainer),this._screenElement.appendChild(this._selectionContainer),this.register(this._linkifier2.onShowLinkUnderline((e=>this._handleLinkHover(e)))),this.register(this._linkifier2.onHideLinkUnderline((e=>this._handleLinkLeave(e)))),this.register((0,d.toDisposable)((()=>{this._element.classList.remove(m+this._terminalClass),this._rowContainer.remove(),this._selectionContainer.remove(),this._themeStyleElement.remove(),this._dimensionsStyleElement.remove()})))}_updateDimensions(){const e=this._coreBrowserService.dpr;this.dimensions.device.char.width=this._charSizeService.width*e,this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*e),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.left=0,this.dimensions.device.char.top=0,this.dimensions.device.canvas.width=this.dimensions.device.cell.width*this._bufferService.cols,this.dimensions.device.canvas.height=this.dimensions.device.cell.height*this._bufferService.rows,this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/e),this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/e),this.dimensions.css.cell.width=this.dimensions.css.canvas.width/this._bufferService.cols,this.dimensions.css.cell.height=this.dimensions.css.canvas.height/this._bufferService.rows;for(const e of this._rowElements)e.style.width=`${this.dimensions.css.canvas.width}px`,e.style.height=`${this.dimensions.css.cell.height}px`,e.style.lineHeight=`${this.dimensions.css.cell.height}px`,e.style.overflow="hidden";this._dimensionsStyleElement||(this._dimensionsStyleElement=document.createElement("style"),this._screenElement.appendChild(this._dimensionsStyleElement));const t=`${this._terminalSelector} .xterm-rows span { display: inline-block; height: 100%; vertical-align: top; width: ${this.dimensions.css.cell.width}px}`;this._dimensionsStyleElement.textContent=t,this._selectionContainer.style.height=this._viewportElement.style.height,this._screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._screenElement.style.height=`${this.dimensions.css.canvas.height}px`}_injectCss(e){this._themeStyleElement||(this._themeStyleElement=document.createElement("style"),this._screenElement.appendChild(this._themeStyleElement));let t=`${this._terminalSelector} .xterm-rows { color: ${e.foreground.css}; font-family: ${this._optionsService.rawOptions.fontFamily}; font-size: ${this._optionsService.rawOptions.fontSize}px;}`;t+=`${this._terminalSelector} .xterm-rows .xterm-dim { color: ${l.color.multiplyOpacity(e.foreground,.5).css};}`,t+=`${this._terminalSelector} span:not(.${r.BOLD_CLASS}) { font-weight: ${this._optionsService.rawOptions.fontWeight};}${this._terminalSelector} span.${r.BOLD_CLASS} { font-weight: ${this._optionsService.rawOptions.fontWeightBold};}${this._terminalSelector} span.${r.ITALIC_CLASS} { font-style: italic;}`,t+="@keyframes blink_box_shadow_"+this._terminalClass+" { 50% {  box-shadow: none; }}",t+="@keyframes blink_block_"+this._terminalClass+" { 0% {"+`  background-color: ${e.cursor.css};`+`  color: ${e.cursorAccent.css}; } 50% {`+`  background-color: ${e.cursorAccent.css};`+`  color: ${e.cursor.css}; }}`,t+=`${this._terminalSelector} .xterm-rows:not(.xterm-focus) .${r.CURSOR_CLASS}.${r.CURSOR_STYLE_BLOCK_CLASS} ,${this._terminalSelector} .xterm-rows:not(.xterm-focus) .${r.CURSOR_CLASS}.${r.CURSOR_STYLE_BAR_CLASS} ,${this._terminalSelector} .xterm-rows:not(.xterm-focus) .${r.CURSOR_CLASS}.${r.CURSOR_STYLE_UNDERLINE_CLASS} { outline: 1px solid ${e.cursor.css}; outline-offset: -1px;}${this._terminalSelector} .xterm-rows.xterm-focus .${r.CURSOR_CLASS}.${r.CURSOR_BLINK_CLASS}:not(.${r.CURSOR_STYLE_BLOCK_CLASS}) { animation: blink_box_shadow_`+this._terminalClass+" 1s step-end infinite;}"+`${this._terminalSelector} .xterm-rows.xterm-focus .${r.CURSOR_CLASS}.${r.CURSOR_BLINK_CLASS}.${r.CURSOR_STYLE_BLOCK_CLASS} { animation: blink_block_`+this._terminalClass+" 1s step-end infinite;}"+`${this._terminalSelector} .xterm-rows.xterm-focus .${r.CURSOR_CLASS}.${r.CURSOR_STYLE_BLOCK_CLASS} {`+` background-color: ${e.cursor.css};`+` color: ${e.cursorAccent.css};}`+`${this._terminalSelector} .xterm-rows .${r.CURSOR_CLASS}.${r.CURSOR_STYLE_BAR_CLASS} {`+` box-shadow: ${this._optionsService.rawOptions.cursorWidth}px 0 0 ${e.cursor.css} inset;}`+`${this._terminalSelector} .xterm-rows .${r.CURSOR_CLASS}.${r.CURSOR_STYLE_UNDERLINE_CLASS} {`+` box-shadow: 0 -1px 0 ${e.cursor.css} inset;}`,t+=`${this._terminalSelector} .xterm-selection { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}${this._terminalSelector}.focus .xterm-selection div { position: absolute; background-color: ${e.selectionBackgroundOpaque.css};}${this._terminalSelector} .xterm-selection div { position: absolute; background-color: ${e.selectionInactiveBackgroundOpaque.css};}`;for(const[i,n]of e.ansi.entries())t+=`${this._terminalSelector} .xterm-fg-${i} { color: ${n.css}; }${this._terminalSelector} .xterm-fg-${i}.${r.DIM_CLASS} { color: ${l.color.multiplyOpacity(n,.5).css}; }${this._terminalSelector} .xterm-bg-${i} { background-color: ${n.css}; }`;t+=`${this._terminalSelector} .xterm-fg-${o.INVERTED_DEFAULT_COLOR} { color: ${l.color.opaque(e.background).css}; }${this._terminalSelector} .xterm-fg-${o.INVERTED_DEFAULT_COLOR}.${r.DIM_CLASS} { color: ${l.color.multiplyOpacity(l.color.opaque(e.background),.5).css}; }${this._terminalSelector} .xterm-bg-${o.INVERTED_DEFAULT_COLOR} { background-color: ${e.foreground.css}; }`,this._themeStyleElement.textContent=t}handleDevicePixelRatioChange(){this._updateDimensions()}_refreshRowElements(e,t){for(let e=this._rowElements.length;e<=t;e++){const e=document.createElement("div");this._rowContainer.appendChild(e),this._rowElements.push(e)}for(;this._rowElements.length>t;)this._rowContainer.removeChild(this._rowElements.pop())}handleResize(e,t){this._refreshRowElements(e,t),this._updateDimensions()}handleCharSizeChanged(){this._updateDimensions()}handleBlur(){this._rowContainer.classList.remove(_)}handleFocus(){this._rowContainer.classList.add(_)}handleSelectionChanged(e,t,i){for(;this._selectionContainer.children.length;)this._selectionContainer.removeChild(this._selectionContainer.children[0]);if(this._rowFactory.handleSelectionChanged(e,t,i),this.renderRows(0,this._bufferService.rows-1),!e||!t)return;const n=e[1]-this._bufferService.buffer.ydisp,s=t[1]-this._bufferService.buffer.ydisp,r=Math.max(n,0),o=Math.min(s,this._bufferService.rows-1);if(r>=this._bufferService.rows||o<0)return;const a=document.createDocumentFragment();if(i){const i=e[0]>t[0];a.appendChild(this._createSelectionElement(r,i?t[0]:e[0],i?e[0]:t[0],o-r+1))}else{const i=n===r?e[0]:0,c=r===s?t[0]:this._bufferService.cols;a.appendChild(this._createSelectionElement(r,i,c));const l=o-r-1;if(a.appendChild(this._createSelectionElement(r+1,0,this._bufferService.cols,l)),r!==o){const e=s===o?t[0]:this._bufferService.cols;a.appendChild(this._createSelectionElement(o,0,e))}}this._selectionContainer.appendChild(a)}_createSelectionElement(e,t,i,n=1){const s=document.createElement("div");return s.style.height=n*this.dimensions.css.cell.height+"px",s.style.top=e*this.dimensions.css.cell.height+"px",s.style.left=t*this.dimensions.css.cell.width+"px",s.style.width=this.dimensions.css.cell.width*(i-t)+"px",s}handleCursorMove(){}_handleOptionsChanged(){this._updateDimensions(),this._injectCss(this._themeService.colors)}clear(){for(const e of this._rowElements)e.replaceChildren()}renderRows(e,t){const i=this._bufferService.buffer.ybase+this._bufferService.buffer.y,n=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),s=this._optionsService.rawOptions.cursorBlink;for(let r=e;r<=t;r++){const e=this._rowElements[r],t=r+this._bufferService.buffer.ydisp,o=this._bufferService.buffer.lines.get(t),a=this._optionsService.rawOptions.cursorStyle;this._cellToRowElements[r]&&this._cellToRowElements[r].length===this._bufferService.cols||(this._cellToRowElements[r]=new Int16Array(this._bufferService.cols)),e.replaceChildren(this._rowFactory.createRow(o,t,t===i,a,n,s,this.dimensions.css.cell.width,this._bufferService.cols,this._cellToRowElements[r]))}}get _terminalSelector(){return`.${m}${this._terminalClass}`}_handleLinkHover(e){this._setCellUnderline(e.x1,e.x2,e.y1,e.y2,e.cols,!0)}_handleLinkLeave(e){this._setCellUnderline(e.x1,e.x2,e.y1,e.y2,e.cols,!1)}_setCellUnderline(e,t,i,n,s,r){i<0&&(e=0),n<0&&(t=0);const o=this._cellToRowElements.length-1;i=Math.max(Math.min(i,o),0),n=Math.max(Math.min(n,o),0);const a=this._cellToRowElements[i],c=this._cellToRowElements[n];if(!(e>=a.length||t>=c.length)&&(e=a[e],t=c[t],-1!==e&&-1!==t))for(;e!==t||i!==n;){const t=this._rowElements[i];if(!t)return;const n=t.children[e];n&&(n.style.textDecoration=r?"underline":"none"),++e>=s&&(e=0,i++)}}};p=n([s(4,u.IInstantiationService),s(5,c.ICharSizeService),s(6,u.IOptionsService),s(7,u.IBufferService),s(8,c.ICoreBrowserService),s(9,c.IThemeService)],p),t.DomRenderer=p},3787:function(e,t,i){var n=this&&this.__decorate||function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},s=this&&this.__param||function(e,t){return function(i,n){t(i,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.DomRendererRowFactory=t.CURSOR_STYLE_UNDERLINE_CLASS=t.CURSOR_STYLE_BAR_CLASS=t.CURSOR_STYLE_BLOCK_CLASS=t.CURSOR_BLINK_CLASS=t.CURSOR_CLASS=t.STRIKETHROUGH_CLASS=t.OVERLINE_CLASS=t.UNDERLINE_CLASS=t.ITALIC_CLASS=t.DIM_CLASS=t.BOLD_CLASS=void 0;const r=i(2223),o=i(643),a=i(511),c=i(2585),l=i(8055),h=i(4725),d=i(4269),u=i(6171),m=i(3734);t.BOLD_CLASS="xterm-bold",t.DIM_CLASS="xterm-dim",t.ITALIC_CLASS="xterm-italic",t.UNDERLINE_CLASS="xterm-underline",t.OVERLINE_CLASS="xterm-overline",t.STRIKETHROUGH_CLASS="xterm-strikethrough",t.CURSOR_CLASS="xterm-cursor",t.CURSOR_BLINK_CLASS="xterm-cursor-blink",t.CURSOR_STYLE_BLOCK_CLASS="xterm-cursor-block",t.CURSOR_STYLE_BAR_CLASS="xterm-cursor-bar",t.CURSOR_STYLE_UNDERLINE_CLASS="xterm-cursor-underline";let _=class{constructor(e,t,i,n,s,r,o){this._document=e,this._characterJoinerService=t,this._optionsService=i,this._coreBrowserService=n,this._coreService=s,this._decorationService=r,this._themeService=o,this._workCell=new a.CellData,this._columnSelectMode=!1}handleSelectionChanged(e,t,i){this._selectionStart=e,this._selectionEnd=t,this._columnSelectMode=i}createRow(e,i,n,s,a,c,h,u,_){const p=this._document.createDocumentFragment(),f=this._characterJoinerService.getJoinedCharacters(i);let v=0;for(let t=Math.min(e.length,u)-1;t>=0;t--)if(e.loadCell(t,this._workCell).getCode()!==o.NULL_CELL_CODE||n&&t===a){v=t+1;break}const b=this._themeService.colors;let S=-1,w=0;for(;w<v;w++){e.loadCell(w,this._workCell);let u=this._workCell.getWidth();if(0===u){_[w]=S;continue}let v=!1,C=w,y=this._workCell;if(f.length>0&&w===f[0][0]){v=!0;const t=f.shift();y=new d.JoinedCellData(this._workCell,e.translateToString(!0,t[0],t[1]),t[1]-t[0]),C=t[1]-1,u=y.getWidth()}const x=this._document.createElement("span");if(u>1&&(x.style.width=h*u+"px"),v&&(x.style.display="inline",a>=w&&a<=C&&(a=w)),!this._coreService.isCursorHidden&&n&&w===a)switch(x.classList.add(t.CURSOR_CLASS),c&&x.classList.add(t.CURSOR_BLINK_CLASS),s){case"bar":x.classList.add(t.CURSOR_STYLE_BAR_CLASS);break;case"underline":x.classList.add(t.CURSOR_STYLE_UNDERLINE_CLASS);break;default:x.classList.add(t.CURSOR_STYLE_BLOCK_CLASS)}if(y.isBold()&&x.classList.add(t.BOLD_CLASS),y.isItalic()&&x.classList.add(t.ITALIC_CLASS),y.isDim()&&x.classList.add(t.DIM_CLASS),y.isInvisible()?x.textContent=o.WHITESPACE_CELL_CHAR:x.textContent=y.getChars()||o.WHITESPACE_CELL_CHAR,y.isUnderline()&&(x.classList.add(`${t.UNDERLINE_CLASS}-${y.extended.underlineStyle}`)," "===x.textContent&&(x.textContent=" "),!y.isUnderlineColorDefault()))if(y.isUnderlineColorRGB())x.style.textDecorationColor=`rgb(${m.AttributeData.toColorRGB(y.getUnderlineColor()).join(",")})`;else{let e=y.getUnderlineColor();this._optionsService.rawOptions.drawBoldTextInBrightColors&&y.isBold()&&e<8&&(e+=8),x.style.textDecorationColor=b.ansi[e].css}y.isOverline()&&(x.classList.add(t.OVERLINE_CLASS)," "===x.textContent&&(x.textContent=" ")),y.isStrikethrough()&&x.classList.add(t.STRIKETHROUGH_CLASS);let k=y.getFgColor(),I=y.getFgColorMode(),D=y.getBgColor(),T=y.getBgColorMode();const E=!!y.isInverse();if(E){const e=k;k=D,D=e;const t=I;I=T,T=t}let A,L,P=!1;this._decorationService.forEachDecorationAtCell(w,i,void 0,(e=>{"top"!==e.options.layer&&P||(e.backgroundColorRGB&&(T=50331648,D=e.backgroundColorRGB.rgba>>8&16777215,A=e.backgroundColorRGB),e.foregroundColorRGB&&(I=50331648,k=e.foregroundColorRGB.rgba>>8&16777215,L=e.foregroundColorRGB),P="top"===e.options.layer)}));const R=this._isCellInSelection(w,i);let M;switch(P||b.selectionForeground&&R&&(I=50331648,k=b.selectionForeground.rgba>>8&16777215,L=b.selectionForeground),R&&(A=this._coreBrowserService.isFocused?b.selectionBackgroundOpaque:b.selectionInactiveBackgroundOpaque,P=!0),P&&x.classList.add("xterm-decoration-top"),T){case 16777216:case 33554432:M=b.ansi[D],x.classList.add(`xterm-bg-${D}`);break;case 50331648:M=l.rgba.toColor(D>>16,D>>8&255,255&D),this._addStyle(x,`background-color:#${g((D>>>0).toString(16),"0",6)}`);break;default:E?(M=b.foreground,x.classList.add(`xterm-bg-${r.INVERTED_DEFAULT_COLOR}`)):M=b.background}switch(A||y.isDim()&&(A=l.color.multiplyOpacity(M,.5)),I){case 16777216:case 33554432:y.isBold()&&k<8&&this._optionsService.rawOptions.drawBoldTextInBrightColors&&(k+=8),this._applyMinimumContrast(x,M,b.ansi[k],y,A,void 0)||x.classList.add(`xterm-fg-${k}`);break;case 50331648:const e=l.rgba.toColor(k>>16&255,k>>8&255,255&k);this._applyMinimumContrast(x,M,e,y,A,L)||this._addStyle(x,`color:#${g(k.toString(16),"0",6)}`);break;default:this._applyMinimumContrast(x,M,b.foreground,y,A,void 0)||E&&x.classList.add(`xterm-fg-${r.INVERTED_DEFAULT_COLOR}`)}p.appendChild(x),_[w]=++S,w=C}return w<u-1&&_.subarray(w).fill(++S),p}_applyMinimumContrast(e,t,i,n,s,r){if(1===this._optionsService.rawOptions.minimumContrastRatio||(0,u.excludeFromContrastRatioDemands)(n.getCode()))return!1;let o;return s||r||(o=this._themeService.colors.contrastCache.getColor(t.rgba,i.rgba)),void 0===o&&(o=l.color.ensureContrastRatio(s||t,r||i,this._optionsService.rawOptions.minimumContrastRatio),this._themeService.colors.contrastCache.setColor((s||t).rgba,(r||i).rgba,null!=o?o:null)),!!o&&(this._addStyle(e,`color:${o.css}`),!0)}_addStyle(e,t){e.setAttribute("style",`${e.getAttribute("style")||""}${t};`)}_isCellInSelection(e,t){const i=this._selectionStart,n=this._selectionEnd;return!(!i||!n)&&(this._columnSelectMode?i[0]<=n[0]?e>=i[0]&&t>=i[1]&&e<n[0]&&t<=n[1]:e<i[0]&&t>=i[1]&&e>=n[0]&&t<=n[1]:t>i[1]&&t<n[1]||i[1]===n[1]&&t===i[1]&&e>=i[0]&&e<n[0]||i[1]<n[1]&&t===n[1]&&e<n[0]||i[1]<n[1]&&t===i[1]&&e>=i[0])}};function g(e,t,i){for(;e.length<i;)e=t+e;return e}_=n([s(1,h.ICharacterJoinerService),s(2,c.IOptionsService),s(3,h.ICoreBrowserService),s(4,c.ICoreService),s(5,c.IDecorationService),s(6,h.IThemeService)],_),t.DomRendererRowFactory=_},2223:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TEXT_BASELINE=t.DIM_OPACITY=t.INVERTED_DEFAULT_COLOR=void 0;const n=i(6114);t.INVERTED_DEFAULT_COLOR=257,t.DIM_OPACITY=.5,t.TEXT_BASELINE=n.isFirefox||n.isLegacyEdge?"bottom":"ideographic"},6171:(e,t)=>{function i(e){return 57508<=e&&e<=57558}Object.defineProperty(t,"__esModule",{value:!0}),t.createRenderDimensions=t.excludeFromContrastRatioDemands=t.isRestrictedPowerlineGlyph=t.isPowerlineGlyph=t.throwIfFalsy=void 0,t.throwIfFalsy=function(e){if(!e)throw new Error("value must not be falsy");return e},t.isPowerlineGlyph=i,t.isRestrictedPowerlineGlyph=function(e){return 57520<=e&&e<=57527},t.excludeFromContrastRatioDemands=function(e){return i(e)||function(e){return 9472<=e&&e<=9631}(e)},t.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}}},456:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SelectionModel=void 0,t.SelectionModel=class{constructor(e){this._bufferService=e,this.isSelectAllActive=!1,this.selectionStartLength=0}clearSelection(){this.selectionStart=void 0,this.selectionEnd=void 0,this.isSelectAllActive=!1,this.selectionStartLength=0}get finalSelectionStart(){return this.isSelectAllActive?[0,0]:this.selectionEnd&&this.selectionStart&&this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart}get finalSelectionEnd(){if(this.isSelectAllActive)return[this._bufferService.cols,this._bufferService.buffer.ybase+this._bufferService.rows-1];if(this.selectionStart){if(!this.selectionEnd||this.areSelectionValuesReversed()){const e=this.selectionStart[0]+this.selectionStartLength;return e>this._bufferService.cols?e%this._bufferService.cols==0?[this._bufferService.cols,this.selectionStart[1]+Math.floor(e/this._bufferService.cols)-1]:[e%this._bufferService.cols,this.selectionStart[1]+Math.floor(e/this._bufferService.cols)]:[e,this.selectionStart[1]]}if(this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]){const e=this.selectionStart[0]+this.selectionStartLength;return e>this._bufferService.cols?[e%this._bufferService.cols,this.selectionStart[1]+Math.floor(e/this._bufferService.cols)]:[Math.max(e,this.selectionEnd[0]),this.selectionEnd[1]]}return this.selectionEnd}}areSelectionValuesReversed(){const e=this.selectionStart,t=this.selectionEnd;return!(!e||!t)&&(e[1]>t[1]||e[1]===t[1]&&e[0]>t[0])}handleTrim(e){return this.selectionStart&&(this.selectionStart[1]-=e),this.selectionEnd&&(this.selectionEnd[1]-=e),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),!0):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),!1)}}},428:function(e,t,i){var n=this&&this.__decorate||function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},s=this&&this.__param||function(e,t){return function(i,n){t(i,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CharSizeService=void 0;const r=i(2585),o=i(8460),a=i(844);let c=class extends a.Disposable{constructor(e,t,i){super(),this._optionsService=i,this.width=0,this.height=0,this._onCharSizeChange=this.register(new o.EventEmitter),this.onCharSizeChange=this._onCharSizeChange.event,this._measureStrategy=new l(e,t,this._optionsService),this.register(this._optionsService.onMultipleOptionChange(["fontFamily","fontSize"],(()=>this.measure())))}get hasValidSize(){return this.width>0&&this.height>0}measure(){const e=this._measureStrategy.measure();e.width===this.width&&e.height===this.height||(this.width=e.width,this.height=e.height,this._onCharSizeChange.fire())}};c=n([s(2,r.IOptionsService)],c),t.CharSizeService=c;class l{constructor(e,t,i){this._document=e,this._parentElement=t,this._optionsService=i,this._result={width:0,height:0},this._measureElement=this._document.createElement("span"),this._measureElement.classList.add("xterm-char-measure-element"),this._measureElement.textContent="W",this._measureElement.setAttribute("aria-hidden","true"),this._parentElement.appendChild(this._measureElement)}measure(){this._measureElement.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._measureElement.style.fontSize=`${this._optionsService.rawOptions.fontSize}px`;const e=this._measureElement.getBoundingClientRect();return 0!==e.width&&0!==e.height&&(this._result.width=e.width,this._result.height=Math.ceil(e.height)),this._result}}},4269:function(e,t,i){var n=this&&this.__decorate||function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},s=this&&this.__param||function(e,t){return function(i,n){t(i,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CharacterJoinerService=t.JoinedCellData=void 0;const r=i(3734),o=i(643),a=i(511),c=i(2585);class l extends r.AttributeData{constructor(e,t,i){super(),this.content=0,this.combinedData="",this.fg=e.fg,this.bg=e.bg,this.combinedData=t,this._width=i}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(e){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}t.JoinedCellData=l;let h=class e{constructor(e){this._bufferService=e,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new a.CellData}register(e){const t={id:this._nextCharacterJoinerId++,handler:e};return this._characterJoiners.push(t),t.id}deregister(e){for(let t=0;t<this._characterJoiners.length;t++)if(this._characterJoiners[t].id===e)return this._characterJoiners.splice(t,1),!0;return!1}getJoinedCharacters(e){if(0===this._characterJoiners.length)return[];const t=this._bufferService.buffer.lines.get(e);if(!t||0===t.length)return[];const i=[],n=t.translateToString(!0);let s=0,r=0,a=0,c=t.getFg(0),l=t.getBg(0);for(let e=0;e<t.getTrimmedLength();e++)if(t.loadCell(e,this._workCell),0!==this._workCell.getWidth()){if(this._workCell.fg!==c||this._workCell.bg!==l){if(e-s>1){const e=this._getJoinedRanges(n,a,r,t,s);for(let t=0;t<e.length;t++)i.push(e[t])}s=e,a=r,c=this._workCell.fg,l=this._workCell.bg}r+=this._workCell.getChars().length||o.WHITESPACE_CELL_CHAR.length}if(this._bufferService.cols-s>1){const e=this._getJoinedRanges(n,a,r,t,s);for(let t=0;t<e.length;t++)i.push(e[t])}return i}_getJoinedRanges(t,i,n,s,r){const o=t.substring(i,n);let a=[];try{a=this._characterJoiners[0].handler(o)}catch(e){console.error(e)}for(let t=1;t<this._characterJoiners.length;t++)try{const i=this._characterJoiners[t].handler(o);for(let t=0;t<i.length;t++)e._mergeRanges(a,i[t])}catch(e){console.error(e)}return this._stringRangesToCellRanges(a,s,r),a}_stringRangesToCellRanges(e,t,i){let n=0,s=!1,r=0,a=e[n];if(a){for(let c=i;c<this._bufferService.cols;c++){const i=t.getWidth(c),l=t.getString(c).length||o.WHITESPACE_CELL_CHAR.length;if(0!==i){if(!s&&a[0]<=r&&(a[0]=c,s=!0),a[1]<=r){if(a[1]=c,a=e[++n],!a)break;a[0]<=r?(a[0]=c,s=!0):s=!1}r+=l}}a&&(a[1]=this._bufferService.cols)}}static _mergeRanges(e,t){let i=!1;for(let n=0;n<e.length;n++){const s=e[n];if(i){if(t[1]<=s[0])return e[n-1][1]=t[1],e;if(t[1]<=s[1])return e[n-1][1]=Math.max(t[1],s[1]),e.splice(n,1),e;e.splice(n,1),n--}else{if(t[1]<=s[0])return e.splice(n,0,t),e;if(t[1]<=s[1])return s[0]=Math.min(t[0],s[0]),e;t[0]<s[1]&&(s[0]=Math.min(t[0],s[0]),i=!0)}}return i?e[e.length-1][1]=t[1]:e.push(t),e}};h=n([s(0,c.IBufferService)],h),t.CharacterJoinerService=h},5114:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CoreBrowserService=void 0,t.CoreBrowserService=class{constructor(e,t){this._textarea=e,this.window=t,this._isFocused=!1,this._cachedIsFocused=void 0,this._textarea.addEventListener("focus",(()=>this._isFocused=!0)),this._textarea.addEventListener("blur",(()=>this._isFocused=!1))}get dpr(){return this.window.devicePixelRatio}get isFocused(){return void 0===this._cachedIsFocused&&(this._cachedIsFocused=this._isFocused&&this._textarea.ownerDocument.hasFocus(),queueMicrotask((()=>this._cachedIsFocused=void 0))),this._cachedIsFocused}}},8934:function(e,t,i){var n=this&&this.__decorate||function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},s=this&&this.__param||function(e,t){return function(i,n){t(i,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.MouseService=void 0;const r=i(4725),o=i(9806);let a=class{constructor(e,t){this._renderService=e,this._charSizeService=t}getCoords(e,t,i,n,s){return(0,o.getCoords)(window,e,t,i,n,this._charSizeService.hasValidSize,this._renderService.dimensions.css.cell.width,this._renderService.dimensions.css.cell.height,s)}getMouseReportCoords(e,t){const i=(0,o.getCoordsRelativeToElement)(window,e,t);if(!(!this._charSizeService.hasValidSize||i[0]<0||i[1]<0||i[0]>=this._renderService.dimensions.css.canvas.width||i[1]>=this._renderService.dimensions.css.canvas.height))return{col:Math.floor(i[0]/this._renderService.dimensions.css.cell.width),row:Math.floor(i[1]/this._renderService.dimensions.css.cell.height),x:Math.floor(i[0]),y:Math.floor(i[1])}}};a=n([s(0,r.IRenderService),s(1,r.ICharSizeService)],a),t.MouseService=a},3230:function(e,t,i){var n=this&&this.__decorate||function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},s=this&&this.__param||function(e,t){return function(i,n){t(i,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.RenderService=void 0;const r=i(6193),o=i(8460),a=i(844),c=i(5596),l=i(3656),h=i(2585),d=i(4725),u=i(7226);let m=class extends a.Disposable{constructor(e,t,i,n,s,a,h,d){if(super(),this._rowCount=e,this._charSizeService=n,this._pausedResizeTask=new u.DebouncedIdleTask,this._isPaused=!1,this._needsFullRefresh=!1,this._isNextRenderRedrawOnly=!0,this._needsSelectionRefresh=!1,this._canvasWidth=0,this._canvasHeight=0,this._selectionState={start:void 0,end:void 0,columnSelectMode:!1},this._onDimensionsChange=this.register(new o.EventEmitter),this.onDimensionsChange=this._onDimensionsChange.event,this._onRenderedViewportChange=this.register(new o.EventEmitter),this.onRenderedViewportChange=this._onRenderedViewportChange.event,this._onRender=this.register(new o.EventEmitter),this.onRender=this._onRender.event,this._onRefreshRequest=this.register(new o.EventEmitter),this.onRefreshRequest=this._onRefreshRequest.event,this.register({dispose:()=>{var e;return null===(e=this._renderer)||void 0===e?void 0:e.dispose()}}),this._renderDebouncer=new r.RenderDebouncer(h.window,((e,t)=>this._renderRows(e,t))),this.register(this._renderDebouncer),this._screenDprMonitor=new c.ScreenDprMonitor(h.window),this._screenDprMonitor.setListener((()=>this.handleDevicePixelRatioChange())),this.register(this._screenDprMonitor),this.register(a.onResize((()=>this._fullRefresh()))),this.register(a.buffers.onBufferActivate((()=>{var e;return null===(e=this._renderer)||void 0===e?void 0:e.clear()}))),this.register(i.onOptionChange((()=>this._handleOptionsChanged()))),this.register(this._charSizeService.onCharSizeChange((()=>this.handleCharSizeChanged()))),this.register(s.onDecorationRegistered((()=>this._fullRefresh()))),this.register(s.onDecorationRemoved((()=>this._fullRefresh()))),this.register(i.onMultipleOptionChange(["customGlyphs","drawBoldTextInBrightColors","letterSpacing","lineHeight","fontFamily","fontSize","fontWeight","fontWeightBold","minimumContrastRatio"],(()=>{this.clear(),this.handleResize(a.cols,a.rows),this._fullRefresh()}))),this.register(i.onMultipleOptionChange(["cursorBlink","cursorStyle"],(()=>this.refreshRows(a.buffer.y,a.buffer.y,!0)))),this.register((0,l.addDisposableDomListener)(h.window,"resize",(()=>this.handleDevicePixelRatioChange()))),this.register(d.onChangeColors((()=>this._fullRefresh()))),"IntersectionObserver"in h.window){const e=new h.window.IntersectionObserver((e=>this._handleIntersectionChange(e[e.length-1])),{threshold:0});e.observe(t),this.register({dispose:()=>e.disconnect()})}}get dimensions(){return this._renderer.dimensions}_handleIntersectionChange(e){this._isPaused=void 0===e.isIntersecting?0===e.intersectionRatio:!e.isIntersecting,this._isPaused||this._charSizeService.hasValidSize||this._charSizeService.measure(),!this._isPaused&&this._needsFullRefresh&&(this._pausedResizeTask.flush(),this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=!1)}refreshRows(e,t,i=!1){this._isPaused?this._needsFullRefresh=!0:(i||(this._isNextRenderRedrawOnly=!1),this._renderDebouncer.refresh(e,t,this._rowCount))}_renderRows(e,t){this._renderer&&(e=Math.min(e,this._rowCount-1),t=Math.min(t,this._rowCount-1),this._renderer.renderRows(e,t),this._needsSelectionRefresh&&(this._renderer.handleSelectionChanged(this._selectionState.start,this._selectionState.end,this._selectionState.columnSelectMode),this._needsSelectionRefresh=!1),this._isNextRenderRedrawOnly||this._onRenderedViewportChange.fire({start:e,end:t}),this._onRender.fire({start:e,end:t}),this._isNextRenderRedrawOnly=!0)}resize(e,t){this._rowCount=t,this._fireOnCanvasResize()}_handleOptionsChanged(){this._renderer&&(this.refreshRows(0,this._rowCount-1),this._fireOnCanvasResize())}_fireOnCanvasResize(){this._renderer&&(this._renderer.dimensions.css.canvas.width===this._canvasWidth&&this._renderer.dimensions.css.canvas.height===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.dimensions))}hasRenderer(){return!!this._renderer}setRenderer(e){var t;null===(t=this._renderer)||void 0===t||t.dispose(),this._renderer=e,this._renderer.onRequestRedraw((e=>this.refreshRows(e.start,e.end,!0))),this._needsSelectionRefresh=!0,this._fullRefresh()}addRefreshCallback(e){return this._renderDebouncer.addRefreshCallback(e)}_fullRefresh(){this._isPaused?this._needsFullRefresh=!0:this.refreshRows(0,this._rowCount-1)}clearTextureAtlas(){var e,t;this._renderer&&(null===(t=(e=this._renderer).clearTextureAtlas)||void 0===t||t.call(e),this._fullRefresh())}handleDevicePixelRatioChange(){this._charSizeService.measure(),this._renderer&&(this._renderer.handleDevicePixelRatioChange(),this.refreshRows(0,this._rowCount-1))}handleResize(e,t){this._renderer&&(this._isPaused?this._pausedResizeTask.set((()=>this._renderer.handleResize(e,t))):this._renderer.handleResize(e,t),this._fullRefresh())}handleCharSizeChanged(){var e;null===(e=this._renderer)||void 0===e||e.handleCharSizeChanged()}handleBlur(){var e;null===(e=this._renderer)||void 0===e||e.handleBlur()}handleFocus(){var e;null===(e=this._renderer)||void 0===e||e.handleFocus()}handleSelectionChanged(e,t,i){var n;this._selectionState.start=e,this._selectionState.end=t,this._selectionState.columnSelectMode=i,null===(n=this._renderer)||void 0===n||n.handleSelectionChanged(e,t,i)}handleCursorMove(){var e;null===(e=this._renderer)||void 0===e||e.handleCursorMove()}clear(){var e;null===(e=this._renderer)||void 0===e||e.clear()}};m=n([s(2,h.IOptionsService),s(3,d.ICharSizeService),s(4,h.IDecorationService),s(5,h.IBufferService),s(6,d.ICoreBrowserService),s(7,d.IThemeService)],m),t.RenderService=m},9312:function(e,t,i){var n=this&&this.__decorate||function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},s=this&&this.__param||function(e,t){return function(i,n){t(i,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.SelectionService=void 0;const r=i(6114),o=i(456),a=i(511),c=i(8460),l=i(4725),h=i(2585),d=i(9806),u=i(9504),m=i(844),_=i(4841),g=String.fromCharCode(160),p=new RegExp(g,"g");let f=class extends m.Disposable{constructor(e,t,i,n,s,r,l,h,d){super(),this._element=e,this._screenElement=t,this._linkifier=i,this._bufferService=n,this._coreService=s,this._mouseService=r,this._optionsService=l,this._renderService=h,this._coreBrowserService=d,this._dragScrollAmount=0,this._enabled=!0,this._workCell=new a.CellData,this._mouseDownTimeStamp=0,this._oldHasSelection=!1,this._oldSelectionStart=void 0,this._oldSelectionEnd=void 0,this._onLinuxMouseSelection=this.register(new c.EventEmitter),this.onLinuxMouseSelection=this._onLinuxMouseSelection.event,this._onRedrawRequest=this.register(new c.EventEmitter),this.onRequestRedraw=this._onRedrawRequest.event,this._onSelectionChange=this.register(new c.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onRequestScrollLines=this.register(new c.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this._mouseMoveListener=e=>this._handleMouseMove(e),this._mouseUpListener=e=>this._handleMouseUp(e),this._coreService.onUserInput((()=>{this.hasSelection&&this.clearSelection()})),this._trimListener=this._bufferService.buffer.lines.onTrim((e=>this._handleTrim(e))),this.register(this._bufferService.buffers.onBufferActivate((e=>this._handleBufferActivate(e)))),this.enable(),this._model=new o.SelectionModel(this._bufferService),this._activeSelectionMode=0,this.register((0,m.toDisposable)((()=>{this._removeMouseDownListeners()})))}reset(){this.clearSelection()}disable(){this.clearSelection(),this._enabled=!1}enable(){this._enabled=!0}get selectionStart(){return this._model.finalSelectionStart}get selectionEnd(){return this._model.finalSelectionEnd}get hasSelection(){const e=this._model.finalSelectionStart,t=this._model.finalSelectionEnd;return!(!e||!t||e[0]===t[0]&&e[1]===t[1])}get selectionText(){const e=this._model.finalSelectionStart,t=this._model.finalSelectionEnd;if(!e||!t)return"";const i=this._bufferService.buffer,n=[];if(3===this._activeSelectionMode){if(e[0]===t[0])return"";const s=e[0]<t[0]?e[0]:t[0],r=e[0]<t[0]?t[0]:e[0];for(let o=e[1];o<=t[1];o++){const e=i.translateBufferLineToString(o,!0,s,r);n.push(e)}}else{const s=e[1]===t[1]?t[0]:void 0;n.push(i.translateBufferLineToString(e[1],!0,e[0],s));for(let s=e[1]+1;s<=t[1]-1;s++){const e=i.lines.get(s),t=i.translateBufferLineToString(s,!0);(null==e?void 0:e.isWrapped)?n[n.length-1]+=t:n.push(t)}if(e[1]!==t[1]){const e=i.lines.get(t[1]),s=i.translateBufferLineToString(t[1],!0,0,t[0]);e&&e.isWrapped?n[n.length-1]+=s:n.push(s)}}return n.map((e=>e.replace(p," "))).join(r.isWindows?"\r\n":"\n")}clearSelection(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()}refresh(e){this._refreshAnimationFrame||(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame((()=>this._refresh()))),r.isLinux&&e&&this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText)}_refresh(){this._refreshAnimationFrame=void 0,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:3===this._activeSelectionMode})}_isClickInSelection(e){const t=this._getMouseBufferCoords(e),i=this._model.finalSelectionStart,n=this._model.finalSelectionEnd;return!!(i&&n&&t)&&this._areCoordsInSelection(t,i,n)}isCellInSelection(e,t){const i=this._model.finalSelectionStart,n=this._model.finalSelectionEnd;return!(!i||!n)&&this._areCoordsInSelection([e,t],i,n)}_areCoordsInSelection(e,t,i){return e[1]>t[1]&&e[1]<i[1]||t[1]===i[1]&&e[1]===t[1]&&e[0]>=t[0]&&e[0]<i[0]||t[1]<i[1]&&e[1]===i[1]&&e[0]<i[0]||t[1]<i[1]&&e[1]===t[1]&&e[0]>=t[0]}_selectWordAtCursor(e,t){var i,n;const s=null===(n=null===(i=this._linkifier.currentLink)||void 0===i?void 0:i.link)||void 0===n?void 0:n.range;if(s)return this._model.selectionStart=[s.start.x-1,s.start.y-1],this._model.selectionStartLength=(0,_.getRangeLength)(s,this._bufferService.cols),this._model.selectionEnd=void 0,!0;const r=this._getMouseBufferCoords(e);return!!r&&(this._selectWordAt(r,t),this._model.selectionEnd=void 0,!0)}selectAll(){this._model.isSelectAllActive=!0,this.refresh(),this._onSelectionChange.fire()}selectLines(e,t){this._model.clearSelection(),e=Math.max(e,0),t=Math.min(t,this._bufferService.buffer.lines.length-1),this._model.selectionStart=[0,e],this._model.selectionEnd=[this._bufferService.cols,t],this.refresh(),this._onSelectionChange.fire()}_handleTrim(e){this._model.handleTrim(e)&&this.refresh()}_getMouseBufferCoords(e){const t=this._mouseService.getCoords(e,this._screenElement,this._bufferService.cols,this._bufferService.rows,!0);if(t)return t[0]--,t[1]--,t[1]+=this._bufferService.buffer.ydisp,t}_getMouseEventScrollAmount(e){let t=(0,d.getCoordsRelativeToElement)(this._coreBrowserService.window,e,this._screenElement)[1];const i=this._renderService.dimensions.css.canvas.height;return t>=0&&t<=i?0:(t>i&&(t-=i),t=Math.min(Math.max(t,-50),50),t/=50,t/Math.abs(t)+Math.round(14*t))}shouldForceSelection(e){return r.isMac?e.altKey&&this._optionsService.rawOptions.macOptionClickForcesSelection:e.shiftKey}handleMouseDown(e){if(this._mouseDownTimeStamp=e.timeStamp,(2!==e.button||!this.hasSelection)&&0===e.button){if(!this._enabled){if(!this.shouldForceSelection(e))return;e.stopPropagation()}e.preventDefault(),this._dragScrollAmount=0,this._enabled&&e.shiftKey?this._handleIncrementalClick(e):1===e.detail?this._handleSingleClick(e):2===e.detail?this._handleDoubleClick(e):3===e.detail&&this._handleTripleClick(e),this._addMouseDownListeners(),this.refresh(!0)}}_addMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.addEventListener("mouseup",this._mouseUpListener)),this._dragScrollIntervalTimer=this._coreBrowserService.window.setInterval((()=>this._dragScroll()),50)}_removeMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),this._coreBrowserService.window.clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=void 0}_handleIncrementalClick(e){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(e))}_handleSingleClick(e){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=!1,this._activeSelectionMode=this.shouldColumnSelect(e)?3:0,this._model.selectionStart=this._getMouseBufferCoords(e),!this._model.selectionStart)return;this._model.selectionEnd=void 0;const t=this._bufferService.buffer.lines.get(this._model.selectionStart[1]);t&&t.length!==this._model.selectionStart[0]&&0===t.hasWidth(this._model.selectionStart[0])&&this._model.selectionStart[0]++}_handleDoubleClick(e){this._selectWordAtCursor(e,!0)&&(this._activeSelectionMode=1)}_handleTripleClick(e){const t=this._getMouseBufferCoords(e);t&&(this._activeSelectionMode=2,this._selectLineAt(t[1]))}shouldColumnSelect(e){return e.altKey&&!(r.isMac&&this._optionsService.rawOptions.macOptionClickForcesSelection)}_handleMouseMove(e){if(e.stopImmediatePropagation(),!this._model.selectionStart)return;const t=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;if(this._model.selectionEnd=this._getMouseBufferCoords(e),!this._model.selectionEnd)return void this.refresh(!0);2===this._activeSelectionMode?this._model.selectionEnd[1]<this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._bufferService.cols:1===this._activeSelectionMode&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(e),3!==this._activeSelectionMode&&(this._dragScrollAmount>0?this._model.selectionEnd[0]=this._bufferService.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0));const i=this._bufferService.buffer;if(this._model.selectionEnd[1]<i.lines.length){const e=i.lines.get(this._model.selectionEnd[1]);e&&0===e.hasWidth(this._model.selectionEnd[0])&&this._model.selectionEnd[0]++}t&&t[0]===this._model.selectionEnd[0]&&t[1]===this._model.selectionEnd[1]||this.refresh(!0)}_dragScroll(){if(this._model.selectionEnd&&this._model.selectionStart&&this._dragScrollAmount){this._onRequestScrollLines.fire({amount:this._dragScrollAmount,suppressScrollEvent:!1});const e=this._bufferService.buffer;this._dragScrollAmount>0?(3!==this._activeSelectionMode&&(this._model.selectionEnd[0]=this._bufferService.cols),this._model.selectionEnd[1]=Math.min(e.ydisp+this._bufferService.rows,e.lines.length-1)):(3!==this._activeSelectionMode&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=e.ydisp),this.refresh()}}_handleMouseUp(e){const t=e.timeStamp-this._mouseDownTimeStamp;if(this._removeMouseDownListeners(),this.selectionText.length<=1&&t<500&&e.altKey&&this._optionsService.rawOptions.altClickMovesCursor){if(this._bufferService.buffer.ybase===this._bufferService.buffer.ydisp){const t=this._mouseService.getCoords(e,this._element,this._bufferService.cols,this._bufferService.rows,!1);if(t&&void 0!==t[0]&&void 0!==t[1]){const e=(0,u.moveToCellSequence)(t[0]-1,t[1]-1,this._bufferService,this._coreService.decPrivateModes.applicationCursorKeys);this._coreService.triggerDataEvent(e,!0)}}}else this._fireEventIfSelectionChanged()}_fireEventIfSelectionChanged(){const e=this._model.finalSelectionStart,t=this._model.finalSelectionEnd,i=!(!e||!t||e[0]===t[0]&&e[1]===t[1]);i?e&&t&&(this._oldSelectionStart&&this._oldSelectionEnd&&e[0]===this._oldSelectionStart[0]&&e[1]===this._oldSelectionStart[1]&&t[0]===this._oldSelectionEnd[0]&&t[1]===this._oldSelectionEnd[1]||this._fireOnSelectionChange(e,t,i)):this._oldHasSelection&&this._fireOnSelectionChange(e,t,i)}_fireOnSelectionChange(e,t,i){this._oldSelectionStart=e,this._oldSelectionEnd=t,this._oldHasSelection=i,this._onSelectionChange.fire()}_handleBufferActivate(e){this.clearSelection(),this._trimListener.dispose(),this._trimListener=e.activeBuffer.lines.onTrim((e=>this._handleTrim(e)))}_convertViewportColToCharacterIndex(e,t){let i=t;for(let n=0;t>=n;n++){const s=e.loadCell(n,this._workCell).getChars().length;0===this._workCell.getWidth()?i--:s>1&&t!==n&&(i+=s-1)}return i}setSelection(e,t,i){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[e,t],this._model.selectionStartLength=i,this.refresh(),this._fireEventIfSelectionChanged()}rightClickSelect(e){this._isClickInSelection(e)||(this._selectWordAtCursor(e,!1)&&this.refresh(!0),this._fireEventIfSelectionChanged())}_getWordAt(e,t,i=!0,n=!0){if(e[0]>=this._bufferService.cols)return;const s=this._bufferService.buffer,r=s.lines.get(e[1]);if(!r)return;const o=s.translateBufferLineToString(e[1],!1);let a=this._convertViewportColToCharacterIndex(r,e[0]),c=a;const l=e[0]-a;let h=0,d=0,u=0,m=0;if(" "===o.charAt(a)){for(;a>0&&" "===o.charAt(a-1);)a--;for(;c<o.length&&" "===o.charAt(c+1);)c++}else{let t=e[0],i=e[0];0===r.getWidth(t)&&(h++,t--),2===r.getWidth(i)&&(d++,i++);const n=r.getString(i).length;for(n>1&&(m+=n-1,c+=n-1);t>0&&a>0&&!this._isCharWordSeparator(r.loadCell(t-1,this._workCell));){r.loadCell(t-1,this._workCell);const e=this._workCell.getChars().length;0===this._workCell.getWidth()?(h++,t--):e>1&&(u+=e-1,a-=e-1),a--,t--}for(;i<r.length&&c+1<o.length&&!this._isCharWordSeparator(r.loadCell(i+1,this._workCell));){r.loadCell(i+1,this._workCell);const e=this._workCell.getChars().length;2===this._workCell.getWidth()?(d++,i++):e>1&&(m+=e-1,c+=e-1),c++,i++}}c++;let _=a+l-h+u,g=Math.min(this._bufferService.cols,c-a+h+d-u-m);if(t||""!==o.slice(a,c).trim()){if(i&&0===_&&32!==r.getCodePoint(0)){const t=s.lines.get(e[1]-1);if(t&&r.isWrapped&&32!==t.getCodePoint(this._bufferService.cols-1)){const t=this._getWordAt([this._bufferService.cols-1,e[1]-1],!1,!0,!1);if(t){const e=this._bufferService.cols-t.start;_-=e,g+=e}}}if(n&&_+g===this._bufferService.cols&&32!==r.getCodePoint(this._bufferService.cols-1)){const t=s.lines.get(e[1]+1);if((null==t?void 0:t.isWrapped)&&32!==t.getCodePoint(0)){const t=this._getWordAt([0,e[1]+1],!1,!1,!0);t&&(g+=t.length)}}return{start:_,length:g}}}_selectWordAt(e,t){const i=this._getWordAt(e,t);if(i){for(;i.start<0;)i.start+=this._bufferService.cols,e[1]--;this._model.selectionStart=[i.start,e[1]],this._model.selectionStartLength=i.length}}_selectToWordAt(e){const t=this._getWordAt(e,!0);if(t){let i=e[1];for(;t.start<0;)t.start+=this._bufferService.cols,i--;if(!this._model.areSelectionValuesReversed())for(;t.start+t.length>this._bufferService.cols;)t.length-=this._bufferService.cols,i++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?t.start:t.start+t.length,i]}}_isCharWordSeparator(e){return 0!==e.getWidth()&&this._optionsService.rawOptions.wordSeparator.indexOf(e.getChars())>=0}_selectLineAt(e){const t=this._bufferService.buffer.getWrappedRangeForLine(e),i={start:{x:0,y:t.first},end:{x:this._bufferService.cols-1,y:t.last}};this._model.selectionStart=[0,t.first],this._model.selectionEnd=void 0,this._model.selectionStartLength=(0,_.getRangeLength)(i,this._bufferService.cols)}};f=n([s(3,h.IBufferService),s(4,h.ICoreService),s(5,l.IMouseService),s(6,h.IOptionsService),s(7,l.IRenderService),s(8,l.ICoreBrowserService)],f),t.SelectionService=f},4725:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.IThemeService=t.ICharacterJoinerService=t.ISelectionService=t.IRenderService=t.IMouseService=t.ICoreBrowserService=t.ICharSizeService=void 0;const n=i(8343);t.ICharSizeService=(0,n.createDecorator)("CharSizeService"),t.ICoreBrowserService=(0,n.createDecorator)("CoreBrowserService"),t.IMouseService=(0,n.createDecorator)("MouseService"),t.IRenderService=(0,n.createDecorator)("RenderService"),t.ISelectionService=(0,n.createDecorator)("SelectionService"),t.ICharacterJoinerService=(0,n.createDecorator)("CharacterJoinerService"),t.IThemeService=(0,n.createDecorator)("ThemeService")},6731:function(e,t,i){var n=this&&this.__decorate||function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},s=this&&this.__param||function(e,t){return function(i,n){t(i,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ThemeService=t.DEFAULT_ANSI_COLORS=void 0;const r=i(7239),o=i(8055),a=i(8460),c=i(844),l=i(2585),h=o.css.toColor("#ffffff"),d=o.css.toColor("#000000"),u=o.css.toColor("#ffffff"),m=o.css.toColor("#000000"),_={css:"rgba(255, 255, 255, 0.3)",rgba:4294967117};t.DEFAULT_ANSI_COLORS=Object.freeze((()=>{const e=[o.css.toColor("#2e3436"),o.css.toColor("#cc0000"),o.css.toColor("#4e9a06"),o.css.toColor("#c4a000"),o.css.toColor("#3465a4"),o.css.toColor("#75507b"),o.css.toColor("#06989a"),o.css.toColor("#d3d7cf"),o.css.toColor("#555753"),o.css.toColor("#ef2929"),o.css.toColor("#8ae234"),o.css.toColor("#fce94f"),o.css.toColor("#729fcf"),o.css.toColor("#ad7fa8"),o.css.toColor("#34e2e2"),o.css.toColor("#eeeeec")],t=[0,95,135,175,215,255];for(let i=0;i<216;i++){const n=t[i/36%6|0],s=t[i/6%6|0],r=t[i%6];e.push({css:o.channels.toCss(n,s,r),rgba:o.channels.toRgba(n,s,r)})}for(let t=0;t<24;t++){const i=8+10*t;e.push({css:o.channels.toCss(i,i,i),rgba:o.channels.toRgba(i,i,i)})}return e})());let g=class extends c.Disposable{constructor(e){super(),this._optionsService=e,this._onChangeColors=this.register(new a.EventEmitter),this.onChangeColors=this._onChangeColors.event,this._contrastCache=new r.ColorContrastCache,this._colors={foreground:h,background:d,cursor:u,cursorAccent:m,selectionForeground:void 0,selectionBackgroundTransparent:_,selectionBackgroundOpaque:o.color.blend(d,_),selectionInactiveBackgroundTransparent:_,selectionInactiveBackgroundOpaque:o.color.blend(d,_),ansi:t.DEFAULT_ANSI_COLORS.slice(),contrastCache:this._contrastCache},this._updateRestoreColors(),this._setTheme(this._optionsService.rawOptions.theme),this.register(this._optionsService.onSpecificOptionChange("minimumContrastRatio",(()=>this._contrastCache.clear()))),this.register(this._optionsService.onSpecificOptionChange("theme",(()=>this._setTheme(this._optionsService.rawOptions.theme))))}get colors(){return this._colors}_setTheme(e={}){const i=this._colors;if(i.foreground=p(e.foreground,h),i.background=p(e.background,d),i.cursor=p(e.cursor,u),i.cursorAccent=p(e.cursorAccent,m),i.selectionBackgroundTransparent=p(e.selectionBackground,_),i.selectionBackgroundOpaque=o.color.blend(i.background,i.selectionBackgroundTransparent),i.selectionInactiveBackgroundTransparent=p(e.selectionInactiveBackground,i.selectionBackgroundTransparent),i.selectionInactiveBackgroundOpaque=o.color.blend(i.background,i.selectionInactiveBackgroundTransparent),i.selectionForeground=e.selectionForeground?p(e.selectionForeground,o.NULL_COLOR):void 0,i.selectionForeground===o.NULL_COLOR&&(i.selectionForeground=void 0),o.color.isOpaque(i.selectionBackgroundTransparent)){const e=.3;i.selectionBackgroundTransparent=o.color.opacity(i.selectionBackgroundTransparent,e)}if(o.color.isOpaque(i.selectionInactiveBackgroundTransparent)){const e=.3;i.selectionInactiveBackgroundTransparent=o.color.opacity(i.selectionInactiveBackgroundTransparent,e)}if(i.ansi=t.DEFAULT_ANSI_COLORS.slice(),i.ansi[0]=p(e.black,t.DEFAULT_ANSI_COLORS[0]),i.ansi[1]=p(e.red,t.DEFAULT_ANSI_COLORS[1]),i.ansi[2]=p(e.green,t.DEFAULT_ANSI_COLORS[2]),i.ansi[3]=p(e.yellow,t.DEFAULT_ANSI_COLORS[3]),i.ansi[4]=p(e.blue,t.DEFAULT_ANSI_COLORS[4]),i.ansi[5]=p(e.magenta,t.DEFAULT_ANSI_COLORS[5]),i.ansi[6]=p(e.cyan,t.DEFAULT_ANSI_COLORS[6]),i.ansi[7]=p(e.white,t.DEFAULT_ANSI_COLORS[7]),i.ansi[8]=p(e.brightBlack,t.DEFAULT_ANSI_COLORS[8]),i.ansi[9]=p(e.brightRed,t.DEFAULT_ANSI_COLORS[9]),i.ansi[10]=p(e.brightGreen,t.DEFAULT_ANSI_COLORS[10]),i.ansi[11]=p(e.brightYellow,t.DEFAULT_ANSI_COLORS[11]),i.ansi[12]=p(e.brightBlue,t.DEFAULT_ANSI_COLORS[12]),i.ansi[13]=p(e.brightMagenta,t.DEFAULT_ANSI_COLORS[13]),i.ansi[14]=p(e.brightCyan,t.DEFAULT_ANSI_COLORS[14]),i.ansi[15]=p(e.brightWhite,t.DEFAULT_ANSI_COLORS[15]),e.extendedAnsi){const n=Math.min(i.ansi.length-16,e.extendedAnsi.length);for(let s=0;s<n;s++)i.ansi[s+16]=p(e.extendedAnsi[s],t.DEFAULT_ANSI_COLORS[s+16])}this._contrastCache.clear(),this._updateRestoreColors(),this._onChangeColors.fire(this.colors)}restoreColor(e){this._restoreColor(e),this._onChangeColors.fire(this.colors)}_restoreColor(e){if(void 0!==e)switch(e){case 256:this._colors.foreground=this._restoreColors.foreground;break;case 257:this._colors.background=this._restoreColors.background;break;case 258:this._colors.cursor=this._restoreColors.cursor;break;default:this._colors.ansi[e]=this._restoreColors.ansi[e]}else for(let e=0;e<this._restoreColors.ansi.length;++e)this._colors.ansi[e]=this._restoreColors.ansi[e]}modifyColors(e){e(this._colors),this._onChangeColors.fire(this.colors)}_updateRestoreColors(){this._restoreColors={foreground:this._colors.foreground,background:this._colors.background,cursor:this._colors.cursor,ansi:this._colors.ansi.slice()}}};function p(e,t){if(void 0!==e)try{return o.css.toColor(e)}catch(e){}return t}g=n([s(0,l.IOptionsService)],g),t.ThemeService=g},6349:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CircularList=void 0;const n=i(8460),s=i(844);class r extends s.Disposable{constructor(e){super(),this._maxLength=e,this.onDeleteEmitter=this.register(new n.EventEmitter),this.onDelete=this.onDeleteEmitter.event,this.onInsertEmitter=this.register(new n.EventEmitter),this.onInsert=this.onInsertEmitter.event,this.onTrimEmitter=this.register(new n.EventEmitter),this.onTrim=this.onTrimEmitter.event,this._array=new Array(this._maxLength),this._startIndex=0,this._length=0}get maxLength(){return this._maxLength}set maxLength(e){if(this._maxLength===e)return;const t=new Array(e);for(let i=0;i<Math.min(e,this.length);i++)t[i]=this._array[this._getCyclicIndex(i)];this._array=t,this._maxLength=e,this._startIndex=0}get length(){return this._length}set length(e){if(e>this._length)for(let t=this._length;t<e;t++)this._array[t]=void 0;this._length=e}get(e){return this._array[this._getCyclicIndex(e)]}set(e,t){this._array[this._getCyclicIndex(e)]=t}push(e){this._array[this._getCyclicIndex(this._length)]=e,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++}recycle(){if(this._length!==this._maxLength)throw new Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]}get isFull(){return this._length===this._maxLength}pop(){return this._array[this._getCyclicIndex(this._length---1)]}splice(e,t,...i){if(t){for(let i=e;i<this._length-t;i++)this._array[this._getCyclicIndex(i)]=this._array[this._getCyclicIndex(i+t)];this._length-=t,this.onDeleteEmitter.fire({index:e,amount:t})}for(let t=this._length-1;t>=e;t--)this._array[this._getCyclicIndex(t+i.length)]=this._array[this._getCyclicIndex(t)];for(let t=0;t<i.length;t++)this._array[this._getCyclicIndex(e+t)]=i[t];if(i.length&&this.onInsertEmitter.fire({index:e,amount:i.length}),this._length+i.length>this._maxLength){const e=this._length+i.length-this._maxLength;this._startIndex+=e,this._length=this._maxLength,this.onTrimEmitter.fire(e)}else this._length+=i.length}trimStart(e){e>this._length&&(e=this._length),this._startIndex+=e,this._length-=e,this.onTrimEmitter.fire(e)}shiftElements(e,t,i){if(!(t<=0)){if(e<0||e>=this._length)throw new Error("start argument out of range");if(e+i<0)throw new Error("Cannot shift elements in list beyond index 0");if(i>0){for(let n=t-1;n>=0;n--)this.set(e+n+i,this.get(e+n));const n=e+t+i-this._length;if(n>0)for(this._length+=n;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(let n=0;n<t;n++)this.set(e+n+i,this.get(e+n))}}_getCyclicIndex(e){return(this._startIndex+e)%this._maxLength}}t.CircularList=r},1439:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.clone=void 0,t.clone=function e(t,i=5){if("object"!=typeof t)return t;const n=Array.isArray(t)?[]:{};for(const s in t)n[s]=i<=1?t[s]:t[s]&&e(t[s],i-1);return n}},8055:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.contrastRatio=t.toPaddedHex=t.rgba=t.rgb=t.css=t.color=t.channels=t.NULL_COLOR=void 0;const n=i(6114);let s=0,r=0,o=0,a=0;var c,l,h;function d(e){const t=e.toString(16);return t.length<2?"0"+t:t}function u(e,t){return e<t?(t+.05)/(e+.05):(e+.05)/(t+.05)}t.NULL_COLOR={css:"#00000000",rgba:0},function(e){e.toCss=function(e,t,i,n){return void 0!==n?`#${d(e)}${d(t)}${d(i)}${d(n)}`:`#${d(e)}${d(t)}${d(i)}`},e.toRgba=function(e,t,i,n=255){return(e<<24|t<<16|i<<8|n)>>>0}}(c=t.channels||(t.channels={})),function(e){function t(e,t){return a=Math.round(255*t),[s,r,o]=h.toChannels(e.rgba),{css:c.toCss(s,r,o,a),rgba:c.toRgba(s,r,o,a)}}e.blend=function(e,t){if(a=(255&t.rgba)/255,1===a)return{css:t.css,rgba:t.rgba};const i=t.rgba>>24&255,n=t.rgba>>16&255,l=t.rgba>>8&255,h=e.rgba>>24&255,d=e.rgba>>16&255,u=e.rgba>>8&255;return s=h+Math.round((i-h)*a),r=d+Math.round((n-d)*a),o=u+Math.round((l-u)*a),{css:c.toCss(s,r,o),rgba:c.toRgba(s,r,o)}},e.isOpaque=function(e){return 255==(255&e.rgba)},e.ensureContrastRatio=function(e,t,i){const n=h.ensureContrastRatio(e.rgba,t.rgba,i);if(n)return h.toColor(n>>24&255,n>>16&255,n>>8&255)},e.opaque=function(e){const t=(255|e.rgba)>>>0;return[s,r,o]=h.toChannels(t),{css:c.toCss(s,r,o),rgba:t}},e.opacity=t,e.multiplyOpacity=function(e,i){return a=255&e.rgba,t(e,a*i/255)},e.toColorRGB=function(e){return[e.rgba>>24&255,e.rgba>>16&255,e.rgba>>8&255]}}(t.color||(t.color={})),function(e){let t,i;if(!n.isNode){const e=document.createElement("canvas");e.width=1,e.height=1;const n=e.getContext("2d",{willReadFrequently:!0});n&&(t=n,t.globalCompositeOperation="copy",i=t.createLinearGradient(0,0,1,1))}e.toColor=function(e){if(e.match(/#[\da-f]{3,8}/i))switch(e.length){case 4:return s=parseInt(e.slice(1,2).repeat(2),16),r=parseInt(e.slice(2,3).repeat(2),16),o=parseInt(e.slice(3,4).repeat(2),16),h.toColor(s,r,o);case 5:return s=parseInt(e.slice(1,2).repeat(2),16),r=parseInt(e.slice(2,3).repeat(2),16),o=parseInt(e.slice(3,4).repeat(2),16),a=parseInt(e.slice(4,5).repeat(2),16),h.toColor(s,r,o,a);case 7:return{css:e,rgba:(parseInt(e.slice(1),16)<<8|255)>>>0};case 9:return{css:e,rgba:parseInt(e.slice(1),16)>>>0}}const n=e.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(n)return s=parseInt(n[1]),r=parseInt(n[2]),o=parseInt(n[3]),a=Math.round(255*(void 0===n[5]?1:parseFloat(n[5]))),h.toColor(s,r,o,a);if(!t||!i)throw new Error("css.toColor: Unsupported css format");if(t.fillStyle=i,t.fillStyle=e,"string"!=typeof t.fillStyle)throw new Error("css.toColor: Unsupported css format");if(t.fillRect(0,0,1,1),[s,r,o,a]=t.getImageData(0,0,1,1).data,255!==a)throw new Error("css.toColor: Unsupported css format");return{rgba:c.toRgba(s,r,o,a),css:e}}}(t.css||(t.css={})),function(e){function t(e,t,i){const n=e/255,s=t/255,r=i/255;return.2126*(n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4))+.7152*(s<=.03928?s/12.92:Math.pow((s+.055)/1.055,2.4))+.0722*(r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4))}e.relativeLuminance=function(e){return t(e>>16&255,e>>8&255,255&e)},e.relativeLuminance2=t}(l=t.rgb||(t.rgb={})),function(e){function t(e,t,i){const n=e>>24&255,s=e>>16&255,r=e>>8&255;let o=t>>24&255,a=t>>16&255,c=t>>8&255,h=u(l.relativeLuminance2(o,a,c),l.relativeLuminance2(n,s,r));for(;h<i&&(o>0||a>0||c>0);)o-=Math.max(0,Math.ceil(.1*o)),a-=Math.max(0,Math.ceil(.1*a)),c-=Math.max(0,Math.ceil(.1*c)),h=u(l.relativeLuminance2(o,a,c),l.relativeLuminance2(n,s,r));return(o<<24|a<<16|c<<8|255)>>>0}function i(e,t,i){const n=e>>24&255,s=e>>16&255,r=e>>8&255;let o=t>>24&255,a=t>>16&255,c=t>>8&255,h=u(l.relativeLuminance2(o,a,c),l.relativeLuminance2(n,s,r));for(;h<i&&(o<255||a<255||c<255);)o=Math.min(255,o+Math.ceil(.1*(255-o))),a=Math.min(255,a+Math.ceil(.1*(255-a))),c=Math.min(255,c+Math.ceil(.1*(255-c))),h=u(l.relativeLuminance2(o,a,c),l.relativeLuminance2(n,s,r));return(o<<24|a<<16|c<<8|255)>>>0}e.ensureContrastRatio=function(e,n,s){const r=l.relativeLuminance(e>>8),o=l.relativeLuminance(n>>8);if(u(r,o)<s){if(o<r){const o=t(e,n,s),a=u(r,l.relativeLuminance(o>>8));if(a<s){const t=i(e,n,s);return a>u(r,l.relativeLuminance(t>>8))?o:t}return o}const a=i(e,n,s),c=u(r,l.relativeLuminance(a>>8));if(c<s){const i=t(e,n,s);return c>u(r,l.relativeLuminance(i>>8))?a:i}return a}},e.reduceLuminance=t,e.increaseLuminance=i,e.toChannels=function(e){return[e>>24&255,e>>16&255,e>>8&255,255&e]},e.toColor=function(e,t,i,n){return{css:c.toCss(e,t,i,n),rgba:c.toRgba(e,t,i,n)}}}(h=t.rgba||(t.rgba={})),t.toPaddedHex=d,t.contrastRatio=u},8969:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CoreTerminal=void 0;const n=i(844),s=i(2585),r=i(4348),o=i(7866),a=i(744),c=i(7302),l=i(6975),h=i(8460),d=i(1753),u=i(1480),m=i(7994),_=i(9282),g=i(5435),p=i(5981),f=i(2660);let v=!1;class b extends n.Disposable{constructor(e){super(),this._onBinary=this.register(new h.EventEmitter),this.onBinary=this._onBinary.event,this._onData=this.register(new h.EventEmitter),this.onData=this._onData.event,this._onLineFeed=this.register(new h.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onResize=this.register(new h.EventEmitter),this.onResize=this._onResize.event,this._onWriteParsed=this.register(new h.EventEmitter),this.onWriteParsed=this._onWriteParsed.event,this._onScroll=this.register(new h.EventEmitter),this._instantiationService=new r.InstantiationService,this.optionsService=this.register(new c.OptionsService(e)),this._instantiationService.setService(s.IOptionsService,this.optionsService),this._bufferService=this.register(this._instantiationService.createInstance(a.BufferService)),this._instantiationService.setService(s.IBufferService,this._bufferService),this._logService=this.register(this._instantiationService.createInstance(o.LogService)),this._instantiationService.setService(s.ILogService,this._logService),this.coreService=this.register(this._instantiationService.createInstance(l.CoreService)),this._instantiationService.setService(s.ICoreService,this.coreService),this.coreMouseService=this.register(this._instantiationService.createInstance(d.CoreMouseService)),this._instantiationService.setService(s.ICoreMouseService,this.coreMouseService),this.unicodeService=this.register(this._instantiationService.createInstance(u.UnicodeService)),this._instantiationService.setService(s.IUnicodeService,this.unicodeService),this._charsetService=this._instantiationService.createInstance(m.CharsetService),this._instantiationService.setService(s.ICharsetService,this._charsetService),this._oscLinkService=this._instantiationService.createInstance(f.OscLinkService),this._instantiationService.setService(s.IOscLinkService,this._oscLinkService),this._inputHandler=this.register(new g.InputHandler(this._bufferService,this._charsetService,this.coreService,this._logService,this.optionsService,this._oscLinkService,this.coreMouseService,this.unicodeService)),this.register((0,h.forwardEvent)(this._inputHandler.onLineFeed,this._onLineFeed)),this.register(this._inputHandler),this.register((0,h.forwardEvent)(this._bufferService.onResize,this._onResize)),this.register((0,h.forwardEvent)(this.coreService.onData,this._onData)),this.register((0,h.forwardEvent)(this.coreService.onBinary,this._onBinary)),this.register(this.coreService.onRequestScrollToBottom((()=>this.scrollToBottom()))),this.register(this.coreService.onUserInput((()=>this._writeBuffer.handleUserInput()))),this.register(this.optionsService.onMultipleOptionChange(["windowsMode","windowsPty"],(()=>this._handleWindowsPtyOptionChange()))),this.register(this._bufferService.onScroll((e=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)}))),this.register(this._inputHandler.onScroll((e=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)}))),this._writeBuffer=this.register(new p.WriteBuffer(((e,t)=>this._inputHandler.parse(e,t)))),this.register((0,h.forwardEvent)(this._writeBuffer.onWriteParsed,this._onWriteParsed)),this.register((0,n.toDisposable)((()=>{var e;null===(e=this._windowsWrappingHeuristics)||void 0===e||e.dispose(),this._windowsWrappingHeuristics=void 0})))}get onScroll(){return this._onScrollApi||(this._onScrollApi=this.register(new h.EventEmitter),this._onScroll.event((e=>{var t;null===(t=this._onScrollApi)||void 0===t||t.fire(e.position)}))),this._onScrollApi.event}get cols(){return this._bufferService.cols}get rows(){return this._bufferService.rows}get buffers(){return this._bufferService.buffers}get options(){return this.optionsService.options}set options(e){for(const t in e)this.optionsService.options[t]=e[t]}write(e,t){this._writeBuffer.write(e,t)}writeSync(e,t){this._logService.logLevel<=s.LogLevelEnum.WARN&&!v&&(this._logService.warn("writeSync is unreliable and will be removed soon."),v=!0),this._writeBuffer.writeSync(e,t)}resize(e,t){isNaN(e)||isNaN(t)||(e=Math.max(e,a.MINIMUM_COLS),t=Math.max(t,a.MINIMUM_ROWS),this._bufferService.resize(e,t))}scroll(e,t=!1){this._bufferService.scroll(e,t)}scrollLines(e,t,i){this._bufferService.scrollLines(e,t,i)}scrollPages(e){this._bufferService.scrollPages(e)}scrollToTop(){this._bufferService.scrollToTop()}scrollToBottom(){this._bufferService.scrollToBottom()}scrollToLine(e){this._bufferService.scrollToLine(e)}registerEscHandler(e,t){return this._inputHandler.registerEscHandler(e,t)}registerDcsHandler(e,t){return this._inputHandler.registerDcsHandler(e,t)}registerCsiHandler(e,t){return this._inputHandler.registerCsiHandler(e,t)}registerOscHandler(e,t){return this._inputHandler.registerOscHandler(e,t)}_setup(){this._handleWindowsPtyOptionChange()}reset(){this._inputHandler.reset(),this._bufferService.reset(),this._charsetService.reset(),this.coreService.reset(),this.coreMouseService.reset()}_handleWindowsPtyOptionChange(){var e;let t=!1;const i=this.optionsService.rawOptions.windowsPty;i&&void 0!==i.buildNumber&&void 0!==i.buildNumber?t=!!("conpty"===i.backend&&i.buildNumber<21376):this.optionsService.rawOptions.windowsMode&&(t=!0),t?this._enableWindowsWrappingHeuristics():(null===(e=this._windowsWrappingHeuristics)||void 0===e||e.dispose(),this._windowsWrappingHeuristics=void 0)}_enableWindowsWrappingHeuristics(){if(!this._windowsWrappingHeuristics){const e=[];e.push(this.onLineFeed(_.updateWindowsModeWrappedState.bind(null,this._bufferService))),e.push(this.registerCsiHandler({final:"H"},(()=>((0,_.updateWindowsModeWrappedState)(this._bufferService),!1)))),this._windowsWrappingHeuristics=(0,n.toDisposable)((()=>{for(const t of e)t.dispose()}))}}}t.CoreTerminal=b},8460:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.forwardEvent=t.EventEmitter=void 0,t.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=e=>(this._listeners.push(e),{dispose:()=>{if(!this._disposed)for(let t=0;t<this._listeners.length;t++)if(this._listeners[t]===e)return void this._listeners.splice(t,1)}})),this._event}fire(e,t){const i=[];for(let e=0;e<this._listeners.length;e++)i.push(this._listeners[e]);for(let n=0;n<i.length;n++)i[n].call(void 0,e,t)}dispose(){this._listeners&&(this._listeners.length=0),this._disposed=!0}},t.forwardEvent=function(e,t){return e((e=>t.fire(e)))}},5435:function(e,t,i){var n=this&&this.__decorate||function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},s=this&&this.__param||function(e,t){return function(i,n){t(i,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.InputHandler=t.WindowsOptionsReportType=void 0;const r=i(2584),o=i(7116),a=i(2015),c=i(844),l=i(482),h=i(8437),d=i(8460),u=i(643),m=i(511),_=i(3734),g=i(2585),p=i(6242),f=i(6351),v=i(5941),b={"(":0,")":1,"*":2,"+":3,"-":1,".":2},S=131072;function w(e,t){if(e>24)return t.setWinLines||!1;switch(e){case 1:return!!t.restoreWin;case 2:return!!t.minimizeWin;case 3:return!!t.setWinPosition;case 4:return!!t.setWinSizePixels;case 5:return!!t.raiseWin;case 6:return!!t.lowerWin;case 7:return!!t.refreshWin;case 8:return!!t.setWinSizeChars;case 9:return!!t.maximizeWin;case 10:return!!t.fullscreenWin;case 11:return!!t.getWinState;case 13:return!!t.getWinPosition;case 14:return!!t.getWinSizePixels;case 15:return!!t.getScreenSizePixels;case 16:return!!t.getCellSizePixels;case 18:return!!t.getWinSizeChars;case 19:return!!t.getScreenSizeChars;case 20:return!!t.getIconTitle;case 21:return!!t.getWinTitle;case 22:return!!t.pushTitle;case 23:return!!t.popTitle;case 24:return!!t.setWinLines}return!1}var C;!function(e){e[e.GET_WIN_SIZE_PIXELS=0]="GET_WIN_SIZE_PIXELS",e[e.GET_CELL_SIZE_PIXELS=1]="GET_CELL_SIZE_PIXELS"}(C=t.WindowsOptionsReportType||(t.WindowsOptionsReportType={}));let y=0;class x extends c.Disposable{constructor(e,t,i,n,s,c,u,_,g=new a.EscapeSequenceParser){super(),this._bufferService=e,this._charsetService=t,this._coreService=i,this._logService=n,this._optionsService=s,this._oscLinkService=c,this._coreMouseService=u,this._unicodeService=_,this._parser=g,this._parseBuffer=new Uint32Array(4096),this._stringDecoder=new l.StringToUtf32,this._utf8Decoder=new l.Utf8ToUtf32,this._workCell=new m.CellData,this._windowTitle="",this._iconName="",this._windowTitleStack=[],this._iconNameStack=[],this._curAttrData=h.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=h.DEFAULT_ATTR_DATA.clone(),this._onRequestBell=this.register(new d.EventEmitter),this.onRequestBell=this._onRequestBell.event,this._onRequestRefreshRows=this.register(new d.EventEmitter),this.onRequestRefreshRows=this._onRequestRefreshRows.event,this._onRequestReset=this.register(new d.EventEmitter),this.onRequestReset=this._onRequestReset.event,this._onRequestSendFocus=this.register(new d.EventEmitter),this.onRequestSendFocus=this._onRequestSendFocus.event,this._onRequestSyncScrollBar=this.register(new d.EventEmitter),this.onRequestSyncScrollBar=this._onRequestSyncScrollBar.event,this._onRequestWindowsOptionsReport=this.register(new d.EventEmitter),this.onRequestWindowsOptionsReport=this._onRequestWindowsOptionsReport.event,this._onA11yChar=this.register(new d.EventEmitter),this.onA11yChar=this._onA11yChar.event,this._onA11yTab=this.register(new d.EventEmitter),this.onA11yTab=this._onA11yTab.event,this._onCursorMove=this.register(new d.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onLineFeed=this.register(new d.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onScroll=this.register(new d.EventEmitter),this.onScroll=this._onScroll.event,this._onTitleChange=this.register(new d.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onColor=this.register(new d.EventEmitter),this.onColor=this._onColor.event,this._parseStack={paused:!1,cursorStartX:0,cursorStartY:0,decodedLength:0,position:0},this._specialColors=[256,257,258],this.register(this._parser),this._dirtyRowTracker=new k(this._bufferService),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate((e=>this._activeBuffer=e.activeBuffer))),this._parser.setCsiHandlerFallback(((e,t)=>{this._logService.debug("Unknown CSI code: ",{identifier:this._parser.identToString(e),params:t.toArray()})})),this._parser.setEscHandlerFallback((e=>{this._logService.debug("Unknown ESC code: ",{identifier:this._parser.identToString(e)})})),this._parser.setExecuteHandlerFallback((e=>{this._logService.debug("Unknown EXECUTE code: ",{code:e})})),this._parser.setOscHandlerFallback(((e,t,i)=>{this._logService.debug("Unknown OSC code: ",{identifier:e,action:t,data:i})})),this._parser.setDcsHandlerFallback(((e,t,i)=>{"HOOK"===t&&(i=i.toArray()),this._logService.debug("Unknown DCS code: ",{identifier:this._parser.identToString(e),action:t,payload:i})})),this._parser.setPrintHandler(((e,t,i)=>this.print(e,t,i))),this._parser.registerCsiHandler({final:"@"},(e=>this.insertChars(e))),this._parser.registerCsiHandler({intermediates:" ",final:"@"},(e=>this.scrollLeft(e))),this._parser.registerCsiHandler({final:"A"},(e=>this.cursorUp(e))),this._parser.registerCsiHandler({intermediates:" ",final:"A"},(e=>this.scrollRight(e))),this._parser.registerCsiHandler({final:"B"},(e=>this.cursorDown(e))),this._parser.registerCsiHandler({final:"C"},(e=>this.cursorForward(e))),this._parser.registerCsiHandler({final:"D"},(e=>this.cursorBackward(e))),this._parser.registerCsiHandler({final:"E"},(e=>this.cursorNextLine(e))),this._parser.registerCsiHandler({final:"F"},(e=>this.cursorPrecedingLine(e))),this._parser.registerCsiHandler({final:"G"},(e=>this.cursorCharAbsolute(e))),this._parser.registerCsiHandler({final:"H"},(e=>this.cursorPosition(e))),this._parser.registerCsiHandler({final:"I"},(e=>this.cursorForwardTab(e))),this._parser.registerCsiHandler({final:"J"},(e=>this.eraseInDisplay(e,!1))),this._parser.registerCsiHandler({prefix:"?",final:"J"},(e=>this.eraseInDisplay(e,!0))),this._parser.registerCsiHandler({final:"K"},(e=>this.eraseInLine(e,!1))),this._parser.registerCsiHandler({prefix:"?",final:"K"},(e=>this.eraseInLine(e,!0))),this._parser.registerCsiHandler({final:"L"},(e=>this.insertLines(e))),this._parser.registerCsiHandler({final:"M"},(e=>this.deleteLines(e))),this._parser.registerCsiHandler({final:"P"},(e=>this.deleteChars(e))),this._parser.registerCsiHandler({final:"S"},(e=>this.scrollUp(e))),this._parser.registerCsiHandler({final:"T"},(e=>this.scrollDown(e))),this._parser.registerCsiHandler({final:"X"},(e=>this.eraseChars(e))),this._parser.registerCsiHandler({final:"Z"},(e=>this.cursorBackwardTab(e))),this._parser.registerCsiHandler({final:"`"},(e=>this.charPosAbsolute(e))),this._parser.registerCsiHandler({final:"a"},(e=>this.hPositionRelative(e))),this._parser.registerCsiHandler({final:"b"},(e=>this.repeatPrecedingCharacter(e))),this._parser.registerCsiHandler({final:"c"},(e=>this.sendDeviceAttributesPrimary(e))),this._parser.registerCsiHandler({prefix:">",final:"c"},(e=>this.sendDeviceAttributesSecondary(e))),this._parser.registerCsiHandler({final:"d"},(e=>this.linePosAbsolute(e))),this._parser.registerCsiHandler({final:"e"},(e=>this.vPositionRelative(e))),this._parser.registerCsiHandler({final:"f"},(e=>this.hVPosition(e))),this._parser.registerCsiHandler({final:"g"},(e=>this.tabClear(e))),this._parser.registerCsiHandler({final:"h"},(e=>this.setMode(e))),this._parser.registerCsiHandler({prefix:"?",final:"h"},(e=>this.setModePrivate(e))),this._parser.registerCsiHandler({final:"l"},(e=>this.resetMode(e))),this._parser.registerCsiHandler({prefix:"?",final:"l"},(e=>this.resetModePrivate(e))),this._parser.registerCsiHandler({final:"m"},(e=>this.charAttributes(e))),this._parser.registerCsiHandler({final:"n"},(e=>this.deviceStatus(e))),this._parser.registerCsiHandler({prefix:"?",final:"n"},(e=>this.deviceStatusPrivate(e))),this._parser.registerCsiHandler({intermediates:"!",final:"p"},(e=>this.softReset(e))),this._parser.registerCsiHandler({intermediates:" ",final:"q"},(e=>this.setCursorStyle(e))),this._parser.registerCsiHandler({final:"r"},(e=>this.setScrollRegion(e))),this._parser.registerCsiHandler({final:"s"},(e=>this.saveCursor(e))),this._parser.registerCsiHandler({final:"t"},(e=>this.windowOptions(e))),this._parser.registerCsiHandler({final:"u"},(e=>this.restoreCursor(e))),this._parser.registerCsiHandler({intermediates:"'",final:"}"},(e=>this.insertColumns(e))),this._parser.registerCsiHandler({intermediates:"'",final:"~"},(e=>this.deleteColumns(e))),this._parser.registerCsiHandler({intermediates:'"',final:"q"},(e=>this.selectProtected(e))),this._parser.registerCsiHandler({intermediates:"$",final:"p"},(e=>this.requestMode(e,!0))),this._parser.registerCsiHandler({prefix:"?",intermediates:"$",final:"p"},(e=>this.requestMode(e,!1))),this._parser.setExecuteHandler(r.C0.BEL,(()=>this.bell())),this._parser.setExecuteHandler(r.C0.LF,(()=>this.lineFeed())),this._parser.setExecuteHandler(r.C0.VT,(()=>this.lineFeed())),this._parser.setExecuteHandler(r.C0.FF,(()=>this.lineFeed())),this._parser.setExecuteHandler(r.C0.CR,(()=>this.carriageReturn())),this._parser.setExecuteHandler(r.C0.BS,(()=>this.backspace())),this._parser.setExecuteHandler(r.C0.HT,(()=>this.tab())),this._parser.setExecuteHandler(r.C0.SO,(()=>this.shiftOut())),this._parser.setExecuteHandler(r.C0.SI,(()=>this.shiftIn())),this._parser.setExecuteHandler(r.C1.IND,(()=>this.index())),this._parser.setExecuteHandler(r.C1.NEL,(()=>this.nextLine())),this._parser.setExecuteHandler(r.C1.HTS,(()=>this.tabSet())),this._parser.registerOscHandler(0,new p.OscHandler((e=>(this.setTitle(e),this.setIconName(e),!0)))),this._parser.registerOscHandler(1,new p.OscHandler((e=>this.setIconName(e)))),this._parser.registerOscHandler(2,new p.OscHandler((e=>this.setTitle(e)))),this._parser.registerOscHandler(4,new p.OscHandler((e=>this.setOrReportIndexedColor(e)))),this._parser.registerOscHandler(8,new p.OscHandler((e=>this.setHyperlink(e)))),this._parser.registerOscHandler(10,new p.OscHandler((e=>this.setOrReportFgColor(e)))),this._parser.registerOscHandler(11,new p.OscHandler((e=>this.setOrReportBgColor(e)))),this._parser.registerOscHandler(12,new p.OscHandler((e=>this.setOrReportCursorColor(e)))),this._parser.registerOscHandler(104,new p.OscHandler((e=>this.restoreIndexedColor(e)))),this._parser.registerOscHandler(110,new p.OscHandler((e=>this.restoreFgColor(e)))),this._parser.registerOscHandler(111,new p.OscHandler((e=>this.restoreBgColor(e)))),this._parser.registerOscHandler(112,new p.OscHandler((e=>this.restoreCursorColor(e)))),this._parser.registerEscHandler({final:"7"},(()=>this.saveCursor())),this._parser.registerEscHandler({final:"8"},(()=>this.restoreCursor())),this._parser.registerEscHandler({final:"D"},(()=>this.index())),this._parser.registerEscHandler({final:"E"},(()=>this.nextLine())),this._parser.registerEscHandler({final:"H"},(()=>this.tabSet())),this._parser.registerEscHandler({final:"M"},(()=>this.reverseIndex())),this._parser.registerEscHandler({final:"="},(()=>this.keypadApplicationMode())),this._parser.registerEscHandler({final:">"},(()=>this.keypadNumericMode())),this._parser.registerEscHandler({final:"c"},(()=>this.fullReset())),this._parser.registerEscHandler({final:"n"},(()=>this.setgLevel(2))),this._parser.registerEscHandler({final:"o"},(()=>this.setgLevel(3))),this._parser.registerEscHandler({final:"|"},(()=>this.setgLevel(3))),this._parser.registerEscHandler({final:"}"},(()=>this.setgLevel(2))),this._parser.registerEscHandler({final:"~"},(()=>this.setgLevel(1))),this._parser.registerEscHandler({intermediates:"%",final:"@"},(()=>this.selectDefaultCharset())),this._parser.registerEscHandler({intermediates:"%",final:"G"},(()=>this.selectDefaultCharset()));for(const e in o.CHARSETS)this._parser.registerEscHandler({intermediates:"(",final:e},(()=>this.selectCharset("("+e))),this._parser.registerEscHandler({intermediates:")",final:e},(()=>this.selectCharset(")"+e))),this._parser.registerEscHandler({intermediates:"*",final:e},(()=>this.selectCharset("*"+e))),this._parser.registerEscHandler({intermediates:"+",final:e},(()=>this.selectCharset("+"+e))),this._parser.registerEscHandler({intermediates:"-",final:e},(()=>this.selectCharset("-"+e))),this._parser.registerEscHandler({intermediates:".",final:e},(()=>this.selectCharset("."+e))),this._parser.registerEscHandler({intermediates:"/",final:e},(()=>this.selectCharset("/"+e)));this._parser.registerEscHandler({intermediates:"#",final:"8"},(()=>this.screenAlignmentPattern())),this._parser.setErrorHandler((e=>(this._logService.error("Parsing error: ",e),e))),this._parser.registerDcsHandler({intermediates:"$",final:"q"},new f.DcsHandler(((e,t)=>this.requestStatusString(e,t))))}getAttrData(){return this._curAttrData}_preserveStack(e,t,i,n){this._parseStack.paused=!0,this._parseStack.cursorStartX=e,this._parseStack.cursorStartY=t,this._parseStack.decodedLength=i,this._parseStack.position=n}_logSlowResolvingAsync(e){this._logService.logLevel<=g.LogLevelEnum.WARN&&Promise.race([e,new Promise(((e,t)=>setTimeout((()=>t("#SLOW_TIMEOUT")),5e3)))]).catch((e=>{if("#SLOW_TIMEOUT"!==e)throw e;console.warn("async parser handler taking longer than 5000 ms")}))}_getCurrentLinkId(){return this._curAttrData.extended.urlId}parse(e,t){let i,n=this._activeBuffer.x,s=this._activeBuffer.y,r=0;const o=this._parseStack.paused;if(o){if(i=this._parser.parse(this._parseBuffer,this._parseStack.decodedLength,t))return this._logSlowResolvingAsync(i),i;n=this._parseStack.cursorStartX,s=this._parseStack.cursorStartY,this._parseStack.paused=!1,e.length>S&&(r=this._parseStack.position+S)}if(this._logService.logLevel<=g.LogLevelEnum.DEBUG&&this._logService.debug("parsing data"+("string"==typeof e?` "${e}"`:` "${Array.prototype.map.call(e,(e=>String.fromCharCode(e))).join("")}"`),"string"==typeof e?e.split("").map((e=>e.charCodeAt(0))):e),this._parseBuffer.length<e.length&&this._parseBuffer.length<S&&(this._parseBuffer=new Uint32Array(Math.min(e.length,S))),o||this._dirtyRowTracker.clearRange(),e.length>S)for(let t=r;t<e.length;t+=S){const r=t+S<e.length?t+S:e.length,o="string"==typeof e?this._stringDecoder.decode(e.substring(t,r),this._parseBuffer):this._utf8Decoder.decode(e.subarray(t,r),this._parseBuffer);if(i=this._parser.parse(this._parseBuffer,o))return this._preserveStack(n,s,o,t),this._logSlowResolvingAsync(i),i}else if(!o){const t="string"==typeof e?this._stringDecoder.decode(e,this._parseBuffer):this._utf8Decoder.decode(e,this._parseBuffer);if(i=this._parser.parse(this._parseBuffer,t))return this._preserveStack(n,s,t,0),this._logSlowResolvingAsync(i),i}this._activeBuffer.x===n&&this._activeBuffer.y===s||this._onCursorMove.fire(),this._onRequestRefreshRows.fire(this._dirtyRowTracker.start,this._dirtyRowTracker.end)}print(e,t,i){let n,s;const r=this._charsetService.charset,o=this._optionsService.rawOptions.screenReaderMode,a=this._bufferService.cols,c=this._coreService.decPrivateModes.wraparound,h=this._coreService.modes.insertMode,d=this._curAttrData;let m=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._activeBuffer.x&&i-t>0&&2===m.getWidth(this._activeBuffer.x-1)&&m.setCellFromCodePoint(this._activeBuffer.x-1,0,1,d.fg,d.bg,d.extended);for(let _=t;_<i;++_){if(n=e[_],s=this._unicodeService.wcwidth(n),n<127&&r){const e=r[String.fromCharCode(n)];e&&(n=e.charCodeAt(0))}if(o&&this._onA11yChar.fire((0,l.stringFromCodePoint)(n)),this._getCurrentLinkId()&&this._oscLinkService.addLineToLink(this._getCurrentLinkId(),this._activeBuffer.ybase+this._activeBuffer.y),s||!this._activeBuffer.x){if(this._activeBuffer.x+s-1>=a)if(c){for(;this._activeBuffer.x<a;)m.setCellFromCodePoint(this._activeBuffer.x++,0,1,d.fg,d.bg,d.extended);this._activeBuffer.x=0,this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData(),!0)):(this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!0),m=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y)}else if(this._activeBuffer.x=a-1,2===s)continue;if(h&&(m.insertCells(this._activeBuffer.x,s,this._activeBuffer.getNullCell(d),d),2===m.getWidth(a-1)&&m.setCellFromCodePoint(a-1,u.NULL_CELL_CODE,u.NULL_CELL_WIDTH,d.fg,d.bg,d.extended)),m.setCellFromCodePoint(this._activeBuffer.x++,n,s,d.fg,d.bg,d.extended),s>0)for(;--s;)m.setCellFromCodePoint(this._activeBuffer.x++,0,0,d.fg,d.bg,d.extended)}else m.getWidth(this._activeBuffer.x-1)?m.addCodepointToCell(this._activeBuffer.x-1,n):m.addCodepointToCell(this._activeBuffer.x-2,n)}i-t>0&&(m.loadCell(this._activeBuffer.x-1,this._workCell),2===this._workCell.getWidth()||this._workCell.getCode()>65535?this._parser.precedingCodepoint=0:this._workCell.isCombined()?this._parser.precedingCodepoint=this._workCell.getChars().charCodeAt(0):this._parser.precedingCodepoint=this._workCell.content),this._activeBuffer.x<a&&i-t>0&&0===m.getWidth(this._activeBuffer.x)&&!m.hasContent(this._activeBuffer.x)&&m.setCellFromCodePoint(this._activeBuffer.x,0,1,d.fg,d.bg,d.extended),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}registerCsiHandler(e,t){return"t"!==e.final||e.prefix||e.intermediates?this._parser.registerCsiHandler(e,t):this._parser.registerCsiHandler(e,(e=>!w(e.params[0],this._optionsService.rawOptions.windowOptions)||t(e)))}registerDcsHandler(e,t){return this._parser.registerDcsHandler(e,new f.DcsHandler(t))}registerEscHandler(e,t){return this._parser.registerEscHandler(e,t)}registerOscHandler(e,t){return this._parser.registerOscHandler(e,new p.OscHandler(t))}bell(){return this._onRequestBell.fire(),!0}lineFeed(){return this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._optionsService.rawOptions.convertEol&&(this._activeBuffer.x=0),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows?this._activeBuffer.y=this._bufferService.rows-1:this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.x>=this._bufferService.cols&&this._activeBuffer.x--,this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._onLineFeed.fire(),!0}carriageReturn(){return this._activeBuffer.x=0,!0}backspace(){var e;if(!this._coreService.decPrivateModes.reverseWraparound)return this._restrictCursor(),this._activeBuffer.x>0&&this._activeBuffer.x--,!0;if(this._restrictCursor(this._bufferService.cols),this._activeBuffer.x>0)this._activeBuffer.x--;else if(0===this._activeBuffer.x&&this._activeBuffer.y>this._activeBuffer.scrollTop&&this._activeBuffer.y<=this._activeBuffer.scrollBottom&&(null===(e=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y))||void 0===e?void 0:e.isWrapped)){this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.y--,this._activeBuffer.x=this._bufferService.cols-1;const e=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);e.hasWidth(this._activeBuffer.x)&&!e.hasContent(this._activeBuffer.x)&&this._activeBuffer.x--}return this._restrictCursor(),!0}tab(){if(this._activeBuffer.x>=this._bufferService.cols)return!0;const e=this._activeBuffer.x;return this._activeBuffer.x=this._activeBuffer.nextStop(),this._optionsService.rawOptions.screenReaderMode&&this._onA11yTab.fire(this._activeBuffer.x-e),!0}shiftOut(){return this._charsetService.setgLevel(1),!0}shiftIn(){return this._charsetService.setgLevel(0),!0}_restrictCursor(e=this._bufferService.cols-1){this._activeBuffer.x=Math.min(e,Math.max(0,this._activeBuffer.x)),this._activeBuffer.y=this._coreService.decPrivateModes.origin?Math.min(this._activeBuffer.scrollBottom,Math.max(this._activeBuffer.scrollTop,this._activeBuffer.y)):Math.min(this._bufferService.rows-1,Math.max(0,this._activeBuffer.y)),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_setCursor(e,t){this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._coreService.decPrivateModes.origin?(this._activeBuffer.x=e,this._activeBuffer.y=this._activeBuffer.scrollTop+t):(this._activeBuffer.x=e,this._activeBuffer.y=t),this._restrictCursor(),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_moveCursor(e,t){this._restrictCursor(),this._setCursor(this._activeBuffer.x+e,this._activeBuffer.y+t)}cursorUp(e){const t=this._activeBuffer.y-this._activeBuffer.scrollTop;return t>=0?this._moveCursor(0,-Math.min(t,e.params[0]||1)):this._moveCursor(0,-(e.params[0]||1)),!0}cursorDown(e){const t=this._activeBuffer.scrollBottom-this._activeBuffer.y;return t>=0?this._moveCursor(0,Math.min(t,e.params[0]||1)):this._moveCursor(0,e.params[0]||1),!0}cursorForward(e){return this._moveCursor(e.params[0]||1,0),!0}cursorBackward(e){return this._moveCursor(-(e.params[0]||1),0),!0}cursorNextLine(e){return this.cursorDown(e),this._activeBuffer.x=0,!0}cursorPrecedingLine(e){return this.cursorUp(e),this._activeBuffer.x=0,!0}cursorCharAbsolute(e){return this._setCursor((e.params[0]||1)-1,this._activeBuffer.y),!0}cursorPosition(e){return this._setCursor(e.length>=2?(e.params[1]||1)-1:0,(e.params[0]||1)-1),!0}charPosAbsolute(e){return this._setCursor((e.params[0]||1)-1,this._activeBuffer.y),!0}hPositionRelative(e){return this._moveCursor(e.params[0]||1,0),!0}linePosAbsolute(e){return this._setCursor(this._activeBuffer.x,(e.params[0]||1)-1),!0}vPositionRelative(e){return this._moveCursor(0,e.params[0]||1),!0}hVPosition(e){return this.cursorPosition(e),!0}tabClear(e){const t=e.params[0];return 0===t?delete this._activeBuffer.tabs[this._activeBuffer.x]:3===t&&(this._activeBuffer.tabs={}),!0}cursorForwardTab(e){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let t=e.params[0]||1;for(;t--;)this._activeBuffer.x=this._activeBuffer.nextStop();return!0}cursorBackwardTab(e){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let t=e.params[0]||1;for(;t--;)this._activeBuffer.x=this._activeBuffer.prevStop();return!0}selectProtected(e){const t=e.params[0];return 1===t&&(this._curAttrData.bg|=536870912),2!==t&&0!==t||(this._curAttrData.bg&=-536870913),!0}_eraseInBufferLine(e,t,i,n=!1,s=!1){const r=this._activeBuffer.lines.get(this._activeBuffer.ybase+e);r.replaceCells(t,i,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData(),s),n&&(r.isWrapped=!1)}_resetBufferLine(e,t=!1){const i=this._activeBuffer.lines.get(this._activeBuffer.ybase+e);i&&(i.fill(this._activeBuffer.getNullCell(this._eraseAttrData()),t),this._bufferService.buffer.clearMarkers(this._activeBuffer.ybase+e),i.isWrapped=!1)}eraseInDisplay(e,t=!1){let i;switch(this._restrictCursor(this._bufferService.cols),e.params[0]){case 0:for(i=this._activeBuffer.y,this._dirtyRowTracker.markDirty(i),this._eraseInBufferLine(i++,this._activeBuffer.x,this._bufferService.cols,0===this._activeBuffer.x,t);i<this._bufferService.rows;i++)this._resetBufferLine(i,t);this._dirtyRowTracker.markDirty(i);break;case 1:for(i=this._activeBuffer.y,this._dirtyRowTracker.markDirty(i),this._eraseInBufferLine(i,0,this._activeBuffer.x+1,!0,t),this._activeBuffer.x+1>=this._bufferService.cols&&(this._activeBuffer.lines.get(i+1).isWrapped=!1);i--;)this._resetBufferLine(i,t);this._dirtyRowTracker.markDirty(0);break;case 2:for(i=this._bufferService.rows,this._dirtyRowTracker.markDirty(i-1);i--;)this._resetBufferLine(i,t);this._dirtyRowTracker.markDirty(0);break;case 3:const e=this._activeBuffer.lines.length-this._bufferService.rows;e>0&&(this._activeBuffer.lines.trimStart(e),this._activeBuffer.ybase=Math.max(this._activeBuffer.ybase-e,0),this._activeBuffer.ydisp=Math.max(this._activeBuffer.ydisp-e,0),this._onScroll.fire(0))}return!0}eraseInLine(e,t=!1){switch(this._restrictCursor(this._bufferService.cols),e.params[0]){case 0:this._eraseInBufferLine(this._activeBuffer.y,this._activeBuffer.x,this._bufferService.cols,0===this._activeBuffer.x,t);break;case 1:this._eraseInBufferLine(this._activeBuffer.y,0,this._activeBuffer.x+1,!1,t);break;case 2:this._eraseInBufferLine(this._activeBuffer.y,0,this._bufferService.cols,!0,t)}return this._dirtyRowTracker.markDirty(this._activeBuffer.y),!0}insertLines(e){this._restrictCursor();let t=e.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const i=this._activeBuffer.ybase+this._activeBuffer.y,n=this._bufferService.rows-1-this._activeBuffer.scrollBottom,s=this._bufferService.rows-1+this._activeBuffer.ybase-n+1;for(;t--;)this._activeBuffer.lines.splice(s-1,1),this._activeBuffer.lines.splice(i,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}deleteLines(e){this._restrictCursor();let t=e.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const i=this._activeBuffer.ybase+this._activeBuffer.y;let n;for(n=this._bufferService.rows-1-this._activeBuffer.scrollBottom,n=this._bufferService.rows-1+this._activeBuffer.ybase-n;t--;)this._activeBuffer.lines.splice(i,1),this._activeBuffer.lines.splice(n,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}insertChars(e){this._restrictCursor();const t=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return t&&(t.insertCells(this._activeBuffer.x,e.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}deleteChars(e){this._restrictCursor();const t=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return t&&(t.deleteCells(this._activeBuffer.x,e.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}scrollUp(e){let t=e.params[0]||1;for(;t--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollDown(e){let t=e.params[0]||1;for(;t--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,0,this._activeBuffer.getBlankLine(h.DEFAULT_ATTR_DATA));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollLeft(e){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const t=e.params[0]||1;for(let e=this._activeBuffer.scrollTop;e<=this._activeBuffer.scrollBottom;++e){const i=this._activeBuffer.lines.get(this._activeBuffer.ybase+e);i.deleteCells(0,t,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),i.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollRight(e){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const t=e.params[0]||1;for(let e=this._activeBuffer.scrollTop;e<=this._activeBuffer.scrollBottom;++e){const i=this._activeBuffer.lines.get(this._activeBuffer.ybase+e);i.insertCells(0,t,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),i.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}insertColumns(e){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const t=e.params[0]||1;for(let e=this._activeBuffer.scrollTop;e<=this._activeBuffer.scrollBottom;++e){const i=this._activeBuffer.lines.get(this._activeBuffer.ybase+e);i.insertCells(this._activeBuffer.x,t,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),i.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}deleteColumns(e){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const t=e.params[0]||1;for(let e=this._activeBuffer.scrollTop;e<=this._activeBuffer.scrollBottom;++e){const i=this._activeBuffer.lines.get(this._activeBuffer.ybase+e);i.deleteCells(this._activeBuffer.x,t,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),i.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}eraseChars(e){this._restrictCursor();const t=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return t&&(t.replaceCells(this._activeBuffer.x,this._activeBuffer.x+(e.params[0]||1),this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}repeatPrecedingCharacter(e){if(!this._parser.precedingCodepoint)return!0;const t=e.params[0]||1,i=new Uint32Array(t);for(let e=0;e<t;++e)i[e]=this._parser.precedingCodepoint;return this.print(i,0,i.length),!0}sendDeviceAttributesPrimary(e){return e.params[0]>0||(this._is("xterm")||this._is("rxvt-unicode")||this._is("screen")?this._coreService.triggerDataEvent(r.C0.ESC+"[?1;2c"):this._is("linux")&&this._coreService.triggerDataEvent(r.C0.ESC+"[?6c")),!0}sendDeviceAttributesSecondary(e){return e.params[0]>0||(this._is("xterm")?this._coreService.triggerDataEvent(r.C0.ESC+"[>0;276;0c"):this._is("rxvt-unicode")?this._coreService.triggerDataEvent(r.C0.ESC+"[>85;95;0c"):this._is("linux")?this._coreService.triggerDataEvent(e.params[0]+"c"):this._is("screen")&&this._coreService.triggerDataEvent(r.C0.ESC+"[>83;40003;0c")),!0}_is(e){return 0===(this._optionsService.rawOptions.termName+"").indexOf(e)}setMode(e){for(let t=0;t<e.length;t++)switch(e.params[t]){case 4:this._coreService.modes.insertMode=!0;break;case 20:this._optionsService.options.convertEol=!0}return!0}setModePrivate(e){for(let t=0;t<e.length;t++)switch(e.params[t]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!0;break;case 2:this._charsetService.setgCharset(0,o.DEFAULT_CHARSET),this._charsetService.setgCharset(1,o.DEFAULT_CHARSET),this._charsetService.setgCharset(2,o.DEFAULT_CHARSET),this._charsetService.setgCharset(3,o.DEFAULT_CHARSET);break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(132,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!0,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!0;break;case 12:this._optionsService.options.cursorBlink=!0;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!0;break;case 66:this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire();break;case 9:this._coreMouseService.activeProtocol="X10";break;case 1e3:this._coreMouseService.activeProtocol="VT200";break;case 1002:this._coreMouseService.activeProtocol="DRAG";break;case 1003:this._coreMouseService.activeProtocol="ANY";break;case 1004:this._coreService.decPrivateModes.sendFocus=!0,this._onRequestSendFocus.fire();break;case 1005:this._logService.debug("DECSET 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="SGR";break;case 1015:this._logService.debug("DECSET 1015 not supported (see #2507)");break;case 1016:this._coreMouseService.activeEncoding="SGR_PIXELS";break;case 25:this._coreService.isCursorHidden=!1;break;case 1048:this.saveCursor();break;case 1049:this.saveCursor();case 47:case 1047:this._bufferService.buffers.activateAltBuffer(this._eraseAttrData()),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!0}return!0}resetMode(e){for(let t=0;t<e.length;t++)switch(e.params[t]){case 4:this._coreService.modes.insertMode=!1;break;case 20:this._optionsService.options.convertEol=!1}return!0}resetModePrivate(e){for(let t=0;t<e.length;t++)switch(e.params[t]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!1;break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(80,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!1,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!1;break;case 12:this._optionsService.options.cursorBlink=!1;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!1;break;case 66:this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire();break;case 9:case 1e3:case 1002:case 1003:this._coreMouseService.activeProtocol="NONE";break;case 1004:this._coreService.decPrivateModes.sendFocus=!1;break;case 1005:this._logService.debug("DECRST 1005 not supported (see #2507)");break;case 1006:case 1016:this._coreMouseService.activeEncoding="DEFAULT";break;case 1015:this._logService.debug("DECRST 1015 not supported (see #2507)");break;case 25:this._coreService.isCursorHidden=!0;break;case 1048:this.restoreCursor();break;case 1049:case 47:case 1047:this._bufferService.buffers.activateNormalBuffer(),1049===e.params[t]&&this.restoreCursor(),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!1}return!0}requestMode(e,t){const i=this._coreService.decPrivateModes,{activeProtocol:n,activeEncoding:s}=this._coreMouseService,o=this._coreService,{buffers:a,cols:c}=this._bufferService,{active:l,alt:h}=a,d=this._optionsService.rawOptions,u=e=>e?1:2,m=e.params[0];return _=m,g=t?2===m?4:4===m?u(o.modes.insertMode):12===m?3:20===m?u(d.convertEol):0:1===m?u(i.applicationCursorKeys):3===m?d.windowOptions.setWinLines?80===c?2:132===c?1:0:0:6===m?u(i.origin):7===m?u(i.wraparound):8===m?3:9===m?u("X10"===n):12===m?u(d.cursorBlink):25===m?u(!o.isCursorHidden):45===m?u(i.reverseWraparound):66===m?u(i.applicationKeypad):67===m?4:1e3===m?u("VT200"===n):1002===m?u("DRAG"===n):1003===m?u("ANY"===n):1004===m?u(i.sendFocus):1005===m?4:1006===m?u("SGR"===s):1015===m?4:1016===m?u("SGR_PIXELS"===s):1048===m?1:47===m||1047===m||1049===m?u(l===h):2004===m?u(i.bracketedPasteMode):0,o.triggerDataEvent(`${r.C0.ESC}[${t?"":"?"}${_};${g}$y`),!0;var _,g}_updateAttrColor(e,t,i,n,s){return 2===t?(e|=50331648,e&=-16777216,e|=_.AttributeData.fromColorRGB([i,n,s])):5===t&&(e&=-50331904,e|=33554432|255&i),e}_extractColor(e,t,i){const n=[0,0,-1,0,0,0];let s=0,r=0;do{if(n[r+s]=e.params[t+r],e.hasSubParams(t+r)){const i=e.getSubParams(t+r);let o=0;do{5===n[1]&&(s=1),n[r+o+1+s]=i[o]}while(++o<i.length&&o+r+1+s<n.length);break}if(5===n[1]&&r+s>=2||2===n[1]&&r+s>=5)break;n[1]&&(s=1)}while(++r+t<e.length&&r+s<n.length);for(let e=2;e<n.length;++e)-1===n[e]&&(n[e]=0);switch(n[0]){case 38:i.fg=this._updateAttrColor(i.fg,n[1],n[3],n[4],n[5]);break;case 48:i.bg=this._updateAttrColor(i.bg,n[1],n[3],n[4],n[5]);break;case 58:i.extended=i.extended.clone(),i.extended.underlineColor=this._updateAttrColor(i.extended.underlineColor,n[1],n[3],n[4],n[5])}return r}_processUnderline(e,t){t.extended=t.extended.clone(),(!~e||e>5)&&(e=1),t.extended.underlineStyle=e,t.fg|=268435456,0===e&&(t.fg&=-268435457),t.updateExtended()}_processSGR0(e){e.fg=h.DEFAULT_ATTR_DATA.fg,e.bg=h.DEFAULT_ATTR_DATA.bg,e.extended=e.extended.clone(),e.extended.underlineStyle=0,e.extended.underlineColor&=-67108864,e.updateExtended()}charAttributes(e){if(1===e.length&&0===e.params[0])return this._processSGR0(this._curAttrData),!0;const t=e.length;let i;const n=this._curAttrData;for(let s=0;s<t;s++)i=e.params[s],i>=30&&i<=37?(n.fg&=-50331904,n.fg|=16777216|i-30):i>=40&&i<=47?(n.bg&=-50331904,n.bg|=16777216|i-40):i>=90&&i<=97?(n.fg&=-50331904,n.fg|=16777224|i-90):i>=100&&i<=107?(n.bg&=-50331904,n.bg|=16777224|i-100):0===i?this._processSGR0(n):1===i?n.fg|=134217728:3===i?n.bg|=67108864:4===i?(n.fg|=268435456,this._processUnderline(e.hasSubParams(s)?e.getSubParams(s)[0]:1,n)):5===i?n.fg|=536870912:7===i?n.fg|=67108864:8===i?n.fg|=1073741824:9===i?n.fg|=2147483648:2===i?n.bg|=134217728:21===i?this._processUnderline(2,n):22===i?(n.fg&=-134217729,n.bg&=-134217729):23===i?n.bg&=-67108865:24===i?(n.fg&=-268435457,this._processUnderline(0,n)):25===i?n.fg&=-536870913:27===i?n.fg&=-67108865:28===i?n.fg&=-1073741825:29===i?n.fg&=2147483647:39===i?(n.fg&=-67108864,n.fg|=16777215&h.DEFAULT_ATTR_DATA.fg):49===i?(n.bg&=-67108864,n.bg|=16777215&h.DEFAULT_ATTR_DATA.bg):38===i||48===i||58===i?s+=this._extractColor(e,s,n):53===i?n.bg|=1073741824:55===i?n.bg&=-1073741825:59===i?(n.extended=n.extended.clone(),n.extended.underlineColor=-1,n.updateExtended()):100===i?(n.fg&=-67108864,n.fg|=16777215&h.DEFAULT_ATTR_DATA.fg,n.bg&=-67108864,n.bg|=16777215&h.DEFAULT_ATTR_DATA.bg):this._logService.debug("Unknown SGR attribute: %d.",i);return!0}deviceStatus(e){switch(e.params[0]){case 5:this._coreService.triggerDataEvent(`${r.C0.ESC}[0n`);break;case 6:const e=this._activeBuffer.y+1,t=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${r.C0.ESC}[${e};${t}R`)}return!0}deviceStatusPrivate(e){if(6===e.params[0]){const e=this._activeBuffer.y+1,t=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${r.C0.ESC}[?${e};${t}R`)}return!0}softReset(e){return this._coreService.isCursorHidden=!1,this._onRequestSyncScrollBar.fire(),this._activeBuffer.scrollTop=0,this._activeBuffer.scrollBottom=this._bufferService.rows-1,this._curAttrData=h.DEFAULT_ATTR_DATA.clone(),this._coreService.reset(),this._charsetService.reset(),this._activeBuffer.savedX=0,this._activeBuffer.savedY=this._activeBuffer.ybase,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,this._coreService.decPrivateModes.origin=!1,!0}setCursorStyle(e){const t=e.params[0]||1;switch(t){case 1:case 2:this._optionsService.options.cursorStyle="block";break;case 3:case 4:this._optionsService.options.cursorStyle="underline";break;case 5:case 6:this._optionsService.options.cursorStyle="bar"}const i=t%2==1;return this._optionsService.options.cursorBlink=i,!0}setScrollRegion(e){const t=e.params[0]||1;let i;return(e.length<2||(i=e.params[1])>this._bufferService.rows||0===i)&&(i=this._bufferService.rows),i>t&&(this._activeBuffer.scrollTop=t-1,this._activeBuffer.scrollBottom=i-1,this._setCursor(0,0)),!0}windowOptions(e){if(!w(e.params[0],this._optionsService.rawOptions.windowOptions))return!0;const t=e.length>1?e.params[1]:0;switch(e.params[0]){case 14:2!==t&&this._onRequestWindowsOptionsReport.fire(C.GET_WIN_SIZE_PIXELS);break;case 16:this._onRequestWindowsOptionsReport.fire(C.GET_CELL_SIZE_PIXELS);break;case 18:this._bufferService&&this._coreService.triggerDataEvent(`${r.C0.ESC}[8;${this._bufferService.rows};${this._bufferService.cols}t`);break;case 22:0!==t&&2!==t||(this._windowTitleStack.push(this._windowTitle),this._windowTitleStack.length>10&&this._windowTitleStack.shift()),0!==t&&1!==t||(this._iconNameStack.push(this._iconName),this._iconNameStack.length>10&&this._iconNameStack.shift());break;case 23:0!==t&&2!==t||this._windowTitleStack.length&&this.setTitle(this._windowTitleStack.pop()),0!==t&&1!==t||this._iconNameStack.length&&this.setIconName(this._iconNameStack.pop())}return!0}saveCursor(e){return this._activeBuffer.savedX=this._activeBuffer.x,this._activeBuffer.savedY=this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,!0}restoreCursor(e){return this._activeBuffer.x=this._activeBuffer.savedX||0,this._activeBuffer.y=Math.max(this._activeBuffer.savedY-this._activeBuffer.ybase,0),this._curAttrData.fg=this._activeBuffer.savedCurAttrData.fg,this._curAttrData.bg=this._activeBuffer.savedCurAttrData.bg,this._charsetService.charset=this._savedCharset,this._activeBuffer.savedCharset&&(this._charsetService.charset=this._activeBuffer.savedCharset),this._restrictCursor(),!0}setTitle(e){return this._windowTitle=e,this._onTitleChange.fire(e),!0}setIconName(e){return this._iconName=e,!0}setOrReportIndexedColor(e){const t=[],i=e.split(";");for(;i.length>1;){const e=i.shift(),n=i.shift();if(/^\d+$/.exec(e)){const i=parseInt(e);if(0<=i&&i<256)if("?"===n)t.push({type:0,index:i});else{const e=(0,v.parseColor)(n);e&&t.push({type:1,index:i,color:e})}}}return t.length&&this._onColor.fire(t),!0}setHyperlink(e){const t=e.split(";");return!(t.length<2)&&(t[1]?this._createHyperlink(t[0],t[1]):!t[0]&&this._finishHyperlink())}_createHyperlink(e,t){this._getCurrentLinkId()&&this._finishHyperlink();const i=e.split(":");let n;const s=i.findIndex((e=>e.startsWith("id=")));return-1!==s&&(n=i[s].slice(3)||void 0),this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=this._oscLinkService.registerLink({id:n,uri:t}),this._curAttrData.updateExtended(),!0}_finishHyperlink(){return this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=0,this._curAttrData.updateExtended(),!0}_setOrReportSpecialColor(e,t){const i=e.split(";");for(let e=0;e<i.length&&!(t>=this._specialColors.length);++e,++t)if("?"===i[e])this._onColor.fire([{type:0,index:this._specialColors[t]}]);else{const n=(0,v.parseColor)(i[e]);n&&this._onColor.fire([{type:1,index:this._specialColors[t],color:n}])}return!0}setOrReportFgColor(e){return this._setOrReportSpecialColor(e,0)}setOrReportBgColor(e){return this._setOrReportSpecialColor(e,1)}setOrReportCursorColor(e){return this._setOrReportSpecialColor(e,2)}restoreIndexedColor(e){if(!e)return this._onColor.fire([{type:2}]),!0;const t=[],i=e.split(";");for(let e=0;e<i.length;++e)if(/^\d+$/.exec(i[e])){const n=parseInt(i[e]);0<=n&&n<256&&t.push({type:2,index:n})}return t.length&&this._onColor.fire(t),!0}restoreFgColor(e){return this._onColor.fire([{type:2,index:256}]),!0}restoreBgColor(e){return this._onColor.fire([{type:2,index:257}]),!0}restoreCursorColor(e){return this._onColor.fire([{type:2,index:258}]),!0}nextLine(){return this._activeBuffer.x=0,this.index(),!0}keypadApplicationMode(){return this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire(),!0}keypadNumericMode(){return this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire(),!0}selectDefaultCharset(){return this._charsetService.setgLevel(0),this._charsetService.setgCharset(0,o.DEFAULT_CHARSET),!0}selectCharset(e){return 2!==e.length?(this.selectDefaultCharset(),!0):("/"===e[0]||this._charsetService.setgCharset(b[e[0]],o.CHARSETS[e[1]]||o.DEFAULT_CHARSET),!0)}index(){return this._restrictCursor(),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._restrictCursor(),!0}tabSet(){return this._activeBuffer.tabs[this._activeBuffer.x]=!0,!0}reverseIndex(){if(this._restrictCursor(),this._activeBuffer.y===this._activeBuffer.scrollTop){const e=this._activeBuffer.scrollBottom-this._activeBuffer.scrollTop;this._activeBuffer.lines.shiftElements(this._activeBuffer.ybase+this._activeBuffer.y,e,1),this._activeBuffer.lines.set(this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.getBlankLine(this._eraseAttrData())),this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom)}else this._activeBuffer.y--,this._restrictCursor();return!0}fullReset(){return this._parser.reset(),this._onRequestReset.fire(),!0}reset(){this._curAttrData=h.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=h.DEFAULT_ATTR_DATA.clone()}_eraseAttrData(){return this._eraseAttrDataInternal.bg&=-67108864,this._eraseAttrDataInternal.bg|=67108863&this._curAttrData.bg,this._eraseAttrDataInternal}setgLevel(e){return this._charsetService.setgLevel(e),!0}screenAlignmentPattern(){const e=new m.CellData;e.content=1<<22|"E".charCodeAt(0),e.fg=this._curAttrData.fg,e.bg=this._curAttrData.bg,this._setCursor(0,0);for(let t=0;t<this._bufferService.rows;++t){const i=this._activeBuffer.ybase+this._activeBuffer.y+t,n=this._activeBuffer.lines.get(i);n&&(n.fill(e),n.isWrapped=!1)}return this._dirtyRowTracker.markAllDirty(),this._setCursor(0,0),!0}requestStatusString(e,t){const i=this._bufferService.buffer,n=this._optionsService.rawOptions;return(e=>(this._coreService.triggerDataEvent(`${r.C0.ESC}${e}${r.C0.ESC}\\`),!0))('"q'===e?`P1$r${this._curAttrData.isProtected()?1:0}"q`:'"p'===e?'P1$r61;1"p':"r"===e?`P1$r${i.scrollTop+1};${i.scrollBottom+1}r`:"m"===e?"P1$r0m":" q"===e?`P1$r${{block:2,underline:4,bar:6}[n.cursorStyle]-(n.cursorBlink?1:0)} q`:"P0$r")}markRangeDirty(e,t){this._dirtyRowTracker.markRangeDirty(e,t)}}t.InputHandler=x;let k=class{constructor(e){this._bufferService=e,this.clearRange()}clearRange(){this.start=this._bufferService.buffer.y,this.end=this._bufferService.buffer.y}markDirty(e){e<this.start?this.start=e:e>this.end&&(this.end=e)}markRangeDirty(e,t){e>t&&(y=e,e=t,t=y),e<this.start&&(this.start=e),t>this.end&&(this.end=t)}markAllDirty(){this.markRangeDirty(0,this._bufferService.rows-1)}};k=n([s(0,g.IBufferService)],k)},844:(e,t)=>{function i(e){for(const t of e)t.dispose();e.length=0}Object.defineProperty(t,"__esModule",{value:!0}),t.getDisposeArrayDisposable=t.disposeArray=t.toDisposable=t.Disposable=void 0,t.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){this._isDisposed=!0;for(const e of this._disposables)e.dispose();this._disposables.length=0}register(e){return this._disposables.push(e),e}unregister(e){const t=this._disposables.indexOf(e);-1!==t&&this._disposables.splice(t,1)}},t.toDisposable=function(e){return{dispose:e}},t.disposeArray=i,t.getDisposeArrayDisposable=function(e){return{dispose:()=>i(e)}}},1505:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FourKeyMap=t.TwoKeyMap=void 0;class i{constructor(){this._data={}}set(e,t,i){this._data[e]||(this._data[e]={}),this._data[e][t]=i}get(e,t){return this._data[e]?this._data[e][t]:void 0}clear(){this._data={}}}t.TwoKeyMap=i,t.FourKeyMap=class{constructor(){this._data=new i}set(e,t,n,s,r){this._data.get(e,t)||this._data.set(e,t,new i),this._data.get(e,t).set(n,s,r)}get(e,t,i,n){var s;return null===(s=this._data.get(e,t))||void 0===s?void 0:s.get(i,n)}clear(){this._data.clear()}}},6114:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isChromeOS=t.isLinux=t.isWindows=t.isIphone=t.isIpad=t.isMac=t.getSafariVersion=t.isSafari=t.isLegacyEdge=t.isFirefox=t.isNode=void 0,t.isNode="undefined"==typeof navigator;const i=t.isNode?"node":navigator.userAgent,n=t.isNode?"node":navigator.platform;t.isFirefox=i.includes("Firefox"),t.isLegacyEdge=i.includes("Edge"),t.isSafari=/^((?!chrome|android).)*safari/i.test(i),t.getSafariVersion=function(){if(!t.isSafari)return 0;const e=i.match(/Version\/(\d+)/);return null===e||e.length<2?0:parseInt(e[1])},t.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(n),t.isIpad="iPad"===n,t.isIphone="iPhone"===n,t.isWindows=["Windows","Win16","Win32","WinCE"].includes(n),t.isLinux=n.indexOf("Linux")>=0,t.isChromeOS=/\bCrOS\b/.test(i)},6106:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SortedList=void 0;let i=0;t.SortedList=class{constructor(e){this._getKey=e,this._array=[]}clear(){this._array.length=0}insert(e){0!==this._array.length?(i=this._search(this._getKey(e),0,this._array.length-1),this._array.splice(i,0,e)):this._array.push(e)}delete(e){if(0===this._array.length)return!1;const t=this._getKey(e);if(void 0===t)return!1;if(i=this._search(t,0,this._array.length-1),-1===i)return!1;if(this._getKey(this._array[i])!==t)return!1;do{if(this._array[i]===e)return this._array.splice(i,1),!0}while(++i<this._array.length&&this._getKey(this._array[i])===t);return!1}*getKeyIterator(e){if(0!==this._array.length&&(i=this._search(e,0,this._array.length-1),!(i<0||i>=this._array.length)&&this._getKey(this._array[i])===e))do{yield this._array[i]}while(++i<this._array.length&&this._getKey(this._array[i])===e)}forEachByKey(e,t){if(0!==this._array.length&&(i=this._search(e,0,this._array.length-1),!(i<0||i>=this._array.length)&&this._getKey(this._array[i])===e))do{t(this._array[i])}while(++i<this._array.length&&this._getKey(this._array[i])===e)}values(){return this._array.values()}_search(e,t,i){if(i<t)return t;let n=Math.floor((t+i)/2);const s=this._getKey(this._array[n]);if(s>e)return this._search(e,t,n-1);if(s<e)return this._search(e,n+1,i);for(;n>0&&this._getKey(this._array[n-1])===e;)n--;return n}}},7226:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DebouncedIdleTask=t.IdleTaskQueue=t.PriorityTaskQueue=void 0;const n=i(6114);class s{constructor(){this._tasks=[],this._i=0}enqueue(e){this._tasks.push(e),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(e){this._idleCallback=void 0;let t=0,i=0,n=e.timeRemaining(),s=0;for(;this._i<this._tasks.length;){if(t=Date.now(),this._tasks[this._i]()||this._i++,t=Math.max(1,Date.now()-t),i=Math.max(t,i),s=e.timeRemaining(),1.5*i>s)return n-t<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(n-t))}ms`),void this._start();n=s}this.clear()}}class r extends s{_requestCallback(e){return setTimeout((()=>e(this._createDeadline(16))))}_cancelCallback(e){clearTimeout(e)}_createDeadline(e){const t=Date.now()+e;return{timeRemaining:()=>Math.max(0,t-Date.now())}}}t.PriorityTaskQueue=r,t.IdleTaskQueue=!n.isNode&&"requestIdleCallback"in window?class extends s{_requestCallback(e){return requestIdleCallback(e)}_cancelCallback(e){cancelIdleCallback(e)}}:r,t.DebouncedIdleTask=class{constructor(){this._queue=new t.IdleTaskQueue}set(e){this._queue.clear(),this._queue.enqueue(e)}flush(){this._queue.flush()}}},9282:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateWindowsModeWrappedState=void 0;const n=i(643);t.updateWindowsModeWrappedState=function(e){const t=e.buffer.lines.get(e.buffer.ybase+e.buffer.y-1),i=null==t?void 0:t.get(e.cols-1),s=e.buffer.lines.get(e.buffer.ybase+e.buffer.y);s&&i&&(s.isWrapped=i[n.CHAR_DATA_CODE_INDEX]!==n.NULL_CELL_CODE&&i[n.CHAR_DATA_CODE_INDEX]!==n.WHITESPACE_CELL_CODE)}},3734:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ExtendedAttrs=t.AttributeData=void 0;class i{constructor(){this.fg=0,this.bg=0,this.extended=new n}static toColorRGB(e){return[e>>>16&255,e>>>8&255,255&e]}static fromColorRGB(e){return(255&e[0])<<16|(255&e[1])<<8|255&e[2]}clone(){const e=new i;return e.fg=this.fg,e.bg=this.bg,e.extended=this.extended.clone(),e}isInverse(){return 67108864&this.fg}isBold(){return 134217728&this.fg}isUnderline(){return this.hasExtendedAttrs()&&0!==this.extended.underlineStyle?1:268435456&this.fg}isBlink(){return 536870912&this.fg}isInvisible(){return 1073741824&this.fg}isItalic(){return 67108864&this.bg}isDim(){return 134217728&this.bg}isStrikethrough(){return 2147483648&this.fg}isProtected(){return 536870912&this.bg}isOverline(){return 1073741824&this.bg}getFgColorMode(){return 50331648&this.fg}getBgColorMode(){return 50331648&this.bg}isFgRGB(){return 50331648==(50331648&this.fg)}isBgRGB(){return 50331648==(50331648&this.bg)}isFgPalette(){return 16777216==(50331648&this.fg)||33554432==(50331648&this.fg)}isBgPalette(){return 16777216==(50331648&this.bg)||33554432==(50331648&this.bg)}isFgDefault(){return 0==(50331648&this.fg)}isBgDefault(){return 0==(50331648&this.bg)}isAttributeDefault(){return 0===this.fg&&0===this.bg}getFgColor(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}getBgColor(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}hasExtendedAttrs(){return 268435456&this.bg}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}isUnderlineColorRGB(){return 268435456&this.bg&&~this.extended.underlineColor?50331648==(50331648&this.extended.underlineColor):this.isFgRGB()}isUnderlineColorPalette(){return 268435456&this.bg&&~this.extended.underlineColor?16777216==(50331648&this.extended.underlineColor)||33554432==(50331648&this.extended.underlineColor):this.isFgPalette()}isUnderlineColorDefault(){return 268435456&this.bg&&~this.extended.underlineColor?0==(50331648&this.extended.underlineColor):this.isFgDefault()}getUnderlineStyle(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}}t.AttributeData=i;class n{constructor(e=0,t=0){this._ext=0,this._urlId=0,this._ext=e,this._urlId=t}get ext(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext}set ext(e){this._ext=e}get underlineStyle(){return this._urlId?5:(469762048&this._ext)>>26}set underlineStyle(e){this._ext&=-469762049,this._ext|=e<<26&469762048}get underlineColor(){return 67108863&this._ext}set underlineColor(e){this._ext&=-67108864,this._ext|=67108863&e}get urlId(){return this._urlId}set urlId(e){this._urlId=e}clone(){return new n(this._ext,this._urlId)}isEmpty(){return 0===this.underlineStyle&&0===this._urlId}}t.ExtendedAttrs=n},9092:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Buffer=t.MAX_BUFFER_SIZE=void 0;const n=i(6349),s=i(8437),r=i(511),o=i(643),a=i(4634),c=i(4863),l=i(7116),h=i(3734),d=i(7226);t.MAX_BUFFER_SIZE=4294967295,t.Buffer=class{constructor(e,t,i){this._hasScrollback=e,this._optionsService=t,this._bufferService=i,this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.tabs={},this.savedY=0,this.savedX=0,this.savedCurAttrData=s.DEFAULT_ATTR_DATA.clone(),this.savedCharset=l.DEFAULT_CHARSET,this.markers=[],this._nullCell=r.CellData.fromCharData([0,o.NULL_CELL_CHAR,o.NULL_CELL_WIDTH,o.NULL_CELL_CODE]),this._whitespaceCell=r.CellData.fromCharData([0,o.WHITESPACE_CELL_CHAR,o.WHITESPACE_CELL_WIDTH,o.WHITESPACE_CELL_CODE]),this._isClearing=!1,this._memoryCleanupQueue=new d.IdleTaskQueue,this._memoryCleanupPosition=0,this._cols=this._bufferService.cols,this._rows=this._bufferService.rows,this.lines=new n.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}getNullCell(e){return e?(this._nullCell.fg=e.fg,this._nullCell.bg=e.bg,this._nullCell.extended=e.extended):(this._nullCell.fg=0,this._nullCell.bg=0,this._nullCell.extended=new h.ExtendedAttrs),this._nullCell}getWhitespaceCell(e){return e?(this._whitespaceCell.fg=e.fg,this._whitespaceCell.bg=e.bg,this._whitespaceCell.extended=e.extended):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0,this._whitespaceCell.extended=new h.ExtendedAttrs),this._whitespaceCell}getBlankLine(e,t){return new s.BufferLine(this._bufferService.cols,this.getNullCell(e),t)}get hasScrollback(){return this._hasScrollback&&this.lines.maxLength>this._rows}get isCursorInViewport(){const e=this.ybase+this.y-this.ydisp;return e>=0&&e<this._rows}_getCorrectBufferLength(e){if(!this._hasScrollback)return e;const i=e+this._optionsService.rawOptions.scrollback;return i>t.MAX_BUFFER_SIZE?t.MAX_BUFFER_SIZE:i}fillViewportRows(e){if(0===this.lines.length){void 0===e&&(e=s.DEFAULT_ATTR_DATA);let t=this._rows;for(;t--;)this.lines.push(this.getBlankLine(e))}}clear(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new n.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}resize(e,t){const i=this.getNullCell(s.DEFAULT_ATTR_DATA);let n=0;const r=this._getCorrectBufferLength(t);if(r>this.lines.maxLength&&(this.lines.maxLength=r),this.lines.length>0){if(this._cols<e)for(let t=0;t<this.lines.length;t++)n+=+this.lines.get(t).resize(e,i);let o=0;if(this._rows<t)for(let n=this._rows;n<t;n++)this.lines.length<t+this.ybase&&(this._optionsService.rawOptions.windowsMode||void 0!==this._optionsService.rawOptions.windowsPty.backend||void 0!==this._optionsService.rawOptions.windowsPty.buildNumber?this.lines.push(new s.BufferLine(e,i)):this.ybase>0&&this.lines.length<=this.ybase+this.y+o+1?(this.ybase--,o++,this.ydisp>0&&this.ydisp--):this.lines.push(new s.BufferLine(e,i)));else for(let e=this._rows;e>t;e--)this.lines.length>t+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(r<this.lines.maxLength){const e=this.lines.length-r;e>0&&(this.lines.trimStart(e),this.ybase=Math.max(this.ybase-e,0),this.ydisp=Math.max(this.ydisp-e,0),this.savedY=Math.max(this.savedY-e,0)),this.lines.maxLength=r}this.x=Math.min(this.x,e-1),this.y=Math.min(this.y,t-1),o&&(this.y+=o),this.savedX=Math.min(this.savedX,e-1),this.scrollTop=0}if(this.scrollBottom=t-1,this._isReflowEnabled&&(this._reflow(e,t),this._cols>e))for(let t=0;t<this.lines.length;t++)n+=+this.lines.get(t).resize(e,i);this._cols=e,this._rows=t,this._memoryCleanupQueue.clear(),n>.1*this.lines.length&&(this._memoryCleanupPosition=0,this._memoryCleanupQueue.enqueue((()=>this._batchedMemoryCleanup())))}_batchedMemoryCleanup(){let e=!0;this._memoryCleanupPosition>=this.lines.length&&(this._memoryCleanupPosition=0,e=!1);let t=0;for(;this._memoryCleanupPosition<this.lines.length;)if(t+=this.lines.get(this._memoryCleanupPosition++).cleanupMemory(),t>100)return!0;return e}get _isReflowEnabled(){const e=this._optionsService.rawOptions.windowsPty;return e&&e.buildNumber?this._hasScrollback&&"conpty"===e.backend&&e.buildNumber>=21376:this._hasScrollback&&!this._optionsService.rawOptions.windowsMode}_reflow(e,t){this._cols!==e&&(e>this._cols?this._reflowLarger(e,t):this._reflowSmaller(e,t))}_reflowLarger(e,t){const i=(0,a.reflowLargerGetLinesToRemove)(this.lines,this._cols,e,this.ybase+this.y,this.getNullCell(s.DEFAULT_ATTR_DATA));if(i.length>0){const n=(0,a.reflowLargerCreateNewLayout)(this.lines,i);(0,a.reflowLargerApplyNewLayout)(this.lines,n.layout),this._reflowLargerAdjustViewport(e,t,n.countRemoved)}}_reflowLargerAdjustViewport(e,t,i){const n=this.getNullCell(s.DEFAULT_ATTR_DATA);let r=i;for(;r-- >0;)0===this.ybase?(this.y>0&&this.y--,this.lines.length<t&&this.lines.push(new s.BufferLine(e,n))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--);this.savedY=Math.max(this.savedY-i,0)}_reflowSmaller(e,t){const i=this.getNullCell(s.DEFAULT_ATTR_DATA),n=[];let r=0;for(let o=this.lines.length-1;o>=0;o--){let c=this.lines.get(o);if(!c||!c.isWrapped&&c.getTrimmedLength()<=e)continue;const l=[c];for(;c.isWrapped&&o>0;)c=this.lines.get(--o),l.unshift(c);const h=this.ybase+this.y;if(h>=o&&h<o+l.length)continue;const d=l[l.length-1].getTrimmedLength(),u=(0,a.reflowSmallerGetNewLineLengths)(l,this._cols,e),m=u.length-l.length;let _;_=0===this.ybase&&this.y!==this.lines.length-1?Math.max(0,this.y-this.lines.maxLength+m):Math.max(0,this.lines.length-this.lines.maxLength+m);const g=[];for(let e=0;e<m;e++){const e=this.getBlankLine(s.DEFAULT_ATTR_DATA,!0);g.push(e)}g.length>0&&(n.push({start:o+l.length+r,newLines:g}),r+=g.length),l.push(...g);let p=u.length-1,f=u[p];0===f&&(p--,f=u[p]);let v=l.length-m-1,b=d;for(;v>=0;){const e=Math.min(b,f);if(void 0===l[p])break;if(l[p].copyCellsFrom(l[v],b-e,f-e,e,!0),f-=e,0===f&&(p--,f=u[p]),b-=e,0===b){v--;const e=Math.max(v,0);b=(0,a.getWrappedLineTrimmedLength)(l,e,this._cols)}}for(let t=0;t<l.length;t++)u[t]<e&&l[t].setCell(u[t],i);let S=m-_;for(;S-- >0;)0===this.ybase?this.y<t-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+r)-t&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++);this.savedY=Math.min(this.savedY+m,this.ybase+t-1)}if(n.length>0){const e=[],t=[];for(let e=0;e<this.lines.length;e++)t.push(this.lines.get(e));const i=this.lines.length;let s=i-1,o=0,a=n[o];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+r);let c=0;for(let l=Math.min(this.lines.maxLength-1,i+r-1);l>=0;l--)if(a&&a.start>s+c){for(let e=a.newLines.length-1;e>=0;e--)this.lines.set(l--,a.newLines[e]);l++,e.push({index:s+1,amount:a.newLines.length}),c+=a.newLines.length,a=n[++o]}else this.lines.set(l,t[s--]);let l=0;for(let t=e.length-1;t>=0;t--)e[t].index+=l,this.lines.onInsertEmitter.fire(e[t]),l+=e[t].amount;const h=Math.max(0,i+r-this.lines.maxLength);h>0&&this.lines.onTrimEmitter.fire(h)}}translateBufferLineToString(e,t,i=0,n){const s=this.lines.get(e);return s?s.translateToString(t,i,n):""}getWrappedRangeForLine(e){let t=e,i=e;for(;t>0&&this.lines.get(t).isWrapped;)t--;for(;i+1<this.lines.length&&this.lines.get(i+1).isWrapped;)i++;return{first:t,last:i}}setupTabStops(e){for(null!=e?this.tabs[e]||(e=this.prevStop(e)):(this.tabs={},e=0);e<this._cols;e+=this._optionsService.rawOptions.tabStopWidth)this.tabs[e]=!0}prevStop(e){for(null==e&&(e=this.x);!this.tabs[--e]&&e>0;);return e>=this._cols?this._cols-1:e<0?0:e}nextStop(e){for(null==e&&(e=this.x);!this.tabs[++e]&&e<this._cols;);return e>=this._cols?this._cols-1:e<0?0:e}clearMarkers(e){this._isClearing=!0;for(let t=0;t<this.markers.length;t++)this.markers[t].line===e&&(this.markers[t].dispose(),this.markers.splice(t--,1));this._isClearing=!1}clearAllMarkers(){this._isClearing=!0;for(let e=0;e<this.markers.length;e++)this.markers[e].dispose(),this.markers.splice(e--,1);this._isClearing=!1}addMarker(e){const t=new c.Marker(e);return this.markers.push(t),t.register(this.lines.onTrim((e=>{t.line-=e,t.line<0&&t.dispose()}))),t.register(this.lines.onInsert((e=>{t.line>=e.index&&(t.line+=e.amount)}))),t.register(this.lines.onDelete((e=>{t.line>=e.index&&t.line<e.index+e.amount&&t.dispose(),t.line>e.index&&(t.line-=e.amount)}))),t.register(t.onDispose((()=>this._removeMarker(t)))),t}_removeMarker(e){this._isClearing||this.markers.splice(this.markers.indexOf(e),1)}}},8437:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BufferLine=t.DEFAULT_ATTR_DATA=void 0;const n=i(482),s=i(643),r=i(511),o=i(3734);t.DEFAULT_ATTR_DATA=Object.freeze(new o.AttributeData);let a=0;class c{constructor(e,t,i=!1){this.isWrapped=i,this._combined={},this._extendedAttrs={},this._data=new Uint32Array(3*e);const n=t||r.CellData.fromCharData([0,s.NULL_CELL_CHAR,s.NULL_CELL_WIDTH,s.NULL_CELL_CODE]);for(let t=0;t<e;++t)this.setCell(t,n);this.length=e}get(e){const t=this._data[3*e+0],i=2097151&t;return[this._data[3*e+1],2097152&t?this._combined[e]:i?(0,n.stringFromCodePoint)(i):"",t>>22,2097152&t?this._combined[e].charCodeAt(this._combined[e].length-1):i]}set(e,t){this._data[3*e+1]=t[s.CHAR_DATA_ATTR_INDEX],t[s.CHAR_DATA_CHAR_INDEX].length>1?(this._combined[e]=t[1],this._data[3*e+0]=2097152|e|t[s.CHAR_DATA_WIDTH_INDEX]<<22):this._data[3*e+0]=t[s.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|t[s.CHAR_DATA_WIDTH_INDEX]<<22}getWidth(e){return this._data[3*e+0]>>22}hasWidth(e){return 12582912&this._data[3*e+0]}getFg(e){return this._data[3*e+1]}getBg(e){return this._data[3*e+2]}hasContent(e){return 4194303&this._data[3*e+0]}getCodePoint(e){const t=this._data[3*e+0];return 2097152&t?this._combined[e].charCodeAt(this._combined[e].length-1):2097151&t}isCombined(e){return 2097152&this._data[3*e+0]}getString(e){const t=this._data[3*e+0];return 2097152&t?this._combined[e]:2097151&t?(0,n.stringFromCodePoint)(2097151&t):""}isProtected(e){return 536870912&this._data[3*e+2]}loadCell(e,t){return a=3*e,t.content=this._data[a+0],t.fg=this._data[a+1],t.bg=this._data[a+2],2097152&t.content&&(t.combinedData=this._combined[e]),268435456&t.bg&&(t.extended=this._extendedAttrs[e]),t}setCell(e,t){2097152&t.content&&(this._combined[e]=t.combinedData),268435456&t.bg&&(this._extendedAttrs[e]=t.extended),this._data[3*e+0]=t.content,this._data[3*e+1]=t.fg,this._data[3*e+2]=t.bg}setCellFromCodePoint(e,t,i,n,s,r){268435456&s&&(this._extendedAttrs[e]=r),this._data[3*e+0]=t|i<<22,this._data[3*e+1]=n,this._data[3*e+2]=s}addCodepointToCell(e,t){let i=this._data[3*e+0];2097152&i?this._combined[e]+=(0,n.stringFromCodePoint)(t):(2097151&i?(this._combined[e]=(0,n.stringFromCodePoint)(2097151&i)+(0,n.stringFromCodePoint)(t),i&=-2097152,i|=2097152):i=t|1<<22,this._data[3*e+0]=i)}insertCells(e,t,i,n){if((e%=this.length)&&2===this.getWidth(e-1)&&this.setCellFromCodePoint(e-1,0,1,(null==n?void 0:n.fg)||0,(null==n?void 0:n.bg)||0,(null==n?void 0:n.extended)||new o.ExtendedAttrs),t<this.length-e){const n=new r.CellData;for(let i=this.length-e-t-1;i>=0;--i)this.setCell(e+t+i,this.loadCell(e+i,n));for(let n=0;n<t;++n)this.setCell(e+n,i)}else for(let t=e;t<this.length;++t)this.setCell(t,i);2===this.getWidth(this.length-1)&&this.setCellFromCodePoint(this.length-1,0,1,(null==n?void 0:n.fg)||0,(null==n?void 0:n.bg)||0,(null==n?void 0:n.extended)||new o.ExtendedAttrs)}deleteCells(e,t,i,n){if(e%=this.length,t<this.length-e){const n=new r.CellData;for(let i=0;i<this.length-e-t;++i)this.setCell(e+i,this.loadCell(e+t+i,n));for(let e=this.length-t;e<this.length;++e)this.setCell(e,i)}else for(let t=e;t<this.length;++t)this.setCell(t,i);e&&2===this.getWidth(e-1)&&this.setCellFromCodePoint(e-1,0,1,(null==n?void 0:n.fg)||0,(null==n?void 0:n.bg)||0,(null==n?void 0:n.extended)||new o.ExtendedAttrs),0!==this.getWidth(e)||this.hasContent(e)||this.setCellFromCodePoint(e,0,1,(null==n?void 0:n.fg)||0,(null==n?void 0:n.bg)||0,(null==n?void 0:n.extended)||new o.ExtendedAttrs)}replaceCells(e,t,i,n,s=!1){if(s)for(e&&2===this.getWidth(e-1)&&!this.isProtected(e-1)&&this.setCellFromCodePoint(e-1,0,1,(null==n?void 0:n.fg)||0,(null==n?void 0:n.bg)||0,(null==n?void 0:n.extended)||new o.ExtendedAttrs),t<this.length&&2===this.getWidth(t-1)&&!this.isProtected(t)&&this.setCellFromCodePoint(t,0,1,(null==n?void 0:n.fg)||0,(null==n?void 0:n.bg)||0,(null==n?void 0:n.extended)||new o.ExtendedAttrs);e<t&&e<this.length;)this.isProtected(e)||this.setCell(e,i),e++;else for(e&&2===this.getWidth(e-1)&&this.setCellFromCodePoint(e-1,0,1,(null==n?void 0:n.fg)||0,(null==n?void 0:n.bg)||0,(null==n?void 0:n.extended)||new o.ExtendedAttrs),t<this.length&&2===this.getWidth(t-1)&&this.setCellFromCodePoint(t,0,1,(null==n?void 0:n.fg)||0,(null==n?void 0:n.bg)||0,(null==n?void 0:n.extended)||new o.ExtendedAttrs);e<t&&e<this.length;)this.setCell(e++,i)}resize(e,t){if(e===this.length)return 4*this._data.length*2<this._data.buffer.byteLength;const i=3*e;if(e>this.length){if(this._data.buffer.byteLength>=4*i)this._data=new Uint32Array(this._data.buffer,0,i);else{const e=new Uint32Array(i);e.set(this._data),this._data=e}for(let i=this.length;i<e;++i)this.setCell(i,t)}else{this._data=this._data.subarray(0,i);const t=Object.keys(this._combined);for(let i=0;i<t.length;i++){const n=parseInt(t[i],10);n>=e&&delete this._combined[n]}const n=Object.keys(this._extendedAttrs);for(let t=0;t<n.length;t++){const i=parseInt(n[t],10);i>=e&&delete this._extendedAttrs[i]}}return this.length=e,4*i*2<this._data.buffer.byteLength}cleanupMemory(){if(4*this._data.length*2<this._data.buffer.byteLength){const e=new Uint32Array(this._data.length);return e.set(this._data),this._data=e,1}return 0}fill(e,t=!1){if(t)for(let t=0;t<this.length;++t)this.isProtected(t)||this.setCell(t,e);else{this._combined={},this._extendedAttrs={};for(let t=0;t<this.length;++t)this.setCell(t,e)}}copyFrom(e){this.length!==e.length?this._data=new Uint32Array(e._data):this._data.set(e._data),this.length=e.length,this._combined={};for(const t in e._combined)this._combined[t]=e._combined[t];this._extendedAttrs={};for(const t in e._extendedAttrs)this._extendedAttrs[t]=e._extendedAttrs[t];this.isWrapped=e.isWrapped}clone(){const e=new c(0);e._data=new Uint32Array(this._data),e.length=this.length;for(const t in this._combined)e._combined[t]=this._combined[t];for(const t in this._extendedAttrs)e._extendedAttrs[t]=this._extendedAttrs[t];return e.isWrapped=this.isWrapped,e}getTrimmedLength(){for(let e=this.length-1;e>=0;--e)if(4194303&this._data[3*e+0])return e+(this._data[3*e+0]>>22);return 0}copyCellsFrom(e,t,i,n,s){const r=e._data;if(s)for(let s=n-1;s>=0;s--){for(let e=0;e<3;e++)this._data[3*(i+s)+e]=r[3*(t+s)+e];268435456&r[3*(t+s)+2]&&(this._extendedAttrs[i+s]=e._extendedAttrs[t+s])}else for(let s=0;s<n;s++){for(let e=0;e<3;e++)this._data[3*(i+s)+e]=r[3*(t+s)+e];268435456&r[3*(t+s)+2]&&(this._extendedAttrs[i+s]=e._extendedAttrs[t+s])}const o=Object.keys(e._combined);for(let n=0;n<o.length;n++){const s=parseInt(o[n],10);s>=t&&(this._combined[s-t+i]=e._combined[s])}}translateToString(e=!1,t=0,i=this.length){e&&(i=Math.min(i,this.getTrimmedLength()));let r="";for(;t<i;){const e=this._data[3*t+0],i=2097151&e;r+=2097152&e?this._combined[t]:i?(0,n.stringFromCodePoint)(i):s.WHITESPACE_CELL_CHAR,t+=e>>22||1}return r}}t.BufferLine=c},4841:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getRangeLength=void 0,t.getRangeLength=function(e,t){if(e.start.y>e.end.y)throw new Error(`Buffer range end (${e.end.x}, ${e.end.y}) cannot be before start (${e.start.x}, ${e.start.y})`);return t*(e.end.y-e.start.y)+(e.end.x-e.start.x+1)}},4634:(e,t)=>{function i(e,t,i){if(t===e.length-1)return e[t].getTrimmedLength();const n=!e[t].hasContent(i-1)&&1===e[t].getWidth(i-1),s=2===e[t+1].getWidth(0);return n&&s?i-1:i}Object.defineProperty(t,"__esModule",{value:!0}),t.getWrappedLineTrimmedLength=t.reflowSmallerGetNewLineLengths=t.reflowLargerApplyNewLayout=t.reflowLargerCreateNewLayout=t.reflowLargerGetLinesToRemove=void 0,t.reflowLargerGetLinesToRemove=function(e,t,n,s,r){const o=[];for(let a=0;a<e.length-1;a++){let c=a,l=e.get(++c);if(!l.isWrapped)continue;const h=[e.get(a)];for(;c<e.length&&l.isWrapped;)h.push(l),l=e.get(++c);if(s>=a&&s<c){a+=h.length-1;continue}let d=0,u=i(h,d,t),m=1,_=0;for(;m<h.length;){const e=i(h,m,t),s=e-_,o=n-u,a=Math.min(s,o);h[d].copyCellsFrom(h[m],_,u,a,!1),u+=a,u===n&&(d++,u=0),_+=a,_===e&&(m++,_=0),0===u&&0!==d&&2===h[d-1].getWidth(n-1)&&(h[d].copyCellsFrom(h[d-1],n-1,u++,1,!1),h[d-1].setCell(n-1,r))}h[d].replaceCells(u,n,r);let g=0;for(let e=h.length-1;e>0&&(e>d||0===h[e].getTrimmedLength());e--)g++;g>0&&(o.push(a+h.length-g),o.push(g)),a+=h.length-1}return o},t.reflowLargerCreateNewLayout=function(e,t){const i=[];let n=0,s=t[n],r=0;for(let o=0;o<e.length;o++)if(s===o){const i=t[++n];e.onDeleteEmitter.fire({index:o-r,amount:i}),o+=i-1,r+=i,s=t[++n]}else i.push(o);return{layout:i,countRemoved:r}},t.reflowLargerApplyNewLayout=function(e,t){const i=[];for(let n=0;n<t.length;n++)i.push(e.get(t[n]));for(let t=0;t<i.length;t++)e.set(t,i[t]);e.length=t.length},t.reflowSmallerGetNewLineLengths=function(e,t,n){const s=[],r=e.map(((n,s)=>i(e,s,t))).reduce(((e,t)=>e+t));let o=0,a=0,c=0;for(;c<r;){if(r-c<n){s.push(r-c);break}o+=n;const l=i(e,a,t);o>l&&(o-=l,a++);const h=2===e[a].getWidth(o-1);h&&o--;const d=h?n-1:n;s.push(d),c+=d}return s},t.getWrappedLineTrimmedLength=i},5295:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BufferSet=void 0;const n=i(9092),s=i(8460),r=i(844);class o extends r.Disposable{constructor(e,t){super(),this._optionsService=e,this._bufferService=t,this._onBufferActivate=this.register(new s.EventEmitter),this.onBufferActivate=this._onBufferActivate.event,this.reset(),this.register(this._optionsService.onSpecificOptionChange("scrollback",(()=>this.resize(this._bufferService.cols,this._bufferService.rows)))),this.register(this._optionsService.onSpecificOptionChange("tabStopWidth",(()=>this.setupTabStops())))}reset(){this._normal=new n.Buffer(!0,this._optionsService,this._bufferService),this._normal.fillViewportRows(),this._alt=new n.Buffer(!1,this._optionsService,this._bufferService),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}),this.setupTabStops()}get alt(){return this._alt}get active(){return this._activeBuffer}get normal(){return this._normal}activateNormalBuffer(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clearAllMarkers(),this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))}activateAltBuffer(e){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(e),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))}resize(e,t){this._normal.resize(e,t),this._alt.resize(e,t),this.setupTabStops(e)}setupTabStops(e){this._normal.setupTabStops(e),this._alt.setupTabStops(e)}}t.BufferSet=o},511:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CellData=void 0;const n=i(482),s=i(643),r=i(3734);class o extends r.AttributeData{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new r.ExtendedAttrs,this.combinedData=""}static fromCharData(e){const t=new o;return t.setFromCharData(e),t}isCombined(){return 2097152&this.content}getWidth(){return this.content>>22}getChars(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,n.stringFromCodePoint)(2097151&this.content):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}setFromCharData(e){this.fg=e[s.CHAR_DATA_ATTR_INDEX],this.bg=0;let t=!1;if(e[s.CHAR_DATA_CHAR_INDEX].length>2)t=!0;else if(2===e[s.CHAR_DATA_CHAR_INDEX].length){const i=e[s.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=i&&i<=56319){const n=e[s.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=n&&n<=57343?this.content=1024*(i-55296)+n-56320+65536|e[s.CHAR_DATA_WIDTH_INDEX]<<22:t=!0}else t=!0}else this.content=e[s.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|e[s.CHAR_DATA_WIDTH_INDEX]<<22;t&&(this.combinedData=e[s.CHAR_DATA_CHAR_INDEX],this.content=2097152|e[s.CHAR_DATA_WIDTH_INDEX]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}t.CellData=o},643:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WHITESPACE_CELL_CODE=t.WHITESPACE_CELL_WIDTH=t.WHITESPACE_CELL_CHAR=t.NULL_CELL_CODE=t.NULL_CELL_WIDTH=t.NULL_CELL_CHAR=t.CHAR_DATA_CODE_INDEX=t.CHAR_DATA_WIDTH_INDEX=t.CHAR_DATA_CHAR_INDEX=t.CHAR_DATA_ATTR_INDEX=t.DEFAULT_EXT=t.DEFAULT_ATTR=t.DEFAULT_COLOR=void 0,t.DEFAULT_COLOR=0,t.DEFAULT_ATTR=256|t.DEFAULT_COLOR<<9,t.DEFAULT_EXT=0,t.CHAR_DATA_ATTR_INDEX=0,t.CHAR_DATA_CHAR_INDEX=1,t.CHAR_DATA_WIDTH_INDEX=2,t.CHAR_DATA_CODE_INDEX=3,t.NULL_CELL_CHAR="",t.NULL_CELL_WIDTH=1,t.NULL_CELL_CODE=0,t.WHITESPACE_CELL_CHAR=" ",t.WHITESPACE_CELL_WIDTH=1,t.WHITESPACE_CELL_CODE=32},4863:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Marker=void 0;const n=i(8460),s=i(844);class r{constructor(e){this.line=e,this.isDisposed=!1,this._disposables=[],this._id=r._nextId++,this._onDispose=this.register(new n.EventEmitter),this.onDispose=this._onDispose.event}get id(){return this._id}dispose(){this.isDisposed||(this.isDisposed=!0,this.line=-1,this._onDispose.fire(),(0,s.disposeArray)(this._disposables),this._disposables.length=0)}register(e){return this._disposables.push(e),e}}t.Marker=r,r._nextId=1},7116:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_CHARSET=t.CHARSETS=void 0,t.CHARSETS={},t.DEFAULT_CHARSET=t.CHARSETS.B,t.CHARSETS[0]={"`":"◆",a:"▒",b:"␉",c:"␌",d:"␍",e:"␊",f:"°",g:"±",h:"␤",i:"␋",j:"┘",k:"┐",l:"┌",m:"└",n:"┼",o:"⎺",p:"⎻",q:"─",r:"⎼",s:"⎽",t:"├",u:"┤",v:"┴",w:"┬",x:"│",y:"≤",z:"≥","{":"π","|":"≠","}":"£","~":"·"},t.CHARSETS.A={"#":"£"},t.CHARSETS.B=void 0,t.CHARSETS[4]={"#":"£","@":"¾","[":"ij","\\":"½","]":"|","{":"¨","|":"f","}":"¼","~":"´"},t.CHARSETS.C=t.CHARSETS[5]={"[":"Ä","\\":"Ö","]":"Å","^":"Ü","`":"é","{":"ä","|":"ö","}":"å","~":"ü"},t.CHARSETS.R={"#":"£","@":"à","[":"°","\\":"ç","]":"§","{":"é","|":"ù","}":"è","~":"¨"},t.CHARSETS.Q={"@":"à","[":"â","\\":"ç","]":"ê","^":"î","`":"ô","{":"é","|":"ù","}":"è","~":"û"},t.CHARSETS.K={"@":"§","[":"Ä","\\":"Ö","]":"Ü","{":"ä","|":"ö","}":"ü","~":"ß"},t.CHARSETS.Y={"#":"£","@":"§","[":"°","\\":"ç","]":"é","`":"ù","{":"à","|":"ò","}":"è","~":"ì"},t.CHARSETS.E=t.CHARSETS[6]={"@":"Ä","[":"Æ","\\":"Ø","]":"Å","^":"Ü","`":"ä","{":"æ","|":"ø","}":"å","~":"ü"},t.CHARSETS.Z={"#":"£","@":"§","[":"¡","\\":"Ñ","]":"¿","{":"°","|":"ñ","}":"ç"},t.CHARSETS.H=t.CHARSETS[7]={"@":"É","[":"Ä","\\":"Ö","]":"Å","^":"Ü","`":"é","{":"ä","|":"ö","}":"å","~":"ü"},t.CHARSETS["="]={"#":"ù","@":"à","[":"é","\\":"ç","]":"ê","^":"î",_:"è","`":"ô","{":"ä","|":"ö","}":"ü","~":"û"}},2584:(e,t)=>{var i,n;Object.defineProperty(t,"__esModule",{value:!0}),t.C1_ESCAPED=t.C1=t.C0=void 0,function(e){e.NUL="\0",e.SOH="",e.STX="",e.ETX="",e.EOT="",e.ENQ="",e.ACK="",e.BEL="",e.BS="\b",e.HT="\t",e.LF="\n",e.VT="\v",e.FF="\f",e.CR="\r",e.SO="",e.SI="",e.DLE="",e.DC1="",e.DC2="",e.DC3="",e.DC4="",e.NAK="",e.SYN="",e.ETB="",e.CAN="",e.EM="",e.SUB="",e.ESC="",e.FS="",e.GS="",e.RS="",e.US="",e.SP=" ",e.DEL=""}(i=t.C0||(t.C0={})),(n=t.C1||(t.C1={})).PAD="",n.HOP="",n.BPH="",n.NBH="",n.IND="",n.NEL="",n.SSA="",n.ESA="",n.HTS="",n.HTJ="",n.VTS="",n.PLD="",n.PLU="",n.RI="",n.SS2="",n.SS3="",n.DCS="",n.PU1="",n.PU2="",n.STS="",n.CCH="",n.MW="",n.SPA="",n.EPA="",n.SOS="",n.SGCI="",n.SCI="",n.CSI="",n.ST="",n.OSC="",n.PM="",n.APC="",(t.C1_ESCAPED||(t.C1_ESCAPED={})).ST=`${i.ESC}\\`},7399:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.evaluateKeyboardEvent=void 0;const n=i(2584),s={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};t.evaluateKeyboardEvent=function(e,t,i,r){const o={type:0,cancel:!1,key:void 0},a=(e.shiftKey?1:0)|(e.altKey?2:0)|(e.ctrlKey?4:0)|(e.metaKey?8:0);switch(e.keyCode){case 0:"UIKeyInputUpArrow"===e.key?o.key=t?n.C0.ESC+"OA":n.C0.ESC+"[A":"UIKeyInputLeftArrow"===e.key?o.key=t?n.C0.ESC+"OD":n.C0.ESC+"[D":"UIKeyInputRightArrow"===e.key?o.key=t?n.C0.ESC+"OC":n.C0.ESC+"[C":"UIKeyInputDownArrow"===e.key&&(o.key=t?n.C0.ESC+"OB":n.C0.ESC+"[B");break;case 8:if(e.altKey){o.key=n.C0.ESC+n.C0.DEL;break}o.key=n.C0.DEL;break;case 9:if(e.shiftKey){o.key=n.C0.ESC+"[Z";break}o.key=n.C0.HT,o.cancel=!0;break;case 13:o.key=e.altKey?n.C0.ESC+n.C0.CR:n.C0.CR,o.cancel=!0;break;case 27:o.key=n.C0.ESC,e.altKey&&(o.key=n.C0.ESC+n.C0.ESC),o.cancel=!0;break;case 37:if(e.metaKey)break;a?(o.key=n.C0.ESC+"[1;"+(a+1)+"D",o.key===n.C0.ESC+"[1;3D"&&(o.key=n.C0.ESC+(i?"b":"[1;5D"))):o.key=t?n.C0.ESC+"OD":n.C0.ESC+"[D";break;case 39:if(e.metaKey)break;a?(o.key=n.C0.ESC+"[1;"+(a+1)+"C",o.key===n.C0.ESC+"[1;3C"&&(o.key=n.C0.ESC+(i?"f":"[1;5C"))):o.key=t?n.C0.ESC+"OC":n.C0.ESC+"[C";break;case 38:if(e.metaKey)break;a?(o.key=n.C0.ESC+"[1;"+(a+1)+"A",i||o.key!==n.C0.ESC+"[1;3A"||(o.key=n.C0.ESC+"[1;5A")):o.key=t?n.C0.ESC+"OA":n.C0.ESC+"[A";break;case 40:if(e.metaKey)break;a?(o.key=n.C0.ESC+"[1;"+(a+1)+"B",i||o.key!==n.C0.ESC+"[1;3B"||(o.key=n.C0.ESC+"[1;5B")):o.key=t?n.C0.ESC+"OB":n.C0.ESC+"[B";break;case 45:e.shiftKey||e.ctrlKey||(o.key=n.C0.ESC+"[2~");break;case 46:o.key=a?n.C0.ESC+"[3;"+(a+1)+"~":n.C0.ESC+"[3~";break;case 36:o.key=a?n.C0.ESC+"[1;"+(a+1)+"H":t?n.C0.ESC+"OH":n.C0.ESC+"[H";break;case 35:o.key=a?n.C0.ESC+"[1;"+(a+1)+"F":t?n.C0.ESC+"OF":n.C0.ESC+"[F";break;case 33:e.shiftKey?o.type=2:e.ctrlKey?o.key=n.C0.ESC+"[5;"+(a+1)+"~":o.key=n.C0.ESC+"[5~";break;case 34:e.shiftKey?o.type=3:e.ctrlKey?o.key=n.C0.ESC+"[6;"+(a+1)+"~":o.key=n.C0.ESC+"[6~";break;case 112:o.key=a?n.C0.ESC+"[1;"+(a+1)+"P":n.C0.ESC+"OP";break;case 113:o.key=a?n.C0.ESC+"[1;"+(a+1)+"Q":n.C0.ESC+"OQ";break;case 114:o.key=a?n.C0.ESC+"[1;"+(a+1)+"R":n.C0.ESC+"OR";break;case 115:o.key=a?n.C0.ESC+"[1;"+(a+1)+"S":n.C0.ESC+"OS";break;case 116:o.key=a?n.C0.ESC+"[15;"+(a+1)+"~":n.C0.ESC+"[15~";break;case 117:o.key=a?n.C0.ESC+"[17;"+(a+1)+"~":n.C0.ESC+"[17~";break;case 118:o.key=a?n.C0.ESC+"[18;"+(a+1)+"~":n.C0.ESC+"[18~";break;case 119:o.key=a?n.C0.ESC+"[19;"+(a+1)+"~":n.C0.ESC+"[19~";break;case 120:o.key=a?n.C0.ESC+"[20;"+(a+1)+"~":n.C0.ESC+"[20~";break;case 121:o.key=a?n.C0.ESC+"[21;"+(a+1)+"~":n.C0.ESC+"[21~";break;case 122:o.key=a?n.C0.ESC+"[23;"+(a+1)+"~":n.C0.ESC+"[23~";break;case 123:o.key=a?n.C0.ESC+"[24;"+(a+1)+"~":n.C0.ESC+"[24~";break;default:if(!e.ctrlKey||e.shiftKey||e.altKey||e.metaKey)if(i&&!r||!e.altKey||e.metaKey)!i||e.altKey||e.ctrlKey||e.shiftKey||!e.metaKey?e.key&&!e.ctrlKey&&!e.altKey&&!e.metaKey&&e.keyCode>=48&&1===e.key.length?o.key=e.key:e.key&&e.ctrlKey&&("_"===e.key&&(o.key=n.C0.US),"@"===e.key&&(o.key=n.C0.NUL)):65===e.keyCode&&(o.type=1);else{const t=s[e.keyCode],i=null==t?void 0:t[e.shiftKey?1:0];if(i)o.key=n.C0.ESC+i;else if(e.keyCode>=65&&e.keyCode<=90){const t=e.ctrlKey?e.keyCode-64:e.keyCode+32;let i=String.fromCharCode(t);e.shiftKey&&(i=i.toUpperCase()),o.key=n.C0.ESC+i}else if(32===e.keyCode)o.key=n.C0.ESC+(e.ctrlKey?n.C0.NUL:" ");else if("Dead"===e.key&&e.code.startsWith("Key")){let t=e.code.slice(3,4);e.shiftKey||(t=t.toLowerCase()),o.key=n.C0.ESC+t,o.cancel=!0}}else e.keyCode>=65&&e.keyCode<=90?o.key=String.fromCharCode(e.keyCode-64):32===e.keyCode?o.key=n.C0.NUL:e.keyCode>=51&&e.keyCode<=55?o.key=String.fromCharCode(e.keyCode-51+27):56===e.keyCode?o.key=n.C0.DEL:219===e.keyCode?o.key=n.C0.ESC:220===e.keyCode?o.key=n.C0.FS:221===e.keyCode&&(o.key=n.C0.GS)}return o}},482:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Utf8ToUtf32=t.StringToUtf32=t.utf32ToString=t.stringFromCodePoint=void 0,t.stringFromCodePoint=function(e){return e>65535?(e-=65536,String.fromCharCode(55296+(e>>10))+String.fromCharCode(e%1024+56320)):String.fromCharCode(e)},t.utf32ToString=function(e,t=0,i=e.length){let n="";for(let s=t;s<i;++s){let t=e[s];t>65535?(t-=65536,n+=String.fromCharCode(55296+(t>>10))+String.fromCharCode(t%1024+56320)):n+=String.fromCharCode(t)}return n},t.StringToUtf32=class{constructor(){this._interim=0}clear(){this._interim=0}decode(e,t){const i=e.length;if(!i)return 0;let n=0,s=0;if(this._interim){const i=e.charCodeAt(s++);56320<=i&&i<=57343?t[n++]=1024*(this._interim-55296)+i-56320+65536:(t[n++]=this._interim,t[n++]=i),this._interim=0}for(let r=s;r<i;++r){const s=e.charCodeAt(r);if(55296<=s&&s<=56319){if(++r>=i)return this._interim=s,n;const o=e.charCodeAt(r);56320<=o&&o<=57343?t[n++]=1024*(s-55296)+o-56320+65536:(t[n++]=s,t[n++]=o)}else 65279!==s&&(t[n++]=s)}return n}},t.Utf8ToUtf32=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(e,t){const i=e.length;if(!i)return 0;let n,s,r,o,a=0,c=0,l=0;if(this.interim[0]){let n=!1,s=this.interim[0];s&=192==(224&s)?31:224==(240&s)?15:7;let r,o=0;for(;(r=63&this.interim[++o])&&o<4;)s<<=6,s|=r;const c=192==(224&this.interim[0])?2:224==(240&this.interim[0])?3:4,h=c-o;for(;l<h;){if(l>=i)return 0;if(r=e[l++],128!=(192&r)){l--,n=!0;break}this.interim[o++]=r,s<<=6,s|=63&r}n||(2===c?s<128?l--:t[a++]=s:3===c?s<2048||s>=55296&&s<=57343||65279===s||(t[a++]=s):s<65536||s>1114111||(t[a++]=s)),this.interim.fill(0)}const h=i-4;let d=l;for(;d<i;){for(;!(!(d<h)||128&(n=e[d])||128&(s=e[d+1])||128&(r=e[d+2])||128&(o=e[d+3]));)t[a++]=n,t[a++]=s,t[a++]=r,t[a++]=o,d+=4;if(n=e[d++],n<128)t[a++]=n;else if(192==(224&n)){if(d>=i)return this.interim[0]=n,a;if(s=e[d++],128!=(192&s)){d--;continue}if(c=(31&n)<<6|63&s,c<128){d--;continue}t[a++]=c}else if(224==(240&n)){if(d>=i)return this.interim[0]=n,a;if(s=e[d++],128!=(192&s)){d--;continue}if(d>=i)return this.interim[0]=n,this.interim[1]=s,a;if(r=e[d++],128!=(192&r)){d--;continue}if(c=(15&n)<<12|(63&s)<<6|63&r,c<2048||c>=55296&&c<=57343||65279===c)continue;t[a++]=c}else if(240==(248&n)){if(d>=i)return this.interim[0]=n,a;if(s=e[d++],128!=(192&s)){d--;continue}if(d>=i)return this.interim[0]=n,this.interim[1]=s,a;if(r=e[d++],128!=(192&r)){d--;continue}if(d>=i)return this.interim[0]=n,this.interim[1]=s,this.interim[2]=r,a;if(o=e[d++],128!=(192&o)){d--;continue}if(c=(7&n)<<18|(63&s)<<12|(63&r)<<6|63&o,c<65536||c>1114111)continue;t[a++]=c}}return a}}},225:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UnicodeV6=void 0;const i=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],n=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]];let s;t.UnicodeV6=class{constructor(){if(this.version="6",!s){s=new Uint8Array(65536),s.fill(1),s[0]=0,s.fill(0,1,32),s.fill(0,127,160),s.fill(2,4352,4448),s[9001]=2,s[9002]=2,s.fill(2,11904,42192),s[12351]=1,s.fill(2,44032,55204),s.fill(2,63744,64256),s.fill(2,65040,65050),s.fill(2,65072,65136),s.fill(2,65280,65377),s.fill(2,65504,65511);for(let e=0;e<i.length;++e)s.fill(0,i[e][0],i[e][1]+1)}}wcwidth(e){return e<32?0:e<127?1:e<65536?s[e]:function(e,t){let i,n=0,s=t.length-1;if(e<t[0][0]||e>t[s][1])return!1;for(;s>=n;)if(i=n+s>>1,e>t[i][1])n=i+1;else{if(!(e<t[i][0]))return!0;s=i-1}return!1}(e,n)?0:e>=131072&&e<=196605||e>=196608&&e<=262141?2:1}}},5981:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WriteBuffer=void 0;const n=i(8460),s=i(844);class r extends s.Disposable{constructor(e){super(),this._action=e,this._writeBuffer=[],this._callbacks=[],this._pendingData=0,this._bufferOffset=0,this._isSyncWriting=!1,this._syncCalls=0,this._didUserInput=!1,this._onWriteParsed=this.register(new n.EventEmitter),this.onWriteParsed=this._onWriteParsed.event}handleUserInput(){this._didUserInput=!0}writeSync(e,t){if(void 0!==t&&this._syncCalls>t)return void(this._syncCalls=0);if(this._pendingData+=e.length,this._writeBuffer.push(e),this._callbacks.push(void 0),this._syncCalls++,this._isSyncWriting)return;let i;for(this._isSyncWriting=!0;i=this._writeBuffer.shift();){this._action(i);const e=this._callbacks.shift();e&&e()}this._pendingData=0,this._bufferOffset=2147483647,this._isSyncWriting=!1,this._syncCalls=0}write(e,t){if(this._pendingData>5e7)throw new Error("write data discarded, use flow control to avoid losing data");if(!this._writeBuffer.length){if(this._bufferOffset=0,this._didUserInput)return this._didUserInput=!1,this._pendingData+=e.length,this._writeBuffer.push(e),this._callbacks.push(t),void this._innerWrite();setTimeout((()=>this._innerWrite()))}this._pendingData+=e.length,this._writeBuffer.push(e),this._callbacks.push(t)}_innerWrite(e=0,t=!0){const i=e||Date.now();for(;this._writeBuffer.length>this._bufferOffset;){const e=this._writeBuffer[this._bufferOffset],n=this._action(e,t);if(n){const e=e=>Date.now()-i>=12?setTimeout((()=>this._innerWrite(0,e))):this._innerWrite(i,e);return void n.catch((e=>(queueMicrotask((()=>{throw e})),Promise.resolve(!1)))).then(e)}const s=this._callbacks[this._bufferOffset];if(s&&s(),this._bufferOffset++,this._pendingData-=e.length,Date.now()-i>=12)break}this._writeBuffer.length>this._bufferOffset?(this._bufferOffset>50&&(this._writeBuffer=this._writeBuffer.slice(this._bufferOffset),this._callbacks=this._callbacks.slice(this._bufferOffset),this._bufferOffset=0),setTimeout((()=>this._innerWrite()))):(this._writeBuffer.length=0,this._callbacks.length=0,this._pendingData=0,this._bufferOffset=0),this._onWriteParsed.fire()}}t.WriteBuffer=r},5941:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.toRgbString=t.parseColor=void 0;const i=/^([\da-f])\/([\da-f])\/([\da-f])$|^([\da-f]{2})\/([\da-f]{2})\/([\da-f]{2})$|^([\da-f]{3})\/([\da-f]{3})\/([\da-f]{3})$|^([\da-f]{4})\/([\da-f]{4})\/([\da-f]{4})$/,n=/^[\da-f]+$/;function s(e,t){const i=e.toString(16),n=i.length<2?"0"+i:i;switch(t){case 4:return i[0];case 8:return n;case 12:return(n+n).slice(0,3);default:return n+n}}t.parseColor=function(e){if(!e)return;let t=e.toLowerCase();if(0===t.indexOf("rgb:")){t=t.slice(4);const e=i.exec(t);if(e){const t=e[1]?15:e[4]?255:e[7]?4095:65535;return[Math.round(parseInt(e[1]||e[4]||e[7]||e[10],16)/t*255),Math.round(parseInt(e[2]||e[5]||e[8]||e[11],16)/t*255),Math.round(parseInt(e[3]||e[6]||e[9]||e[12],16)/t*255)]}}else if(0===t.indexOf("#")&&(t=t.slice(1),n.exec(t)&&[3,6,9,12].includes(t.length))){const e=t.length/3,i=[0,0,0];for(let n=0;n<3;++n){const s=parseInt(t.slice(e*n,e*n+e),16);i[n]=1===e?s<<4:2===e?s:3===e?s>>4:s>>8}return i}},t.toRgbString=function(e,t=16){const[i,n,r]=e;return`rgb:${s(i,t)}/${s(n,t)}/${s(r,t)}`}},5770:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PAYLOAD_LIMIT=void 0,t.PAYLOAD_LIMIT=1e7},6351:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DcsHandler=t.DcsParser=void 0;const n=i(482),s=i(8742),r=i(5770),o=[];t.DcsParser=class{constructor(){this._handlers=Object.create(null),this._active=o,this._ident=0,this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=o}registerHandler(e,t){void 0===this._handlers[e]&&(this._handlers[e]=[]);const i=this._handlers[e];return i.push(t),{dispose:()=>{const e=i.indexOf(t);-1!==e&&i.splice(e,1)}}}clearHandler(e){this._handlers[e]&&delete this._handlers[e]}setHandlerFallback(e){this._handlerFb=e}reset(){if(this._active.length)for(let e=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;e>=0;--e)this._active[e].unhook(!1);this._stack.paused=!1,this._active=o,this._ident=0}hook(e,t){if(this.reset(),this._ident=e,this._active=this._handlers[e]||o,this._active.length)for(let e=this._active.length-1;e>=0;e--)this._active[e].hook(t);else this._handlerFb(this._ident,"HOOK",t)}put(e,t,i){if(this._active.length)for(let n=this._active.length-1;n>=0;n--)this._active[n].put(e,t,i);else this._handlerFb(this._ident,"PUT",(0,n.utf32ToString)(e,t,i))}unhook(e,t=!0){if(this._active.length){let i=!1,n=this._active.length-1,s=!1;if(this._stack.paused&&(n=this._stack.loopPosition-1,i=t,s=this._stack.fallThrough,this._stack.paused=!1),!s&&!1===i){for(;n>=0&&(i=this._active[n].unhook(e),!0!==i);n--)if(i instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=n,this._stack.fallThrough=!1,i;n--}for(;n>=0;n--)if(i=this._active[n].unhook(!1),i instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=n,this._stack.fallThrough=!0,i}else this._handlerFb(this._ident,"UNHOOK",e);this._active=o,this._ident=0}};const a=new s.Params;a.addParam(0),t.DcsHandler=class{constructor(e){this._handler=e,this._data="",this._params=a,this._hitLimit=!1}hook(e){this._params=e.length>1||e.params[0]?e.clone():a,this._data="",this._hitLimit=!1}put(e,t,i){this._hitLimit||(this._data+=(0,n.utf32ToString)(e,t,i),this._data.length>r.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}unhook(e){let t=!1;if(this._hitLimit)t=!1;else if(e&&(t=this._handler(this._data,this._params),t instanceof Promise))return t.then((e=>(this._params=a,this._data="",this._hitLimit=!1,e)));return this._params=a,this._data="",this._hitLimit=!1,t}}},2015:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EscapeSequenceParser=t.VT500_TRANSITION_TABLE=t.TransitionTable=void 0;const n=i(844),s=i(8742),r=i(6242),o=i(6351);class a{constructor(e){this.table=new Uint8Array(e)}setDefault(e,t){this.table.fill(e<<4|t)}add(e,t,i,n){this.table[t<<8|e]=i<<4|n}addMany(e,t,i,n){for(let s=0;s<e.length;s++)this.table[t<<8|e[s]]=i<<4|n}}t.TransitionTable=a;const c=160;t.VT500_TRANSITION_TABLE=function(){const e=new a(4095),t=Array.apply(null,Array(256)).map(((e,t)=>t)),i=(e,i)=>t.slice(e,i),n=i(32,127),s=i(0,24);s.push(25),s.push.apply(s,i(28,32));const r=i(0,14);let o;for(o in e.setDefault(1,0),e.addMany(n,0,2,0),r)e.addMany([24,26,153,154],o,3,0),e.addMany(i(128,144),o,3,0),e.addMany(i(144,152),o,3,0),e.add(156,o,0,0),e.add(27,o,11,1),e.add(157,o,4,8),e.addMany([152,158,159],o,0,7),e.add(155,o,11,3),e.add(144,o,11,9);return e.addMany(s,0,3,0),e.addMany(s,1,3,1),e.add(127,1,0,1),e.addMany(s,8,0,8),e.addMany(s,3,3,3),e.add(127,3,0,3),e.addMany(s,4,3,4),e.add(127,4,0,4),e.addMany(s,6,3,6),e.addMany(s,5,3,5),e.add(127,5,0,5),e.addMany(s,2,3,2),e.add(127,2,0,2),e.add(93,1,4,8),e.addMany(n,8,5,8),e.add(127,8,5,8),e.addMany([156,27,24,26,7],8,6,0),e.addMany(i(28,32),8,0,8),e.addMany([88,94,95],1,0,7),e.addMany(n,7,0,7),e.addMany(s,7,0,7),e.add(156,7,0,0),e.add(127,7,0,7),e.add(91,1,11,3),e.addMany(i(64,127),3,7,0),e.addMany(i(48,60),3,8,4),e.addMany([60,61,62,63],3,9,4),e.addMany(i(48,60),4,8,4),e.addMany(i(64,127),4,7,0),e.addMany([60,61,62,63],4,0,6),e.addMany(i(32,64),6,0,6),e.add(127,6,0,6),e.addMany(i(64,127),6,0,0),e.addMany(i(32,48),3,9,5),e.addMany(i(32,48),5,9,5),e.addMany(i(48,64),5,0,6),e.addMany(i(64,127),5,7,0),e.addMany(i(32,48),4,9,5),e.addMany(i(32,48),1,9,2),e.addMany(i(32,48),2,9,2),e.addMany(i(48,127),2,10,0),e.addMany(i(48,80),1,10,0),e.addMany(i(81,88),1,10,0),e.addMany([89,90,92],1,10,0),e.addMany(i(96,127),1,10,0),e.add(80,1,11,9),e.addMany(s,9,0,9),e.add(127,9,0,9),e.addMany(i(28,32),9,0,9),e.addMany(i(32,48),9,9,12),e.addMany(i(48,60),9,8,10),e.addMany([60,61,62,63],9,9,10),e.addMany(s,11,0,11),e.addMany(i(32,128),11,0,11),e.addMany(i(28,32),11,0,11),e.addMany(s,10,0,10),e.add(127,10,0,10),e.addMany(i(28,32),10,0,10),e.addMany(i(48,60),10,8,10),e.addMany([60,61,62,63],10,0,11),e.addMany(i(32,48),10,9,12),e.addMany(s,12,0,12),e.add(127,12,0,12),e.addMany(i(28,32),12,0,12),e.addMany(i(32,48),12,9,12),e.addMany(i(48,64),12,0,11),e.addMany(i(64,127),12,12,13),e.addMany(i(64,127),10,12,13),e.addMany(i(64,127),9,12,13),e.addMany(s,13,13,13),e.addMany(n,13,13,13),e.add(127,13,0,13),e.addMany([27,156,24,26],13,14,0),e.add(c,0,2,0),e.add(c,8,5,8),e.add(c,6,0,6),e.add(c,11,0,11),e.add(c,13,13,13),e}();class l extends n.Disposable{constructor(e=t.VT500_TRANSITION_TABLE){super(),this._transitions=e,this._parseStack={state:0,handlers:[],handlerPos:0,transition:0,chunkPos:0},this.initialState=0,this.currentState=this.initialState,this._params=new s.Params,this._params.addParam(0),this._collect=0,this.precedingCodepoint=0,this._printHandlerFb=(e,t,i)=>{},this._executeHandlerFb=e=>{},this._csiHandlerFb=(e,t)=>{},this._escHandlerFb=e=>{},this._errorHandlerFb=e=>e,this._printHandler=this._printHandlerFb,this._executeHandlers=Object.create(null),this._csiHandlers=Object.create(null),this._escHandlers=Object.create(null),this.register((0,n.toDisposable)((()=>{this._csiHandlers=Object.create(null),this._executeHandlers=Object.create(null),this._escHandlers=Object.create(null)}))),this._oscParser=this.register(new r.OscParser),this._dcsParser=this.register(new o.DcsParser),this._errorHandler=this._errorHandlerFb,this.registerEscHandler({final:"\\"},(()=>!0))}_identifier(e,t=[64,126]){let i=0;if(e.prefix){if(e.prefix.length>1)throw new Error("only one byte as prefix supported");if(i=e.prefix.charCodeAt(0),i&&60>i||i>63)throw new Error("prefix must be in range 0x3c .. 0x3f")}if(e.intermediates){if(e.intermediates.length>2)throw new Error("only two bytes as intermediates are supported");for(let t=0;t<e.intermediates.length;++t){const n=e.intermediates.charCodeAt(t);if(32>n||n>47)throw new Error("intermediate must be in range 0x20 .. 0x2f");i<<=8,i|=n}}if(1!==e.final.length)throw new Error("final must be a single byte");const n=e.final.charCodeAt(0);if(t[0]>n||n>t[1])throw new Error(`final must be in range ${t[0]} .. ${t[1]}`);return i<<=8,i|=n,i}identToString(e){const t=[];for(;e;)t.push(String.fromCharCode(255&e)),e>>=8;return t.reverse().join("")}setPrintHandler(e){this._printHandler=e}clearPrintHandler(){this._printHandler=this._printHandlerFb}registerEscHandler(e,t){const i=this._identifier(e,[48,126]);void 0===this._escHandlers[i]&&(this._escHandlers[i]=[]);const n=this._escHandlers[i];return n.push(t),{dispose:()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}}clearEscHandler(e){this._escHandlers[this._identifier(e,[48,126])]&&delete this._escHandlers[this._identifier(e,[48,126])]}setEscHandlerFallback(e){this._escHandlerFb=e}setExecuteHandler(e,t){this._executeHandlers[e.charCodeAt(0)]=t}clearExecuteHandler(e){this._executeHandlers[e.charCodeAt(0)]&&delete this._executeHandlers[e.charCodeAt(0)]}setExecuteHandlerFallback(e){this._executeHandlerFb=e}registerCsiHandler(e,t){const i=this._identifier(e);void 0===this._csiHandlers[i]&&(this._csiHandlers[i]=[]);const n=this._csiHandlers[i];return n.push(t),{dispose:()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}}clearCsiHandler(e){this._csiHandlers[this._identifier(e)]&&delete this._csiHandlers[this._identifier(e)]}setCsiHandlerFallback(e){this._csiHandlerFb=e}registerDcsHandler(e,t){return this._dcsParser.registerHandler(this._identifier(e),t)}clearDcsHandler(e){this._dcsParser.clearHandler(this._identifier(e))}setDcsHandlerFallback(e){this._dcsParser.setHandlerFallback(e)}registerOscHandler(e,t){return this._oscParser.registerHandler(e,t)}clearOscHandler(e){this._oscParser.clearHandler(e)}setOscHandlerFallback(e){this._oscParser.setHandlerFallback(e)}setErrorHandler(e){this._errorHandler=e}clearErrorHandler(){this._errorHandler=this._errorHandlerFb}reset(){this.currentState=this.initialState,this._oscParser.reset(),this._dcsParser.reset(),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0,0!==this._parseStack.state&&(this._parseStack.state=2,this._parseStack.handlers=[])}_preserveStack(e,t,i,n,s){this._parseStack.state=e,this._parseStack.handlers=t,this._parseStack.handlerPos=i,this._parseStack.transition=n,this._parseStack.chunkPos=s}parse(e,t,i){let n,s=0,r=0,o=0;if(this._parseStack.state)if(2===this._parseStack.state)this._parseStack.state=0,o=this._parseStack.chunkPos+1;else{if(void 0===i||1===this._parseStack.state)throw this._parseStack.state=1,new Error("improper continuation due to previous async handler, giving up parsing");const t=this._parseStack.handlers;let r=this._parseStack.handlerPos-1;switch(this._parseStack.state){case 3:if(!1===i&&r>-1)for(;r>=0&&(n=t[r](this._params),!0!==n);r--)if(n instanceof Promise)return this._parseStack.handlerPos=r,n;this._parseStack.handlers=[];break;case 4:if(!1===i&&r>-1)for(;r>=0&&(n=t[r](),!0!==n);r--)if(n instanceof Promise)return this._parseStack.handlerPos=r,n;this._parseStack.handlers=[];break;case 6:if(s=e[this._parseStack.chunkPos],n=this._dcsParser.unhook(24!==s&&26!==s,i),n)return n;27===s&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break;case 5:if(s=e[this._parseStack.chunkPos],n=this._oscParser.end(24!==s&&26!==s,i),n)return n;27===s&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0}this._parseStack.state=0,o=this._parseStack.chunkPos+1,this.precedingCodepoint=0,this.currentState=15&this._parseStack.transition}for(let i=o;i<t;++i){switch(s=e[i],r=this._transitions.table[this.currentState<<8|(s<160?s:c)],r>>4){case 2:for(let n=i+1;;++n){if(n>=t||(s=e[n])<32||s>126&&s<c){this._printHandler(e,i,n),i=n-1;break}if(++n>=t||(s=e[n])<32||s>126&&s<c){this._printHandler(e,i,n),i=n-1;break}if(++n>=t||(s=e[n])<32||s>126&&s<c){this._printHandler(e,i,n),i=n-1;break}if(++n>=t||(s=e[n])<32||s>126&&s<c){this._printHandler(e,i,n),i=n-1;break}}break;case 3:this._executeHandlers[s]?this._executeHandlers[s]():this._executeHandlerFb(s),this.precedingCodepoint=0;break;case 0:break;case 1:if(this._errorHandler({position:i,code:s,currentState:this.currentState,collect:this._collect,params:this._params,abort:!1}).abort)return;break;case 7:const o=this._csiHandlers[this._collect<<8|s];let a=o?o.length-1:-1;for(;a>=0&&(n=o[a](this._params),!0!==n);a--)if(n instanceof Promise)return this._preserveStack(3,o,a,r,i),n;a<0&&this._csiHandlerFb(this._collect<<8|s,this._params),this.precedingCodepoint=0;break;case 8:do{switch(s){case 59:this._params.addParam(0);break;case 58:this._params.addSubParam(-1);break;default:this._params.addDigit(s-48)}}while(++i<t&&(s=e[i])>47&&s<60);i--;break;case 9:this._collect<<=8,this._collect|=s;break;case 10:const l=this._escHandlers[this._collect<<8|s];let h=l?l.length-1:-1;for(;h>=0&&(n=l[h](),!0!==n);h--)if(n instanceof Promise)return this._preserveStack(4,l,h,r,i),n;h<0&&this._escHandlerFb(this._collect<<8|s),this.precedingCodepoint=0;break;case 11:this._params.reset(),this._params.addParam(0),this._collect=0;break;case 12:this._dcsParser.hook(this._collect<<8|s,this._params);break;case 13:for(let n=i+1;;++n)if(n>=t||24===(s=e[n])||26===s||27===s||s>127&&s<c){this._dcsParser.put(e,i,n),i=n-1;break}break;case 14:if(n=this._dcsParser.unhook(24!==s&&26!==s),n)return this._preserveStack(6,[],0,r,i),n;27===s&&(r|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0;break;case 4:this._oscParser.start();break;case 5:for(let n=i+1;;n++)if(n>=t||(s=e[n])<32||s>127&&s<c){this._oscParser.put(e,i,n),i=n-1;break}break;case 6:if(n=this._oscParser.end(24!==s&&26!==s),n)return this._preserveStack(5,[],0,r,i),n;27===s&&(r|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0}this.currentState=15&r}}}t.EscapeSequenceParser=l},6242:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OscHandler=t.OscParser=void 0;const n=i(5770),s=i(482),r=[];t.OscParser=class{constructor(){this._state=0,this._active=r,this._id=-1,this._handlers=Object.create(null),this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}registerHandler(e,t){void 0===this._handlers[e]&&(this._handlers[e]=[]);const i=this._handlers[e];return i.push(t),{dispose:()=>{const e=i.indexOf(t);-1!==e&&i.splice(e,1)}}}clearHandler(e){this._handlers[e]&&delete this._handlers[e]}setHandlerFallback(e){this._handlerFb=e}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=r}reset(){if(2===this._state)for(let e=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;e>=0;--e)this._active[e].end(!1);this._stack.paused=!1,this._active=r,this._id=-1,this._state=0}_start(){if(this._active=this._handlers[this._id]||r,this._active.length)for(let e=this._active.length-1;e>=0;e--)this._active[e].start();else this._handlerFb(this._id,"START")}_put(e,t,i){if(this._active.length)for(let n=this._active.length-1;n>=0;n--)this._active[n].put(e,t,i);else this._handlerFb(this._id,"PUT",(0,s.utf32ToString)(e,t,i))}start(){this.reset(),this._state=1}put(e,t,i){if(3!==this._state){if(1===this._state)for(;t<i;){const i=e[t++];if(59===i){this._state=2,this._start();break}if(i<48||57<i)return void(this._state=3);-1===this._id&&(this._id=0),this._id=10*this._id+i-48}2===this._state&&i-t>0&&this._put(e,t,i)}}end(e,t=!0){if(0!==this._state){if(3!==this._state)if(1===this._state&&this._start(),this._active.length){let i=!1,n=this._active.length-1,s=!1;if(this._stack.paused&&(n=this._stack.loopPosition-1,i=t,s=this._stack.fallThrough,this._stack.paused=!1),!s&&!1===i){for(;n>=0&&(i=this._active[n].end(e),!0!==i);n--)if(i instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=n,this._stack.fallThrough=!1,i;n--}for(;n>=0;n--)if(i=this._active[n].end(!1),i instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=n,this._stack.fallThrough=!0,i}else this._handlerFb(this._id,"END",e);this._active=r,this._id=-1,this._state=0}}},t.OscHandler=class{constructor(e){this._handler=e,this._data="",this._hitLimit=!1}start(){this._data="",this._hitLimit=!1}put(e,t,i){this._hitLimit||(this._data+=(0,s.utf32ToString)(e,t,i),this._data.length>n.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}end(e){let t=!1;if(this._hitLimit)t=!1;else if(e&&(t=this._handler(this._data),t instanceof Promise))return t.then((e=>(this._data="",this._hitLimit=!1,e)));return this._data="",this._hitLimit=!1,t}}},8742:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Params=void 0;const i=2147483647;class n{constructor(e=32,t=32){if(this.maxLength=e,this.maxSubParamsLength=t,t>256)throw new Error("maxSubParamsLength must not be greater than 256");this.params=new Int32Array(e),this.length=0,this._subParams=new Int32Array(t),this._subParamsLength=0,this._subParamsIdx=new Uint16Array(e),this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}static fromArray(e){const t=new n;if(!e.length)return t;for(let i=Array.isArray(e[0])?1:0;i<e.length;++i){const n=e[i];if(Array.isArray(n))for(let e=0;e<n.length;++e)t.addSubParam(n[e]);else t.addParam(n)}return t}clone(){const e=new n(this.maxLength,this.maxSubParamsLength);return e.params.set(this.params),e.length=this.length,e._subParams.set(this._subParams),e._subParamsLength=this._subParamsLength,e._subParamsIdx.set(this._subParamsIdx),e._rejectDigits=this._rejectDigits,e._rejectSubDigits=this._rejectSubDigits,e._digitIsSub=this._digitIsSub,e}toArray(){const e=[];for(let t=0;t<this.length;++t){e.push(this.params[t]);const i=this._subParamsIdx[t]>>8,n=255&this._subParamsIdx[t];n-i>0&&e.push(Array.prototype.slice.call(this._subParams,i,n))}return e}reset(){this.length=0,this._subParamsLength=0,this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}addParam(e){if(this._digitIsSub=!1,this.length>=this.maxLength)this._rejectDigits=!0;else{if(e<-1)throw new Error("values lesser than -1 are not allowed");this._subParamsIdx[this.length]=this._subParamsLength<<8|this._subParamsLength,this.params[this.length++]=e>i?i:e}}addSubParam(e){if(this._digitIsSub=!0,this.length)if(this._rejectDigits||this._subParamsLength>=this.maxSubParamsLength)this._rejectSubDigits=!0;else{if(e<-1)throw new Error("values lesser than -1 are not allowed");this._subParams[this._subParamsLength++]=e>i?i:e,this._subParamsIdx[this.length-1]++}}hasSubParams(e){return(255&this._subParamsIdx[e])-(this._subParamsIdx[e]>>8)>0}getSubParams(e){const t=this._subParamsIdx[e]>>8,i=255&this._subParamsIdx[e];return i-t>0?this._subParams.subarray(t,i):null}getSubParamsAll(){const e={};for(let t=0;t<this.length;++t){const i=this._subParamsIdx[t]>>8,n=255&this._subParamsIdx[t];n-i>0&&(e[t]=this._subParams.slice(i,n))}return e}addDigit(e){let t;if(this._rejectDigits||!(t=this._digitIsSub?this._subParamsLength:this.length)||this._digitIsSub&&this._rejectSubDigits)return;const n=this._digitIsSub?this._subParams:this.params,s=n[t-1];n[t-1]=~s?Math.min(10*s+e,i):e}}t.Params=n},5741:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AddonManager=void 0,t.AddonManager=class{constructor(){this._addons=[]}dispose(){for(let e=this._addons.length-1;e>=0;e--)this._addons[e].instance.dispose()}loadAddon(e,t){const i={instance:t,dispose:t.dispose,isDisposed:!1};this._addons.push(i),t.dispose=()=>this._wrappedAddonDispose(i),t.activate(e)}_wrappedAddonDispose(e){if(e.isDisposed)return;let t=-1;for(let i=0;i<this._addons.length;i++)if(this._addons[i]===e){t=i;break}if(-1===t)throw new Error("Could not dispose an addon that has not been loaded");e.isDisposed=!0,e.dispose.apply(e.instance),this._addons.splice(t,1)}}},8771:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BufferApiView=void 0;const n=i(3785),s=i(511);t.BufferApiView=class{constructor(e,t){this._buffer=e,this.type=t}init(e){return this._buffer=e,this}get cursorY(){return this._buffer.y}get cursorX(){return this._buffer.x}get viewportY(){return this._buffer.ydisp}get baseY(){return this._buffer.ybase}get length(){return this._buffer.lines.length}getLine(e){const t=this._buffer.lines.get(e);if(t)return new n.BufferLineApiView(t)}getNullCell(){return new s.CellData}}},3785:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BufferLineApiView=void 0;const n=i(511);t.BufferLineApiView=class{constructor(e){this._line=e}get isWrapped(){return this._line.isWrapped}get length(){return this._line.length}getCell(e,t){if(!(e<0||e>=this._line.length))return t?(this._line.loadCell(e,t),t):this._line.loadCell(e,new n.CellData)}translateToString(e,t,i){return this._line.translateToString(e,t,i)}}},8285:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BufferNamespaceApi=void 0;const n=i(8771),s=i(8460);t.BufferNamespaceApi=class{constructor(e){this._core=e,this._onBufferChange=new s.EventEmitter,this.onBufferChange=this._onBufferChange.event,this._normal=new n.BufferApiView(this._core.buffers.normal,"normal"),this._alternate=new n.BufferApiView(this._core.buffers.alt,"alternate"),this._core.buffers.onBufferActivate((()=>this._onBufferChange.fire(this.active)))}get active(){if(this._core.buffers.active===this._core.buffers.normal)return this.normal;if(this._core.buffers.active===this._core.buffers.alt)return this.alternate;throw new Error("Active buffer is neither normal nor alternate")}get normal(){return this._normal.init(this._core.buffers.normal)}get alternate(){return this._alternate.init(this._core.buffers.alt)}}},7975:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ParserApi=void 0,t.ParserApi=class{constructor(e){this._core=e}registerCsiHandler(e,t){return this._core.registerCsiHandler(e,(e=>t(e.toArray())))}addCsiHandler(e,t){return this.registerCsiHandler(e,t)}registerDcsHandler(e,t){return this._core.registerDcsHandler(e,((e,i)=>t(e,i.toArray())))}addDcsHandler(e,t){return this.registerDcsHandler(e,t)}registerEscHandler(e,t){return this._core.registerEscHandler(e,t)}addEscHandler(e,t){return this.registerEscHandler(e,t)}registerOscHandler(e,t){return this._core.registerOscHandler(e,t)}addOscHandler(e,t){return this.registerOscHandler(e,t)}}},7090:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UnicodeApi=void 0,t.UnicodeApi=class{constructor(e){this._core=e}register(e){this._core.unicodeService.register(e)}get versions(){return this._core.unicodeService.versions}get activeVersion(){return this._core.unicodeService.activeVersion}set activeVersion(e){this._core.unicodeService.activeVersion=e}}},744:function(e,t,i){var n=this&&this.__decorate||function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},s=this&&this.__param||function(e,t){return function(i,n){t(i,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.BufferService=t.MINIMUM_ROWS=t.MINIMUM_COLS=void 0;const r=i(2585),o=i(5295),a=i(8460),c=i(844);t.MINIMUM_COLS=2,t.MINIMUM_ROWS=1;let l=class extends c.Disposable{constructor(e){super(),this.isUserScrolling=!1,this._onResize=this.register(new a.EventEmitter),this.onResize=this._onResize.event,this._onScroll=this.register(new a.EventEmitter),this.onScroll=this._onScroll.event,this.cols=Math.max(e.rawOptions.cols||0,t.MINIMUM_COLS),this.rows=Math.max(e.rawOptions.rows||0,t.MINIMUM_ROWS),this.buffers=this.register(new o.BufferSet(e,this))}get buffer(){return this.buffers.active}resize(e,t){this.cols=e,this.rows=t,this.buffers.resize(e,t),this._onResize.fire({cols:e,rows:t})}reset(){this.buffers.reset(),this.isUserScrolling=!1}scroll(e,t=!1){const i=this.buffer;let n;n=this._cachedBlankLine,n&&n.length===this.cols&&n.getFg(0)===e.fg&&n.getBg(0)===e.bg||(n=i.getBlankLine(e,t),this._cachedBlankLine=n),n.isWrapped=t;const s=i.ybase+i.scrollTop,r=i.ybase+i.scrollBottom;if(0===i.scrollTop){const e=i.lines.isFull;r===i.lines.length-1?e?i.lines.recycle().copyFrom(n):i.lines.push(n.clone()):i.lines.splice(r+1,0,n.clone()),e?this.isUserScrolling&&(i.ydisp=Math.max(i.ydisp-1,0)):(i.ybase++,this.isUserScrolling||i.ydisp++)}else{const e=r-s+1;i.lines.shiftElements(s+1,e-1,-1),i.lines.set(r,n.clone())}this.isUserScrolling||(i.ydisp=i.ybase),this._onScroll.fire(i.ydisp)}scrollLines(e,t,i){const n=this.buffer;if(e<0){if(0===n.ydisp)return;this.isUserScrolling=!0}else e+n.ydisp>=n.ybase&&(this.isUserScrolling=!1);const s=n.ydisp;n.ydisp=Math.max(Math.min(n.ydisp+e,n.ybase),0),s!==n.ydisp&&(t||this._onScroll.fire(n.ydisp))}scrollPages(e){this.scrollLines(e*(this.rows-1))}scrollToTop(){this.scrollLines(-this.buffer.ydisp)}scrollToBottom(){this.scrollLines(this.buffer.ybase-this.buffer.ydisp)}scrollToLine(e){const t=e-this.buffer.ydisp;0!==t&&this.scrollLines(t)}};l=n([s(0,r.IOptionsService)],l),t.BufferService=l},7994:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CharsetService=void 0,t.CharsetService=class{constructor(){this.glevel=0,this._charsets=[]}reset(){this.charset=void 0,this._charsets=[],this.glevel=0}setgLevel(e){this.glevel=e,this.charset=this._charsets[e]}setgCharset(e,t){this._charsets[e]=t,this.glevel===e&&(this.charset=t)}}},1753:function(e,t,i){var n=this&&this.__decorate||function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},s=this&&this.__param||function(e,t){return function(i,n){t(i,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CoreMouseService=void 0;const r=i(2585),o=i(8460),a=i(844),c={NONE:{events:0,restrict:()=>!1},X10:{events:1,restrict:e=>4!==e.button&&1===e.action&&(e.ctrl=!1,e.alt=!1,e.shift=!1,!0)},VT200:{events:19,restrict:e=>32!==e.action},DRAG:{events:23,restrict:e=>32!==e.action||3!==e.button},ANY:{events:31,restrict:e=>!0}};function l(e,t){let i=(e.ctrl?16:0)|(e.shift?4:0)|(e.alt?8:0);return 4===e.button?(i|=64,i|=e.action):(i|=3&e.button,4&e.button&&(i|=64),8&e.button&&(i|=128),32===e.action?i|=32:0!==e.action||t||(i|=3)),i}const h=String.fromCharCode,d={DEFAULT:e=>{const t=[l(e,!1)+32,e.col+32,e.row+32];return t[0]>255||t[1]>255||t[2]>255?"":`[M${h(t[0])}${h(t[1])}${h(t[2])}`},SGR:e=>{const t=0===e.action&&4!==e.button?"m":"M";return`[<${l(e,!0)};${e.col};${e.row}${t}`},SGR_PIXELS:e=>{const t=0===e.action&&4!==e.button?"m":"M";return`[<${l(e,!0)};${e.x};${e.y}${t}`}};let u=class extends a.Disposable{constructor(e,t){super(),this._bufferService=e,this._coreService=t,this._protocols={},this._encodings={},this._activeProtocol="",this._activeEncoding="",this._lastEvent=null,this._onProtocolChange=this.register(new o.EventEmitter),this.onProtocolChange=this._onProtocolChange.event;for(const e of Object.keys(c))this.addProtocol(e,c[e]);for(const e of Object.keys(d))this.addEncoding(e,d[e]);this.reset()}addProtocol(e,t){this._protocols[e]=t}addEncoding(e,t){this._encodings[e]=t}get activeProtocol(){return this._activeProtocol}get areMouseEventsActive(){return 0!==this._protocols[this._activeProtocol].events}set activeProtocol(e){if(!this._protocols[e])throw new Error(`unknown protocol "${e}"`);this._activeProtocol=e,this._onProtocolChange.fire(this._protocols[e].events)}get activeEncoding(){return this._activeEncoding}set activeEncoding(e){if(!this._encodings[e])throw new Error(`unknown encoding "${e}"`);this._activeEncoding=e}reset(){this.activeProtocol="NONE",this.activeEncoding="DEFAULT",this._lastEvent=null}triggerMouseEvent(e){if(e.col<0||e.col>=this._bufferService.cols||e.row<0||e.row>=this._bufferService.rows)return!1;if(4===e.button&&32===e.action)return!1;if(3===e.button&&32!==e.action)return!1;if(4!==e.button&&(2===e.action||3===e.action))return!1;if(e.col++,e.row++,32===e.action&&this._lastEvent&&this._equalEvents(this._lastEvent,e,"SGR_PIXELS"===this._activeEncoding))return!1;if(!this._protocols[this._activeProtocol].restrict(e))return!1;const t=this._encodings[this._activeEncoding](e);return t&&("DEFAULT"===this._activeEncoding?this._coreService.triggerBinaryEvent(t):this._coreService.triggerDataEvent(t,!0)),this._lastEvent=e,!0}explainEvents(e){return{down:!!(1&e),up:!!(2&e),drag:!!(4&e),move:!!(8&e),wheel:!!(16&e)}}_equalEvents(e,t,i){if(i){if(e.x!==t.x)return!1;if(e.y!==t.y)return!1}else{if(e.col!==t.col)return!1;if(e.row!==t.row)return!1}return e.button===t.button&&e.action===t.action&&e.ctrl===t.ctrl&&e.alt===t.alt&&e.shift===t.shift}};u=n([s(0,r.IBufferService),s(1,r.ICoreService)],u),t.CoreMouseService=u},6975:function(e,t,i){var n=this&&this.__decorate||function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},s=this&&this.__param||function(e,t){return function(i,n){t(i,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CoreService=void 0;const r=i(2585),o=i(8460),a=i(1439),c=i(844),l=Object.freeze({insertMode:!1}),h=Object.freeze({applicationCursorKeys:!1,applicationKeypad:!1,bracketedPasteMode:!1,origin:!1,reverseWraparound:!1,sendFocus:!1,wraparound:!0});let d=class extends c.Disposable{constructor(e,t,i){super(),this._bufferService=e,this._logService=t,this._optionsService=i,this.isCursorInitialized=!1,this.isCursorHidden=!1,this._onData=this.register(new o.EventEmitter),this.onData=this._onData.event,this._onUserInput=this.register(new o.EventEmitter),this.onUserInput=this._onUserInput.event,this._onBinary=this.register(new o.EventEmitter),this.onBinary=this._onBinary.event,this._onRequestScrollToBottom=this.register(new o.EventEmitter),this.onRequestScrollToBottom=this._onRequestScrollToBottom.event,this.modes=(0,a.clone)(l),this.decPrivateModes=(0,a.clone)(h)}reset(){this.modes=(0,a.clone)(l),this.decPrivateModes=(0,a.clone)(h)}triggerDataEvent(e,t=!1){if(this._optionsService.rawOptions.disableStdin)return;const i=this._bufferService.buffer;t&&this._optionsService.rawOptions.scrollOnUserInput&&i.ybase!==i.ydisp&&this._onRequestScrollToBottom.fire(),t&&this._onUserInput.fire(),this._logService.debug(`sending data "${e}"`,(()=>e.split("").map((e=>e.charCodeAt(0))))),this._onData.fire(e)}triggerBinaryEvent(e){this._optionsService.rawOptions.disableStdin||(this._logService.debug(`sending binary "${e}"`,(()=>e.split("").map((e=>e.charCodeAt(0))))),this._onBinary.fire(e))}};d=n([s(0,r.IBufferService),s(1,r.ILogService),s(2,r.IOptionsService)],d),t.CoreService=d},9074:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DecorationService=void 0;const n=i(8055),s=i(8460),r=i(844),o=i(6106);let a=0,c=0;class l extends r.Disposable{constructor(){super(),this._decorations=new o.SortedList((e=>null==e?void 0:e.marker.line)),this._onDecorationRegistered=this.register(new s.EventEmitter),this.onDecorationRegistered=this._onDecorationRegistered.event,this._onDecorationRemoved=this.register(new s.EventEmitter),this.onDecorationRemoved=this._onDecorationRemoved.event,this.register((0,r.toDisposable)((()=>{for(const e of this._decorations.values())this._onDecorationRemoved.fire(e);this.reset()})))}get decorations(){return this._decorations.values()}registerDecoration(e){if(e.marker.isDisposed)return;const t=new h(e);if(t){const e=t.marker.onDispose((()=>t.dispose()));t.onDispose((()=>{t&&(this._decorations.delete(t)&&this._onDecorationRemoved.fire(t),e.dispose())})),this._decorations.insert(t),this._onDecorationRegistered.fire(t)}return t}reset(){for(const e of this._decorations.values())e.dispose();this._decorations.clear()}*getDecorationsAtCell(e,t,i){var n,s,r;let o=0,a=0;for(const c of this._decorations.getKeyIterator(t))o=null!==(n=c.options.x)&&void 0!==n?n:0,a=o+(null!==(s=c.options.width)&&void 0!==s?s:1),e>=o&&e<a&&(!i||(null!==(r=c.options.layer)&&void 0!==r?r:"bottom")===i)&&(yield c)}forEachDecorationAtCell(e,t,i,n){this._decorations.forEachByKey(t,(t=>{var s,r,o;a=null!==(s=t.options.x)&&void 0!==s?s:0,c=a+(null!==(r=t.options.width)&&void 0!==r?r:1),e>=a&&e<c&&(!i||(null!==(o=t.options.layer)&&void 0!==o?o:"bottom")===i)&&n(t)}))}dispose(){for(const e of this._decorations.values())this._onDecorationRemoved.fire(e);this.reset()}}t.DecorationService=l;class h extends r.Disposable{constructor(e){super(),this.options=e,this.onRenderEmitter=this.register(new s.EventEmitter),this.onRender=this.onRenderEmitter.event,this._onDispose=this.register(new s.EventEmitter),this.onDispose=this._onDispose.event,this._cachedBg=null,this._cachedFg=null,this.marker=e.marker,this.options.overviewRulerOptions&&!this.options.overviewRulerOptions.position&&(this.options.overviewRulerOptions.position="full")}get isDisposed(){return this._isDisposed}get backgroundColorRGB(){return null===this._cachedBg&&(this.options.backgroundColor?this._cachedBg=n.css.toColor(this.options.backgroundColor):this._cachedBg=void 0),this._cachedBg}get foregroundColorRGB(){return null===this._cachedFg&&(this.options.foregroundColor?this._cachedFg=n.css.toColor(this.options.foregroundColor):this._cachedFg=void 0),this._cachedFg}dispose(){this._onDispose.fire(),super.dispose()}}},4348:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.InstantiationService=t.ServiceCollection=void 0;const n=i(2585),s=i(8343);class r{constructor(...e){this._entries=new Map;for(const[t,i]of e)this.set(t,i)}set(e,t){const i=this._entries.get(e);return this._entries.set(e,t),i}forEach(e){for(const[t,i]of this._entries.entries())e(t,i)}has(e){return this._entries.has(e)}get(e){return this._entries.get(e)}}t.ServiceCollection=r,t.InstantiationService=class{constructor(){this._services=new r,this._services.set(n.IInstantiationService,this)}setService(e,t){this._services.set(e,t)}getService(e){return this._services.get(e)}createInstance(e,...t){const i=(0,s.getServiceDependencies)(e).sort(((e,t)=>e.index-t.index)),n=[];for(const t of i){const i=this._services.get(t.id);if(!i)throw new Error(`[createInstance] ${e.name} depends on UNKNOWN service ${t.id}.`);n.push(i)}const r=i.length>0?i[0].index:t.length;if(t.length!==r)throw new Error(`[createInstance] First service dependency of ${e.name} at position ${r+1} conflicts with ${t.length} static arguments`);return new e(...[...t,...n])}}},7866:function(e,t,i){var n=this&&this.__decorate||function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},s=this&&this.__param||function(e,t){return function(i,n){t(i,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.LogService=void 0;const r=i(844),o=i(2585),a={debug:o.LogLevelEnum.DEBUG,info:o.LogLevelEnum.INFO,warn:o.LogLevelEnum.WARN,error:o.LogLevelEnum.ERROR,off:o.LogLevelEnum.OFF};let c=class extends r.Disposable{constructor(e){super(),this._optionsService=e,this.logLevel=o.LogLevelEnum.OFF,this._updateLogLevel(),this.register(this._optionsService.onSpecificOptionChange("logLevel",(()=>this._updateLogLevel())))}_updateLogLevel(){this.logLevel=a[this._optionsService.rawOptions.logLevel]}_evalLazyOptionalParams(e){for(let t=0;t<e.length;t++)"function"==typeof e[t]&&(e[t]=e[t]())}_log(e,t,i){this._evalLazyOptionalParams(i),e.call(console,"xterm.js: "+t,...i)}debug(e,...t){this.logLevel<=o.LogLevelEnum.DEBUG&&this._log(console.log,e,t)}info(e,...t){this.logLevel<=o.LogLevelEnum.INFO&&this._log(console.info,e,t)}warn(e,...t){this.logLevel<=o.LogLevelEnum.WARN&&this._log(console.warn,e,t)}error(e,...t){this.logLevel<=o.LogLevelEnum.ERROR&&this._log(console.error,e,t)}};c=n([s(0,o.IOptionsService)],c),t.LogService=c},7302:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OptionsService=t.DEFAULT_OPTIONS=void 0;const n=i(8460),s=i(6114),r=i(844);t.DEFAULT_OPTIONS={cols:80,rows:24,cursorBlink:!1,cursorStyle:"block",cursorWidth:1,customGlyphs:!0,drawBoldTextInBrightColors:!0,fastScrollModifier:"alt",fastScrollSensitivity:5,fontFamily:"courier-new, courier, monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",lineHeight:1,letterSpacing:0,linkHandler:null,logLevel:"info",scrollback:1e3,scrollOnUserInput:!0,scrollSensitivity:1,screenReaderMode:!1,smoothScrollDuration:0,macOptionIsMeta:!1,macOptionClickForcesSelection:!1,minimumContrastRatio:1,disableStdin:!1,allowProposedApi:!1,allowTransparency:!1,tabStopWidth:8,theme:{},rightClickSelectsWord:s.isMac,windowOptions:{},windowsMode:!1,windowsPty:{},wordSeparator:" ()[]{}',\"`",altClickMovesCursor:!0,convertEol:!1,termName:"xterm",cancelEvents:!1,overviewRulerWidth:0};const o=["normal","bold","100","200","300","400","500","600","700","800","900"];class a extends r.Disposable{constructor(e){super(),this._onOptionChange=this.register(new n.EventEmitter),this.onOptionChange=this._onOptionChange.event;const i=Object.assign({},t.DEFAULT_OPTIONS);for(const t in e)if(t in i)try{const n=e[t];i[t]=this._sanitizeAndValidateOption(t,n)}catch(e){console.error(e)}this.rawOptions=i,this.options=Object.assign({},i),this._setupOptions()}onSpecificOptionChange(e,t){return this.onOptionChange((i=>{i===e&&t(this.rawOptions[e])}))}onMultipleOptionChange(e,t){return this.onOptionChange((i=>{-1!==e.indexOf(i)&&t()}))}_setupOptions(){const e=e=>{if(!(e in t.DEFAULT_OPTIONS))throw new Error(`No option with key "${e}"`);return this.rawOptions[e]},i=(e,i)=>{if(!(e in t.DEFAULT_OPTIONS))throw new Error(`No option with key "${e}"`);i=this._sanitizeAndValidateOption(e,i),this.rawOptions[e]!==i&&(this.rawOptions[e]=i,this._onOptionChange.fire(e))};for(const t in this.rawOptions){const n={get:e.bind(this,t),set:i.bind(this,t)};Object.defineProperty(this.options,t,n)}}_sanitizeAndValidateOption(e,i){switch(e){case"cursorStyle":if(i||(i=t.DEFAULT_OPTIONS[e]),!function(e){return"block"===e||"underline"===e||"bar"===e}(i))throw new Error(`"${i}" is not a valid value for ${e}`);break;case"wordSeparator":i||(i=t.DEFAULT_OPTIONS[e]);break;case"fontWeight":case"fontWeightBold":if("number"==typeof i&&1<=i&&i<=1e3)break;i=o.includes(i)?i:t.DEFAULT_OPTIONS[e];break;case"cursorWidth":i=Math.floor(i);case"lineHeight":case"tabStopWidth":if(i<1)throw new Error(`${e} cannot be less than 1, value: ${i}`);break;case"minimumContrastRatio":i=Math.max(1,Math.min(21,Math.round(10*i)/10));break;case"scrollback":if((i=Math.min(i,4294967295))<0)throw new Error(`${e} cannot be less than 0, value: ${i}`);break;case"fastScrollSensitivity":case"scrollSensitivity":if(i<=0)throw new Error(`${e} cannot be less than or equal to 0, value: ${i}`);break;case"rows":case"cols":if(!i&&0!==i)throw new Error(`${e} must be numeric, value: ${i}`);break;case"windowsPty":i=null!=i?i:{}}return i}}t.OptionsService=a},2660:function(e,t,i){var n=this&&this.__decorate||function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},s=this&&this.__param||function(e,t){return function(i,n){t(i,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.OscLinkService=void 0;const r=i(2585);let o=class{constructor(e){this._bufferService=e,this._nextId=1,this._entriesWithId=new Map,this._dataByLinkId=new Map}registerLink(e){const t=this._bufferService.buffer;if(void 0===e.id){const i=t.addMarker(t.ybase+t.y),n={data:e,id:this._nextId++,lines:[i]};return i.onDispose((()=>this._removeMarkerFromLink(n,i))),this._dataByLinkId.set(n.id,n),n.id}const i=e,n=this._getEntryIdKey(i),s=this._entriesWithId.get(n);if(s)return this.addLineToLink(s.id,t.ybase+t.y),s.id;const r=t.addMarker(t.ybase+t.y),o={id:this._nextId++,key:this._getEntryIdKey(i),data:i,lines:[r]};return r.onDispose((()=>this._removeMarkerFromLink(o,r))),this._entriesWithId.set(o.key,o),this._dataByLinkId.set(o.id,o),o.id}addLineToLink(e,t){const i=this._dataByLinkId.get(e);if(i&&i.lines.every((e=>e.line!==t))){const e=this._bufferService.buffer.addMarker(t);i.lines.push(e),e.onDispose((()=>this._removeMarkerFromLink(i,e)))}}getLinkData(e){var t;return null===(t=this._dataByLinkId.get(e))||void 0===t?void 0:t.data}_getEntryIdKey(e){return`${e.id};;${e.uri}`}_removeMarkerFromLink(e,t){const i=e.lines.indexOf(t);-1!==i&&(e.lines.splice(i,1),0===e.lines.length&&(void 0!==e.data.id&&this._entriesWithId.delete(e.key),this._dataByLinkId.delete(e.id)))}};o=n([s(0,r.IBufferService)],o),t.OscLinkService=o},8343:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createDecorator=t.getServiceDependencies=t.serviceRegistry=void 0,t.serviceRegistry=new Map,t.getServiceDependencies=function(e){return e.di$dependencies||[]},t.createDecorator=function(e){if(t.serviceRegistry.has(e))return t.serviceRegistry.get(e);const i=function(e,t,n){if(3!==arguments.length)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");!function(e,t,i){t.di$target===t?t.di$dependencies.push({id:e,index:i}):(t.di$dependencies=[{id:e,index:i}],t.di$target=t)}(i,e,n)};return i.toString=()=>e,t.serviceRegistry.set(e,i),i}},2585:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.IDecorationService=t.IUnicodeService=t.IOscLinkService=t.IOptionsService=t.ILogService=t.LogLevelEnum=t.IInstantiationService=t.ICharsetService=t.ICoreService=t.ICoreMouseService=t.IBufferService=void 0;const n=i(8343);var s;t.IBufferService=(0,n.createDecorator)("BufferService"),t.ICoreMouseService=(0,n.createDecorator)("CoreMouseService"),t.ICoreService=(0,n.createDecorator)("CoreService"),t.ICharsetService=(0,n.createDecorator)("CharsetService"),t.IInstantiationService=(0,n.createDecorator)("InstantiationService"),(s=t.LogLevelEnum||(t.LogLevelEnum={}))[s.DEBUG=0]="DEBUG",s[s.INFO=1]="INFO",s[s.WARN=2]="WARN",s[s.ERROR=3]="ERROR",s[s.OFF=4]="OFF",t.ILogService=(0,n.createDecorator)("LogService"),t.IOptionsService=(0,n.createDecorator)("OptionsService"),t.IOscLinkService=(0,n.createDecorator)("OscLinkService"),t.IUnicodeService=(0,n.createDecorator)("UnicodeService"),t.IDecorationService=(0,n.createDecorator)("DecorationService")},1480:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UnicodeService=void 0;const n=i(8460),s=i(225);t.UnicodeService=class{constructor(){this._providers=Object.create(null),this._active="",this._onChange=new n.EventEmitter,this.onChange=this._onChange.event;const e=new s.UnicodeV6;this.register(e),this._active=e.version,this._activeProvider=e}dispose(){this._onChange.dispose()}get versions(){return Object.keys(this._providers)}get activeVersion(){return this._active}set activeVersion(e){if(!this._providers[e])throw new Error(`unknown Unicode version "${e}"`);this._active=e,this._activeProvider=this._providers[e],this._onChange.fire(e)}register(e){this._providers[e.version]=e}wcwidth(e){return this._activeProvider.wcwidth(e)}getStringCellWidth(e){let t=0;const i=e.length;for(let n=0;n<i;++n){let s=e.charCodeAt(n);if(55296<=s&&s<=56319){if(++n>=i)return t+this.wcwidth(s);const r=e.charCodeAt(n);56320<=r&&r<=57343?s=1024*(s-55296)+r-56320+65536:t+=this.wcwidth(r)}t+=this.wcwidth(s)}return t}}}},t={};function i(n){var s=t[n];if(void 0!==s)return s.exports;var r=t[n]={exports:{}};return e[n].call(r.exports,r,r.exports,i),r.exports}var n={};return(()=>{var e=n;Object.defineProperty(e,"__esModule",{value:!0}),e.Terminal=void 0;const t=i(3236),s=i(9042),r=i(7975),o=i(7090),a=i(5741),c=i(8285),l=["cols","rows"];e.Terminal=class{constructor(e){this._core=new t.Terminal(e),this._addonManager=new a.AddonManager,this._publicOptions=Object.assign({},this._core.options);const i=e=>this._core.options[e],n=(e,t)=>{this._checkReadonlyOptions(e),this._core.options[e]=t};for(const e in this._core.options){const t={get:i.bind(this,e),set:n.bind(this,e)};Object.defineProperty(this._publicOptions,e,t)}}_checkReadonlyOptions(e){if(l.includes(e))throw new Error(`Option "${e}" can only be set in the constructor`)}_checkProposedApi(){if(!this._core.optionsService.rawOptions.allowProposedApi)throw new Error("You must set the allowProposedApi option to true to use proposed API")}get onBell(){return this._core.onBell}get onBinary(){return this._core.onBinary}get onCursorMove(){return this._core.onCursorMove}get onData(){return this._core.onData}get onKey(){return this._core.onKey}get onLineFeed(){return this._core.onLineFeed}get onRender(){return this._core.onRender}get onResize(){return this._core.onResize}get onScroll(){return this._core.onScroll}get onSelectionChange(){return this._core.onSelectionChange}get onTitleChange(){return this._core.onTitleChange}get onWriteParsed(){return this._core.onWriteParsed}get element(){return this._core.element}get parser(){return this._parser||(this._parser=new r.ParserApi(this._core)),this._parser}get unicode(){return this._checkProposedApi(),new o.UnicodeApi(this._core)}get textarea(){return this._core.textarea}get rows(){return this._core.rows}get cols(){return this._core.cols}get buffer(){return this._buffer||(this._buffer=new c.BufferNamespaceApi(this._core)),this._buffer}get markers(){return this._checkProposedApi(),this._core.markers}get modes(){const e=this._core.coreService.decPrivateModes;let t="none";switch(this._core.coreMouseService.activeProtocol){case"X10":t="x10";break;case"VT200":t="vt200";break;case"DRAG":t="drag";break;case"ANY":t="any"}return{applicationCursorKeysMode:e.applicationCursorKeys,applicationKeypadMode:e.applicationKeypad,bracketedPasteMode:e.bracketedPasteMode,insertMode:this._core.coreService.modes.insertMode,mouseTrackingMode:t,originMode:e.origin,reverseWraparoundMode:e.reverseWraparound,sendFocusMode:e.sendFocus,wraparoundMode:e.wraparound}}get options(){return this._publicOptions}set options(e){for(const t in e)this._publicOptions[t]=e[t]}blur(){this._core.blur()}focus(){this._core.focus()}resize(e,t){this._verifyIntegers(e,t),this._core.resize(e,t)}open(e){this._core.open(e)}attachCustomKeyEventHandler(e){this._core.attachCustomKeyEventHandler(e)}registerLinkProvider(e){return this._core.registerLinkProvider(e)}registerCharacterJoiner(e){return this._checkProposedApi(),this._core.registerCharacterJoiner(e)}deregisterCharacterJoiner(e){this._checkProposedApi(),this._core.deregisterCharacterJoiner(e)}registerMarker(e=0){return this._verifyIntegers(e),this._core.addMarker(e)}registerDecoration(e){var t,i,n;return this._checkProposedApi(),this._verifyPositiveIntegers(null!==(t=e.x)&&void 0!==t?t:0,null!==(i=e.width)&&void 0!==i?i:0,null!==(n=e.height)&&void 0!==n?n:0),this._core.registerDecoration(e)}hasSelection(){return this._core.hasSelection()}select(e,t,i){this._verifyIntegers(e,t,i),this._core.select(e,t,i)}getSelection(){return this._core.getSelection()}getSelectionPosition(){return this._core.getSelectionPosition()}clearSelection(){this._core.clearSelection()}selectAll(){this._core.selectAll()}selectLines(e,t){this._verifyIntegers(e,t),this._core.selectLines(e,t)}dispose(){this._addonManager.dispose(),this._core.dispose()}scrollLines(e){this._verifyIntegers(e),this._core.scrollLines(e)}scrollPages(e){this._verifyIntegers(e),this._core.scrollPages(e)}scrollToTop(){this._core.scrollToTop()}scrollToBottom(){this._core.scrollToBottom()}scrollToLine(e){this._verifyIntegers(e),this._core.scrollToLine(e)}clear(){this._core.clear()}write(e,t){this._core.write(e,t)}writeln(e,t){this._core.write(e),this._core.write("\r\n",t)}paste(e){this._core.paste(e)}refresh(e,t){this._verifyIntegers(e,t),this._core.refresh(e,t)}reset(){this._core.reset()}clearTextureAtlas(){this._core.clearTextureAtlas()}loadAddon(e){return this._addonManager.loadAddon(this,e)}static get strings(){return s}_verifyIntegers(...e){for(const t of e)if(t===1/0||isNaN(t)||t%1!=0)throw new Error("This API only accepts integers")}_verifyPositiveIntegers(...e){for(const t of e)if(t&&(t===1/0||isNaN(t)||t%1!=0||t<0))throw new Error("This API only accepts positive integers")}}})(),n})(),e.exports=t()},13685:(e,t,i)=>{"use strict";i.r(t),i.d(t,{SimpleTerminalBackend:()=>po,SimpleTerminalProcess:()=>fo,default:()=>vo}),i(29769);var n=i(97108),s=i(3460),r=i(56069),o=i(65396),a=i(80855),c=i(65321),l=i(15393),h=i(49898),d=i(4669),u=i(5976),m=i(66663),_=i(1432),g=i(70666),p=i(63580),f=i(94565),v=i(33108),b=i(93983),S=(i(49953),i(72065)),w=i(59422);function C(e,t={}){let i="";return t.excludeLeadingNewLine||(i+="\r\n"),i+="[0m[7m * ",t.loudFormatting?i+="[0;104m":i+="[0m",i+=` ${e} [0m\n\r`,i}var y=i(73910),x=i(59554),k=i(92321),I=i(97781),D=i(25670),T=i(40382),E=i(88813),A=i(8321),L=i(10161),P=i(74741),R=i(73046),M=i(22258),B=i(98401),N=i(11640),O=i(31106),H=i(84144),F=i(44349),W=i(32414),V=i(50988),$=i(41157),U=i(3701),G=i(54713),z=i(55061),K=i(75392);const q=(0,x.q5)("terminal-view-icon",R.lA.terminal,(0,p.NC)("terminalViewIcon","View icon of the terminal view.")),j=(0,x.q5)("terminal-rename",R.lA.gear,(0,p.NC)("renameTerminalIcon","Icon for rename in the terminal quick menu.")),Q=(0,x.q5)("terminal-kill",R.lA.trash,(0,p.NC)("killTerminalIcon","Icon for killing a terminal instance.")),X=(0,x.q5)("terminal-new",R.lA.add,(0,p.NC)("newTerminalIcon","Icon for creating a new terminal instance.")),J=(0,x.q5)("terminal-configure-profile",R.lA.gear,(0,p.NC)("configureTerminalProfileIcon","Icon for creating a new terminal profile.")),Y=(0,x.q5)("terminal-decoration-mark",R.lA.circleSmallFilled,(0,p.NC)("terminalDecorationMark","Icon for a terminal decoration mark.")),Z=(0,x.q5)("terminal-decoration-incomplete",R.lA.circle,(0,p.NC)("terminalDecorationIncomplete","Icon for a terminal decoration of a command that was incomplete.")),ee=(0,x.q5)("terminal-decoration-error",R.lA.errorSmall,(0,p.NC)("terminalDecorationError","Icon for a terminal decoration of a command that errored.")),te=(0,x.q5)("terminal-decoration-success",R.lA.circleFilled,(0,p.NC)("terminalDecorationSuccess","Icon for a terminal decoration of a command that was successful.")),ie=(0,x.q5)("terminal-command-history-remove",R.lA.close,(0,p.NC)("terminalCommandHistoryRemove","Icon for removing a terminal command from command history.")),ne=(0,x.q5)("terminal-command-history-output",R.lA.output,(0,p.NC)("terminalCommandHistoryOutput","Icon for viewing output of a terminal command.")),se=(0,x.q5)("terminal-command-history-fuzzy-search",R.lA.searchFuzzy,(0,p.NC)("terminalCommandHistoryFuzzySearch","Icon for toggling fuzzy search of command history."));var re=i(20013);const oe={terminal:(0,p.NC)("terminal","Terminal"),new:(0,p.NC)("terminal.new","New Terminal"),doNotShowAgain:(0,p.NC)("doNotShowAgain","Do Not Show Again"),currentSessionCategory:(0,p.NC)("currentSessionCategory","current session"),previousSessionCategory:(0,p.NC)("previousSessionCategory","previous session"),actionCategory:{value:(0,p.NC)("terminalCategory","Terminal"),original:"Terminal"},focus:{value:(0,p.NC)("workbench.action.terminal.focus","Focus Terminal"),original:"Focus Terminal"},kill:{value:(0,p.NC)("killTerminal","Kill Terminal"),original:"Kill Terminal",short:(0,p.NC)("killTerminal.short","Kill")},moveToEditor:{value:(0,p.NC)("moveToEditor","Move Terminal into Editor Area"),original:"Move Terminal into Editor Area"},moveToTerminalPanel:{value:(0,p.NC)("workbench.action.terminal.moveToTerminalPanel","Move Terminal into Panel"),original:"Move Terminal into Panel"},changeIcon:{value:(0,p.NC)("workbench.action.terminal.changeIcon","Change Icon..."),original:"Change Icon..."},changeColor:{value:(0,p.NC)("workbench.action.terminal.changeColor","Change Color..."),original:"Change Color..."},split:{value:(0,p.NC)("splitTerminal","Split Terminal"),original:"Split Terminal",short:(0,p.NC)("splitTerminal.short","Split")},unsplit:{value:(0,p.NC)("unsplitTerminal","Unsplit Terminal"),original:"Unsplit Terminal"},rename:{value:(0,p.NC)("workbench.action.terminal.rename","Rename..."),original:"Rename..."},toggleSizeToContentWidth:{value:(0,p.NC)("workbench.action.terminal.sizeToContentWidthInstance","Toggle Size to Content Width"),original:"Toggle Size to Content Width"},focusHover:{value:(0,p.NC)("workbench.action.terminal.focusHover","Focus Hover"),original:"Focus Hover"},sendSequence:{value:(0,p.NC)("workbench.action.terminal.sendSequence","Send Custom Sequence To Terminal"),original:"Send Custom Sequence To Terminal"},newWithCwd:{value:(0,p.NC)("workbench.action.terminal.newWithCwd","Create New Terminal Starting in a Custom Working Directory"),original:"Create New Terminal Starting in a Custom Working Directory"},renameWithArgs:{value:(0,p.NC)("workbench.action.terminal.renameWithArg","Rename the Currently Active Terminal"),original:"Rename the Currently Active Terminal"}};var ae=i(24448);let ce=[],le=class e extends z.${static{this.PREFIX="term "}constructor(t,i,n,s,r,o,a){super(e.PREFIX,{canAcceptInBackground:!0}),this._editorService=t,this._terminalService=i,this._terminalEditorService=n,this._terminalGroupService=s,this._commandService=r,this._themeService=o,this._instantiationService=a}_getPicks(e){ce=[],ce.push({type:"separator",label:"panel"});const t=this._terminalGroupService.groups;for(let i=0;i<t.length;i++){const n=t[i];for(let t=0;t<n.terminalInstances.length;t++){const s=n.terminalInstances[t],r=this._createPick(s,t,e,{groupIndex:i,groupSize:n.terminalInstances.length});r&&ce.push(r)}}ce.length>0&&ce.push({type:"separator",label:"editor"});const i=this._terminalEditorService.instances;for(let t=0;t<i.length;t++){const n=i[t];n.target=s.i2.Editor;const r=this._createPick(n,t,e);r&&ce.push(r)}ce.length>0&&ce.push({type:"separator"});const n=(0,p.NC)("workbench.action.terminal.newplus","Create New Terminal");ce.push({label:`$(plus) ${n}`,ariaLabel:n,accept:()=>this._commandService.executeCommand("workbench.action.terminal.new")});const r=(0,p.NC)("workbench.action.terminal.newWithProfilePlus","Create New Terminal With Profile");return ce.push({label:`$(plus) ${r}`,ariaLabel:r,accept:()=>this._commandService.executeCommand("workbench.action.terminal.newWithProfile")}),ce}_createPick(e,t,i,n){const r=`$(${this._instantiationService.invokeFunction(re.yX,e)}) ${n?n.groupSize>1?`${n.groupIndex+1}.${t+1}`:`${n.groupIndex+1}`:`${t+1}`}: ${e.title}`,o=[],a=(0,re.pv)(e);a&&o.push(a);const c=(0,re.A5)(e,this._themeService.getColorTheme().type);c&&o.push(...c);const l=(0,K.Oh)(i,r,!0);if(l)return{label:r,description:e.description,highlights:{label:l},buttons:[{iconClass:D.kS.asClassName(j),tooltip:(0,p.NC)("renameTerminal","Rename Terminal")},{iconClass:D.kS.asClassName(Q),tooltip:oe.kill.value}],iconClasses:o,trigger:t=>{switch(t){case 0:return this._commandService.executeCommand("workbench.action.terminal.rename",e),z.L.NO_ACTION;case 1:return this._terminalService.safeDisposeTerminal(e),z.L.REMOVE_ITEM}return z.L.NO_ACTION},accept:(t,i)=>{if(e.target===s.i2.Editor){const t=this._editorService.findEditors(e.resource);this._terminalEditorService.openEditor(e,{viewColumn:t?.[0].groupId}),this._terminalEditorService.setActiveInstance(e)}else this._terminalGroupService.showPanel(!i.inBackground),this._terminalGroupService.setActiveInstance(e)}}}};le=(0,a.g)([(0,a.f)(0,ae.AR),(0,a.f)(1,o.BZ),(0,a.f)(2,o.BZ),(0,a.f)(3,o.Qy),(0,a.f)(4,f.H),(0,a.f)(5,I.XE),(0,a.f)(6,S.TG)],le);var he=i(76721);function de(e,t){const i=[{name:null,description:(0,p.NC)("terminalAutomaticProfile","Automatically detect the default")}];return i.push(...e.map((e=>({name:e.profileName,description:ue(e)})))),t&&i.push(...t.map((e=>{return{name:e.title,description:(t=e,`$(${D.kS.isThemeIcon(t.icon)?t.icon.id:t.icon?t.icon:R.lA.terminal.id}) ${t.title}\n- extensionIdentifier: ${t.extensionIdentifier}`)};var t}))),{values:i.map((e=>e.name)),markdownDescriptions:i.map((e=>e.description))}}function ue(e){let t=`$(${D.kS.isThemeIcon(e.icon)?e.icon.id:e.icon?e.icon:R.lA.terminal.id}) ${e.profileName}\n- path: ${e.path}`;return e.args&&("string"==typeof e.args?t+=`\n- args: "${e.args}"`:t+=`\n- args: [${0===e.args.length?"":`'${e.args.join("','")}'`}]`),void 0!==e.overrideName&&(t+=`\n- overrideName: ${e.overrideName}`),e.color&&(t+=`\n- color: ${e.color}`),e.env&&(t+=`\n- env: ${JSON.stringify(e.env)}`),t}function me(e,t){if(!e&&!t)return!0;if("string"==typeof e&&"string"==typeof t)return e===t;if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0}return!1}function _e(e){return!!e&&"string"==typeof e.path&&"string"==typeof e.scheme}var ge=i(44474),pe=i(78787),fe=i(43202),ve=i(46973),be=i(43459),Se=i(82663),we=i(40093),Ce=i(76648),ye=i(43702),xe=i(75761),ke=i(26904);let Ie,De;function Te(e){return Ie||(Ie=e.get(S.TG).createInstance(Pe,"commands")),Ie}function Ee(e){return De||(De=e.get(S.TG).createInstance(Pe,"dirs")),De}const Ae=new Map;async function Le(e,t){const i=Ae.get(t);if(null===i)return[];if(void 0!==i)return i;let n;switch(t){case"bash":n=await async function(e){const t=e.get(xe.sn),i=e.get(be.R),n=await i.getEnvironment();if(1===n?.os||!n&&_.ED)return;const s=await Re(Ce.OB.HOME,".bash_history",!1,t,i);if(void 0===s)return;const r=s.split("\n"),o=new Set;let a,c,l;for(let e=0;e<r.length;e++){a=r[e],void 0===c?c=a:c+=`\n${a}`;for(let e=0;e<a.length;e++)l?a[e]===l&&(l=void 0):a[e].match(/['"]/)&&(l=a[e]);void 0===l&&(c.length>0&&o.add(c.trim()),c=void 0)}return o.values()}(e);break;case"pwsh":n=await async function(e){const t=e.get(xe.sn),i=e.get(be.R);let n,s;const r=await i.getEnvironment(),o=1===r?.os||!r&&_.ED;o?(n=Ce.OB.APPDATA,s="\\Microsoft\\Windows\\PowerShell\\PSReadLine\\ConsoleHost_history.txt"):(n=Ce.OB.HOME,s=".local/share/powershell/PSReadline/ConsoleHost_history.txt");const a=await Re(n,s,o,t,i);if(void 0===a)return;const c=a.split("\n"),l=new Set;let h,d,u;for(let e=0;e<c.length;e++)if(h=c[e],void 0===d?d=h:d+=`\n${h}`,h.endsWith("`")){for(let e=0;e<h.length;e++)u?h[e]===u&&(u=void 0):h[e].match(/`/)&&(u=h[e]);if(u)d=d.replace(/`$/,""),u=void 0;else{const e=d.trim();e.length>0&&l.add(e),d=void 0}}else{const e=d.trim();e.length>0&&l.add(e),d=void 0}return l.values()}(e);break;case"zsh":n=await async function(e){const t=e.get(xe.sn),i=e.get(be.R),n=await i.getEnvironment();if(1===n?.os||!n&&_.ED)return;const s=await Re(Ce.OB.HOME,".zsh_history",!1,t,i);if(void 0===s)return;const r=s.split(/\:\s\d+\:\d+;/),o=new Set;for(let e=0;e<r.length;e++){const t=r[e].replace(/\\\n/g,"\n").trim();t.length>0&&o.add(t)}return o.values()}(e);break;case"fish":n=await async function(e){const t=e.get(xe.sn),i=e.get(be.R),n=await i.getEnvironment();if(1===n?.os||!n&&_.ED)return;const s=Ce.OB.XDG_DATA_HOME,r=await(s?Re(Ce.OB.XDG_DATA_HOME,"fish/fish_history",!1,t,i):Re(Ce.OB.HOME,".local/share/fish/fish_history",!1,t,i));if(void 0===r)return;const o=new Set,a=r.split("\n").filter((e=>e.startsWith("- cmd:"))).map((e=>e.substring(6).trimStart()));for(let e=0;e<a.length;e++){const t=(c=a[e],function(e,t,i){let n,s=t;for(;;)if(n=s,s=s.replace(e,"$1$2\n"),s===n)return s}(/(^|[^\\])((?:\\\\)*)(\\n)/g,c)).trim();t.length>0&&o.add(t)}var c;return o.values()}(e);break;default:return[]}if(void 0===n)return Ae.set(t,null),[];const s=Array.from(n);return Ae.set(t,s),s}let Pe=class extends u.JT{get entries(){return this._ensureUpToDate(),this._entries.entries()}constructor(e,t,i){super(),this._storageDataKey=e,this._configurationService=t,this._storageService=i,this._timestamp=0,this._isReady=!1,this._isStale=!0,this._entries=new ye.z6(this._getHistoryLimit()),this._configurationService.onDidChangeConfiguration((e=>{e.affectsConfiguration("terminal.integrated.shellIntegration.history")&&(this._entries.limit=this._getHistoryLimit())})),this._storageService.onDidChangeValue((e=>{e.key!==this._getTimestampStorageKey()||this._isStale||(this._isStale=this._storageService.getNumber(this._getTimestampStorageKey(),-1,0)!==this._timestamp)}))}add(e,t){this._ensureUpToDate(),this._entries.set(e,t),this._saveState()}remove(e){this._ensureUpToDate(),this._entries.delete(e),this._saveState()}clear(){this._ensureUpToDate(),this._entries.clear(),this._saveState()}_ensureUpToDate(){this._isReady||(this._loadState(),this._isReady=!0),this._isStale&&(this._entries.clear(),this._loadState(),this._isStale=!1)}_loadState(){this._timestamp=this._storageService.getNumber(this._getTimestampStorageKey(),-1,0);const e=this._loadPersistedState();if(e)for(const t of e.entries)this._entries.set(t.key,t.value)}_loadPersistedState(){const e=this._storageService.get(this._getEntriesStorageKey(),-1);if(void 0===e||0===e.length)return;let t;try{t=JSON.parse(e)}catch{return}return t}_saveState(){const e={entries:[]};this._entries.forEach(((t,i)=>e.entries.push({key:i,value:t}))),this._storageService.store(this._getEntriesStorageKey(),JSON.stringify(e),-1,1),this._timestamp=Date.now(),this._storageService.store(this._getTimestampStorageKey(),this._timestamp,-1,1)}_getHistoryLimit(){const e=this._configurationService.getValue("terminal.integrated.shellIntegration.history");return"number"==typeof e?e:100}_getTimestampStorageKey(){return`terminal.history.timestamp.${this._storageDataKey}`}_getEntriesStorageKey(){return`terminal.history.entries.${this._storageDataKey}`}};async function Re(e,t,i,n,s){if(!e)return;const r=!!s.getConnection()?.remoteAuthority,o=g.ov.from({scheme:r?m.lg.vscodeRemote:m.lg.file,path:(i?Se.Ku.join:Se.KR.join)(e,t)});let a;try{a=await n.readFile(o)}catch(e){if(e instanceof xe.Ym&&1===e.fileOperationResult)return;throw e}return void 0!==a?a.value.toString():void 0}Pe=(0,a.g)([(0,a.f)(1,v.Ui),(0,a.f)(2,ke.Uy)],Pe);var Me=i(73733),Be=i(72042),Ne=i(71050),Oe=i(95935),He=i(22016),Fe=i(84972),We=i(86456),Ve=i(53725);const $e="─────────",Ue=(0,p.NC)("showTerminalTabs","Show Tabs"),Ge=oe.actionCategory;async function ze(e,t,i,n){switch(e.config.splitCwd){case"workspaceRoot":if(void 0!==i&&void 0!==n){if(1===i.length)return i[0].uri;if(i.length>1){const e={placeHolder:(0,p.NC)("workbench.action.terminal.newWorkspacePlaceholder","Select current working directory for new terminal")},t=await n.executeCommand(U.RS,[e]);if(!t)return;return Promise.resolve(t.uri)}}return"";case"initial":return t.getInitialCwd();case"inherited":return t.getCwd()}}const Ke=async(e,t)=>{const i=e.get(o.x4).activeInstance;if(i){const n=(0,B.Kn)(t)&&"text"in t?ot(t.text):void 0;if(!n)return;const s=e.get(ge.qb),r=e.get(T.ec),o=e.get(fe.CE).getLastActiveWorkspaceRoot(i.isRemote?m.lg.vscodeRemote:m.lg.file),a=o?(0,B.f6)(r.getWorkspaceFolder(o)):void 0,c=await s.resolveAsync(a,n);i.sendText(c,!1)}};let qe,je=class extends P.aU{constructor(e){super("workbench.action.terminal.launchHelp",(0,p.NC)("terminalLaunchHelp","Open Help")),this._openerService=e}async run(){this._openerService.open("https://aka.ms/vscode-troubleshoot-terminal-launch")}};function Qe(e){e.f1=e.f1??!0,e.category=e.category??Ge,e.precondition=e.precondition??he.r.processSupported;const t=e.run,i=e;return delete i.run,(0,H.r1)(class extends H.Ke{constructor(){super(i)}run(e,i){return t(Ye(e),e,i)}})}function Xe(e){const t=e.run;return Qe({...e,run:(e,i,n)=>{const s=e.service.activeInstance;if(s)return t(s,e,i,n)}})}function Je(e){const t=e.run;return Qe({...e,run:(e,i,n)=>{const s=Ve.$.find(e.service.detachedXterms,(e=>e.isFocused));if(s)return t(s,i,void 0,n);const r=e.service.activeInstance;return r?.xterm?t(r.xterm,i,r,n):void 0}})}function Ye(e){return{service:e.get(o.x4),groupService:e.get(o.Qy),instanceService:e.get(o.N4),editorService:e.get(o.BZ),profileService:e.get(r.l5),profileResolverService:e.get(r.if)}}function Ze(e){const t=e.get(W.Lw),i=e.get(o.x4);if(!t.lastFocusedList?.getSelection())return;const n=t.lastFocusedList.getSelection(),s=t.lastFocusedList.getFocus(),r=[];if(1===s.length&&!n.includes(s[0]))return r.push(i.getInstanceFromIndex(s[0])),r;for(const e of n)r.push(i.getInstanceFromIndex(e));return r}function et(e){return(0,B.Kn)(e)&&"profileName"in e?{config:e,location:e.location}:e}function tt(e){const t=de(e);qe?.dispose(),qe=(0,H.r1)(class extends H.Ke{constructor(){super({id:"workbench.action.terminal.newWithProfile",title:{value:(0,p.NC)("workbench.action.terminal.newWithProfile","Create New Terminal (With Profile)"),original:"Create New Terminal (With Profile)"},f1:!0,category:Ge,precondition:b.Ao.or(he.r.processSupported,he.r.webExtensionContributedProfile),description:{description:"workbench.action.terminal.newWithProfile",args:[{name:"args",schema:{type:"object",required:["profileName"],properties:{profileName:{description:(0,p.NC)("workbench.action.terminal.newWithProfile.profileName","The name of the profile to create"),type:"string",enum:t.values,markdownEnumDescriptions:t.markdownDescriptions}}}}]}})}async run(e,t,i){const n=Ye(e),s=e.get(T.ec),r=e.get(f.H);let o,a,c,l;if((0,B.Kn)(t)&&t&&"profileName"in t){const e=n.profileService.availableProfiles.find((e=>e.profileName===t.profileName));if(!e)throw new Error(`Could not find terminal profile "${t.profileName}"`);a={config:e}}else t instanceof MouseEvent||t instanceof PointerEvent||t instanceof KeyboardEvent?(o=t,a=i?{config:i}:void 0):a=et(t);if(o&&(o.altKey||o.ctrlKey)){const e=n.service.activeInstance;if(e)return void await n.service.createTerminal({location:{parentTerminal:e},config:a?.config})}if(s.getWorkspace().folders.length>1){const e={placeHolder:(0,p.NC)("workbench.action.terminal.newWorkspacePlaceholder","Select current working directory for new terminal")},t=await r.executeCommand(U.RS,[e]);if(!t)return;l=t.uri}a?(a.cwd=l,c=await n.service.createTerminal(a)):c=await n.service.showProfileQuickPick("createInstance",l),c&&(n.service.setActiveInstance(c),await nt(c,n))}})}function it(e,t){return e.service.getInstanceFromResource(rt(t))||e.service.activeInstance}async function nt(e,t){e.target===s.i2.Editor?(await t.editorService.revealActiveEditor(),await e.focusWhenReady(!0)):await t.groupService.showPanel(!0)}async function st(e,t,i){const n=it(e,i);if(n){const e=await t.get($.eJ).input({value:n.title,prompt:(0,p.NC)("workbench.action.terminal.rename.prompt","Enter terminal name")});n.rename(e)}}function rt(e){return g.ov.isUri(e)?e:void 0}function ot(e){return(0,B.HD)(e)?e:void 0}je=(0,a.g)([(0,a.f)(0,V.v4)],je);var at=i(64141),ct=i(14603),lt=i(15965),ht=i(3277);(0,ht.Z)('.monaco-action-bar .action-item .action-label.extension-action{line-height:normal;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.monaco-action-bar .action-dropdown-item>.action-label.extension-action.label,.monaco-action-bar .action-item>.action-label.extension-action.label{padding:0 5px}.monaco-action-bar .action-dropdown-item>.monaco-dropdown .action-label{padding:0}.monaco-action-bar .action-item .action-label.extension-action.label{outline-offset:1px}.monaco-action-bar .action-dropdown-item .action-label.extension-action.label,.monaco-action-bar .action-item .action-label.extension-action.label,.monaco-action-bar .action-item .action-label.extension-action.text{height:auto;line-height:14px;width:auto}.monaco-action-bar .action-item .action-label.extension-action.built-in-status{border-color:var(--vscode-foreground)}.monaco-action-bar .action-item .action-label.extension-action.label,.monaco-action-bar .action-item.action-dropdown-item>.action-dropdown-item-separator{background-color:var(--vscode-extensionButton-background)!important}.monaco-action-bar .action-item .action-label.extension-action.label{color:var(--vscode-extensionButton-foreground)!important}.monaco-action-bar .action-item .action-label.extension-action.label:hover{background-color:var(--vscode-extensionButton-hoverBackground)!important}.monaco-action-bar .action-item.action-dropdown-item>.action-dropdown-item-separator>div{background-color:var(--vscode-extensionButton-separator)}.monaco-action-bar .action-item .action-label.extension-action.label.prominent,.monaco-action-bar .action-item.action-dropdown-item>.action-dropdown-item-separator.prominent{background-color:var(--vscode-extensionButton-prominentBackground)}.monaco-action-bar .action-item .action-label.extension-action.label.prominent{color:var(--vscode-extensionButton-prominentForeground)!important}.monaco-action-bar .action-item .action-label.extension-action.label.prominent:hover{background-color:var(--vscode-extensionButton-prominentHoverBackground)}.monaco-action-bar .action-item .action-label.extension-action:not(.disabled){border:1px solid var(--vscode-contrastBorder)}.monaco-action-bar .action-item.action-dropdown-item>.action-dropdown-item-separator{border-bottom:1px solid var(--vscode-contrastBorder);border-top:1px solid var(--vscode-contrastBorder)}.monaco-action-bar .action-item .action-label.extension-action.extension-status-error{color:var(--vscode-editorError-foreground)}.monaco-action-bar .action-item .action-label.extension-action.extension-status-warning{color:var(--vscode-editorWarning-foreground)}.monaco-action-bar .action-item .action-label.extension-action.extension-status-info{color:var(--vscode-editorInfo-foreground)}.monaco-action-bar .action-dropdown-item .action-label.extension-action.label,.monaco-action-bar .action-item .action-label.extension-action.icon,.monaco-action-bar .action-item:not(.disabled) .action-label.extension-action.label,.monaco-action-bar .action-item:not(.disabled) .action-label.extension-action.text{margin-top:2px}.monaco-action-bar .action-item .action-label.extension-action.manage.hide,.monaco-action-bar .action-item.action-dropdown-item .action-label.extension-action.hide,.monaco-action-bar .action-item.action-dropdown-item.disabled,.monaco-action-bar .action-item.disabled .action-label.disable-status.hide,.monaco-action-bar .action-item.disabled .action-label.extension-action.extension-sync,.monaco-action-bar .action-item.disabled .action-label.extension-action.hide,.monaco-action-bar .action-item.disabled .action-label.extension-action.hide-when-disabled,.monaco-action-bar .action-item.disabled .action-label.extension-action.ignore,.monaco-action-bar .action-item.disabled .action-label.extension-action.install:not(.installing),.monaco-action-bar .action-item.disabled .action-label.extension-action.language,.monaco-action-bar .action-item.disabled .action-label.extension-action.migrate,.monaco-action-bar .action-item.disabled .action-label.extension-action.reload,.monaco-action-bar .action-item.disabled .action-label.extension-action.theme,.monaco-action-bar .action-item.disabled .action-label.extension-action.undo-ignore,.monaco-action-bar .action-item.disabled .action-label.extension-action.uninstall:not(.uninstalling),.monaco-action-bar .action-item.disabled .action-label.extension-action.update,.monaco-action-bar .action-item.disabled .action-label.extension-status-label.hide,.monaco-action-bar .action-item.disabled .action-label.extension-status.hide{display:none}.monaco-action-bar .extension-action.label{display:inherit}.monaco-action-bar .action-item.disabled .action-label.extension-status:before{opacity:1}.monaco-action-bar .action-item.disabled .action-label.extension-status-label:before{content:"\\2713";padding-right:4px}.monaco-action-bar .action-item.disabled .action-label.extension-action{opacity:1}.monaco-action-bar .action-item.disabled .action-label.extension-action.text{font-style:italic;opacity:.9}',{});var dt=i(61683),ut=i(5606),mt=i(90290);const _t=["{","\t// See https://go.microsoft.com/fwlink/?LinkId=827846 to learn about workspace recommendations.","\t// Extension identifier format: ${publisher}.${name}. Example: vscode.csharp","","\t// List of extensions which should be recommended for users of this workspace.",'\t"recommendations": [',"\t\t","\t],","\t// List of extensions recommended by VS Code that should not be recommended for users of this workspace.",'\t"unwantedRecommendations": [',"\t\t","\t]","}"].join("\n");var gt=i(53084);const pt=(0,S.yh)("extensionRecommendationsService"),ft=(0,S.yh)("IExtensionIgnoredRecommendationsService");var vt=i(2687),bt=i(90553),St=i(12021),wt=i(78244),Ct=i(88216),yt=i(56346),xt=i(50868),kt=i(5826),It=i(51902),Dt=i(76033);const Tt=".vscode/extensions.json";var Et=i(17301),At=i(43557),Lt=i(52433),Pt=i(57481),Rt=i(29122),Mt=i(59365),Bt=i(7481),Nt=i(3356),Ot=i(45258),Ht=i(41443),Ft=i(10829),Wt=i(76446);let Vt=class extends P.aU{constructor(e,t,i,n,s,r,o,a,c,l,h,d,u,m){super("extension.promptExtensionInstallFailure"),this.extension=e,this.version=t,this.installOperation=i,this.error=n,this.productService=s,this.openerService=r,this.notificationService=o,this.dialogService=a,this.commandService=c,this.logService=l,this.extensionManagementServerService=h,this.instantiationService=d,this.galleryService=u,this.extensionManifestPropertiesService=m}async run(){if((0,Et.n2)(this.error))return;if(this.logService.error(this.error),this.error.name===lt.m3.Unsupported){const e=_.$L?(0,p.NC)("VS Code for Web","{0} for the Web",this.productService.nameLong):this.productService.nameLong,t=(0,p.NC)("cannot be installed","The '{0}' extension is not available in {1}. Click 'More Information' to learn more.",this.extension.displayName||this.extension.identifier.id,e),{confirmed:i}=await this.dialogService.confirm({type:w.zb.Info,message:t,primaryButton:(0,p.NC)({key:"more information",comment:["&& denotes a mnemonic"]},"&&More Information"),cancelButton:(0,p.NC)("close","Close")});return void(i&&this.openerService.open(_.$L?g.ov.parse("https://aka.ms/vscode-web-extensions-guide"):g.ov.parse("https://aka.ms/vscode-remote")))}if([lt.m3.Incompatible,lt.m3.IncompatibleTargetPlatform,lt.m3.Malicious,lt.m3.ReleaseVersionNotFound,lt.m3.Deprecated].includes(this.error.name))return void await this.dialogService.info((0,Et.e$)(this.error));if(lt.m3.Signature===this.error.name)return void await this.dialogService.prompt({type:"error",message:(0,p.NC)("signature verification failed","{0} cannot verify the '{1}' extension. Are you sure you want to install it?",this.productService.nameLong,this.extension.displayName||this.extension.identifier.id),buttons:[{label:(0,p.NC)("install anyway","Install Anyway"),run:()=>{const e=this.instantiationService.createInstance(Ut,{donotVerifySignature:!0});return e.extension=this.extension,e.run()}}],cancelButton:(0,p.NC)("cancel","Cancel")});const e=3===this.installOperation?(0,p.NC)("update operation","Error while updating '{0}' extension.",this.extension.displayName||this.extension.identifier.id):(0,p.NC)("install operation","Error while installing '{0}' extension.",this.extension.displayName||this.extension.identifier.id);let t;const i=[],n=await this.getDownloadUrl();n&&(t=(0,p.NC)("check logs","Please check the [log]({0}) for more details.",`command:${Ht.X}`),i.push({label:(0,p.NC)("download","Try Downloading Manually..."),run:()=>this.openerService.open(n).then((()=>{this.notificationService.prompt(w.zb.Info,(0,p.NC)("install vsix","Once downloaded, please manually install the downloaded VSIX of '{0}'.",this.extension.identifier.id),[{label:(0,p.NC)("installVSIX","Install from VSIX..."),run:()=>this.commandService.executeCommand(mt.oC)}])}))}));const s=`${e}${t?` ${t}`:""}`;this.notificationService.prompt(w.zb.Error,s,i)}async getDownloadUrl(){if(_.gn)return;if(!this.extension.gallery)return;if(!this.productService.extensionsGallery)return;if(!this.extensionManagementServerService.localExtensionManagementServer&&!this.extensionManagementServerService.remoteExtensionManagementServer)return;let e=this.extension.gallery.properties.targetPlatform;if("universal"!==e&&"undefined"!==e&&this.extensionManagementServerService.remoteExtensionManagementServer)try{const t=await this.galleryService.getManifest(this.extension.gallery,Ne.T.None);t&&this.extensionManifestPropertiesService.prefersExecuteOnWorkspace(t)&&(e=await this.extensionManagementServerService.remoteExtensionManagementServer.extensionManagementService.getTargetPlatform())}catch(e){return void this.logService.error(e)}return"unknown"!==e?g.ov.parse(`${this.productService.extensionsGallery.serviceUrl}/publishers/${this.extension.publisher}/vsextensions/${this.extension.name}/${this.version}/vspackage${"undefined"!==e?`?targetPlatform=${e}`:""}`):void 0}};Vt=(0,a.g)([(0,a.f)(4,It.a),(0,a.f)(5,V.v4),(0,a.f)(6,w.lT),(0,a.f)(7,Wt.Ss),(0,a.f)(8,f.H),(0,a.f)(9,At.VZ),(0,a.f)(10,gt.ZV),(0,a.f)(11,S.TG),(0,a.f)(12,lt.Lj),(0,a.f)(13,Pt.A)],Vt);class $t extends P.aU{constructor(){super(...arguments),this._extension=null}static{this.EXTENSION_ACTION_CLASS="extension-action"}static{this.TEXT_ACTION_CLASS=`${$t.EXTENSION_ACTION_CLASS} text`}static{this.LABEL_ACTION_CLASS=`${$t.EXTENSION_ACTION_CLASS} label`}static{this.ICON_ACTION_CLASS=`${$t.EXTENSION_ACTION_CLASS} icon`}get extension(){return this._extension}set extension(e){this._extension=e,this.update()}}let Ut=class e extends $t{static{this.Class=`${$t.LABEL_ACTION_CLASS} prominent install`}set manifest(e){this._manifest=e,this.updateLabel()}constructor(t,i,n,s,r,o,a,c,h){super("extensions.install",(0,p.NC)("install","Install"),e.Class,!1),this.extensionsWorkbenchService=i,this.instantiationService=n,this.runtimeExtensionService=s,this.workbenchThemeService=r,this.labelService=o,this.dialogService=a,this.preferencesService=c,this.telemetryService=h,this._manifest=null,this.updateThrottler=new l.eD,this.options={...t,isMachineScoped:!1},this.update(),this._register(this.labelService.onDidChangeFormatters((()=>this.updateLabel()),this))}update(){this.updateThrottler.queue((()=>this.computeAndUpdateEnablement()))}async computeAndUpdateEnablement(){this.enabled=!1,this.extension&&(this.extension.isBuiltin||this.extensionsWorkbenchService.canSetLanguage(this.extension)||3===this.extension.state&&await this.extensionsWorkbenchService.canInstall(this.extension)&&(this.enabled=this.options.installPreReleaseVersion?this.extension.hasPreReleaseVersion:this.extension.hasReleaseVersion,this.updateLabel()))}async run(){if(!this.extension)return;if(this.extension.deprecationInfo){let e,t=(0,p.NC)("deprecated message","This extension is deprecated as it is no longer being maintained.");!function(e){e[e.InstallAnyway=0]="InstallAnyway",e[e.ShowAlternateExtension=1]="ShowAlternateExtension",e[e.ConfigureSettings=2]="ConfigureSettings",e[e.Cancel=3]="Cancel"}(e||(e={}));const i=[{label:(0,p.NC)("install anyway","Install Anyway"),run:()=>e.InstallAnyway}];if(this.extension.deprecationInfo.extension){t=(0,p.NC)("deprecated with alternate extension message","This extension is deprecated. Use the {0} extension instead.",this.extension.deprecationInfo.extension.displayName);const n=this.extension.deprecationInfo.extension;i.push({label:(0,p.NC)({key:"Show alternate extension",comment:["&& denotes a mnemonic"]},"&&Open {0}",this.extension.deprecationInfo.extension.displayName),run:async()=>{const[t]=await this.extensionsWorkbenchService.getExtensions([{id:n.id,preRelease:n.preRelease}],Ne.T.None);return await this.extensionsWorkbenchService.open(t),e.ShowAlternateExtension}})}else if(this.extension.deprecationInfo.settings){t=(0,p.NC)("deprecated with alternate settings message","This extension is deprecated as this functionality is now built-in to VS Code.");const n=this.extension.deprecationInfo.settings;i.push({label:(0,p.NC)({key:"configure in settings",comment:["&& denotes a mnemonic"]},"&&Configure Settings"),run:async()=>(await this.preferencesService.openSettings({query:n.map((e=>`@id:${e}`)).join(" ")}),e.ConfigureSettings)})}else this.extension.deprecationInfo.additionalInfo&&(t=new Mt.W5(`${t} ${this.extension.deprecationInfo.additionalInfo}`));const{result:n}=await this.dialogService.prompt({type:w.zb.Warning,message:(0,p.NC)("install confirmation","Are you sure you want to install '{0}'?",this.extension.displayName),detail:(0,B.HD)(t)?t:void 0,custom:(0,B.HD)(t)?void 0:{markdownDetails:[{markdown:t}]},buttons:i,cancelButton:{run:()=>e.Cancel}});if(n!==e.InstallAnyway)return}this.extensionsWorkbenchService.open(this.extension,{showPreReleaseVersion:this.options.installPreReleaseVersion}),(0,yt.Z9)((0,p.NC)("installExtensionStart","Installing extension {0} started. An editor is now open with more details on this extension",this.extension.displayName)),this.telemetryService.publicLog("extensions:action:install",{...this.extension.telemetryData,actionId:this.id});const e=await this.install(this.extension);if(e?.local){(0,yt.Z9)((0,p.NC)("installExtensionComplete","Installing extension {0} is completed.",this.extension.displayName));const t=await this.getRunningExtension(e.local);if(t&&(!t.activationEvents||!t.activationEvents.some((e=>e.startsWith("onLanguage"))))){const t=await this.getThemeAction(e);if(t){t.extension=e;try{return t.run({showCurrentTheme:!0,ignoreFocusLost:!0})}finally{t.dispose()}}}}}async getThemeAction(e){return(await this.workbenchThemeService.getColorThemes()).some((t=>ni(t,e)))?this.instantiationService.createInstance(ri):(await this.workbenchThemeService.getFileIconThemes()).some((t=>ni(t,e)))?this.instantiationService.createInstance(oi):(await this.workbenchThemeService.getProductIconThemes()).some((t=>ni(t,e)))?this.instantiationService.createInstance(ai):void 0}async install(e){try{return await this.extensionsWorkbenchService.install(e,this.options)}catch(t){return void await this.instantiationService.createInstance(Vt,e,e.latestVersion,2,t).run()}}async getRunningExtension(e){return await this.runtimeExtensionService.getExtension(e.identifier.id)||(this.runtimeExtensionService.canAddExtension((0,St.Br)(e))?new Promise(((t,i)=>{const n=this.runtimeExtensionService.onDidChangeExtensions((async()=>{const i=await this.runtimeExtensionService.getExtension(e.identifier.id);i&&(n.dispose(),t(i))}))})):null)}updateLabel(){this.label=this.getLabel()}getLabel(e){return this.options.installPreReleaseVersion&&this.extension?.hasPreReleaseVersion?e?(0,p.NC)("install pre-release","Install Pre-Release"):(0,p.NC)("install pre-release version","Install Pre-Release Version"):this.extension?.hasPreReleaseVersion?e?(0,p.NC)("install","Install"):(0,p.NC)("install release version","Install Release Version"):(0,p.NC)("install","Install")}};Ut=(0,a.g)([(0,a.f)(1,mt.Wi),(0,a.f)(2,S.TG),(0,a.f)(3,St.QS),(0,a.f)(4,xt.Dc),(0,a.f)(5,F.e),(0,a.f)(6,Wt.Ss),(0,a.f)(7,ve.UP),(0,a.f)(8,Ft.bU)],Ut);class Gt extends $t{static{this.LABEL=(0,p.NC)("installing","Installing")}static{this.CLASS=`${$t.LABEL_ACTION_CLASS} install installing`}constructor(){super("extension.installing",Gt.LABEL,Gt.CLASS,!1)}update(){this.class=`${Gt.CLASS}${this.extension&&0===this.extension.state?"":" hide"}`}}(class e extends $t{static{this.INSTALL_LABEL=(0,p.NC)("install","Install")}static{this.INSTALLING_LABEL=(0,p.NC)("installing","Installing")}static{this.Class=`${$t.LABEL_ACTION_CLASS} prominent install`}static{this.InstallingClass=`${$t.LABEL_ACTION_CLASS} install installing`}constructor(t,i,n,s,r,o){super(t,e.INSTALL_LABEL,e.Class,!1),this.server=i,this.canInstallAnyWhere=n,this.extensionsWorkbenchService=s,this.extensionManagementServerService=r,this.extensionManifestPropertiesService=o,this.updateWhenCounterExtensionChanges=!0,this.update()}update(){if(this.enabled=!1,this.class=e.Class,this.canInstall()){const t=this.extensionsWorkbenchService.installed.filter((e=>(0,vt.Q_)(e.identifier,this.extension.identifier)&&e.server===this.server))[0];t?0!==t.state||t.local||(this.enabled=!0,this.label=e.INSTALLING_LABEL,this.class=e.InstallingClass):(this.enabled=!0,this.label=this.getInstallLabel())}}canInstall(){if(!this.extension||!this.server||!this.extension.local||1!==this.extension.state||1!==this.extension.type||2===this.extension.enablementState||0===this.extension.enablementState||4===this.extension.enablementState)return!1;if((0,bt.QF)(this.extension.local.manifest))return!0;if(this.server===this.extensionManagementServerService.localExtensionManagementServer&&this.extensionManifestPropertiesService.prefersExecuteOnUI(this.extension.local.manifest))return!0;if(this.server===this.extensionManagementServerService.remoteExtensionManagementServer&&this.extensionManifestPropertiesService.prefersExecuteOnWorkspace(this.extension.local.manifest))return!0;if(this.server===this.extensionManagementServerService.webExtensionManagementServer&&this.extensionManifestPropertiesService.prefersExecuteOnWeb(this.extension.local.manifest))return!0;if(this.canInstallAnyWhere){if(this.server===this.extensionManagementServerService.localExtensionManagementServer&&this.extensionManifestPropertiesService.canExecuteOnUI(this.extension.local.manifest))return!0;if(this.server===this.extensionManagementServerService.remoteExtensionManagementServer&&this.extensionManifestPropertiesService.canExecuteOnWorkspace(this.extension.local.manifest))return!0}return!1}async run(){if(this.extension?.local&&this.extension?.server&&this.server)return this.extensionsWorkbenchService.open(this.extension),(0,yt.Z9)((0,p.NC)("installExtensionStart","Installing extension {0} started. An editor is now open with more details on this extension",this.extension.displayName)),this.extensionsWorkbenchService.installInServer(this.extension,this.server)}});let zt=class e extends $t{static{this.UninstallLabel=(0,p.NC)("uninstallAction","Uninstall")}static{this.UninstallingLabel=(0,p.NC)("Uninstalling","Uninstalling")}static{this.UninstallClass=`${$t.LABEL_ACTION_CLASS} uninstall`}static{this.UnInstallingClass=`${$t.LABEL_ACTION_CLASS} uninstall uninstalling`}constructor(t){super("extensions.uninstall",e.UninstallLabel,e.UninstallClass,!1),this.extensionsWorkbenchService=t,this.update()}update(){if(!this.extension)return void(this.enabled=!1);const t=this.extension.state;if(2===t)return this.label=e.UninstallingLabel,this.class=e.UnInstallingClass,void(this.enabled=!1);this.label=e.UninstallLabel,this.class=e.UninstallClass,this.tooltip=e.UninstallLabel,1===t?this.extension.isBuiltin?this.enabled=!1:this.enabled=!0:this.enabled=!1}async run(){if(this.extension)return(0,yt.Z9)((0,p.NC)("uninstallExtensionStart","Uninstalling extension {0} started.",this.extension.displayName)),this.extensionsWorkbenchService.uninstall(this.extension).then((()=>{(0,yt.Z9)((0,p.NC)("uninstallExtensionComplete","Please reload Visual Studio Code to complete the uninstallation of the extension {0}.",this.extension.displayName))}))}};zt=(0,a.g)([(0,a.f)(0,mt.Wi)],zt);class Kt extends $t{static{this.EnabledClass=`${$t.LABEL_ACTION_CLASS} prominent update`}static{this.DisabledClass=`${Kt.EnabledClass} disabled`}constructor(e,t,i){super(e,t,Kt.DisabledClass,!1),this.extensionsWorkbenchService=i,this.updateThrottler=new l.eD,this.update()}update(){this.updateThrottler.queue((()=>this.computeAndUpdateEnablement()))}async computeAndUpdateEnablement(){if(this.enabled=!1,this.class=qt.DisabledClass,!this.extension)return;if(this.extension.deprecationInfo)return;const e=await this.extensionsWorkbenchService.canInstall(this.extension),t=1===this.extension.state;this.enabled=e&&t&&this.extension.outdated,this.class=this.enabled?Kt.EnabledClass:Kt.DisabledClass}}let qt=class extends Kt{constructor(e,t,i){super("extensions.update",(0,p.NC)("update","Update"),t),this.verbose=e,this.instantiationService=i}update(){super.update(),this.extension&&(this.label=this.verbose?(0,p.NC)("update to","Update to v{0}",this.extension.latestVersion):(0,p.NC)("update","Update"))}async run(){if(this.extension)return(0,yt.Z9)((0,p.NC)("updateExtensionStart","Updating extension {0} to version {1} started.",this.extension.displayName,this.extension.latestVersion)),this.install(this.extension)}async install(e){try{await this.extensionsWorkbenchService.install(e,e.local?.preRelease?{installPreReleaseVersion:!0}:void 0),(0,yt.Z9)((0,p.NC)("updateExtensionComplete","Updating extension {0} to version {1} completed.",e.displayName,e.latestVersion))}catch(t){this.instantiationService.createInstance(Vt,e,e.latestVersion,3,t).run()}}};qt=(0,a.g)([(0,a.f)(1,mt.Wi),(0,a.f)(2,S.TG)],qt),class e extends $t{static{this.EnabledClass=`${$t.LABEL_ACTION_CLASS} migrate`}static{this.DisabledClass=`${e.EnabledClass} disabled`}constructor(t,i){super("extensionsAction.migrateDeprecatedExtension",(0,p.NC)("migrateExtension","Migrate"),e.DisabledClass,!1),this.small=t,this.extensionsWorkbenchService=i,this.update()}update(){if(this.enabled=!1,this.class=e.DisabledClass,!this.extension?.local)return;if(1!==this.extension.state)return;if(!this.extension.deprecationInfo?.extension)return;const t=this.extension.deprecationInfo.extension.id;this.extensionsWorkbenchService.local.some((e=>(0,vt.Q_)(e.identifier,{id:t})))||(this.enabled=!0,this.class=e.EnabledClass,this.tooltip=(0,p.NC)("migrate to","Migrate to {0}",this.extension.deprecationInfo.extension.displayName),this.label=this.small?(0,p.NC)("migrate","Migrate"):this.tooltip)}async run(){if(!this.extension?.deprecationInfo?.extension)return;const e=this.extension.local;await this.extensionsWorkbenchService.uninstall(this.extension);const[t]=await this.extensionsWorkbenchService.getExtensions([{id:this.extension.deprecationInfo.extension.id,preRelease:this.extension.deprecationInfo?.extension?.preRelease}],Ne.T.None);await this.extensionsWorkbenchService.install(t,{isMachineScoped:e?.isMachineScoped})}};let jt=class extends $t{constructor(e,t,i,n,s){super(e,t,i,n),this.instantiationService=s,this._actionViewItem=null}createActionViewItem(){return this._actionViewItem=this.instantiationService.createInstance(Qt,this),this._actionViewItem}run({actionGroups:e,disposeActionsOnHide:t}){return this._actionViewItem?.showMenu(e,t),Promise.resolve()}};jt=(0,a.g)([(0,a.f)(4,S.TG)],jt);let Qt=class extends Dt.gU{constructor(e,t){super(null,e,{icon:!0,label:!0}),this.contextMenuService=t}showMenu(e,t){if(this.element){const i=this.getActions(e),n=c.i(this.element),s={x:n.left,y:n.top+n.height+10};this.contextMenuService.showContextMenu({getAnchor:()=>s,getActions:()=>i,actionRunner:this.actionRunner,onHide:()=>{t&&(0,u.ex)(i)}})}}getActions(e){let t=[];for(const i of e)t=[...t,...i,new P.Z0];return t.length?t.slice(0,t.length-1):t}};function Xt(e,t){const i=[];for(const[,n]of e)i.push(n.map((e=>e instanceof P.wY?e:t.createInstance(Jt,e))));return i}Qt=(0,a.g)([(0,a.f)(1,ut.i)],Qt),class e extends jt{static{this.ID="extensions.manage"}static{this.Class=`${$t.ICON_ACTION_CLASS} manage `+D.kS.asClassName(Lt.Bl)}static{this.HideManageExtensionClass=`${e.Class} hide`}constructor(t,i,n){super(e.ID,"","",!0,t),this.extensionService=i,this.contextKeyService=n,this.tooltip=(0,p.NC)("manage","Manage"),this.update()}async getActionGroups(){const e=[],t=await async function(e,t,i){return i.invokeFunction((async i=>{const n=i.get(mt.Wi),s=i.get(H.co),r=i.get(pt),o=i.get(ft),a=i.get(xt.Dc),c=[];if(e){c.push(["extension",e.identifier.id]),c.push(["isBuiltinExtension",e.isBuiltin]),c.push(["isDefaultApplicationScopedExtension",e.local&&(0,bt.d2)(e.local.manifest)]),c.push(["isApplicationScopedExtension",e.local&&e.local.isApplicationScoped]),c.push(["extensionHasConfiguration",e.local&&!!e.local.manifest.contributes&&!!e.local.manifest.contributes.configuration]),c.push(["extensionHasKeybindings",e.local&&!!e.local.manifest.contributes&&!!e.local.manifest.contributes.keybindings]),c.push(["extensionHasCommands",e.local&&!!e.local.manifest.contributes&&!!e.local.manifest.contributes?.commands]),c.push(["isExtensionRecommended",!!r.getAllRecommendationsWithReason()[e.identifier.id.toLowerCase()]]),c.push(["isExtensionWorkspaceRecommended",0===r.getAllRecommendationsWithReason()[e.identifier.id.toLowerCase()]?.reasonId]),c.push(["isUserIgnoredRecommendation",o.globalIgnoredRecommendations.some((t=>t===e.identifier.id.toLowerCase()))]),1===e.state&&c.push(["extensionStatus","installed"]),c.push(["installedExtensionIsPreReleaseVersion",!!e.local?.isPreReleaseVersion]),c.push(["installedExtensionIsOptedTpPreRelease",!!e.local?.preRelease]),c.push(["galleryExtensionIsPreReleaseVersion",!!e.gallery?.properties.isPreReleaseVersion]),c.push(["extensionHasPreReleaseVersion",e.hasPreReleaseVersion]),c.push(["extensionHasReleaseVersion",e.hasReleaseVersion]);const[t,i,s]=await Promise.all([a.getColorThemes(),a.getFileIconThemes(),a.getProductIconThemes()]);c.push(["extensionHasColorThemes",t.some((t=>ni(t,e)))]),c.push(["extensionHasFileIconThemes",i.some((t=>ni(t,e)))]),c.push(["extensionHasProductIconThemes",s.some((t=>ni(t,e)))]),c.push(["canSetLanguage",n.canSetLanguage(e)]),c.push(["isActiveLanguagePackExtension",e.gallery&&_.dK===(0,Ot.K)(e.gallery)])}const l=s.createMenu(H.eH.ExtensionContext,t.createOverlay(c)),h=l.getActions({shouldForwardArgs:!0});return l.dispose(),h}))}(this.extension,this.contextKeyService,this.instantiationService),i=[],n=[],s=[];for(const[e,r]of t)e===mt.J2?n.push(...Xt([[e,r]],this.instantiationService)[0]):e===mt.ED?i.push(...Xt([[e,r]],this.instantiationService)[0]):s.push(...Xt([[e,r]],this.instantiationService));return i.length&&e.push(i),e.push([this.instantiationService.createInstance(ei),this.instantiationService.createInstance(Zt)]),e.push([this.instantiationService.createInstance(ii),this.instantiationService.createInstance(ti)]),e.push([...n.length?n:[],this.instantiationService.createInstance(Yt),this.instantiationService.createInstance(zt)]),s.forEach((t=>e.push(t))),e.forEach((e=>e.forEach((e=>{e instanceof $t&&(e.extension=this.extension)})))),e}async run(){return await this.extensionService.whenInstalledExtensionsRegistered(),super.run({actionGroups:await this.getActionGroups(),disposeActionsOnHide:!0})}update(){if(this.class=e.HideManageExtensionClass,this.enabled=!1,this.extension){const t=this.extension.state;this.enabled=1===t,this.class=this.enabled||2===t?e.Class:e.HideManageExtensionClass,this.tooltip=2===t?(0,p.NC)("ManageExtensionAction.uninstallingTooltip","Uninstalling"):""}}};let Jt=class extends $t{constructor(e,t){super(e.id,e.label),this.action=e,this.extensionsWorkbenchService=t}update(){this.extension&&(this.action.id===mt.K5?this.checked=!this.extensionsWorkbenchService.isExtensionIgnoredToSync(this.extension):this.checked=this.action.checked)}async run(){this.extension&&await this.action.run(this.extension.local?(0,vt.Me)(this.extension.local.manifest.publisher,this.extension.local.manifest.name):this.extension.gallery?(0,vt.Me)(this.extension.gallery.publisher,this.extension.gallery.name):this.extension.identifier.id)}};Jt=(0,a.g)([(0,a.f)(1,mt.Wi)],Jt),class e extends $t{static{this.ID="workbench.extensions.action.switchToPreReleaseVersion"}static{this.TITLE={value:(0,p.NC)("switch to pre-release version","Switch to Pre-Release Version"),original:"Switch to  Pre-Release Version"}}constructor(t,i){super(e.ID,t?"":e.TITLE.value,`${t?$t.ICON_ACTION_CLASS+" "+D.kS.asClassName(Lt.qT):$t.LABEL_ACTION_CLASS} hide-when-disabled switch-to-prerelease`,!0),this.commandService=i,this.tooltip=(0,p.NC)("switch to pre-release version tooltip","Switch to Pre-Release version of this extension"),this.update()}update(){this.enabled=!!this.extension&&!this.extension.isBuiltin&&!this.extension.local?.isPreReleaseVersion&&!this.extension.local?.preRelease&&this.extension.hasPreReleaseVersion&&1===this.extension.state}async run(){if(this.enabled)return this.commandService.executeCommand(e.ID,this.extension?.identifier.id)}},class e extends $t{static{this.ID="workbench.extensions.action.switchToReleaseVersion"}static{this.TITLE={value:(0,p.NC)("switch to release version","Switch to Release Version"),original:"Switch to Release Version"}}constructor(t,i){super(e.ID,t?"":e.TITLE.value,`${t?$t.ICON_ACTION_CLASS+" "+D.kS.asClassName(Lt.qT):$t.LABEL_ACTION_CLASS} hide-when-disabled switch-to-released`),this.commandService=i,this.tooltip=(0,p.NC)("switch to release version tooltip","Switch to Release version of this extension"),this.update()}update(){this.enabled=!(!this.extension||this.extension.isBuiltin||1!==this.extension.state||!this.extension.local?.isPreReleaseVersion||!this.extension.hasReleaseVersion)}async run(){if(this.enabled)return this.commandService.executeCommand(e.ID,this.extension?.identifier.id)}};let Yt=class e extends $t{static{this.ID="workbench.extensions.action.install.anotherVersion"}static{this.LABEL=(0,p.NC)("install another version","Install Another Version...")}constructor(t,i,n,s,r){super(e.ID,e.LABEL,$t.LABEL_ACTION_CLASS),this.extensionsWorkbenchService=t,this.extensionGalleryService=i,this.quickInputService=n,this.instantiationService=s,this.dialogService=r,this.update()}update(){this.enabled=!(!this.extension||this.extension.isBuiltin||!this.extension.gallery||!this.extension.local||!this.extension.server||1!==this.extension.state||this.extension.deprecationInfo)}async run(){if(!this.enabled)return;const e=await this.extension.server.extensionManagementService.getTargetPlatform(),t=await this.extensionGalleryService.getAllCompatibleVersions(this.extension.gallery,this.extension.local.preRelease,e);if(!t.length)return void await this.dialogService.info((0,p.NC)("no versions","This extension has no other versions."));const i=t.map(((e,t)=>({id:e.version,label:e.version,description:`${(0,Nt.Z)(new Date(Date.parse(e.date)),!0)}${e.isPreReleaseVersion?` (${(0,p.NC)("pre-release","pre-release")})`:""}${e.version===this.extension.version?` (${(0,p.NC)("current","current")})`:""}`,latest:0===t,ariaLabel:`${e.isPreReleaseVersion?"Pre-Release version":"Release version"} ${e.version}`,isPreReleaseVersion:e.isPreReleaseVersion}))),n=await this.quickInputService.pick(i,{placeHolder:(0,p.NC)("selectVersion","Select Version to Install"),matchOnDetail:!0});if(n){if(this.extension.version===n.id)return;try{n.latest?await this.extensionsWorkbenchService.install(this.extension,{installPreReleaseVersion:n.isPreReleaseVersion}):await this.extensionsWorkbenchService.installVersion(this.extension,n.id,{installPreReleaseVersion:n.isPreReleaseVersion})}catch(e){this.instantiationService.createInstance(Vt,this.extension,n.latest?this.extension.latestVersion:n.id,2,e).run()}}return null}};Yt=(0,a.g)([(0,a.f)(0,mt.Wi),(0,a.f)(1,lt.Lj),(0,a.f)(2,$.eJ),(0,a.f)(3,S.TG),(0,a.f)(4,Wt.Ss)],Yt);let Zt=class e extends $t{static{this.ID="extensions.enableForWorkspace"}static{this.LABEL=(0,p.NC)("enableForWorkspaceAction","Enable (Workspace)")}constructor(t,i){super(e.ID,e.LABEL,$t.LABEL_ACTION_CLASS),this.extensionsWorkbenchService=t,this.extensionEnablementService=i,this.tooltip=(0,p.NC)("enableForWorkspaceActionToolTip","Enable this extension only in this workspace"),this.update()}update(){this.enabled=!1,this.extension&&this.extension.local&&(this.enabled=1===this.extension.state&&!this.extensionEnablementService.isEnabled(this.extension.local)&&this.extensionEnablementService.canChangeWorkspaceEnablement(this.extension.local))}async run(){if(this.extension)return this.extensionsWorkbenchService.setEnablement(this.extension,9)}};Zt=(0,a.g)([(0,a.f)(0,mt.Wi),(0,a.f)(1,gt.uI)],Zt);let ei=class e extends $t{static{this.ID="extensions.enableGlobally"}static{this.LABEL=(0,p.NC)("enableGloballyAction","Enable")}constructor(t,i){super(e.ID,e.LABEL,$t.LABEL_ACTION_CLASS),this.extensionsWorkbenchService=t,this.extensionEnablementService=i,this.tooltip=(0,p.NC)("enableGloballyActionToolTip","Enable this extension"),this.update()}update(){this.enabled=!1,this.extension&&this.extension.local&&(this.enabled=1===this.extension.state&&this.extensionEnablementService.isDisabledGlobally(this.extension.local)&&this.extensionEnablementService.canChangeEnablement(this.extension.local))}async run(){if(this.extension)return this.extensionsWorkbenchService.setEnablement(this.extension,8)}};ei=(0,a.g)([(0,a.f)(0,mt.Wi),(0,a.f)(1,gt.uI)],ei);let ti=class e extends $t{static{this.ID="extensions.disableForWorkspace"}static{this.LABEL=(0,p.NC)("disableForWorkspaceAction","Disable (Workspace)")}constructor(t,i,n,s){super(e.ID,e.LABEL,$t.LABEL_ACTION_CLASS),this.workspaceContextService=t,this.extensionsWorkbenchService=i,this.extensionEnablementService=n,this.extensionService=s,this.tooltip=(0,p.NC)("disableForWorkspaceActionToolTip","Disable this extension only in this workspace"),this.update(),this._register(this.extensionService.onDidChangeExtensions((()=>this.update())))}update(){this.enabled=!1,this.extension&&this.extension.local&&this.extensionService.extensions.some((e=>(0,vt.Q_)({id:e.identifier.value,uuid:e.uuid},this.extension.identifier)&&1!==this.workspaceContextService.getWorkbenchState()))&&(this.enabled=1===this.extension.state&&(8===this.extension.enablementState||9===this.extension.enablementState)&&this.extensionEnablementService.canChangeWorkspaceEnablement(this.extension.local))}async run(){if(this.extension)return this.extensionsWorkbenchService.setEnablement(this.extension,7)}};ti=(0,a.g)([(0,a.f)(0,T.ec),(0,a.f)(1,mt.Wi),(0,a.f)(2,gt.uI),(0,a.f)(3,St.QS)],ti);let ii=class e extends $t{static{this.ID="extensions.disableGlobally"}static{this.LABEL=(0,p.NC)("disableGloballyAction","Disable")}constructor(t,i,n){super(e.ID,e.LABEL,$t.LABEL_ACTION_CLASS),this.extensionsWorkbenchService=t,this.extensionEnablementService=i,this.extensionService=n,this.tooltip=(0,p.NC)("disableGloballyActionToolTip","Disable this extension"),this.update(),this._register(this.extensionService.onDidChangeExtensions((()=>this.update())))}update(){this.enabled=!1,this.extension&&this.extension.local&&this.extensionService.extensions.some((e=>(0,vt.Q_)({id:e.identifier.value,uuid:e.uuid},this.extension.identifier)))&&(this.enabled=1===this.extension.state&&(8===this.extension.enablementState||9===this.extension.enablementState)&&this.extensionEnablementService.canChangeEnablement(this.extension.local))}async run(){if(this.extension)return this.extensionsWorkbenchService.setEnablement(this.extension,6)}};function ni(e,t){return!!(t&&e.extensionData&&bt.kP.equals(e.extensionData.extensionId,t.identifier.id))}function si(e,t,i,n){const s=[];for(const r of e)!ni(r,i)||n&&r===t||s.push({label:r.label,id:r.id});return n&&(s.push({type:"separator",label:(0,p.NC)("current","current")}),s.push({label:t.label,id:t.id})),s}ii=(0,a.g)([(0,a.f)(0,mt.Wi),(0,a.f)(1,gt.uI),(0,a.f)(2,St.QS)],ii),class e extends $t{static{this.EnabledClass=`${$t.LABEL_ACTION_CLASS} reload`}static{this.DisabledClass=`${e.EnabledClass} disabled`}constructor(t,i){super("extensions.reload",(0,p.NC)("reloadAction","Reload"),e.DisabledClass,!1),this.hostService=t,this.extensionService=i,this.updateWhenCounterExtensionChanges=!0,this._register(this.extensionService.onDidChangeExtensions((()=>this.update()))),this.update()}update(){if(this.enabled=!1,this.tooltip="",!this.extension)return;const t=this.extension.state;if(0===t||2===t)return;if(this.extension.local&&this.extension.local.manifest&&this.extension.local.manifest.contributes&&this.extension.local.manifest.contributes.localizations&&this.extension.local.manifest.contributes.localizations.length>0)return;const i=this.extension.reloadRequiredStatus;this.enabled=void 0!==i,this.label=void 0!==i?(0,p.NC)("reload required","Reload Required"):"",this.tooltip=void 0!==i?i:"",this.class=this.enabled?e.EnabledClass:e.DisabledClass}run(){return Promise.resolve(this.hostService.reload())}};let ri=class e extends $t{static{this.ID="workbench.extensions.action.setColorTheme"}static{this.TITLE={value:(0,p.NC)("workbench.extensions.action.setColorTheme","Set Color Theme"),original:"Set Color Theme"}}static{this.EnabledClass=`${$t.LABEL_ACTION_CLASS} theme`}static{this.DisabledClass=`${e.EnabledClass} disabled`}constructor(t,i,n,s){super(e.ID,e.TITLE.value,e.DisabledClass,!1),this.workbenchThemeService=i,this.quickInputService=n,this.extensionEnablementService=s,this._register(d.ju.any(t.onDidChangeExtensions,i.onDidColorThemeChange)((()=>this.update()),this)),this.update()}update(){this.workbenchThemeService.getColorThemes().then((t=>{this.enabled=this.computeEnablement(t),this.class=this.enabled?e.EnabledClass:e.DisabledClass}))}computeEnablement(e){return!!this.extension&&1===this.extension.state&&this.extensionEnablementService.isEnabledEnablementState(this.extension.enablementState)&&e.some((e=>ni(e,this.extension)))}async run({showCurrentTheme:e,ignoreFocusLost:t}={showCurrentTheme:!1,ignoreFocusLost:!1}){const i=await this.workbenchThemeService.getColorThemes();if(!this.computeEnablement(i))return;const n=this.workbenchThemeService.getColorTheme(),s=new l.vp(100),r=si(i,n,this.extension,e),o=await this.quickInputService.pick(r,{placeHolder:(0,p.NC)("select color theme","Select Color Theme"),onDidFocus:e=>s.trigger((()=>this.workbenchThemeService.setColorTheme(e.id,void 0))),ignoreFocusLost:t});return this.workbenchThemeService.setColorTheme(o?o.id:n.id,"auto")}};ri=(0,a.g)([(0,a.f)(0,St.QS),(0,a.f)(1,xt.Dc),(0,a.f)(2,$.eJ),(0,a.f)(3,gt.uI)],ri);let oi=class e extends $t{static{this.ID="workbench.extensions.action.setFileIconTheme"}static{this.TITLE={value:(0,p.NC)("workbench.extensions.action.setFileIconTheme","Set File Icon Theme"),original:"Set File Icon Theme"}}static{this.EnabledClass=`${$t.LABEL_ACTION_CLASS} theme`}static{this.DisabledClass=`${e.EnabledClass} disabled`}constructor(t,i,n,s){super(e.ID,e.TITLE.value,e.DisabledClass,!1),this.workbenchThemeService=i,this.quickInputService=n,this.extensionEnablementService=s,this._register(d.ju.any(t.onDidChangeExtensions,i.onDidFileIconThemeChange)((()=>this.update()),this)),this.update()}update(){this.workbenchThemeService.getFileIconThemes().then((t=>{this.enabled=this.computeEnablement(t),this.class=this.enabled?e.EnabledClass:e.DisabledClass}))}computeEnablement(e){return!!this.extension&&1===this.extension.state&&this.extensionEnablementService.isEnabledEnablementState(this.extension.enablementState)&&e.some((e=>ni(e,this.extension)))}async run({showCurrentTheme:e,ignoreFocusLost:t}={showCurrentTheme:!1,ignoreFocusLost:!1}){const i=await this.workbenchThemeService.getFileIconThemes();if(!this.computeEnablement(i))return;const n=this.workbenchThemeService.getFileIconTheme(),s=new l.vp(100),r=si(i,n,this.extension,e),o=await this.quickInputService.pick(r,{placeHolder:(0,p.NC)("select file icon theme","Select File Icon Theme"),onDidFocus:e=>s.trigger((()=>this.workbenchThemeService.setFileIconTheme(e.id,void 0))),ignoreFocusLost:t});return this.workbenchThemeService.setFileIconTheme(o?o.id:n.id,"auto")}};oi=(0,a.g)([(0,a.f)(0,St.QS),(0,a.f)(1,xt.Dc),(0,a.f)(2,$.eJ),(0,a.f)(3,gt.uI)],oi);let ai=class e extends $t{static{this.ID="workbench.extensions.action.setProductIconTheme"}static{this.TITLE={value:(0,p.NC)("workbench.extensions.action.setProductIconTheme","Set Product Icon Theme"),original:"Set Product Icon Theme"}}static{this.EnabledClass=`${$t.LABEL_ACTION_CLASS} theme`}static{this.DisabledClass=`${e.EnabledClass} disabled`}constructor(t,i,n,s){super(e.ID,e.TITLE.value,e.DisabledClass,!1),this.workbenchThemeService=i,this.quickInputService=n,this.extensionEnablementService=s,this._register(d.ju.any(t.onDidChangeExtensions,i.onDidProductIconThemeChange)((()=>this.update()),this)),this.update()}update(){this.workbenchThemeService.getProductIconThemes().then((t=>{this.enabled=this.computeEnablement(t),this.class=this.enabled?e.EnabledClass:e.DisabledClass}))}computeEnablement(e){return!!this.extension&&1===this.extension.state&&this.extensionEnablementService.isEnabledEnablementState(this.extension.enablementState)&&e.some((e=>ni(e,this.extension)))}async run({showCurrentTheme:e,ignoreFocusLost:t}={showCurrentTheme:!1,ignoreFocusLost:!1}){const i=await this.workbenchThemeService.getProductIconThemes();if(!this.computeEnablement(i))return;const n=this.workbenchThemeService.getProductIconTheme(),s=new l.vp(100),r=si(i,n,this.extension,e),o=await this.quickInputService.pick(r,{placeHolder:(0,p.NC)("select product icon theme","Select Product Icon Theme"),onDidFocus:e=>s.trigger((()=>this.workbenchThemeService.setProductIconTheme(e.id,void 0))),ignoreFocusLost:t});return this.workbenchThemeService.setProductIconTheme(o?o.id:n.id,"auto")}};ai=(0,a.g)([(0,a.f)(0,St.QS),(0,a.f)(1,xt.Dc),(0,a.f)(2,$.eJ),(0,a.f)(3,gt.uI)],ai),class e extends $t{static{this.ID="workbench.extensions.action.setDisplayLanguage"}static{this.TITLE={value:(0,p.NC)("workbench.extensions.action.setDisplayLanguage","Set Display Language"),original:"Set Display Language"}}static{this.EnabledClass=`${$t.LABEL_ACTION_CLASS} language`}static{this.DisabledClass=`${e.EnabledClass} disabled`}constructor(t){super(e.ID,e.TITLE.value,e.DisabledClass,!1),this.extensionsWorkbenchService=t,this.update()}update(){this.enabled=!1,this.class=e.DisabledClass,this.extension&&this.extensionsWorkbenchService.canSetLanguage(this.extension)&&(this.extension.gallery&&_.dK===(0,Ot.K)(this.extension.gallery)||(this.enabled=!0,this.class=e.EnabledClass))}async run(){return this.extension&&this.extensionsWorkbenchService.setLanguage(this.extension)}},class e extends $t{static{this.ID="workbench.extensions.action.clearLanguage"}static{this.TITLE={value:(0,p.NC)("workbench.extensions.action.clearLanguage","Clear Display Language"),original:"Clear Display Language"}}static{this.EnabledClass=`${$t.LABEL_ACTION_CLASS} language`}static{this.DisabledClass=`${e.EnabledClass} disabled`}constructor(t,i){super(e.ID,e.TITLE.value,e.DisabledClass,!1),this.extensionsWorkbenchService=t,this.localeService=i,this.update()}update(){this.enabled=!1,this.class=e.DisabledClass,this.extension&&this.extensionsWorkbenchService.canSetLanguage(this.extension)&&(this.extension.gallery&&_.dK!==(0,Ot.K)(this.extension.gallery)||(this.enabled=!0,this.class=e.EnabledClass))}async run(){return this.extension&&this.localeService.clearLocalePreference()}},class e extends P.aU{static{this.ID="workbench.extensions.action.showRecommendedExtension"}static{this.LABEL=(0,p.NC)("showRecommendedExtension","Show Recommended Extension")}constructor(t,i,n){super(e.ID,e.LABEL,void 0,!1),this.paneCompositeService=i,this.extensionWorkbenchService=n,this.extensionId=t}async run(){const e=await this.paneCompositeService.openPaneComposite(mt.f3,0,!0),t=e?.getViewPaneContainer();t.search(`@id:${this.extensionId}`),t.focus();const[i]=await this.extensionWorkbenchService.getExtensions([{id:this.extensionId}],{source:"install-recommendation"},Ne.T.None);return i?this.extensionWorkbenchService.open(i):null}};let ci=class e extends P.aU{static{this.ID="workbench.extensions.action.installRecommendedExtension"}static{this.LABEL=(0,p.NC)("installRecommendedExtension","Install Recommended Extension")}constructor(t,i,n,s){super(e.ID,e.LABEL,void 0,!1),this.paneCompositeService=i,this.instantiationService=n,this.extensionWorkbenchService=s,this.extensionId=t}async run(){const e=await this.paneCompositeService.openPaneComposite(mt.f3,0,!0),t=e?.getViewPaneContainer();t.search(`@id:${this.extensionId}`),t.focus();const[i]=await this.extensionWorkbenchService.getExtensions([{id:this.extensionId}],{source:"install-recommendation"},Ne.T.None);if(i){await this.extensionWorkbenchService.open(i);try{await this.extensionWorkbenchService.install(i)}catch(e){this.instantiationService.createInstance(Vt,i,i.latestVersion,2,e).run()}}}};ci=(0,a.g)([(0,a.f)(1,Bt.c),(0,a.f)(2,S.TG),(0,a.f)(3,mt.Wi)],ci),class e extends P.aU{static{this.ID="extensions.ignore"}static{this.Class=`${$t.LABEL_ACTION_CLASS} ignore`}constructor(t,i){super(e.ID,"Ignore Recommendation"),this.extension=t,this.extensionRecommendationsManagementService=i,this.class=e.Class,this.tooltip=(0,p.NC)("ignoreExtensionRecommendation","Do not recommend this extension again"),this.enabled=!0}run(){return this.extensionRecommendationsManagementService.toggleGlobalIgnoredRecommendation(this.extension.identifier.id,!0),Promise.resolve()}},class e extends P.aU{static{this.ID="extensions.ignore"}static{this.Class=`${$t.LABEL_ACTION_CLASS} undo-ignore`}constructor(t,i){super(e.ID,"Undo"),this.extension=t,this.extensionRecommendationsManagementService=i,this.class=e.Class,this.tooltip=(0,p.NC)("undo","Undo"),this.enabled=!0}run(){return this.extensionRecommendationsManagementService.toggleGlobalIgnoredRecommendation(this.extension.identifier.id,!1),Promise.resolve()}};let li=class extends P.aU{constructor(e,t){super("extensions.searchExtensions",(0,p.NC)("search recommendations","Search Extensions"),void 0,!0),this.searchValue=e,this.paneCompositeService=t}async run(){const e=(await this.paneCompositeService.openPaneComposite(mt.f3,0,!0))?.getViewPaneContainer();e.search(this.searchValue),e.focus()}};li=(0,a.g)([(0,a.f)(1,Bt.c)],li);let hi=class extends P.aU{constructor(e,t,i,n,s,r,o,a){super(e,t),this.contextService=i,this.fileService=n,this.textFileService=s,this.editorService=r,this.jsonEditingService=o,this.textModelResolverService=a}openExtensionsFile(e){return this.getOrCreateExtensionsFile(e).then((({created:t,content:i})=>this.getSelectionPosition(i,e,["recommendations"]).then((i=>this.editorService.openEditor({resource:e,options:{pinned:t,selection:i}})))),(e=>Promise.reject(new Error((0,p.NC)("OpenExtensionsFile.failed","Unable to create 'extensions.json' file inside the '.vscode' folder ({0}).",e)))))}openWorkspaceConfigurationFile(e){return this.getOrUpdateWorkspaceConfigurationFile(e).then((e=>this.getSelectionPosition(e.value.toString(),e.resource,["extensions","recommendations"]))).then((t=>this.editorService.openEditor({resource:e,options:{selection:t,forceReload:!0}})))}getOrUpdateWorkspaceConfigurationFile(e){return Promise.resolve(this.fileService.readFile(e)).then((t=>{const i=dt.Qc(t.value.toString()).extensions;return i&&i.recommendations?t:this.jsonEditingService.write(e,[{path:["extensions"],value:{recommendations:[]}}],!0).then((()=>this.fileService.readFile(e)))}))}getSelectionPosition(e,t,i){const n=dt.jv(e),s=dt.SN(n,i);if(s&&s.parent&&s.parent.children){const e=s.parent.children[1],i=e.children&&e.children.length?e.children[e.children.length-1]:null,n=i?i.offset+i.length:e.offset+1;return Promise.resolve(this.textModelResolverService.createModelReference(t)).then((e=>{const t=e.object.textEditorModel.getPositionAt(n);return e.dispose(),{startLineNumber:t.lineNumber,startColumn:t.column,endLineNumber:t.lineNumber,endColumn:t.column}}))}return Promise.resolve(void 0)}getOrCreateExtensionsFile(e){return Promise.resolve(this.fileService.readFile(e)).then((t=>({created:!1,extensionsFileResource:e,content:t.value.toString()})),(t=>this.textFileService.write(e,_t).then((()=>({created:!0,extensionsFileResource:e,content:_t})))))}};hi=(0,a.g)([(0,a.f)(2,T.ec),(0,a.f)(3,xe.sn),(0,a.f)(4,kt.MM),(0,a.f)(5,ae.AR),(0,a.f)(6,wt.R),(0,a.f)(7,Ct.S)],hi),class extends hi{static{this.ID="workbench.extensions.action.configureWorkspaceRecommendedExtensions"}static{this.LABEL=(0,p.NC)("configureWorkspaceRecommendedExtensions","Configure Recommended Extensions (Workspace)")}constructor(e,t,i,n,s,r,o,a){super(e,t,s,i,n,r,o,a),this._register(this.contextService.onDidChangeWorkbenchState((()=>this.update()),this)),this.update()}update(){this.enabled=1!==this.contextService.getWorkbenchState()}run(){switch(this.contextService.getWorkbenchState()){case 2:return this.openExtensionsFile(this.contextService.getWorkspace().folders[0].toResource(Tt));case 3:return this.openWorkspaceConfigurationFile(this.contextService.getWorkspace().configuration)}return Promise.resolve()}},class extends hi{static{this.ID="workbench.extensions.action.configureWorkspaceFolderRecommendedExtensions"}static{this.LABEL=(0,p.NC)("configureWorkspaceFolderRecommendedExtensions","Configure Recommended Extensions (Workspace Folder)")}constructor(e,t,i,n,s,r,o,a,c){super(e,t,s,i,n,r,o,a),this.commandService=c}run(){const e=1===this.contextService.getWorkspace().folders.length?Promise.resolve(this.contextService.getWorkspace().folders[0]):this.commandService.executeCommand(U.RS);return Promise.resolve(e).then((e=>e?this.openExtensionsFile(e.toResource(Tt)):null))}},class e extends P.aU{static{this.ENABLED_CLASS=`${$t.TEXT_ACTION_CLASS} extension-status-label`}static{this.DISABLED_CLASS=`${e.ENABLED_CLASS} hide`}get extension(){return this._extension}set extension(e){this._extension&&e&&(0,vt.Q_)(this._extension.identifier,e.identifier)||(this.initialStatus=null,this.status=null,this.enablementState=null),this._extension=e,this.update()}constructor(t,i,n){super("extensions.action.statusLabel","",e.DISABLED_CLASS,!1),this.extensionService=t,this.extensionManagementServerService=i,this.extensionEnablementService=n,this.initialStatus=null,this.status=null,this.version=null,this.enablementState=null,this._extension=null}update(){const t=this.computeLabel();this.label=t||"",this.class=t?e.ENABLED_CLASS:e.DISABLED_CLASS}computeLabel(){if(!this.extension)return null;const e=this.status,t=this.version,i=this.enablementState;this.status=this.extension.state,this.version=this.extension.version,null===this.initialStatus&&(this.initialStatus=this.status),this.enablementState=this.extension.enablementState;const n=()=>{const e=this.extensionService.extensions.filter((e=>(0,vt.Q_)({id:e.identifier.value,uuid:e.uuid},this.extension.identifier)))[0];return!!this.extension.local&&(!(!e||this.extension.version!==e.version)||this.extensionService.canAddExtension((0,St.Br)(this.extension.local)))},s=()=>!!this.extension.local&&(!!this.extensionService.extensions.every((e=>!((0,vt.Q_)({id:e.identifier.value,uuid:e.uuid},this.extension.identifier)&&this.extension.server===this.extensionManagementServerService.getExtensionManagementServer((0,St.IZ)(e)))))||this.extensionService.canRemoveExtension((0,St.Br)(this.extension.local)));if(null!==e){if(0===e&&1===this.status)return n()?1===this.initialStatus&&this.version!==t?(0,p.NC)("updated","Updated"):(0,p.NC)("installed","Installed"):null;if(2===e&&3===this.status)return this.initialStatus=this.status,s()?(0,p.NC)("uninstalled","Uninstalled"):null}if(null!==i){const e=this.extensionEnablementService.isEnabledEnablementState(i),t=this.extensionEnablementService.isEnabledEnablementState(this.enablementState);if(!e&&t)return n()?(0,p.NC)("enabled","Enabled"):null;if(e&&!t)return s()?(0,p.NC)("disabled","Disabled"):null}return null}run(){return Promise.resolve()}},class e extends jt{static{this.IGNORED_SYNC_CLASS=`${$t.ICON_ACTION_CLASS} extension-sync ${D.kS.asClassName(Lt.jO)}`}static{this.SYNC_CLASS=`${e.ICON_ACTION_CLASS} extension-sync ${D.kS.asClassName(Lt.j8)}`}constructor(t,i,n,s){super("extensions.sync","",e.SYNC_CLASS,!1,s),this.configurationService=t,this.extensionsWorkbenchService=i,this.userDataSyncEnablementService=n,this._register(d.ju.filter(this.configurationService.onDidChangeConfiguration,(e=>e.affectsConfiguration("settingsSync.ignoredExtensions")))((()=>this.update()))),this._register(n.onDidChangeEnablement((()=>this.update()))),this.update()}update(){if(this.enabled=!!this.extension&&this.userDataSyncEnablementService.isEnabled()&&1===this.extension.state,this.extension){const t=this.extensionsWorkbenchService.isExtensionIgnoredToSync(this.extension);this.class=t?e.IGNORED_SYNC_CLASS:e.SYNC_CLASS,this.tooltip=t?(0,p.NC)("ignored","This extension is ignored during sync"):(0,p.NC)("synced","This extension is synced")}}async run(){return super.run({actionGroups:[[new P.aU("extensions.syncignore",this.extensionsWorkbenchService.isExtensionIgnoredToSync(this.extension)?(0,p.NC)("sync","Sync this extension"):(0,p.NC)("do not sync","Do not sync this extension"),void 0,!0,(()=>this.extensionsWorkbenchService.toggleExtensionIgnoredToSync(this.extension)))]],disposeActionsOnHide:!0})}},class e extends $t{static{this.CLASS=`${$t.ICON_ACTION_CLASS} extension-status`}get status(){return this._status}constructor(t,i,n,s,r,o,a,c,h,u,m){super("extensions.status","",`${e.CLASS} hide`,!1),this.extensionManagementServerService=t,this.labelService=i,this.commandService=n,this.workspaceTrustEnablementService=s,this.workspaceTrustService=r,this.extensionsWorkbenchService=o,this.extensionService=a,this.extensionManifestPropertiesService=c,this.contextService=h,this.productService=u,this.workbenchExtensionEnablementService=m,this.updateWhenCounterExtensionChanges=!0,this._onDidChangeStatus=this._register(new d.Q5),this.onDidChangeStatus=this._onDidChangeStatus.event,this.updateThrottler=new l.eD,this._register(this.labelService.onDidChangeFormatters((()=>this.update()),this)),this._register(this.extensionService.onDidChangeExtensions((()=>this.update()))),this.update()}update(){this.updateThrottler.queue((()=>this.computeAndUpdateStatus()))}async computeAndUpdateStatus(){if(this.updateStatus(void 0,!0),this.enabled=!1,!this.extension)return;if(this.extension.isMalicious)return void this.updateStatus({icon:Lt.tO,message:new Mt.W5((0,p.NC)("malicious tooltip","This extension was reported to be problematic."))},!0);if(this.extension.deprecationInfo){if(this.extension.deprecationInfo.extension){const e=`[${this.extension.deprecationInfo.extension.displayName}](${g.ov.parse(`command:extension.open?${encodeURIComponent(JSON.stringify([this.extension.deprecationInfo.extension.id]))}`)})`;this.updateStatus({icon:Lt.tO,message:new Mt.W5((0,p.NC)("deprecated with alternate extension tooltip","This extension is deprecated. Use the {0} extension instead.",e))},!0)}else if(this.extension.deprecationInfo.settings){const e=`[${(0,p.NC)("settings","settings")}](${g.ov.parse(`command:workbench.action.openSettings?${encodeURIComponent(JSON.stringify([this.extension.deprecationInfo.settings.map((e=>`@id:${e}`)).join(" ")]))}`)})`;this.updateStatus({icon:Lt.tO,message:new Mt.W5((0,p.NC)("deprecated with alternate settings tooltip","This extension is deprecated as this functionality is now built-in to VS Code. Configure these {0} to use this functionality.",e))},!0)}else{const e=new Mt.W5((0,p.NC)("deprecated tooltip","This extension is deprecated as it is no longer being maintained."));this.extension.deprecationInfo.additionalInfo&&e.appendMarkdown(` ${this.extension.deprecationInfo.additionalInfo}`),this.updateStatus({icon:Lt.tO,message:e},!0)}return}if(this.extensionsWorkbenchService.canSetLanguage(this.extension))return;if(this.extension.gallery&&3===this.extension.state&&!await this.extensionsWorkbenchService.canInstall(this.extension)){if(this.extensionManagementServerService.localExtensionManagementServer||this.extensionManagementServerService.remoteExtensionManagementServer){const e=await(this.extensionManagementServerService.localExtensionManagementServer?this.extensionManagementServerService.localExtensionManagementServer.extensionManagementService.getTargetPlatform():this.extensionManagementServerService.remoteExtensionManagementServer.extensionManagementService.getTargetPlatform()),t=new Mt.W5(`${(0,p.NC)("incompatible platform","The '{0}' extension is not available in {1} for {2}.",this.extension.displayName||this.extension.identifier.id,this.productService.nameLong,(0,lt.nm)(e))} [${(0,p.NC)("learn more","Learn More")}](https://aka.ms/vscode-platform-specific-extensions)`);return void this.updateStatus({icon:Lt.tO,message:t},!0)}if(this.extensionManagementServerService.webExtensionManagementServer){const e=(0,p.NC)("VS Code for Web","{0} for the Web",this.productService.nameLong),t=new Mt.W5(`${(0,p.NC)("not web tooltip","The '{0}' extension is not available in {1}.",this.extension.displayName||this.extension.identifier.id,e)} [${(0,p.NC)("learn why","Learn Why")}](https://aka.ms/vscode-web-extensions-guide)`);return void this.updateStatus({icon:Lt.tO,message:t},!0)}}if(!this.extension.local||!this.extension.server||1!==this.extension.state)return;if(2===this.extension.enablementState)return void this.updateStatus({message:new Mt.W5((0,p.NC)("disabled by environment","This extension is disabled by the environment."))},!0);if(3===this.extension.enablementState)return void this.updateStatus({message:new Mt.W5((0,p.NC)("enabled by environment","This extension is enabled because it is required in the current environment."))},!0);if(4===this.extension.enablementState){const e=(0,bt.Gd)(this.extension.local.manifest.capabilities?.virtualWorkspaces);return void this.updateStatus({icon:Lt.DJ,message:new Mt.W5(e?(0,Mt.p9)(e):(0,p.NC)("disabled because of virtual workspace","This extension has been disabled because it does not support virtual workspaces."))},!0)}if((0,Rt.wB)(this.contextService.getWorkspace())){const e=this.extensionManifestPropertiesService.getExtensionVirtualWorkspaceSupportType(this.extension.local.manifest),t=(0,bt.Gd)(this.extension.local.manifest.capabilities?.virtualWorkspaces);if("limited"===e||t)return void this.updateStatus({icon:Lt.tO,message:new Mt.W5(t?(0,Mt.p9)(t):(0,p.NC)("extension limited because of virtual workspace","This extension has limited features because the current workspace is virtual."))},!0)}if(0===this.extension.enablementState||5===this.extension.enablementState&&this.workbenchExtensionEnablementService.getDependenciesEnablementStates(this.extension.local).every((([,e])=>this.workbenchExtensionEnablementService.isEnabledEnablementState(e)||0===e))){this.enabled=!0;const e=(0,bt.Gd)(this.extension.local.manifest.capabilities?.untrustedWorkspaces);return void this.updateStatus({icon:Lt.$m,message:new Mt.W5(e?(0,Mt.p9)(e):(0,p.NC)("extension disabled because of trust requirement","This extension has been disabled because the current workspace is not trusted."))},!0)}if(this.workspaceTrustEnablementService.isWorkspaceTrustEnabled()&&!this.workspaceTrustService.isWorkspaceTrusted()){const e=this.extensionManifestPropertiesService.getExtensionUntrustedWorkspaceSupportType(this.extension.local.manifest),t=(0,bt.Gd)(this.extension.local.manifest.capabilities?.untrustedWorkspaces);if("limited"===e||t)return this.enabled=!0,void this.updateStatus({icon:Lt.$m,message:new Mt.W5(t?(0,Mt.p9)(t):(0,p.NC)("extension limited because of trust requirement","This extension has limited features because the current workspace is not trusted."))},!0)}if(1===this.extension.enablementState&&!this.extensionsWorkbenchService.installed.some((e=>(0,vt.Q_)(e.identifier,this.extension.identifier)&&e.server!==this.extension.server))){let e;return this.extensionManagementServerService.localExtensionManagementServer===this.extension.server?this.extensionManifestPropertiesService.prefersExecuteOnWorkspace(this.extension.local.manifest)&&this.extensionManagementServerService.remoteExtensionManagementServer&&(e=new Mt.W5(`${(0,p.NC)("Install in remote server to enable","This extension is disabled in this workspace because it is defined to run in the Remote Extension Host. Please install the extension in '{0}' to enable.",this.extensionManagementServerService.remoteExtensionManagementServer.label)} [${(0,p.NC)("learn more","Learn More")}](https://aka.ms/vscode-remote/developing-extensions/architecture)`)):this.extensionManagementServerService.remoteExtensionManagementServer===this.extension.server?this.extensionManifestPropertiesService.prefersExecuteOnUI(this.extension.local.manifest)&&(this.extensionManagementServerService.localExtensionManagementServer?e=new Mt.W5(`${(0,p.NC)("Install in local server to enable","This extension is disabled in this workspace because it is defined to run in the Local Extension Host. Please install the extension locally to enable.",this.extensionManagementServerService.remoteExtensionManagementServer.label)} [${(0,p.NC)("learn more","Learn More")}](https://aka.ms/vscode-remote/developing-extensions/architecture)`):_.$L&&(e=new Mt.W5(`${(0,p.NC)("Defined to run in desktop","This extension is disabled because it is defined to run only in {0} for the Desktop.",this.productService.nameLong)} [${(0,p.NC)("learn more","Learn More")}](https://aka.ms/vscode-remote/developing-extensions/architecture)`))):this.extensionManagementServerService.webExtensionManagementServer===this.extension.server&&(e=new Mt.W5(`${(0,p.NC)("Cannot be enabled","This extension is disabled because it is not supported in {0} for the Web.",this.productService.nameLong)} [${(0,p.NC)("learn more","Learn More")}](https://aka.ms/vscode-remote/developing-extensions/architecture)`)),void(e&&this.updateStatus({icon:Lt.tO,message:e},!0))}if(this.extensionManagementServerService.remoteExtensionManagementServer){if((0,bt.QF)(this.extension.local.manifest)){if(!this.extensionsWorkbenchService.installed.some((e=>(0,vt.Q_)(e.identifier,this.extension.identifier)&&e.server!==this.extension.server))){const e=this.extension.server===this.extensionManagementServerService.localExtensionManagementServer?new Mt.W5((0,p.NC)("Install language pack also in remote server","Install the language pack extension on '{0}' to enable it there also.",this.extensionManagementServerService.remoteExtensionManagementServer.label)):new Mt.W5((0,p.NC)("Install language pack also locally","Install the language pack extension locally to enable it there also."));this.updateStatus({icon:Lt.DJ,message:e},!0)}return}const e=this.extensionService.extensions.filter((e=>(0,vt.Q_)({id:e.identifier.value,uuid:e.uuid},this.extension.identifier)))[0],t=e?this.extensionManagementServerService.getExtensionManagementServer((0,St.IZ)(e)):null;if(this.extension.server===this.extensionManagementServerService.localExtensionManagementServer&&t===this.extensionManagementServerService.remoteExtensionManagementServer)return void(this.extensionManifestPropertiesService.prefersExecuteOnWorkspace(this.extension.local.manifest)&&this.updateStatus({icon:Lt.DJ,message:new Mt.W5(`${(0,p.NC)("enabled remotely","This extension is enabled in the Remote Extension Host because it prefers to run there.")} [${(0,p.NC)("learn more","Learn More")}](https://aka.ms/vscode-remote/developing-extensions/architecture)`)},!0));if(this.extension.server===this.extensionManagementServerService.remoteExtensionManagementServer&&t===this.extensionManagementServerService.localExtensionManagementServer)return void(this.extensionManifestPropertiesService.prefersExecuteOnUI(this.extension.local.manifest)&&this.updateStatus({icon:Lt.DJ,message:new Mt.W5(`${(0,p.NC)("enabled locally","This extension is enabled in the Local Extension Host because it prefers to run there.")} [${(0,p.NC)("learn more","Learn More")}](https://aka.ms/vscode-remote/developing-extensions/architecture)`)},!0));if(this.extension.server===this.extensionManagementServerService.remoteExtensionManagementServer&&t===this.extensionManagementServerService.webExtensionManagementServer)return void(this.extensionManifestPropertiesService.canExecuteOnWeb(this.extension.local.manifest)&&this.updateStatus({icon:Lt.DJ,message:new Mt.W5(`${(0,p.NC)("enabled in web worker","This extension is enabled in the Web Worker Extension Host because it prefers to run there.")} [${(0,p.NC)("learn more","Learn More")}](https://aka.ms/vscode-remote/developing-extensions/architecture)`)},!0))}if(5===this.extension.enablementState)return void this.updateStatus({icon:Lt.tO,message:new Mt.W5((0,p.NC)("extension disabled because of dependency","This extension has been disabled because it depends on an extension that is disabled."))},!0);const e=this.workbenchExtensionEnablementService.isEnabled(this.extension.local),t=this.extensionService.extensions.some((e=>(0,vt.Q_)({id:e.identifier.value,uuid:e.uuid},this.extension.identifier)));if(e&&t){if(this.extensionManagementServerService.localExtensionManagementServer&&this.extensionManagementServerService.remoteExtensionManagementServer&&this.extension.server===this.extensionManagementServerService.remoteExtensionManagementServer)return void this.updateStatus({message:new Mt.W5((0,p.NC)("extension enabled on remote","Extension is enabled on '{0}'",this.extension.server.label))},!0);if(8===this.extension.enablementState)return void this.updateStatus({message:new Mt.W5((0,p.NC)("globally enabled","This extension is enabled globally."))},!0);if(9===this.extension.enablementState)return void this.updateStatus({message:new Mt.W5((0,p.NC)("workspace enabled","This extension is enabled for this workspace by the user."))},!0)}if(!e&&!t){if(6===this.extension.enablementState)return void this.updateStatus({message:new Mt.W5((0,p.NC)("globally disabled","This extension is disabled globally by the user."))},!0);if(7===this.extension.enablementState)return void this.updateStatus({message:new Mt.W5((0,p.NC)("workspace disabled","This extension is disabled for this workspace by the user."))},!0)}if(e&&!t&&!this.extension.local.isValid){const e=this.extension.local.validations.filter((([e])=>e===w.zb.Error)).map((([,e])=>e));this.updateStatus({icon:Lt.mb,message:new Mt.W5(e.join(" ").trim())},!0)}}updateStatus(t,i){this._status!==t&&(this._status&&t&&this._status.message===t.message&&this._status.icon?.id===t.icon?.id||(this._status=t,i&&(this._status?.icon===Lt.mb?this.class=`${e.CLASS} extension-status-error ${D.kS.asClassName(Lt.mb)}`:this._status?.icon===Lt.tO?this.class=`${e.CLASS} extension-status-warning ${D.kS.asClassName(Lt.tO)}`:this._status?.icon===Lt.DJ?this.class=`${e.CLASS} extension-status-info ${D.kS.asClassName(Lt.DJ)}`:this._status?.icon===Lt.$m?this.class=`${e.CLASS} ${D.kS.asClassName(Lt.$m)}`:this.class=`${e.CLASS} hide`),this._onDidChangeStatus.fire()))}async run(){if(this._status?.icon===Lt.$m)return this.commandService.executeCommand("workbench.trust.manage")}},class e extends P.aU{static{this.ID="workbench.extensions.action.reinstall"}static{this.LABEL=(0,p.NC)("reinstall","Reinstall Extension...")}constructor(t=e.ID,i=e.LABEL,n,s,r,o,a,c,l){super(t,i),this.extensionsWorkbenchService=n,this.extensionManagementServerService=s,this.quickInputService=r,this.notificationService=o,this.hostService=a,this.instantiationService=c,this.extensionService=l}get enabled(){return this.extensionsWorkbenchService.local.filter((e=>!e.isBuiltin&&e.local)).length>0}run(){return this.quickInputService.pick(this.getEntries(),{placeHolder:(0,p.NC)("selectExtensionToReinstall","Select Extension to Reinstall")}).then((e=>e&&this.reinstallExtension(e.extension)))}getEntries(){return this.extensionsWorkbenchService.queryLocal().then((e=>e.filter((e=>!e.isBuiltin&&e.server!==this.extensionManagementServerService.webExtensionManagementServer)).map((e=>({id:e.identifier.id,label:e.displayName,description:e.identifier.id,extension:e})))))}reinstallExtension(e){return this.instantiationService.createInstance(li,"@installed ").run().then((()=>this.extensionsWorkbenchService.reinstall(e).then((e=>{const t=!(e.local&&this.extensionService.canAddExtension((0,St.Br)(e.local))),i=t?(0,p.NC)("ReinstallAction.successReload","Please reload Visual Studio Code to complete reinstalling the extension {0}.",e.identifier.id):(0,p.NC)("ReinstallAction.success","Reinstalling the extension {0} is completed.",e.identifier.id),n=t?[{label:(0,p.NC)("InstallVSIXAction.reloadNow","Reload Now"),run:()=>this.hostService.reload()}]:[];this.notificationService.prompt(w.zb.Info,i,n,{sticky:!0})}),(e=>this.notificationService.error(e)))))}},class e extends P.aU{static{this.ID="workbench.extensions.action.install.specificVersion"}static{this.LABEL=(0,p.NC)("install previous version","Install Specific Version of Extension...")}constructor(t=e.ID,i=e.LABEL,n,s,r,o){super(t,i),this.extensionsWorkbenchService=n,this.quickInputService=s,this.instantiationService=r,this.extensionEnablementService=o}get enabled(){return this.extensionsWorkbenchService.local.some((e=>this.isEnabled(e)))}async run(){const e=await this.quickInputService.pick(this.getExtensionEntries(),{placeHolder:(0,p.NC)("selectExtension","Select Extension"),matchOnDetail:!0});if(e&&e.extension){const t=this.instantiationService.createInstance(Yt);t.extension=e.extension,await t.run(),await this.instantiationService.createInstance(li,e.extension.identifier.id).run()}}isEnabled(e){const t=this.instantiationService.createInstance(Yt);return t.extension=e,t.enabled&&!!e.local&&this.extensionEnablementService.isEnabled(e.local)}async getExtensionEntries(){const e=await this.extensionsWorkbenchService.queryLocal(),t=[];for(const i of e)this.isEnabled(i)&&t.push({id:i.identifier.id,label:i.displayName||i.identifier.id,description:i.identifier.id,extension:i});return t.sort(((e,t)=>e.extension.displayName.localeCompare(t.extension.displayName)))}},f.P.registerCommand("workbench.extensions.action.showExtensionsForLanguage",(function(e,t){return e.get(Bt.c).openPaneComposite(mt.f3,0,!0).then((e=>e?.getViewPaneContainer())).then((e=>{e.search(`ext:${t.replace(/^\./,"")}`),e.focus()}))})),f.P.registerCommand("workbench.extensions.action.showExtensionsWithIds",(function(e,t){return e.get(Bt.c).openPaneComposite(mt.f3,0,!0).then((e=>e?.getViewPaneContainer())).then((e=>{const i=t.map((e=>`@id:${e}`)).join(" ");e.search(i),e.focus()}))})),(0,y.P6G)("extensionButton.background",{dark:y.b7$,light:y.b7$,hcDark:null,hcLight:null},(0,p.NC)("extensionButtonBackground","Button background color for extension actions.")),(0,y.P6G)("extensionButton.foreground",{dark:y.j5u,light:y.j5u,hcDark:null,hcLight:null},(0,p.NC)("extensionButtonForeground","Button foreground color for extension actions.")),(0,y.P6G)("extensionButton.hoverBackground",{dark:y.GO4,light:y.GO4,hcDark:null,hcLight:null},(0,p.NC)("extensionButtonHoverBackground","Button background hover color for extension actions.")),(0,y.P6G)("extensionButton.separator",{dark:y.iFQ,light:y.iFQ,hcDark:y.iFQ,hcLight:y.iFQ},(0,p.NC)("extensionButtonSeparator","Button separator color for extension actions")),(0,y.P6G)("extensionButton.prominentBackground",{dark:y.b7$,light:y.b7$,hcDark:null,hcLight:null},(0,p.NC)("extensionButtonProminentBackground","Button background color for extension actions that stand out (e.g. install button).")),(0,y.P6G)("extensionButton.prominentForeground",{dark:y.j5u,light:y.j5u,hcDark:null,hcLight:null},(0,p.NC)("extensionButtonProminentForeground","Button foreground color for extension actions that stand out (e.g. install button).")),(0,y.P6G)("extensionButton.prominentHoverBackground",{dark:y.GO4,light:y.GO4,hcDark:null,hcLight:null},(0,p.NC)("extensionButtonProminentHoverBackground","Button background hover color for extension actions that stand out (e.g. install button).")),(0,I.Ic)(((e,t)=>{const i=e.getColor(y.lXJ);i&&(t.addRule(`.extension-editor .header .actions-status-container > .status ${D.kS.asCSSSelector(Lt.mb)} { color: ${i}; }`),t.addRule(`.extension-editor .body .subcontent .runtime-status ${D.kS.asCSSSelector(Lt.mb)} { color: ${i}; }`),t.addRule(`.monaco-hover.extension-hover .markdown-hover .hover-contents ${D.kS.asCSSSelector(Lt.mb)} { color: ${i}; }`));const n=e.getColor(y.uoC);n&&(t.addRule(`.extension-editor .header .actions-status-container > .status ${D.kS.asCSSSelector(Lt.tO)} { color: ${n}; }`),t.addRule(`.extension-editor .body .subcontent .runtime-status ${D.kS.asCSSSelector(Lt.tO)} { color: ${n}; }`),t.addRule(`.monaco-hover.extension-hover .markdown-hover .hover-contents ${D.kS.asCSSSelector(Lt.tO)} { color: ${n}; }`));const s=e.getColor(y.c63);s&&(t.addRule(`.extension-editor .header .actions-status-container > .status ${D.kS.asCSSSelector(Lt.DJ)} { color: ${s}; }`),t.addRule(`.extension-editor .body .subcontent .runtime-status ${D.kS.asCSSSelector(Lt.DJ)} { color: ${s}; }`),t.addRule(`.monaco-hover.extension-hover .markdown-hover .hover-contents ${D.kS.asCSSSelector(Lt.DJ)} { color: ${s}; }`))}));let di=class{get onConfigChanged(){return this._onConfigChanged.event}constructor(e,t,i,n,s){this._configurationService=e,this._extensionManagementService=t,this._notificationService=i,this._instantiationService=n,this._productService=s,this._linuxDistro=1,this._onConfigChanged=new d.Q5,this._recommendationsShown=!1,this._updateConfig(),this._configurationService.onDidChangeConfiguration((e=>{e.affectsConfiguration(r.H$)&&this._updateConfig()})),_.IJ&&(navigator.userAgent.includes("Ubuntu")?this._linuxDistro=3:navigator.userAgent.includes("Fedora")&&(this._linuxDistro=2))}_updateConfig(){const e=this._configurationService.getValue(r.H$);e.fontWeight=this._normalizeFontWeight(e.fontWeight,r.P3),e.fontWeightBold=this._normalizeFontWeight(e.fontWeightBold,r.rS),this.config=e,this._onConfigChanged.fire()}configFontIsMonospace(){const e=this.config.fontFamily||this._configurationService.getValue("editor").fontFamily||at.hL.fontFamily,t=this._getBoundingRectFor("i",e,15),i=this._getBoundingRectFor("w",e,15);return!(t&&i&&t.width&&i.width)||t.width===i.width}_createCharMeasureElementIfNecessary(){if(!this.panelContainer)throw new Error("Cannot measure element when terminal is not attached");return this._charMeasureElement&&this._charMeasureElement.parentElement||(this._charMeasureElement=document.createElement("div"),this.panelContainer.appendChild(this._charMeasureElement)),this._charMeasureElement}_getBoundingRectFor(e,t,i){let n;try{n=this._createCharMeasureElementIfNecessary()}catch{return}const s=n.style;s.display="inline-block",s.fontFamily=t,s.fontSize=i+"px",s.lineHeight="normal",n.innerText=e;const r=n.getBoundingClientRect();return s.display="none",r}_measureFont(e,t,i,n){const s=this._getBoundingRectFor("X",e,t);if(this._lastFontMeasurement&&(!s||!s.width||!s.height))return this._lastFontMeasurement;if(this._lastFontMeasurement={fontFamily:e,fontSize:t,letterSpacing:i,lineHeight:n,charWidth:0,charHeight:0},s&&s.width&&s.height)if(this._lastFontMeasurement.charHeight=Math.ceil(s.height),"off"===this.config.gpuAcceleration)this._lastFontMeasurement.charWidth=s.width;else{const e=(Math.floor(s.width*window.devicePixelRatio)+Math.round(i))/window.devicePixelRatio;this._lastFontMeasurement.charWidth=e-Math.round(i)/window.devicePixelRatio}return this._lastFontMeasurement}getFont(e,t){const i=this._configurationService.getValue("editor");let n=this.config.fontFamily||i.fontFamily||at.hL.fontFamily,s=this._clampInt(this.config.fontSize,6,100,at.hL.fontSize);this.config.fontFamily||(2===this._linuxDistro&&(n="'DejaVu Sans Mono'"),3===this._linuxDistro&&(n="'Ubuntu Mono'",s=this._clampInt(s+2,6,100,at.hL.fontSize))),n+=", monospace";const o=this.config.letterSpacing?Math.max(Math.floor(this.config.letterSpacing),r.f):r.dd,a=this.config.lineHeight?Math.max(this.config.lineHeight,1):r.fr;return t?{fontFamily:n,fontSize:s,letterSpacing:o,lineHeight:a}:e&&e._renderService&&e._renderService.dimensions?.css.cell.width&&e._renderService.dimensions?.css.cell.height?{fontFamily:n,fontSize:s,letterSpacing:o,lineHeight:a,charHeight:e._renderService.dimensions.css.cell.height/a,charWidth:e._renderService.dimensions.css.cell.width-Math.round(o)/window.devicePixelRatio}:this._measureFont(n,s,o,a)}_clampInt(e,t,i,n){let s=parseInt(e,10);return isNaN(s)?n:("number"==typeof t&&(s=Math.max(t,s)),"number"==typeof i&&(s=Math.min(i,s)),s)}async showRecommendations(e){if(!this._recommendationsShown&&(this._recommendationsShown=!0,_.ED&&e.executable&&"wsl.exe"===(0,Se.EZ)(e.executable).toLowerCase())){const e=this._productService.exeBasedExtensionTips;if(!e||!e.wsl)return;const t=Object.keys(e.wsl.recommendations).find((t=>e.wsl.recommendations[t].important));t&&!await this._isExtensionInstalled(t)&&this._notificationService.prompt(ct.Z.Info,p.NC("useWslExtension.title","The '{0}' extension is recommended for opening a terminal in WSL.",e.wsl.friendlyName),[{label:p.NC("install","Install"),run:()=>{this._instantiationService.createInstance(ci,t).run()}}],{sticky:!0,neverShowAgain:{id:"terminalConfigHelper/launchRecommendationsIgnore",scope:w.YB.APPLICATION},onCancel:()=>{}})}}async _isExtensionInstalled(e){return(await this._extensionManagementService.getInstalled()).some((t=>t.identifier.id===e))}_normalizeFontWeight(e,t){return"normal"===e||"bold"===e?e:this._clampInt(e,r.fc,r.ig,t)}};di=(0,a.g)([(0,a.f)(0,v.Ui),(0,a.f)(1,lt.J6),(0,a.f)(2,w.lT),(0,a.f)(3,S.TG),(0,a.f)(4,It.a)],di);var ui=i(97368);let mi=class{constructor(e,t,i,n,s,r){this._terminalProfileService=e,this._terminalProfileResolverService=t,this._configurationService=i,this._quickInputService=n,this._themeService=s,this._notificationService=r}async showAndGetResult(e){const t=await this._terminalProfileService.getPlatformKey(),i="terminal.integrated.profiles."+t,n=await this._createAndShow(e),s=`terminal.integrated.defaultProfile.${t}`;if(n){if("setDefault"===e){if("command"in n.profile)return;if("id"in n.profile)return await this._configurationService.updateValue(s,n.profile.title,2),{config:{extensionIdentifier:n.profile.extensionIdentifier,id:n.profile.id,title:n.profile.title,options:{color:n.profile.color,icon:n.profile.icon}},keyMods:n.keyMods};if("isAutoDetected"in n.profile){const e=await this._configurationService.getValue(i);if("object"==typeof e){const t={path:n.profile.path};n.profile.args&&(t.args=n.profile.args),e[n.profile.profileName]=t}await this._configurationService.updateValue(i,e,2)}await this._configurationService.updateValue(s,n.profileName,2)}else if("createInstance"===e)return"id"in n.profile?{config:{extensionIdentifier:n.profile.extensionIdentifier,id:n.profile.id,title:n.profile.title,options:{icon:n.profile.icon,color:n.profile.color}},keyMods:n.keyMods}:{config:n.profile,keyMods:n.keyMods};return"profileName"in n.profile?n.profile.profileName:n.profile.title}}async _createAndShow(e){const t=await this._terminalProfileService.getPlatformKey(),i=this._terminalProfileService.availableProfiles,n="terminal.integrated.profiles."+t,s=this._terminalProfileService.getDefaultProfileName();let r;const o={placeHolder:"createInstance"===e?p.NC("terminal.integrated.selectProfileToCreate","Select the terminal profile to create"):p.NC("terminal.integrated.chooseDefaultProfile","Select your default terminal profile"),onDidTriggerItemButton:async e=>{if(!await this._isProfileSafe(e.item.profile))return;if("command"in e.item.profile)return;if("id"in e.item.profile)return;const i=this._configurationService.getValue("terminal.integrated.profiles."+t),s=i?Object.keys(i):[],r=await this._quickInputService.input({prompt:p.NC("enterTerminalProfileName","Enter terminal profile name"),value:e.item.profile.profileName,validateInput:async e=>{if(s.includes(e))return p.NC("terminalProfileAlreadyExists","A terminal profile already exists with that name")}});if(!r)return;const o={...i};o[r]={path:e.item.profile.path,args:e.item.profile.args},await this._configurationService.updateValue(n,o,2)},onKeyMods:e=>r=e},a=[],c=i.filter((e=>!e.isAutoDetected)),l=i.filter((e=>e.isAutoDetected));c.length>0&&(a.push({type:"separator",label:p.NC("terminalProfiles","profiles")}),a.push(...this._sortProfileQuickPickItems(c.map((e=>this._createProfileQuickPickItem(e))),s))),a.push({type:"separator",label:p.NC("ICreateContributedTerminalProfileOptions","contributed")});const h=[];for(const e of this._terminalProfileService.contributedProfiles){let t;"string"==typeof e.icon&&(t=e.icon.startsWith("$(")?D.kS.fromString(e.icon):D.kS.fromId(e.icon)),t&&(0,x.Ks)().getIcon(t.id)||(t=this._terminalProfileResolverService.getDefaultIcon());const i=(0,re.A5)(e,this._themeService.getColorTheme().type,!0),n=(0,re.pv)(e),s=[];i&&s.push(...i),n&&s.push(n),h.push({label:`$(${t.id}) ${e.title}`,profile:{extensionIdentifier:e.extensionIdentifier,title:e.title,icon:e.icon,id:e.id,color:e.color},profileName:e.title,iconClasses:s})}h.length>0&&a.push(...this._sortProfileQuickPickItems(h,s)),l.length>0&&(a.push({type:"separator",label:p.NC("terminalProfiles.detected","detected")}),a.push(...this._sortProfileQuickPickItems(l.map((e=>this._createProfileQuickPickItem(e))),s)));const d=(0,re.m5)(this._themeService.getColorTheme());document.body.appendChild(d);const u=await this._quickInputService.pick(a,o);if(document.body.removeChild(d),u&&await this._isProfileSafe(u.profile))return r&&(u.keyMods=r),u}async _isProfileSafe(e){const t="isUnsafePath"in e&&e.isUnsafePath,i="requiresUnsafePath"in e&&e.requiresUnsafePath;return!t&&!i||await new Promise((n=>{const s=[];t&&s.push(e.path),i&&s.push(i),this._notificationService.prompt(w.zb.Warning,p.NC("unsafePathWarning","This terminal profile uses a potentially unsafe path that can be modified by another user: {0}. Are you sure you want to use it?",`"${s.join(",")}"`),[{label:p.NC("yes","Yes"),run:()=>n(!0)},{label:p.NC("cancel","Cancel"),run:()=>n(!1)}]).onDidClose((()=>n(!1)))}))}_createProfileQuickPickItem(e){const t=[{iconClass:D.kS.asClassName(J),tooltip:p.NC("createQuickLaunchProfile","Configure Terminal Profile")}],i=`$(${(e.icon&&D.kS.isThemeIcon(e.icon)?e.icon:R.lA.terminal).id}) ${e.profileName}`,n=e.isFromPath?(0,Se.EZ)(e.path):e.path,s=(0,re.pv)(e),r=[];return s&&r.push(s),e.args?"string"==typeof e.args?{label:i,description:`${e.path} ${e.args}`,profile:e,profileName:e.profileName,buttons:t,iconClasses:r}:{label:i,description:`${n} ${e.args.map((e=>e.includes(" ")?`"${e.replace(/"/g,'\\"')}"`:e)).join(" ")}`,profile:e,profileName:e.profileName,buttons:t,iconClasses:r}:{label:i,description:n,profile:e,profileName:e.profileName,buttons:t,iconClasses:r}}_sortProfileQuickPickItems(e,t){return e.sort(((e,i)=>i.profileName===t?1:e.profileName===t?-1:e.profileName.localeCompare(i.profileName)))}};function _i(e){const[,t,i]=e.path.split("/");if(!t||!Number.parseInt(i))throw new Error(`Could not parse terminal uri for resource ${e}`);return{workspaceId:t,instanceId:Number.parseInt(i)}}function gi(e,t,i){return g.ov.from({scheme:m.lg.vscodeTerminal,path:`/${e}/${t}`,fragment:i||void 0})}function pi(e){const t=e.dataTransfer?.getData("Terminals");if(t){const e=JSON.parse(t),i=[];for(const t of e)i.push(g.ov.parse(t));return 0===i.length?void 0:i}}function fi(e,t){if(t)for(const i of e)if(i.resource.path===t.path)return i}mi=(0,a.g)([(0,a.f)(0,r.l5),(0,a.f)(1,r.if),(0,a.f)(2,v.Ui),(0,a.f)(3,$.eJ),(0,a.f)(4,I.XE),(0,a.f)(5,w.lT)],mi);var vi,bi=i(48341),Si=i(22384),wi=i(16268),Ci=i(9488),yi=i(61036);!function(e){e[e.Top=0]="Top",e[e.Bottom=1]="Bottom"}(vi||(vi={}));let xi=class extends u.JT{activate(e){this._terminal=e,this._register(this._terminal.onData((()=>{this._currentMarker=vi.Bottom})))}constructor(e,t){super(),this._capabilities=e,this._themeService=t,this._currentMarker=vi.Bottom,this._selectionStart=null,this._isDisposable=!1}_getMarkers(e){const t=this._capabilities.get(2),i=this._capabilities.get(3),n=this._capabilities.get(4);let s=[];if(t?s=(0,Ci.kX)(t.commands.map((e=>e.marker))):i&&s.push(...i.commands),n&&!e){let e=n.markers().next()?.value;const t=[];for(;e;)t.push(e),e=n.markers().next()?.value;s=t}return s}clearMarker(){this._currentMarker=vi.Bottom,this._resetNavigationDecorations(),this._selectionStart=null}_resetNavigationDecorations(){this._navigationDecorations&&(0,u.B9)(this._navigationDecorations),this._navigationDecorations=[]}_isEmptyCommand(e){return e===vi.Bottom||(e===vi.Top?!this._getMarkers(!0).map((e=>e.line)).includes(0):!this._getMarkers(!0).includes(e))}scrollToPreviousMark(e=1,t=!1,i=!1){if(!this._terminal)return;let n;t||(this._selectionStart=null);const s="object"==typeof this._currentMarker?this._getTargetScrollLine(this._terminal,this._currentMarker,e):Math.min(ki(this._terminal,this._currentMarker),this._terminal.buffer.active.baseY),r=this._terminal.buffer.active.viewportY;if("object"==typeof this._currentMarker?this._isMarkerInViewport(this._terminal,this._currentMarker):s===r)this._currentMarker===vi.Bottom?n=this._getMarkers(i).length-1:this._currentMarker===vi.Top?n=-1:this._isDisposable?(n=this._findPreviousMarker(this._terminal,i),this._currentMarker.dispose(),this._isDisposable=!1):n=i&&this._isEmptyCommand(this._currentMarker)?this._findPreviousMarker(this._terminal,!0):this._getMarkers(i).indexOf(this._currentMarker)-1;else{const e=this._getMarkers(i).filter((e=>e.line>=r)).length;n=this._getMarkers(i).length-e-1}if(n<0)return this._currentMarker=vi.Top,this._terminal.scrollToTop(),void this._resetNavigationDecorations();this._currentMarker=this._getMarkers(i)[n],this._scrollToMarker(this._currentMarker,e)}scrollToNextMark(e=1,t=!1,i=!0){if(!this._terminal)return;let n;t||(this._selectionStart=null);const s="object"==typeof this._currentMarker?this._getTargetScrollLine(this._terminal,this._currentMarker,e):Math.min(ki(this._terminal,this._currentMarker),this._terminal.buffer.active.baseY),r=this._terminal.buffer.active.viewportY;if(("object"==typeof this._currentMarker?this._isMarkerInViewport(this._terminal,this._currentMarker):s===r)?this._currentMarker===vi.Bottom?n=this._getMarkers(i).length:this._currentMarker===vi.Top?n=0:this._isDisposable?(n=this._findNextMarker(this._terminal,i),this._currentMarker.dispose(),this._isDisposable=!1):n=i&&this._isEmptyCommand(this._currentMarker)?this._findNextMarker(this._terminal,!0):this._getMarkers(i).indexOf(this._currentMarker)+1:n=this._getMarkers(i).filter((e=>e.line<=r)).length,n>=this._getMarkers(i).length)return this._currentMarker=vi.Bottom,this._terminal.scrollToBottom(),void this._resetNavigationDecorations();this._currentMarker=this._getMarkers(i)[n],this._scrollToMarker(this._currentMarker,e)}_scrollToMarker(e,t,i,n){if(this._terminal){if(!this._isMarkerInViewport(this._terminal,e)){const i=this._getTargetScrollLine(this._terminal,e,t);this._terminal.scrollToLine(i)}n||this._registerTemporaryDecoration(e,i)}}_createMarkerForOffset(e,t){if(0===t)return e;{const i=this._terminal?.registerMarker(-this._terminal.buffer.active.cursorY+e.line-this._terminal.buffer.active.baseY+t);if(i)return i;throw new Error(`Could not register marker with offset ${e.line}, ${t}`)}}_registerTemporaryDecoration(e,t){if(!this._terminal)return;this._resetNavigationDecorations();const i=this._themeService.getColorTheme().getColor(yi.Qh),n=e.line,s=t?t.line-n+1:1;for(let t=0;t<s;t++){const n=this._terminal.registerDecoration({marker:this._createMarkerForOffset(e,t),width:this._terminal.cols,overviewRulerOptions:{color:i?.toString()||"#a0a0a0cc"}});if(n){let e;this._navigationDecorations?.push(n),n.onRender((t=>{e||(e=t,s>1?t.classList.add("terminal-scroll-highlight"):t.classList.add("terminal-scroll-highlight","terminal-scroll-highlight-outline"),this._terminal?.element&&(t.style.marginLeft=`-${getComputedStyle(this._terminal.element).paddingLeft}`))})),n.onDispose((()=>{this._navigationDecorations=this._navigationDecorations?.filter((e=>e!==n))})),(0,l.Vs)(350).then((()=>{e&&e.classList.remove("terminal-scroll-highlight-outline")}))}}}_getTargetScrollLine(e,t,i){return 1===i?Math.max(t.line-Math.floor(e.rows/4),0):t.line}_isMarkerInViewport(e,t){const i=e.buffer.active.viewportY;return t.line>=i&&t.line<i+e.rows}scrollToClosestMarker(e,t,i){const n=this._capabilities.get(4);if(!n)return;const s=n.getMark(e);if(!s)return;const r=t?n.getMark(t):s;this._scrollToMarker(s,0,r,!i)}selectToPreviousMark(){this._terminal&&(null===this._selectionStart&&(this._selectionStart=this._currentMarker),this._capabilities.has(2)?this.scrollToPreviousMark(1,!0,!0):this.scrollToPreviousMark(1,!0,!1),Ii(this._terminal,this._currentMarker,this._selectionStart))}selectToNextMark(){this._terminal&&(null===this._selectionStart&&(this._selectionStart=this._currentMarker),this._capabilities.has(2)?this.scrollToNextMark(1,!0,!0):this.scrollToNextMark(1,!0,!1),Ii(this._terminal,this._currentMarker,this._selectionStart))}selectToPreviousLine(){this._terminal&&(null===this._selectionStart&&(this._selectionStart=this._currentMarker),this.scrollToPreviousLine(this._terminal,1,!0),Ii(this._terminal,this._currentMarker,this._selectionStart))}selectToNextLine(){this._terminal&&(null===this._selectionStart&&(this._selectionStart=this._currentMarker),this.scrollToNextLine(this._terminal,1,!0),Ii(this._terminal,this._currentMarker,this._selectionStart))}scrollToPreviousLine(e,t=1,i=!1){if(i||(this._selectionStart=null),this._currentMarker!==vi.Top){if(this._currentMarker===vi.Bottom)this._currentMarker=this._registerMarkerOrThrow(e,this._getOffset(e)-1);else{const t=this._getOffset(e);this._isDisposable&&this._currentMarker.dispose(),this._currentMarker=this._registerMarkerOrThrow(e,t-1)}this._isDisposable=!0,this._scrollToMarker(this._currentMarker,t)}else e.scrollToTop()}scrollToNextLine(e,t=1,i=!1){if(i||(this._selectionStart=null),this._currentMarker!==vi.Bottom){if(this._currentMarker===vi.Top)this._currentMarker=this._registerMarkerOrThrow(e,this._getOffset(e)+1);else{const t=this._getOffset(e);this._isDisposable&&this._currentMarker.dispose(),this._currentMarker=this._registerMarkerOrThrow(e,t+1)}this._isDisposable=!0,this._scrollToMarker(this._currentMarker,t)}else e.scrollToBottom()}_registerMarkerOrThrow(e,t){const i=e.registerMarker(t);if(!i)throw new Error(`Could not create marker for ${t}`);return i}_getOffset(e){if(this._currentMarker===vi.Bottom)return 0;if(this._currentMarker===vi.Top)return 0-(e.buffer.active.baseY+e.buffer.active.cursorY);{let t=ki(e,this._currentMarker);return t-=e.buffer.active.baseY+e.buffer.active.cursorY,t}}_findPreviousMarker(e,t=!1){if(this._currentMarker===vi.Top)return 0;if(this._currentMarker===vi.Bottom)return this._getMarkers(t).length-1;let i;for(i=this._getMarkers(t).length-1;i>=0;i--)if(this._getMarkers(t)[i].line<this._currentMarker.line)return i;return-1}_findNextMarker(e,t=!1){if(this._currentMarker===vi.Top)return 0;if(this._currentMarker===vi.Bottom)return this._getMarkers(t).length-1;let i;for(i=0;i<this._getMarkers(t).length;i++)if(this._getMarkers(t)[i].line>this._currentMarker.line)return i;return this._getMarkers(t).length}};function ki(e,t){return t===vi.Bottom?e.buffer.active.baseY+e.rows-1:t===vi.Top?0:t.line}function Ii(e,t,i){null===i&&(i=vi.Bottom);let n=ki(e,t),s=ki(e,i);if(n>s){const e=n;n=s,s=e}s-=1,e.selectLines(n,s)}xi=(0,a.g)([(0,a.f)(1,I.XE)],xi);var Di=i(88550);class Ti extends u.JT{constructor(){super(...arguments),this._map=new Map,this._onDidRemoveCapability=this._register(new d.Q5),this.onDidRemoveCapability=this._onDidRemoveCapability.event,this._onDidAddCapability=this._register(new d.Q5),this.onDidAddCapability=this._onDidAddCapability.event}get items(){return this._map.keys()}add(e,t){this._map.set(e,t),this._onDidAddCapability.fire(e)}get(e){return this._map.get(e)}remove(e){this._map.has(e)&&(this._map.delete(e),this._onDidRemoveCapability.fire(e))}has(e){return this._map.has(e)}}class Ei extends u.JT{constructor(){super(...arguments),this._stores=[],this._onDidRemoveCapability=this._register(new d.Q5),this.onDidRemoveCapability=this._onDidRemoveCapability.event,this._onDidAddCapability=this._register(new d.Q5),this.onDidAddCapability=this._onDidAddCapability.event}get items(){return this._items()}*_items(){for(const e of this._stores)for(const t of e.items)yield t}has(e){for(const t of this._stores)for(const i of t.items)if(i===e)return!0;return!1}get(e){for(const t of this._stores){const i=t.get(e);if(i)return i}}add(e){this._stores.push(e);for(const t of e.items)this._onDidAddCapability.fire(t);e.onDidAddCapability((e=>this._onDidAddCapability.fire(e))),e.onDidRemoveCapability((e=>this._onDidRemoveCapability.fire(e)))}}class Ai{get commands(){return this._commands}get executingCommand(){return this._currentCommand.command}get executingCommandObject(){if(this._currentCommand.commandStartMarker)return{marker:this._currentCommand.commandStartMarker}}get cwd(){return this._cwd}get _isInputting(){return!(!this._currentCommand.commandStartMarker||this._currentCommand.commandExecutedMarker)}get hasInput(){if(this._isInputting&&this._currentCommand?.commandStartMarker){if(this._terminal.buffer.active.baseY+this._terminal.buffer.active.cursorY===this._currentCommand.commandStartMarker?.line){const e=this._terminal.buffer.active.getLine(this._terminal.buffer.active.cursorY)?.translateToString(!0,this._currentCommand.commandStartX);if(void 0===e)return;return e.length>0}return!0}}constructor(e,t){this._terminal=e,this._logService=t,this.type=2,this._commands=[],this._currentCommand={},this._isWindowsPty=!1,this._commandMarkers=[],this.__isCommandStorageDisabled=!1,this._onCommandStarted=new d.Q5,this.onCommandStarted=this._onCommandStarted.event,this._onBeforeCommandFinished=new d.Q5,this.onBeforeCommandFinished=this._onBeforeCommandFinished.event,this._onCommandFinished=new d.Q5,this.onCommandFinished=this._onCommandFinished.event,this._onCommandExecuted=new d.Q5,this.onCommandExecuted=this._onCommandExecuted.event,this._onCommandInvalidated=new d.Q5,this.onCommandInvalidated=this._onCommandInvalidated.event,this._onCurrentCommandInvalidated=new d.Q5,this.onCurrentCommandInvalidated=this._onCurrentCommandInvalidated.event,this._dimensions={cols:this._terminal.cols,rows:this._terminal.rows},this._terminal.onResize((e=>this._handleResize(e))),this._terminal.onCursorMove((()=>this._handleCursorMove())),this._setupClearListeners()}_handleResize(e){this._isWindowsPty&&this._preHandleResizeWindows(e),this._dimensions.cols=e.cols,this._dimensions.rows=e.rows}_handleCursorMove(){this._terminal.buffer.active===this._terminal.buffer.normal&&this._currentCommand.commandStartMarker&&this._terminal.buffer.active.baseY+this._terminal.buffer.active.cursorY<this._currentCommand.commandStartMarker.line&&(this._clearCommandsInViewport(),this._currentCommand.isInvalid=!0,this._onCurrentCommandInvalidated.fire({reason:"windows"}))}_setupClearListeners(){this.onBeforeCommandFinished((e=>{this._isWindowsPty&&("clear"!==e.command.trim().toLowerCase()&&"cls"!==e.command.trim().toLowerCase()||(this._clearCommandsInViewport(),this._currentCommand.isInvalid=!0,this._onCurrentCommandInvalidated.fire({reason:"windows"})))})),this._terminal.parser.registerCsiHandler({final:"J"},(e=>(this._isWindowsPty||e.length>=1&&(2===e[0]||3===e[0])&&this._clearCommandsInViewport(),!1)))}_preHandleResizeWindows(e){const t=this._terminal.buffer.active.baseY,i=e.rows-this._dimensions.rows;i>0&&this._waitForCursorMove().then((()=>{const e=Math.min(i,t);for(let i=this.commands.length-1;i>=0;i--){const n=this.commands[i];if(!n.marker||n.marker.line<t||void 0===n.commandStartLineContent)break;const s=this._terminal.buffer.active.getLine(n.marker.line);if(!s||s.translateToString(!0)===n.commandStartLineContent)continue;const r=n.marker.line-e,o=this._terminal.buffer.active.getLine(r);o?.translateToString(!0)===n.commandStartLineContent&&this._terminal._core._bufferService.buffer.lines.onDeleteEmitter.fire({index:this._terminal.buffer.active.baseY,amount:e})}}))}_clearCommandsInViewport(){let e=0;for(let t=this._commands.length-1;t>=0;t--){const i=this._commands[t].marker?.line;if(i&&i<this._terminal.buffer.active.baseY)break;e++}e>0&&this._onCommandInvalidated.fire(this._commands.splice(this._commands.length-e,e))}_waitForCursorMove(){const e=this._terminal.buffer.active.cursorX,t=this._terminal.buffer.active.cursorY;let i=0;return new Promise(((n,s)=>{const r=setInterval((()=>{if(e!==this._terminal.buffer.active.cursorX||t!==this._terminal.buffer.active.cursorY)return n(),void clearInterval(r);i+=10,i>1e3&&(clearInterval(r),n())}),10)}))}setCwd(e){this._cwd=e}setIsWindowsPty(e){this._isWindowsPty=e}setIsCommandStorageDisabled(){this.__isCommandStorageDisabled=!0}getCwdForLine(e){if(this._currentCommand.promptStartMarker&&e>=this._currentCommand.promptStartMarker?.line)return this._cwd;const t=[...this._commands].reverse();return t.find((t=>t.marker.line<=e-1))?.cwd}handlePromptStart(e){this._currentCommand.promptStartMarker=e?.marker||this._terminal.registerMarker(0),this._logService.debug("CommandDetectionCapability#handlePromptStart",this._terminal.buffer.active.cursorX,this._currentCommand.promptStartMarker?.line)}handleContinuationStart(){this._currentCommand.currentContinuationMarker=this._terminal.registerMarker(0),this._logService.debug("CommandDetectionCapability#handleContinuationStart",this._currentCommand.currentContinuationMarker)}handleContinuationEnd(){this._currentCommand.currentContinuationMarker?(this._currentCommand.continuations||(this._currentCommand.continuations=[]),this._currentCommand.continuations.push({marker:this._currentCommand.currentContinuationMarker,end:this._terminal.buffer.active.cursorX}),this._currentCommand.currentContinuationMarker=void 0,this._logService.debug("CommandDetectionCapability#handleContinuationEnd",this._currentCommand.continuations[this._currentCommand.continuations.length-1])):this._logService.warn("CommandDetectionCapability#handleContinuationEnd Received continuation end without start")}handleRightPromptStart(){this._currentCommand.commandRightPromptStartX=this._terminal.buffer.active.cursorX,this._logService.debug("CommandDetectionCapability#handleRightPromptStart",this._currentCommand.commandRightPromptStartX)}handleRightPromptEnd(){this._currentCommand.commandRightPromptEndX=this._terminal.buffer.active.cursorX,this._logService.debug("CommandDetectionCapability#handleRightPromptEnd",this._currentCommand.commandRightPromptEndX)}handleCommandStart(e){if(this._handleCommandStartOptions=e,this._currentCommand.commandStartMarker=e?.marker||this._currentCommand.commandStartMarker,this._currentCommand.commandStartMarker?.line===this._terminal.buffer.active.cursorY)return this._currentCommand.commandStartX=this._terminal.buffer.active.cursorX,void this._logService.debug("CommandDetectionCapability#handleCommandStart",this._currentCommand.commandStartX,this._currentCommand.commandStartMarker?.line);if(this._isWindowsPty)this._handleCommandStartWindows();else{this._currentCommand.commandStartX=this._terminal.buffer.active.cursorX,this._currentCommand.commandStartMarker=e?.marker||this._terminal.registerMarker(0),this._currentCommand.commandExecutedMarker?.dispose(),this._currentCommand.commandExecutedMarker=void 0,this._currentCommand.commandExecutedX=void 0;for(const e of this._commandMarkers)e.dispose();this._commandMarkers.length=0,this._onCommandStarted.fire({marker:e?.marker||this._currentCommand.commandStartMarker,markProperties:e?.markProperties}),this._logService.debug("CommandDetectionCapability#handleCommandStart",this._currentCommand.commandStartX,this._currentCommand.commandStartMarker?.line)}}_handleCommandStartWindows(){this._currentCommand.commandStartX=this._terminal.buffer.active.cursorX,this._commandMarkers.length=0,(0,l.Vs)(0).then((()=>{if(this._currentCommand.commandExecutedMarker||(this._onCursorMoveListener=this._terminal.onCursorMove((()=>{if(0===this._commandMarkers.length||this._commandMarkers[this._commandMarkers.length-1].line!==this._terminal.buffer.active.cursorY){const e=this._terminal.registerMarker(0);e&&this._commandMarkers.push(e)}}))),this._currentCommand.commandStartMarker=this._terminal.registerMarker(0),this._currentCommand.commandStartMarker){const e=this._terminal.buffer.active.getLine(this._currentCommand.commandStartMarker.line);e&&(this._currentCommand.commandStartLineContent=e.translateToString(!0))}this._onCommandStarted.fire({marker:this._currentCommand.commandStartMarker}),this._logService.debug("CommandDetectionCapability#_handleCommandStartWindows",this._currentCommand.commandStartX,this._currentCommand.commandStartMarker?.line)}))}handleGenericCommand(e){e?.markProperties?.disableCommandStorage&&this.setIsCommandStorageDisabled(),this.handlePromptStart(e),this.handleCommandStart(e),this.handleCommandExecuted(e),this.handleCommandFinished(void 0,e)}handleCommandExecuted(e){if(this._isWindowsPty)return void this._handleCommandExecutedWindows();if(this._currentCommand.commandExecutedMarker=e?.marker||this._terminal.registerMarker(0),this._currentCommand.commandExecutedX=this._terminal.buffer.active.cursorX,this._logService.debug("CommandDetectionCapability#handleCommandExecuted",this._currentCommand.commandExecutedX,this._currentCommand.commandExecutedMarker?.line),!this._currentCommand.commandStartMarker||!this._currentCommand.commandExecutedMarker||void 0===this._currentCommand.commandStartX)return;this._currentCommand.command=this.__isCommandStorageDisabled?"":this._terminal.buffer.active.getLine(this._currentCommand.commandStartMarker.line)?.translateToString(!0,this._currentCommand.commandStartX,this._currentCommand.commandRightPromptStartX).trim();let t=this._currentCommand.commandStartMarker.line+1;const i=this._currentCommand.commandExecutedMarker.line;for(;t<i;t++){const e=this._terminal.buffer.active.getLine(t);if(e){const i=this._currentCommand.continuations?.find((e=>e.marker.line===t));i&&(this._currentCommand.command+="\n");const n=i?.end??0;this._currentCommand.command+=e.translateToString(!0,n)}}t===i&&(this._currentCommand.command+=this._terminal.buffer.active.getLine(i)?.translateToString(!0,void 0,this._currentCommand.commandExecutedX)||""),this._onCommandExecuted.fire()}_handleCommandExecutedWindows(){this._onCursorMoveListener?.dispose(),this._onCursorMoveListener=void 0,this._evaluateCommandMarkersWindows(),this._currentCommand.commandExecutedX=this._terminal.buffer.active.cursorX,this._onCommandExecuted.fire(),this._logService.debug("CommandDetectionCapability#handleCommandExecuted",this._currentCommand.commandExecutedX,this._currentCommand.commandExecutedMarker?.line)}invalidateCurrentCommand(e){this._currentCommand.isInvalid=!0,this._onCurrentCommandInvalidated.fire(e)}handleCommandFinished(e,t){this._isWindowsPty&&this._preHandleCommandFinishedWindows(),this._currentCommand.commandFinishedMarker=t?.marker||this._terminal.registerMarker(0);let i=this._currentCommand.command;if(this._logService.debug("CommandDetectionCapability#handleCommandFinished",this._terminal.buffer.active.cursorX,this._currentCommand.commandFinishedMarker?.line,this._currentCommand.command,this._currentCommand),this._exitCode=e,void 0===this._exitCode){const e=this.commands.length>0?this.commands[this.commands.length-1]:void 0;i&&i.length>0&&e?.command===i&&(this._exitCode=e.exitCode)}if(void 0!==this._currentCommand.commandStartMarker&&this._terminal.buffer.active){if(void 0===this._exitCode&&void 0===i&&(i=""),void 0!==i&&!i.startsWith("\\")||this._handleCommandStartOptions?.ignoreCommandLine){const e=this._terminal.buffer.active,n=Date.now(),s=this._currentCommand.commandExecutedMarker,r=this._currentCommand.commandFinishedMarker,o={command:this._handleCommandStartOptions?.ignoreCommandLine?"":i||"",isTrusted:!!this._currentCommand.isTrusted,marker:this._currentCommand.commandStartMarker,endMarker:r,executedMarker:s,timestamp:n,cwd:this._cwd,exitCode:this._exitCode,commandStartLineContent:this._currentCommand.commandStartLineContent,hasOutput:()=>!s?.isDisposed&&!r?.isDisposed&&!!(s&&r&&s?.line<r.line),getOutput:()=>Li(s,r,e),getOutputMatch:t=>Pi(this._isWindowsPty&&s?.line===r?.line?this._currentCommand.commandStartMarker:s,r,e,this._terminal.cols,t),markProperties:t?.markProperties};this._commands.push(o),this._logService.debug("CommandDetectionCapability#onCommandFinished",o),this._onBeforeCommandFinished.fire(o),this._currentCommand.isInvalid||this._onCommandFinished.fire(o)}this._currentCommand.previousCommandMarker=this._currentCommand.commandStartMarker,this._currentCommand={},this._handleCommandStartOptions=void 0}}_preHandleCommandFinishedWindows(){this._currentCommand.commandExecutedMarker||(0===this._commandMarkers.length&&(this._currentCommand.commandStartMarker||(this._currentCommand.commandStartMarker=this._terminal.registerMarker(0)),this._currentCommand.commandStartMarker&&this._commandMarkers.push(this._currentCommand.commandStartMarker)),this._evaluateCommandMarkersWindows())}_evaluateCommandMarkersWindows(){if(0!==this._commandMarkers.length){if(this._commandMarkers=this._commandMarkers.sort(((e,t)=>e.line-t.line)),this._currentCommand.commandStartMarker=this._commandMarkers[0],this._currentCommand.commandStartMarker){const e=this._terminal.buffer.active.getLine(this._currentCommand.commandStartMarker.line);e&&(this._currentCommand.commandStartLineContent=e.translateToString(!0))}this._currentCommand.commandExecutedMarker=this._commandMarkers[this._commandMarkers.length-1]}}setCommandLine(e,t){this._logService.debug("CommandDetectionCapability#setCommandLine",e,t),this._currentCommand.command=e,this._currentCommand.isTrusted=t}serialize(){const e=this.commands.map((e=>({startLine:e.marker?.line,startX:void 0,endLine:e.endMarker?.line,executedLine:e.executedMarker?.line,command:this.__isCommandStorageDisabled?"":e.command,isTrusted:e.isTrusted,cwd:e.cwd,exitCode:e.exitCode,commandStartLineContent:e.commandStartLineContent,timestamp:e.timestamp,markProperties:e.markProperties,aliases:e.aliases})));return this._currentCommand.commandStartMarker&&e.push({startLine:this._currentCommand.commandStartMarker.line,startX:this._currentCommand.commandStartX,endLine:void 0,executedLine:void 0,command:"",isTrusted:!0,cwd:this._cwd,exitCode:void 0,commandStartLineContent:void 0,timestamp:0,markProperties:void 0}),{isWindowsPty:this._isWindowsPty,commands:e}}deserialize(e){e.isWindowsPty&&this.setIsWindowsPty(e.isWindowsPty);const t=this._terminal.buffer.normal;for(const i of e.commands){const e=void 0!==i.startLine?this._terminal.registerMarker(i.startLine-(t.baseY+t.cursorY)):void 0;if(!e)continue;if(!i.endLine){this._currentCommand.commandStartMarker=e,this._currentCommand.commandStartX=i.startX,this._cwd=i.cwd,this._onCommandStarted.fire({marker:e});continue}const n=void 0!==i.endLine?this._terminal.registerMarker(i.endLine-(t.baseY+t.cursorY)):void 0,s=void 0!==i.executedLine?this._terminal.registerMarker(i.executedLine-(t.baseY+t.cursorY)):void 0,r={command:this.__isCommandStorageDisabled?"":i.command,isTrusted:i.isTrusted,marker:e,endMarker:n,executedMarker:s,timestamp:i.timestamp,cwd:i.cwd,commandStartLineContent:i.commandStartLineContent,exitCode:i.exitCode,hasOutput:()=>!s?.isDisposed&&!n?.isDisposed&&!!(s&&n&&s.line<n.line),getOutput:()=>Li(s,n,t),getOutputMatch:i=>Pi(this._isWindowsPty&&s?.line===n?.line?e:s,n,t,this._terminal.cols,i),markProperties:i.markProperties,wasReplayed:!0};this._commands.push(r),this._logService.debug("CommandDetectionCapability#onCommandFinished",r),this._onCommandFinished.fire(r)}}}function Li(e,t,i){if(!e||!t)return;const n=e.line,s=t.line;if(n===s)return;let r,o="";for(let e=n;e<s;e++)r=i.getLine(e),r&&(o+=r.translateToString(!r.isWrapped)+(r.isWrapped?"":"\n"));return""===o?void 0:o}function Pi(e,t,i,n,s){if(!e||!t)return;const r=t.line;if(-1===r)return;const o=Math.max(e.line,0),a=s.lineMatcher,c="string"==typeof a?1:s.length||function(e){if(!e.multiline)return 1;const t=e.source;let i=1,n=t.indexOf("\\n");for(;-1!==n;)i++,n=t.indexOf("\\n",n+1);return i}(a),l=[];let h;if("bottom"===s.anchor)for(let e=r-(s.offset||0);e>=o;e--){let t=e;const s=e;for(;t>=o&&i.getLine(t)?.isWrapped;)t--;if(e=t,l.unshift(Ri(i,t,s,n)),h||(h=l[0].match(a)),l.length>=c)break}else for(let e=o+(s.offset||0);e<r;e++){const t=e;let s=e;for(;s+1<r&&i.getLine(s+1)?.isWrapped;)s++;if(e=s,l.push(Ri(i,t,s,n)),h||(h=l[l.length-1].match(a)),l.length>=c)break}return h?{regexMatch:h,outputLines:l}:void 0}function Ri(e,t,i,n){const s=Math.max(2048/n*2);i=Math.min(i,t+s);let r="";for(let s=t;s<=i;s++){const t=e.getLine(s);t&&(r+=t.translateToString(!0,0,n))}return r}Ai.__decorator=(0,a.g)([(0,h.Ds)(500)],Ai.prototype,"_handleCursorMove",null);class Mi{constructor(){this.type=0,this._cwd="",this._cwds=new Map,this._onDidChangeCwd=new d.Q5,this.onDidChangeCwd=this._onDidChangeCwd.event}get cwds(){return Array.from(this._cwds.keys())}getCwd(){return this._cwd}updateCwd(e){const t=this._cwd!==e;this._cwd=e;const i=this._cwds.get(this._cwd)||0;this._cwds.delete(this._cwd),this._cwds.set(this._cwd,i+1),t&&this._onDidChangeCwd.fire(e)}}class Bi{get commands(){return this._commands}constructor(e){this._terminal=e,this.type=3,this._commands=[],this._onCommandFinished=new d.Q5,this.onCommandFinished=this._onCommandFinished.event,this._terminal.onData((e=>this._onData(e))),this._terminal.parser.registerCsiHandler({final:"J"},(e=>(e.length>=1&&(2===e[0]||3===e[0])&&this._clearCommandsInViewport(),!1)))}_onData(e){"\r"===e&&this._onEnter()}_onEnter(){if(this._terminal&&this._terminal.buffer.active.cursorX>=2){const e=this._terminal.registerMarker(0);e&&(this._commands.push(e),this._onCommandFinished.fire(e))}}_clearCommandsInViewport(){let e=0;for(let t=this._commands.length-1;t>=0&&!(this._commands[t].line<this._terminal.buffer.active.baseY);t--)e++;this._commands.splice(this._commands.length-e,e)}}class Ni{constructor(e){this._terminal=e,this.type=4,this._idToMarkerMap=new Map,this._anonymousMarkers=new Map,this._onMarkAdded=new d.Q5,this.onMarkAdded=this._onMarkAdded.event}*markers(){for(const e of this._idToMarkerMap.values())yield e;for(const e of this._anonymousMarkers.values())yield e}addMark(e){const t=e?.marker||this._terminal.registerMarker(),i=e?.id;t&&(i?(this._idToMarkerMap.set(i,t),t.onDispose((()=>this._idToMarkerMap.delete(i)))):(this._anonymousMarkers.set(t.id,t),t.onDispose((()=>this._anonymousMarkers.delete(t.id)))),this._onMarkAdded.fire({marker:t,id:i,hidden:e?.hidden,hoverMessage:e?.hoverMessage}))}getMark(e){return this._idToMarkerMap.get(e)}}function Oi(e){let t=e;return t.includes("\\")&&(t=t.replace(/\\/g,"\\\\")),t=t.replace(/[\`\$\|\&\>\~\#\!\^\*\;\<\"\']/g,""),`'${t}'`}function Hi(e,t,i){if(!e)return"";if(!t)return e;t.match(/[\/\\]$/)&&(t=t.slice(0,t.length-1));const n=e.replace(/\\/g,"/").toLowerCase(),s=t.replace(/\\/g,"/").toLowerCase();return n.includes(s)?`~${i}${e.slice(t.length+1)}`:e}function Fi(e){return e.match(/^['"].*['"]$/)&&(e=e.substring(1,e.length-1)),1===_.OS&&e&&":"===e[1]?e[0].toUpperCase()+e.substring(1):e}class Wi extends u.JT{get status(){return this._status}constructor(e,t,i,n){super(),this._nonce=e,this._disableTelemetry=t,this._telemetryService=i,this._logService=n,this.capabilities=new Ti,this._hasUpdatedTelemetry=!1,this._commonProtocolDisposables=[],this._status=0,this._onDidChangeStatus=new d.Q5,this.onDidChangeStatus=this._onDidChangeStatus.event,this._register((0,u.OF)((()=>{this._clearActivationTimeout(),this._disposeCommonProtocol()})))}_disposeCommonProtocol(){(0,u.B9)(this._commonProtocolDisposables),this._commonProtocolDisposables.length=0}activate(e){this._terminal=e,this.capabilities.add(3,new Bi(this._terminal)),this._register(e.parser.registerOscHandler(633,(e=>this._handleVSCodeSequence(e)))),this._register(e.parser.registerOscHandler(1337,(e=>this._doHandleITermSequence(e)))),this._commonProtocolDisposables.push(e.parser.registerOscHandler(133,(e=>this._handleFinalTermSequence(e)))),this._register(e.parser.registerOscHandler(7,(e=>this._doHandleSetCwd(e)))),this._register(e.parser.registerOscHandler(9,(e=>this._doHandleSetWindowsFriendlyCwd(e)))),this._ensureCapabilitiesOrAddFailureTelemetry()}_handleFinalTermSequence(e){const t=this._doHandleFinalTermSequence(e);return 0===this._status&&(this._status=1,this._onDidChangeStatus.fire(this._status)),t}_doHandleFinalTermSequence(e){if(!this._terminal)return!1;const[t,...i]=e.split(";");switch(t){case"A":return this._createOrGetCommandDetection(this._terminal).handlePromptStart(),!0;case"B":return this._createOrGetCommandDetection(this._terminal).handleCommandStart({ignoreCommandLine:!0}),!0;case"C":return this._createOrGetCommandDetection(this._terminal).handleCommandExecuted(),!0;case"D":{const e=1===i.length?parseInt(i[0]):void 0;return this._createOrGetCommandDetection(this._terminal).handleCommandFinished(e),!0}}return!1}_handleVSCodeSequence(e){const t=this._doHandleVSCodeSequence(e);return!this._hasUpdatedTelemetry&&t&&(this._telemetryService?.publicLog2("terminal/shellIntegrationActivationSucceeded"),this._hasUpdatedTelemetry=!0,this._clearActivationTimeout()),2!==this._status&&(this._status=2,this._onDidChangeStatus.fire(this._status)),t}async _ensureCapabilitiesOrAddFailureTelemetry(){this._telemetryService&&!this._disableTelemetry&&(this._activationTimeout=setTimeout((()=>{this.capabilities.get(2)||this.capabilities.get(0)||(this._telemetryService?.publicLog2("terminal/shellIntegrationActivationTimeout"),this._logService.warn("Shell integration failed to add capabilities within 10 seconds")),this._hasUpdatedTelemetry=!0}),1e4))}_clearActivationTimeout(){void 0!==this._activationTimeout&&(clearTimeout(this._activationTimeout),this._activationTimeout=void 0)}_doHandleVSCodeSequence(e){if(!this._terminal)return!1;const t=e.indexOf(";"),i=-1===t?e:e.substring(0,t),n=-1===t?[]:e.substring(t+1).split(";");switch(i){case"A":return this._createOrGetCommandDetection(this._terminal).handlePromptStart(),!0;case"B":return this._createOrGetCommandDetection(this._terminal).handleCommandStart(),!0;case"C":return this._createOrGetCommandDetection(this._terminal).handleCommandExecuted(),!0;case"D":{const e=n[0],t=void 0!==e?parseInt(e):void 0;return this._createOrGetCommandDetection(this._terminal).handleCommandFinished(t),!0}case"E":{const e=n[0],t=n[1];let i;return i=void 0!==e?Vi(e):"",this._createOrGetCommandDetection(this._terminal).setCommandLine(i,t===this._nonce),!0}case"F":return this._createOrGetCommandDetection(this._terminal).handleContinuationStart(),!0;case"G":return this._createOrGetCommandDetection(this._terminal).handleContinuationEnd(),!0;case"H":return this._createOrGetCommandDetection(this._terminal).handleRightPromptStart(),!0;case"I":return this._createOrGetCommandDetection(this._terminal).handleRightPromptEnd(),!0;case"P":{const e=n[0],t=void 0!==e?Vi(e):"",{key:i,value:s}=$i(t);if(void 0===s)return!0;switch(i){case"Cwd":return this._updateCwd(s),!0;case"IsWindows":return this._createOrGetCommandDetection(this._terminal).setIsWindowsPty("True"===s),!0;case"Task":return this._createOrGetBufferMarkDetection(this._terminal),this.capabilities.get(2)?.setIsCommandStorageDisabled(),!0}}case"SetMark":return this._createOrGetBufferMarkDetection(this._terminal).addMark(function(e){let t,i=!1;for(const n of e)void 0!==n&&("Hidden"===n&&(i=!0),n.startsWith("Id=")&&(t=n.substring(3)));return{id:t,hidden:i}}(n)),!0}return!1}_updateCwd(e){e=Fi(e),this._createOrGetCwdDetection().updateCwd(e);const t=this.capabilities.get(2);t?.setCwd(e)}_doHandleITermSequence(e){if(!this._terminal)return!1;const[t]=e.split(";");"SetMark"===t&&this._createOrGetBufferMarkDetection(this._terminal).addMark();{const{key:e,value:i}=$i(t);if(void 0===i)return!0;if("CurrentDir"===e)return this._updateCwd(i),!0}return!1}_doHandleSetWindowsFriendlyCwd(e){if(!this._terminal)return!1;const[t,...i]=e.split(";");return"9"===t&&(i.length&&this._updateCwd(i[0]),!0)}_doHandleSetCwd(e){if(!this._terminal)return!1;const[t]=e.split(";");if(t.match(/^file:\/\/.*\//)){const e=g.ov.parse(t);if(e.path&&e.path.length>0)return this._updateCwd(e.path),!0}return!1}serialize(){return this._terminal&&this.capabilities.has(2)?this._createOrGetCommandDetection(this._terminal).serialize():{isWindowsPty:!1,commands:[]}}deserialize(e){if(!this._terminal)throw new Error("Cannot restore commands before addon is activated");this._createOrGetCommandDetection(this._terminal).deserialize(e)}_createOrGetCwdDetection(){let e=this.capabilities.get(0);return e||(e=new Mi,this.capabilities.add(0,e)),e}_createOrGetCommandDetection(e){let t=this.capabilities.get(2);return t||(t=new Ai(e,this._logService),this.capabilities.add(2,t)),t}_createOrGetBufferMarkDetection(e){let t=this.capabilities.get(4);return t||(t=new Ni(e),this.capabilities.add(4,t)),t}}function Vi(e){return e.replaceAll(/\\(\\|x([0-9a-f]{2}))/gi,((e,t,i)=>i?String.fromCharCode(parseInt(i,16)):t))}function $i(e){const t=e.indexOf("=");return-1===t?{key:e,value:void 0}:{key:e.substring(0,t),value:e.substring(1+t)}}var Ui=i(22713);let Gi=class extends u.JT{constructor(e,t,i){super(),this._hoverService=e,this._contextMenuVisible=!1,this._register(i.onDidShowContextMenu((()=>this._contextMenuVisible=!0))),this._register(i.onDidHideContextMenu((()=>this._contextMenuVisible=!1))),this._hoverDelayer=this._register(new l.vp(t.getValue("workbench.hover.delay")))}hideHover(){this._hoverDelayer.cancel(),this._hoverService.hideHover()}createHover(e,t,i){return(0,u.F8)(c.nm(e,c.tw.MOUSE_ENTER,(()=>{this._contextMenuVisible||this._hoverDelayer.trigger((()=>{let n=`${(0,p.NC)("terminalPromptContextMenu","Show Command Actions")}`;if(n+="\n\n---\n\n",t)if(t.markProperties||i){if(!t.markProperties?.hoverMessage&&!i)return;n=t.markProperties?.hoverMessage||i||""}else t.exitCode?-1===t.exitCode?n+=(0,p.NC)("terminalPromptCommandFailed","Command executed {0} and failed",(0,Nt.Z)(t.timestamp,!0)):n+=(0,p.NC)("terminalPromptCommandFailedWithExitCode","Command executed {0} and failed (Exit Code {1})",(0,Nt.Z)(t.timestamp,!0),t.exitCode):n+=(0,p.NC)("terminalPromptCommandSuccess","Command executed {0}",(0,Nt.Z)(t.timestamp,!0));else{if(!i)return;n=i}this._hoverService.showHover({content:new Mt.W5(n),target:e})}))})),c.nm(e,c.tw.MOUSE_LEAVE,(()=>this.hideHover())),c.nm(e,c.tw.MOUSE_OUT,(()=>this.hideHover())))}};function zi(e,t){if(!t)return;const i=e.inspect("terminal.integrated.fontSize").value,n=e.inspect("terminal.integrated.fontSize").defaultValue,s=e.inspect("terminal.integrated.lineHeight").value;if("number"==typeof i&&"number"==typeof n&&"number"==typeof s){const e=i/n<=1?i/n:1;t.style.width=16*e+"px",t.style.height=16*e*s+"px",t.style.fontSize=16*e+"px",t.style.marginLeft=-17*e+"px"}}Gi=(0,a.g)([(0,a.f)(0,Ui.B),(0,a.f)(1,v.Ui),(0,a.f)(2,ut.i)],Gi);var Ki=i(69149);let qi=class extends u.JT{constructor(e,t,i,n,s,r,o,a,c,l,h,m){super(),this._capabilities=e,this._clipboardService=t,this._contextMenuService=i,this._configurationService=n,this._themeService=s,this._openerService=r,this._quickInputService=o,this._commandService=c,this._audioCueService=h,this._notificationService=m,this._capabilityDisposables=new Map,this._decorations=new Map,this._onDidRequestRunCommand=this._register(new d.Q5),this.onDidRequestRunCommand=this._onDidRequestRunCommand.event,this._register((0,u.OF)((()=>this._dispose()))),this._register(this._configurationService.onDidChangeConfiguration((e=>{e.affectsConfiguration("terminal.integrated.fontSize")||e.affectsConfiguration("terminal.integrated.lineHeight")?this.refreshLayouts():e.affectsConfiguration("workbench.colorCustomizations")?this._refreshStyles(!0):e.affectsConfiguration("terminal.integrated.shellIntegration.decorationsEnabled")&&(this._removeCapabilityDisposables(2),this._updateDecorationVisibility())}))),this._register(this._themeService.onDidColorThemeChange((()=>this._refreshStyles(!0)))),this._updateDecorationVisibility(),this._register(this._capabilities.onDidAddCapability((e=>this._createCapabilityDisposables(e)))),this._register(this._capabilities.onDidRemoveCapability((e=>this._removeCapabilityDisposables(e)))),this._register(a.onWillShutdown((()=>this._disposeAllDecorations()))),this._terminalDecorationHoverService=l.createInstance(Gi)}_removeCapabilityDisposables(e){const t=this._capabilityDisposables.get(e);t&&(0,u.B9)(t),this._capabilityDisposables.delete(e)}_createCapabilityDisposables(e){let t=[];const i=this._capabilities.get(e);if(i&&!this._capabilityDisposables.has(e)){switch(i.type){case 4:t=[i.onMarkAdded((e=>this.registerMarkDecoration(e)))];break;case 2:t=this._getCommandDetectionListeners(i)}this._capabilityDisposables.set(e,t)}}registerMarkDecoration(e){if(this._terminal&&(this._showGutterDecorations||this._showOverviewRulerDecorations)&&!e.hidden)return this.registerCommandDecoration(void 0,void 0,e)}_updateDecorationVisibility(){const e=this._configurationService.getValue("terminal.integrated.shellIntegration.decorationsEnabled");this._showGutterDecorations="both"===e||"gutter"===e,this._showOverviewRulerDecorations="both"===e||"overviewRuler"===e,this._disposeAllDecorations(),(this._showGutterDecorations||this._showOverviewRulerDecorations)&&(this._attachToCommandCapability(),this._updateGutterDecorationVisibility());const t=this._capabilities.get(2)?.executingCommandObject;t&&this.registerCommandDecoration(t,!0)}_disposeAllDecorations(){this._placeholderDecoration?.dispose();for(const e of this._decorations.values())e.decoration.dispose(),(0,u.B9)(e.disposables)}_updateGutterDecorationVisibility(){const e=document.querySelectorAll("terminal-command-decoration");for(const t of e)this._updateCommandDecorationVisibility(t)}_updateCommandDecorationVisibility(e){this._showGutterDecorations?e.classList.remove("hide"):e.classList.add("hide")}refreshLayouts(){zi(this._configurationService,this._placeholderDecoration?.element);for(const e of this._decorations)zi(this._configurationService,e[1].decoration.element)}_refreshStyles(e){if(e)for(const e of this._decorations.values()){const t=this._getDecorationCssColor(e)?.toString()??"";e.decoration.options?.overviewRulerOptions?e.decoration.options.overviewRulerOptions.color=t:e.decoration.options&&(e.decoration.options.overviewRulerOptions={color:t})}this._updateClasses(this._placeholderDecoration?.element);for(const e of this._decorations.values())this._updateClasses(e.decoration.element,e.exitCode,e.markProperties)}_dispose(){this._terminalDecorationHoverService.dispose();for(const e of this._capabilityDisposables.values())(0,u.B9)(e);this.clearDecorations()}_clearPlaceholder(){this._placeholderDecoration?.dispose(),this._placeholderDecoration=void 0}clearDecorations(){this._placeholderDecoration?.marker.dispose(),this._clearPlaceholder(),this._disposeAllDecorations(),this._decorations.clear()}_attachToCommandCapability(){this._capabilities.has(2)&&this._getCommandDetectionListeners(this._capabilities.get(2))}_getCommandDetectionListeners(e){if(this._capabilityDisposables.has(2)){const t=this._capabilityDisposables.get(2);(0,u.B9)(t),this._capabilityDisposables.delete(e.type)}const t=[];e.executingCommandObject?.marker&&this.registerCommandDecoration(e.executingCommandObject,!0),t.push(e.onCommandStarted((e=>this.registerCommandDecoration(e,!0))));for(const t of e.commands)this.registerCommandDecoration(t);return t.push(e.onCommandFinished((e=>{this.registerCommandDecoration(e),e.exitCode&&this._audioCueService.playAudioCue(Ki.y$.terminalCommandFailed)}))),t.push(e.onCommandInvalidated((e=>{for(const t of e){const e=t.marker?.id;if(e){const t=this._decorations.get(e);t&&(t.decoration.dispose(),(0,u.B9)(t.disposables))}}}))),t.push(e.onCurrentCommandInvalidated((e=>{if("noProblemsReported"===e.reason){const e=Array.from(this._decorations.entries())[this._decorations.size-1];e?.[1].decoration.dispose()}else"windows"===e.reason&&this._clearPlaceholder()}))),t}activate(e){this._terminal=e,this._attachToCommandCapability()}registerCommandDecoration(e,t,i){if(!this._terminal||t&&!e||!this._showGutterDecorations&&!this._showOverviewRulerDecorations)return;const n=e?.marker||i?.marker;if(!n)throw new Error(`cannot add a decoration for a command ${JSON.stringify(e)} with no marker`);this._clearPlaceholder();const s=this._getDecorationCssColor(e)?.toString()??"",r=this._terminal.registerDecoration({marker:n,overviewRulerOptions:this._showOverviewRulerDecorations?t?{color:s,position:"left"}:{color:s,position:e?.exitCode?"right":"left"}:void 0});return r?(t&&(this._placeholderDecoration=r),r.onRender((t=>{t.classList.contains(".xterm-decoration-overview-ruler")||(this._decorations.get(r.marker.id)||(r.onDispose((()=>this._decorations.delete(r.marker.id))),this._decorations.set(r.marker.id,{decoration:r,disposables:this._createDisposables(t,e,i),exitCode:e?.exitCode,markProperties:e?.markProperties})),t.classList.contains("codicon")&&0!==e?.marker?.line||(zi(this._configurationService,t),this._updateClasses(t,e?.exitCode,e?.markProperties||i)))})),r):void 0}_createDisposables(e,t,i){return void 0!==t?.exitCode||t?.markProperties?t?.markProperties||i?[this._terminalDecorationHoverService.createHover(e,t||i,i?.hoverMessage)]:[this._createContextMenu(e,t),this._terminalDecorationHoverService.createHover(e,t)]:[]}_updateClasses(e,t,i){if(e){for(const t of e.classList)e.classList.remove(t);e.classList.add("terminal-command-decoration","codicon","xterm-decoration"),i?(e.classList.add("default-color",...D.kS.asClassNameArray(Y)),i.hoverMessage||e.classList.add("default")):(this._updateCommandDecorationVisibility(e),void 0===t?(e.classList.add("default-color","default"),e.classList.add(...D.kS.asClassNameArray(Z))):t?(e.classList.add("error"),e.classList.add(...D.kS.asClassNameArray(ee))):e.classList.add(...D.kS.asClassNameArray(te)))}}_createContextMenu(e,t){return c.nm(e,c.tw.CLICK,(async()=>{this._terminalDecorationHoverService.hideHover();const i=await this._getCommandActions(t);this._contextMenuService.showContextMenu({getAnchor:()=>e,getActions:()=>i})}))}async _getCommandActions(e){const t=[];if(""!==e.command){const i=(0,p.NC)("terminal.rerunCommand","Rerun Command");t.push({class:void 0,tooltip:i,id:"terminal.rerunCommand",label:i,enabled:!0,run:async()=>{if(""!==e.command){if(!e.isTrusted&&!await new Promise((t=>{this._notificationService.prompt(w.zb.Info,(0,p.NC)("rerun","Do you want to run the command: {0}",e.command),[{label:(0,p.NC)("yes","Yes"),run:()=>t(!0)},{label:(0,p.NC)("no","No"),run:()=>t(!1)}])})))return;this._onDidRequestRunCommand.fire({command:e})}}});const n=(0,p.NC)("terminal.copyCommand","Copy Command");t.push({class:void 0,tooltip:n,id:"terminal.copyCommand",label:n,enabled:!0,run:()=>this._clipboardService.writeText(e.command)})}if(e.hasOutput()){t.length>0&&t.push(new P.Z0);const i=(0,p.NC)("terminal.copyOutput","Copy Output");t.push({class:void 0,tooltip:i,id:"terminal.copyOutput",label:i,enabled:!0,run:()=>{const t=e.getOutput();"string"==typeof t&&this._clipboardService.writeText(t)}});const n=(0,p.NC)("terminal.copyOutputAsHtml","Copy Output as HTML");t.push({class:void 0,tooltip:n,id:"terminal.copyOutputAsHtml",label:n,enabled:!0,run:()=>this._onDidRequestRunCommand.fire({command:e,copyAsHtml:!0})})}t.length>0&&t.push(new P.Z0);const i=(0,p.NC)("workbench.action.terminal.runRecentCommand","Run Recent Command");t.push({class:void 0,tooltip:i,id:"workbench.action.terminal.runRecentCommand",label:i,enabled:!0,run:()=>this._commandService.executeCommand("workbench.action.terminal.runRecentCommand")});const n=(0,p.NC)("workbench.action.terminal.goToRecentDirectory","Go To Recent Directory");t.push({class:void 0,tooltip:i,id:"workbench.action.terminal.goToRecentDirectory",label:n,enabled:!0,run:()=>this._commandService.executeCommand("workbench.action.terminal.goToRecentDirectory")}),t.push(new P.Z0);const s=(0,p.NC)("terminal.configureCommandDecorations","Configure Command Decorations");t.push({class:void 0,tooltip:s,id:"terminal.configureCommandDecorations",label:s,enabled:!0,run:()=>this._showConfigureCommandDecorationsQuickPick()});const r=(0,p.NC)("terminal.learnShellIntegration","Learn About Shell Integration");return t.push({class:void 0,tooltip:r,id:"terminal.learnShellIntegration",label:r,enabled:!0,run:()=>this._openerService.open("https://code.visualstudio.com/docs/terminal/shell-integration")}),t}async _showConfigureCommandDecorationsQuickPick(){const e=this._quickInputService.createQuickPick();e.items=[{id:"a",label:(0,p.NC)("toggleVisibility","Toggle visibility")}],e.canSelectMany=!1,e.onDidAccept((async t=>{e.hide(),"a"===e.activeItems[0].id&&this._showToggleVisibilityQuickPick()})),e.show()}_showToggleVisibilityQuickPick(){const e=this._quickInputService.createQuickPick();e.hideInput=!0,e.hideCheckAll=!0,e.canSelectMany=!0,e.title=(0,p.NC)("toggleVisibility","Toggle visibility");const t=this._configurationService.getValue("terminal.integrated.shellIntegration.decorationsEnabled"),i={label:(0,p.NC)("gutter","Gutter command decorations"),picked:"never"!==t&&"overviewRuler"!==t},n={label:(0,p.NC)("overviewRuler","Overview ruler command decorations"),picked:"never"!==t&&"gutter"!==t};e.items=[i,n];const s=[];"never"!==t&&("gutter"!==t&&s.push(i),"overviewRuler"!==t&&s.push(n)),e.selectedItems=s,e.onDidChangeSelection((async e=>{let t="never";e.includes(i)?t=e.includes(n)?"both":"gutter":e.includes(n)&&(t="overviewRuler"),await this._configurationService.updateValue("terminal.integrated.shellIntegration.decorationsEnabled",t)})),e.ok=!1,e.show()}_getDecorationCssColor(e){let t;return t=void 0===e?.exitCode?yi.oA:e.exitCode?yi.on:yi.ZQ,this._themeService.getColorTheme().getColor(t)?.toString()}};qi=(0,a.g)([(0,a.f)(1,Fe.p),(0,a.f)(2,ut.i),(0,a.f)(3,v.Ui),(0,a.f)(4,I.XE),(0,a.f)(5,V.v4),(0,a.f)(6,$.eJ),(0,a.f)(7,Si.g),(0,a.f)(8,f.H),(0,a.f)(9,S.TG),(0,a.f)(10,Ki.e7),(0,a.f)(11,w.lT)],qi);class ji{constructor(e){this.completion=e,this.score=K.CL.Default,this.distance=0,this.labelLow=this.completion.label.toLowerCase()}}class Qi{constructor(e,t){this.leadingLineContent=e,this.characterCountDelta=t}}class Xi{constructor(e,t,i,n){this._items=e,this._lineContext=t,this.replacementIndex=i,this.replacementLength=n,this._refilterKind=1,this._fuzzyScoreOptions=K.mX.default,this._options={}}get items(){return this._ensureCachedState(),this._filteredItems}get stats(){return this._ensureCachedState(),this._stats}get lineContext(){return this._lineContext}set lineContext(e){this._lineContext.leadingLineContent===e.leadingLineContent&&this._lineContext.characterCountDelta===e.characterCountDelta||(this._refilterKind=this._lineContext.characterCountDelta<e.characterCountDelta&&this._filteredItems?2:1,this._lineContext=e)}_ensureCachedState(){0!==this._refilterKind&&this._createCachedState()}_createCachedState(){const e=[],{leadingLineContent:t,characterCountDelta:i}=this._lineContext;let n="",s="";const r=1===this._refilterKind?this._items:this._filteredItems,o=[],a=!this._options.filterGraceful||r.length>2e3?K.EW:K.l7;for(let c=0;c<r.length;c++){const l=r[c],h=this.replacementLength,d=h+i;if(n.length!==d&&(n=0===d?"":t.slice(-d),s=n.toLowerCase()),l.word=n,0===d)l.score=K.CL.Default;else{let e=0;for(;e<h;){const t=n.charCodeAt(e);if(32!==t&&9!==t)break;e+=1}if(e>=d)l.score=K.CL.Default;else{const t=a(n,s,e,l.completion.label,l.labelLow,0,this._fuzzyScoreOptions);if(!t)continue;l.score=t}}l.idx=c,l.distance=1,o.push(l),e.push(l.completion.label.length)}this._filteredItems=o,this._refilterKind=0,this._stats={pLabelLen:e.length?(0,Ci.HW)(e.length-.85,e,((e,t)=>e-t)):0}}}(0,ht.Z)('.workbench-suggest-widget{display:flex;flex-direction:column;left:0;position:absolute;top:0;width:430px;z-index:40}.workbench-suggest-widget.message{align-items:center;flex-direction:row}.monaco-workbench .workbench-suggest-details,.workbench-suggest-widget{background-color:var(--vscode-editorSuggestWidget-background);border-color:var(--vscode-editorSuggestWidget-border);border-style:solid;border-width:1px;flex:0 1 auto;width:100%}.monaco-workbench.hc-black .workbench-suggest-details,.monaco-workbench.hc-black .workbench-suggest-widget,.monaco-workbench.hc-light .workbench-suggest-details,.monaco-workbench.hc-light .workbench-suggest-widget{border-width:2px}.monaco-workbench .workbench-suggest-widget.with-status-bar .suggest-status-bar{display:flex}.monaco-workbench .workbench-suggest-widget .suggest-status-bar .left{padding-right:8px}.monaco-workbench .workbench-suggest-widget.with-status-bar .suggest-status-bar .action-label{color:var(--vscode-editorSuggestWidgetStatus-foreground)}.monaco-workbench .workbench-suggest-widget.with-status-bar .suggest-status-bar .action-item:not(:last-of-type) .action-label{margin-right:0}.monaco-workbench .workbench-suggest-widget.with-status-bar .suggest-status-bar .action-item:not(:last-of-type) .action-label:after{content:", ";margin-right:.3em}.monaco-workbench .workbench-suggest-widget.with-status-bar .monaco-list .monaco-list-row.focused.string-label>.contents>.main>.right>.readMore,.monaco-workbench .workbench-suggest-widget.with-status-bar .monaco-list .monaco-list-row>.contents>.main>.right>.readMore{display:none}.workbench-suggest-widget .monaco-list .monaco-list-row{background-position:2px 2px;background-repeat:no-repeat;-mox-box-sizing:border-box;box-sizing:border-box;cursor:pointer;display:flex;padding-right:10px;touch-action:none;white-space:nowrap}.workbench-suggest-widget .monaco-list .monaco-list-row.focused{color:var(--vscode-editorSuggestWidget-selectedForeground)}.workbench-suggest-widget .monaco-list .monaco-list-row.focused .codicon{color:var(--vscode-editorSuggestWidget-selectedIconForeground)}.workbench-suggest-widget .monaco-list .monaco-list-row>.contents{flex:1;height:100%;overflow:hidden;padding-left:2px}.workbench-suggest-widget .monaco-list .monaco-list-row>.contents>.main{display:flex;justify-content:space-between;overflow:hidden;text-overflow:ellipsis;white-space:pre}.workbench-suggest-widget .monaco-list .monaco-list-row>.contents>.main>.left,.workbench-suggest-widget .monaco-list .monaco-list-row>.contents>.main>.right{display:flex}.workbench-suggest-widget .monaco-list .monaco-list-row:not(.focused)>.contents>.main .monaco-icon-label{color:var(--vscode-editorSuggestWidget-foreground)}.workbench-suggest-widget:not(.frozen) .monaco-highlighted-label .highlight{font-weight:700}.workbench-suggest-widget .monaco-list .monaco-list-row>.contents>.main .monaco-highlighted-label .highlight{color:var(--vscode-editorSuggestWidget-highlightForeground)}.workbench-suggest-widget .monaco-list .monaco-list-row.focused>.contents>.main .monaco-highlighted-label .highlight{color:var(--vscode-editorSuggestWidget-focusHighlightForeground)}.workbench-suggest-widget .monaco-list .monaco-list-row .monaco-icon-label.deprecated{opacity:.66;text-decoration:unset}.workbench-suggest-widget .monaco-list .monaco-list-row .monaco-icon-label.deprecated>.monaco-icon-label-container>.monaco-icon-name-container{text-decoration:line-through}.workbench-suggest-widget .monaco-list .monaco-list-row .monaco-icon-label:before{height:100%}.workbench-suggest-widget .monaco-list .monaco-list-row .icon{background-position:50%;background-repeat:no-repeat;background-size:80%;display:block;height:16px;margin-left:2px;width:16px}.workbench-suggest-widget .monaco-list .monaco-list-row .icon.hide{display:none}.workbench-suggest-widget .monaco-list .monaco-list-row .suggest-icon{align-items:center;display:flex;margin-right:4px}.workbench-suggest-widget.no-icons .monaco-list .monaco-list-row .icon,.workbench-suggest-widget.no-icons .monaco-list .monaco-list-row .suggest-icon:before{display:none}.workbench-suggest-widget .monaco-list .monaco-list-row .icon.customcolor .colorspan{border:.1em solid #000;display:inline-block;height:.7em;margin:0 0 0 .3em;width:.7em}.workbench-suggest-widget .monaco-list .monaco-list-row>.contents>.main>.right>.details-label{opacity:.7}.workbench-suggest-widget .monaco-list .monaco-list-row>.contents>.main>.left>.signature-label{opacity:.6;overflow:hidden;text-overflow:ellipsis}.workbench-suggest-widget .monaco-list .monaco-list-row>.contents>.main>.left>.qualifier-label{align-self:center;font-size:85%;line-height:normal;margin-left:12px;opacity:.4;overflow:hidden;text-overflow:ellipsis}.workbench-suggest-widget .monaco-list .monaco-list-row>.contents>.main>.right>.details-label{font-size:85%;margin-left:1.1em;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.workbench-suggest-widget .monaco-list .monaco-list-row>.contents>.main>.right>.details-label>.monaco-tokenized-source{display:inline}.workbench-suggest-widget .monaco-list .monaco-list-row>.contents>.main>.right>.details-label{display:none}.workbench-suggest-widget .monaco-list .monaco-list-row:not(.string-label)>.contents>.main>.right>.details-label,.workbench-suggest-widget.docs-side .monaco-list .monaco-list-row.focused:not(.string-label)>.contents>.main>.right>.details-label,.workbench-suggest-widget:not(.shows-details) .monaco-list .monaco-list-row.focused>.contents>.main>.right>.details-label{display:inline}.workbench-suggest-widget:not(.docs-side) .monaco-list .monaco-list-row.focused:hover>.contents>.main>.right.can-expand-details>.details-label{width:calc(100% - 26px)}.workbench-suggest-widget .monaco-list .monaco-list-row>.contents>.main>.left{flex-grow:1;flex-shrink:1;overflow:hidden}.workbench-suggest-widget .monaco-list .monaco-list-row>.contents>.main>.left>.monaco-icon-label{flex-shrink:0}.workbench-suggest-widget .monaco-list .monaco-list-row:not(.string-label)>.contents>.main>.left>.monaco-icon-label{max-width:100%}.workbench-suggest-widget .monaco-list .monaco-list-row.string-label>.contents>.main>.left>.monaco-icon-label{flex-shrink:1}.workbench-suggest-widget .monaco-list .monaco-list-row>.contents>.main>.right{flex-shrink:4;max-width:70%;overflow:hidden}.workbench-suggest-widget .monaco-list .monaco-list-row>.contents>.main>.right>.readMore{display:inline-block;height:18px;position:absolute;right:10px;visibility:hidden;width:18px}',{});var Ji=i(16252),Yi=i(17735),Zi=i(32107);class en{constructor(){this._onDidToggleDetails=new d.Q5,this.onDidToggleDetails=this._onDidToggleDetails.event,this.templateId="suggestion"}dispose(){this._onDidToggleDetails.dispose()}renderTemplate(e){const t=new u.SL,i=e;i.classList.add("show-file-icons");const n=(0,c.R3)(e,(0,c.$)(".icon")),s=(0,c.R3)(n,(0,c.$)("span.colorspan")),r=(0,c.R3)(e,(0,c.$)(".contents")),o=(0,c.R3)(r,(0,c.$)(".main")),a=(0,c.R3)(o,(0,c.$)(".icon-label.codicon")),l=(0,c.R3)(o,(0,c.$)("span.left")),h=(0,c.R3)(o,(0,c.$)("span.right")),d=new Zi.g(l,{supportHighlights:!0,supportIcons:!0});t.add(d);const m=(0,c.R3)(l,(0,c.$)("span.signature-label")),_=(0,c.R3)(l,(0,c.$)("span.qualifier-label")),g=(0,c.R3)(h,(0,c.$)("span.details-label"));return(()=>{const e="20px";i.style.fontSize="12px",i.style.fontWeight="normal",i.style.letterSpacing="0px",o.style.fontFamily="Hack",o.style.fontFeatureSettings="",o.style.lineHeight=e,n.style.height=e,n.style.width=e})(),{root:i,left:l,right:h,icon:n,colorspan:s,iconLabel:d,iconContainer:a,parametersLabel:m,qualifierLabel:_,detailsLabel:g,disposables:t}}renderElement(e,t,i){const{completion:n}=e;i.root.id=function(e){return`simple-suggest-aria-id:${e}`}(t),i.colorspan.style.backgroundColor="";const s={labelEscapeNewLines:!0,matches:(0,K.mB)(e.score)};i.icon.className="icon hide",i.iconContainer.className="",i.iconContainer.classList.add("suggest-icon",...D.kS.asClassNameArray(n.icon||R.lA.symbolText)),i.iconLabel.setLabel(n.label,void 0,s),i.parametersLabel.textContent="",i.detailsLabel.textContent=(n.detail||"").replace(/\r\n|\r|\n/g,""),i.root.classList.add("string-label"),(0,c.$Z)(i.detailsLabel),i.right.classList.remove("can-expand-details")}disposeTemplate(e){e.disposables.dispose()}}var tn=i(59870),nn=i(25015);const sn=c.$;let rn=class{get list(){return this._list}constructor(e,t,i,n){this._container=e,this._persistedSize=t,this._state=0,this._forceRenderingAbove=!1,this._pendingLayout=new u.XK,this._showTimeout=new l._F,this._disposables=new u.SL,this._onDidSelect=new d.Q5,this.onDidSelect=this._onDidSelect.event,this._onDidHide=new d.Q5,this.onDidHide=this._onDidHide.event,this._onDidShow=new d.Q5,this.onDidShow=this._onDidShow.event,this.element=new Yi.f,this.element.domNode.classList.add("workbench-suggest-widget"),this._container.appendChild(this.element.domNode);class s{constructor(e,t,i=!1,n=!1){this.persistedSize=e,this.currentSize=t,this.persistHeight=i,this.persistWidth=n}}let r;this._disposables.add(this.element.onDidWillResize((()=>{r=new s(this._persistedSize.restore(),this.element.size)}))),this._disposables.add(this.element.onDidResize((e=>{if(this._resize(e.dimension.width,e.dimension.height),r&&(r.persistHeight=r.persistHeight||!!e.north||!!e.south,r.persistWidth=r.persistWidth||!!e.east||!!e.west),e.done){if(r){const{itemHeight:e,defaultSize:t}=this._getLayoutInfo(),i=Math.round(e/2);let{width:n,height:s}=this.element.size;(!r.persistHeight||Math.abs(r.currentSize.height-s)<=i)&&(s=r.persistedSize?.height??t.height),(!r.persistWidth||Math.abs(r.currentSize.width-n)<=i)&&(n=r.persistedSize?.width??t.width),this._persistedSize.store(new c.Ro(n,s))}r=void 0}})));const o=new en;this._disposables.add(o),this._listElement=c.R3(this.element.domNode,sn(".tree")),this._list=new Ji.aV("SuggestWidget",this._listElement,{getHeight:e=>this._getLayoutInfo().itemHeight,getTemplateId:e=>"suggestion"},[o],{alwaysConsumeMouseWheel:!0,useShadows:!1,mouseSupport:!1,multipleSelectionSupport:!1,accessibilityProvider:{getRole:()=>"option",getWidgetAriaLabel:()=>(0,p.NC)("suggest","Suggest"),getWidgetRole:()=>"listbox",getAriaLabel:e=>{let t=e.completion.label;if("string"!=typeof e.completion.label){const{detail:i,description:n}=e.completion.label;i&&n?t=(0,p.NC)("label.full","{0}{1}, {2}",t,i,n):i?t=(0,p.NC)("label.detail","{0}{1}",t,i):n&&(t=(0,p.NC)("label.desc","{0}, {1}",t,n))}const{detail:i}=e.completion;return(0,p.NC)("ariaCurrenttSuggestionReadDetails","{0}, docs: {1}",t,i)}}}),i.statusBarMenuId&&(this._status=n.createInstance(nn.I,this.element.domNode,i.statusBarMenuId),this.element.domNode.classList.toggle("with-status-bar",!0)),this._disposables.add(this._list.onMouseDown((e=>this._onListMouseDownOrTap(e)))),this._disposables.add(this._list.onTap((e=>this._onListMouseDownOrTap(e)))),this._disposables.add(this._list.onDidChangeSelection((e=>this._onListSelection(e))))}dispose(){this._disposables.dispose(),this._status?.dispose(),this.element.dispose()}showSuggestions(e,t,i,n,s){if(this._cursorPosition=s,this._completionModel!==e&&(this._completionModel=e),i&&2!==this._state&&0!==this._state)this._setState(4);else{if(0===this._completionModel.items.length)return this._setState(n?0:2),void(this._completionModel=void 0);try{this._list.splice(0,this._list.length,this._completionModel.items),this._setState(i?4:3),this._list.reveal(t,0),this._list.setFocus([t])}finally{}this._pendingLayout.value=c.lI((()=>{this._pendingLayout.clear(),this._layout(this.element.size)}))}}setLineContext(e){this._completionModel&&(this._completionModel.lineContext=e)}_setState(e){if(this._state!==e)switch(this._state=e,this.element.domNode.classList.toggle("frozen",4===e),this.element.domNode.classList.remove("message"),e){case 0:c.Cp(this._listElement),this._status&&c.Cp(this._status?.element),this._status?.hide(),this._showTimeout.cancel(),this.element.domNode.classList.remove("visible"),this._list.splice(0,this._list.length),this._cappedHeight=void 0;break;case 1:case 2:this.element.domNode.classList.add("message"),c.Cp(this._listElement),this._status&&c.Cp(this._status?.element),this._show();break;case 3:case 4:case 5:c.$Z(this._listElement),this._status&&c.$Z(this._status?.element),this._show()}}_show(){this._status?.show(),c.$Z(this.element.domNode),this._layout(this._persistedSize.restore()),this._showTimeout.cancelAndSet((()=>{this.element.domNode.classList.add("visible"),this._onDidShow.fire(this)}),100)}hide(){this._pendingLayout.clear(),this._setState(0),this._onDidHide.fire(this),c.Cp(this.element.domNode),this.element.clearSashHoverState();const e=this._persistedSize.restore(),t=Math.ceil(4.3*this._getLayoutInfo().itemHeight);e&&e.height<t&&this._persistedSize.store(e.with(void 0,t))}_layout(e){if(!this._cursorPosition)return;const t=c.D6(document.body),i=this._getLayoutInfo();e||(e=i.defaultSize);let n=e.height,s=e.width;this._status&&(this._status.element.style.lineHeight=`${i.itemHeight}px`);const r=t.width-i.borderHeight-2*i.horizontalPadding;s>r&&(s=r);const o=this._completionModel?this._completionModel.stats.pLabelLen*i.typicalHalfwidthCharacterWidth:s,a=i.statusBarHeight+this._list.contentHeight+i.borderHeight,l=i.itemHeight+i.statusBarHeight,h=c.i(this._container),d=this._cursorPosition,u=h.top+d.top+d.height,m=Math.min(t.height-u-i.verticalPadding,a),_=h.top+d.top-i.verticalPadding,g=Math.min(_,a);let p=Math.min(Math.max(g,m)+i.borderHeight,a);n===this._cappedHeight?.capped&&(n=this._cappedHeight.wanted),n<l&&(n=l),n>p&&(n=p),n>m||this._forceRenderingAbove&&_>150?(this._preference=0,this.element.enableSashes(!0,!0,!1,!1),p=g):(this._preference=1,this.element.enableSashes(!1,!0,!0,!1),p=m),this.element.preferredSize=new c.Ro(o,i.defaultSize.height),this.element.maxSize=new c.Ro(r,p),this.element.minSize=new c.Ro(220,l),this._cappedHeight=n===a?{wanted:this._cappedHeight?.wanted??e.height,capped:n}:void 0,this.element.domNode.style.left=`${this._cursorPosition.left}px`,0===this._preference?this.element.domNode.style.top=this._cursorPosition.top-n-i.borderHeight+"px":this.element.domNode.style.top=`${this._cursorPosition.top+this._cursorPosition.height}px`,this._resize(s,n)}_resize(e,t){const{width:i,height:n}=this.element.maxSize;e=Math.min(i,e),n&&(t=Math.min(n,t));const{statusBarHeight:s}=this._getLayoutInfo();this._list.layout(t-s,e),this._listElement.style.height=t-s+"px",this._listElement.style.width=`${e}px`,this._listElement.style.height=`${t}px`,this.element.layout(t,e)}_getLayoutInfo(){const e=(0,tn.uZ)(20,8,1e3);return{itemHeight:e,statusBarHeight:0,borderWidth:1,borderHeight:2,typicalHalfwidthCharacterWidth:10,verticalPadding:22,horizontalPadding:14,defaultSize:new c.Ro(430,0+12*e+2)}}_onListMouseDownOrTap(e){void 0!==e.element&&void 0!==e.index&&(e.browserEvent.preventDefault(),e.browserEvent.stopPropagation(),this._select(e.element,e.index))}_onListSelection(e){e.elements.length&&this._select(e.elements[0],e.indexes[0])}_select(e,t){const i=this._completionModel;i&&this._onDidSelect.fire({item:e,index:t,model:i})}selectNext(){this._list.focusNext(1,!0);const e=this._list.getFocus();return e.length>0&&this._list.reveal(e[0]),!0}selectNextPage(){this._list.focusNextPage();const e=this._list.getFocus();return e.length>0&&this._list.reveal(e[0]),!0}selectPrevious(){this._list.focusPrevious(1,!0);const e=this._list.getFocus();return e.length>0&&this._list.reveal(e[0]),!0}selectPreviousPage(){this._list.focusPreviousPage();const e=this._list.getFocus();return e.length>0&&this._list.reveal(e[0]),!0}getFocusedItem(){if(this._completionModel)return{item:this._list.getFocusedElements()[0],index:this._list.getFocus()[0],model:this._completionModel}}forceRenderingAbove(){this._forceRenderingAbove||(this._forceRenderingAbove=!0,this._layout(this._persistedSize.restore()))}stopForceRenderingAbove(){this._forceRenderingAbove=!1}};rn=(0,a.g)([(0,a.f)(3,S.TG)],rn);var on=i(54101),an=i(86253);const cn={0:R.lA.symbolText,1:R.lA.history,2:R.lA.symbolMethod,3:R.lA.symbolFile,4:R.lA.folder,5:R.lA.symbolProperty,6:R.lA.symbolMethod,7:R.lA.symbolVariable,8:R.lA.symbolValue,9:R.lA.symbolVariable,10:R.lA.symbolNamespace,11:R.lA.symbolInterface,12:R.lA.symbolKeyword,13:R.lA.symbolKeyword};let ln=class extends u.JT{constructor(e,t){super(),this._terminalSuggestWidgetVisibleContextKey=e,this._instantiationService=t,this._enableWidget=!0,this._cursorIndexStart=0,this._cursorIndexDelta=0,this._onBell=new d.Q5,this.onBell=this._onBell.event,this._onAcceptedCompletion=new d.Q5,this.onAcceptedCompletion=this._onAcceptedCompletion.event,this._cachedBashAliases=new Set,this._cachedBashBuiltins=new Set,this._cachedBashCommands=new Set,this._cachedBashKeywords=new Set}activate(e){this._terminal=e,this._register(e.parser.registerOscHandler(633,(e=>this._handleVSCodeSequence(e)))),this._register(e.onData((e=>{this._handleTerminalInput(e)})))}setContainer(e){this._container=e}_handleVSCodeSequence(e){if(!this._terminal)return!1;const[t,...i]=e.split(";");switch(t){case"Completions":return this._handleCompletionsSequence(this._terminal,e,t,i),!0;case"CompletionsBash":return this._handleCompletionsBashSequence(this._terminal,e,t,i),!0;case"CompletionsBashFirstWord":return this._handleCompletionsBashFirstWordSequence(this._terminal,e,t,i)}return!1}_handleCompletionsSequence(e,t,i,n){if(!e.element||!this._enableWidget)return;const s=parseInt(n[0]),r=parseInt(n[1]);if(this._cursorIndexStart=parseInt(n[2]),!n[3])return void this._onBell.fire();let o=JSON.parse(t.slice(i.length+n[0].length+n[1].length+n[2].length+4));Array.isArray(o)||(o=[o]);const a=o.map((e=>new ji({label:e.CompletionText,icon:cn[e.ResultType],detail:e.ToolTip})));this._leadingLineContent=a[0].completion.label.slice(0,r),this._cursorIndexDelta=0;const c=new Xi(a,new Qi(this._leadingLineContent,s),s,r);1!==a.length||0!==a[0].completion.label.substring(r).length?this._handleCompletionModel(c):this._onBell.fire()}_handleCompletionsBashFirstWordSequence(e,t,i,n){const s=n[0],r=t.slice(i.length+s.length+2).split(";");let o;switch(s){case"alias":o=this._cachedBashAliases;break;case"builtin":o=this._cachedBashBuiltins;break;case"command":o=this._cachedBashCommands;break;case"keyword":o=this._cachedBashKeywords;break;default:return!1}o.clear();const a=new Set;for(const e of r)a.add(e);for(const e of a)o.add(new ji({label:e,icon:R.lA.symbolString,detail:s}));return this._cachedFirstWord=void 0,!0}_handleCompletionsBashSequence(e,t,i,n){if(!e.element)return;let s=parseInt(n[0]);const r=parseInt(n[1]);if(!n[2])return void this._onBell.fire();const o=t.slice(i.length+n[0].length+n[1].length+n[2].length+4).split(";");let a;if(100!==s&&o.length>0?a=o.map((e=>new ji({label:e,icon:R.lA.symbolProperty}))):(s=0,this._cachedFirstWord||(this._cachedFirstWord=[...this._cachedBashAliases,...this._cachedBashBuiltins,...this._cachedBashCommands,...this._cachedBashKeywords],this._cachedFirstWord.sort(((e,t)=>{const i=e.completion.label.charCodeAt(0),n=t.completion.label.charCodeAt(0),s=i<65||i>90&&i<97||i>122?1:0,r=n<65||n>90&&n<97||n>122?1:0;return s!==r?s-r:e.completion.label.localeCompare(t.completion.label)}))),a=this._cachedFirstWord),0===a.length)return;this._leadingLineContent=a[0].completion.label.slice(0,r);const c=new Xi(a,new Qi(this._leadingLineContent,s),s,r);1!==a.length||0!==a[0].completion.label.substring(r).length?this._handleCompletionModel(c):this._onBell.fire()}_handleCompletionModel(e){if(0===e.items.length||!this._terminal?.element)return;if(1===e.items.length)return void this.acceptSelectedSuggestion({item:e.items[0],model:e});const t=this._ensureSuggestWidget(this._terminal);this._additionalInput=void 0;const i={width:this._terminal._core._renderService.dimensions.device.cell.width,height:this._terminal._core._renderService.dimensions.device.cell.height};if(!i.width||!i.height)return;const n=this._terminal.element.getBoundingClientRect(),s=c.Fx(this._container,"panel").offsetParent.getBoundingClientRect();if(t.showSuggestions(e,0,!1,!1,{left:n.left-s.left+this._terminal.buffer.active.cursorX*i.width,top:n.top-s.top+this._terminal.buffer.active.cursorY*i.height,height:i.height}),this._inputQueue){const e=this._inputQueue;this._inputQueue=void 0;for(const t of e)this._handleTerminalInput(t)}}_ensureSuggestWidget(e){return this._terminalSuggestWidgetVisibleContextKey.set(!0),this._suggestWidget||(this._suggestWidget=this._register(this._instantiationService.createInstance(rn,c.Fx(this._container,"panel"),this._instantiationService.createInstance(pn),{})),this._suggestWidget.list.style((0,an.TU)({listInactiveFocusBackground:on.OF,listInactiveFocusOutline:y.xL1})),this._suggestWidget.onDidSelect((async e=>this.acceptSelectedSuggestion(e))),this._suggestWidget.onDidHide((()=>this._terminalSuggestWidgetVisibleContextKey.set(!1))),this._suggestWidget.onDidShow((()=>this._terminalSuggestWidgetVisibleContextKey.set(!0)))),this._suggestWidget}selectPreviousSuggestion(){this._suggestWidget?.selectPrevious()}selectPreviousPageSuggestion(){this._suggestWidget?.selectPreviousPage()}selectNextSuggestion(){this._suggestWidget?.selectNext()}selectNextPageSuggestion(){this._suggestWidget?.selectNextPage()}acceptSelectedSuggestion(e){e||(e=this._suggestWidget?.getFocusedItem()),e&&this._leadingLineContent&&(this._suggestWidget?.hide(),this._onAcceptedCompletion.fire(["[D".repeat(Math.max(e.model.replacementLength-this._cursorIndexStart+this._cursorIndexDelta,0)),"[3~".repeat(this._additionalInput?.length??0),"".repeat(e.model.replacementLength),e.item.completion.label].join("")),this._enableWidget=!1,(0,l.Vs)(100).then((e=>this._enableWidget=!0)))}hideSuggestWidget(){this._suggestWidget?.hide()}handleNonXtermData(e){this._handleTerminalInput(e)}_handleTerminalInput(e){if(!this._terminal||!this._enableWidget||!this._terminalSuggestWidgetVisibleContextKey.get())return void("-"===e?this._inputQueue=[]:this._inputQueue?.push(e));let t=!1;if(""===e&&this._additionalInput&&this._additionalInput.length>0&&this._cursorIndexDelta>0&&(t=!0,this._additionalInput=this._additionalInput.substring(0,this._cursorIndexDelta---1)+this._additionalInput.substring(this._cursorIndexDelta)),"[3~"===e&&this._additionalInput&&this._additionalInput.length>0&&this._cursorIndexDelta<this._additionalInput.length-1&&(t=!0,this._additionalInput=this._additionalInput.substring(0,this._cursorIndexDelta)+this._additionalInput.substring(this._cursorIndexDelta+1)),"[D"===e&&this._cursorIndexDelta>0&&(t=!0,this._cursorIndexDelta--),"[C"===e&&(t=!0,this._cursorIndexDelta+=1),e.match(/^[a-z0-9]$/i)&&(t=!0,void 0===this._additionalInput&&(this._additionalInput=""),this._additionalInput+=e,this._cursorIndexDelta++),t){if(this._terminalSuggestWidgetVisibleContextKey.get()&&this._suggestWidget?.setLineContext(new Qi(this._leadingLineContent+(this._additionalInput??""),this._additionalInput?.length??0)),0===this._suggestWidget._completionModel?.items.length)return this._additionalInput=void 0,void this.hideSuggestWidget();const e={width:this._terminal._core._renderService.dimensions.device.cell.width,height:this._terminal._core._renderService.dimensions.device.cell.height};if(!e.width||!e.height)return;const t=this._terminal.element.getBoundingClientRect(),i=c.Fx(this._container,"panel").offsetParent.getBoundingClientRect();this._suggestWidget?.showSuggestions(this._suggestWidget._completionModel,0,!1,!1,{left:t.left-i.left+this._terminal.buffer.active.cursorX*e.width,top:t.top-i.top+this._terminal.buffer.active.cursorY*e.height,height:e.height})}else this._additionalInput=void 0,this.hideSuggestWidget()}};ln=(0,a.g)([(0,a.f)(1,S.TG)],ln);let hn,dn,un,mn,_n,gn,pn=class{constructor(e){this._storageService=e,this._key="terminal.integrated.suggestSize"}restore(){const e=this._storageService.get(this._key,0)??"";try{const t=JSON.parse(e);if(c.Ro.is(t))return c.Ro.lift(t)}catch{}}store(e){this._storageService.store(this._key,JSON.stringify(e),0,1)}reset(){this._storageService.remove(this._key,0)}};function fn(e,t){let i=t.getLine(e);if(!i)return{lineData:void 0,lineIndex:e};let n=i.translateToString(!0);for(;e>0&&i.isWrapped&&(i=t.getLine(--e),i);)n=i.translateToString(!1)+n;return{lineData:n,lineIndex:e}}pn=(0,a.g)([(0,a.f)(0,ke.Uy)],pn);let vn=class e extends u.SL{static{this._suggestedRendererType=void 0}get findResult(){return this._lastFindResult}get isStdinDisabled(){return!!this.raw.options.disableStdin}get markTracker(){return this._markNavigationAddon}get shellIntegration(){return this._shellIntegrationAddon}get suggestController(){return this._suggestAddon}get textureAtlas(){const e=this._webglAddon?.textureAtlas||this._canvasAddon?.textureAtlas;if(e)return createImageBitmap(e)}get isFocused(){return!!this.raw.element?.contains(document.activeElement)}constructor(t,i,n,s,r,o,a,c,l,h,m,_,g,p,f,v,b,S){super(),this._configHelper=i,this._backgroundColorProvider=r,this._capabilities=o,this._terminalSuggestWidgetVisibleContextKey=c,this._configurationService=h,this._instantiationService=m,this._logService=_,this._notificationService=g,this._storageService=p,this._themeService=f,this._telemetryService=v,this._clipboardService=b,this._attachedDisposables=this.add(new u.SL),this._onDidRequestRunCommand=new d.Q5,this.onDidRequestRunCommand=this._onDidRequestRunCommand.event,this._onDidRequestFocus=new d.Q5,this.onDidRequestFocus=this._onDidRequestFocus.event,this._onDidRequestSendText=new d.Q5,this.onDidRequestSendText=this._onDidRequestSendText.event,this._onDidRequestFreePort=new d.Q5,this.onDidRequestFreePort=this._onDidRequestFreePort.event,this._onDidChangeFindResults=new d.Q5,this.onDidChangeFindResults=this._onDidChangeFindResults.event,this._onDidChangeSelection=new d.Q5,this.onDidChangeSelection=this._onDidChangeSelection.event,this._onDidChangeFocus=new d.Q5,this.onDidChangeFocus=this._onDidChangeFocus.event,this._onDidDispose=new d.Q5,this.onDidDispose=this._onDidDispose.event;const w=this._configHelper.getFont(void 0,!0),C=this._configHelper.config,y=this._configurationService.getValue("editor");this.raw=this.add(new t({allowProposedApi:!0,cols:n,rows:s,altClickMovesCursor:C.altClickMovesCursor&&"alt"===y.multiCursorModifier,scrollback:C.scrollback,theme:this._getXtermTheme(),drawBoldTextInBrightColors:C.drawBoldTextInBrightColors,fontFamily:w.fontFamily,fontWeight:C.fontWeight,fontWeightBold:C.fontWeightBold,fontSize:w.fontSize,letterSpacing:w.letterSpacing,lineHeight:w.lineHeight,logLevel:bn(this._logService.getLevel()),logger:this._logService,minimumContrastRatio:C.minimumContrastRatio,tabStopWidth:C.tabStopWidth,cursorBlink:C.cursorBlinking,cursorStyle:"line"===C.cursorStyle?"bar":C.cursorStyle,cursorWidth:C.cursorWidth,macOptionIsMeta:C.macOptionIsMeta,macOptionClickForcesSelection:C.macOptionClickForcesSelection,rightClickSelectsWord:"selectWord"===C.rightClickBehavior,fastScrollModifier:"alt",fastScrollSensitivity:C.fastScrollSensitivity,scrollSensitivity:C.mouseWheelScrollSensitivity,wordSeparator:C.wordSeparators,overviewRulerWidth:10,smoothScrollDuration:C.smoothScrolling?125:0})),this._core=this.raw._core,this.add(this._configurationService.onDidChangeConfiguration((async t=>{t.affectsConfiguration("terminal.integrated.gpuAcceleration")&&(e._suggestedRendererType=void 0),(t.affectsConfiguration("terminal.integrated")||t.affectsConfiguration("editor.fastScrollSensitivity")||t.affectsConfiguration("editor.mouseWheelScrollSensitivity")||t.affectsConfiguration("editor.multiCursorModifier"))&&this.updateConfig(),t.affectsConfiguration("terminal.integrated.unicodeVersion")&&this._updateUnicodeVersion()}))),this.add(this._themeService.onDidColorThemeChange((e=>this._updateTheme(e)))),this.add(this._logService.onDidChangeLogLevel((e=>this.raw.options.logLevel=bn(e)))),this.add(this.raw.onSelectionChange((()=>{this._onDidChangeSelection.fire(),this.isFocused&&this._anyFocusedTerminalHasSelection.set(this.raw.hasSelection())}))),this._updateUnicodeVersion(),this._markNavigationAddon=this._instantiationService.createInstance(xi,o),this.raw.loadAddon(this._markNavigationAddon),this._decorationAddon=this._instantiationService.createInstance(qi,this._capabilities),this._decorationAddon.onDidRequestRunCommand((e=>this._onDidRequestRunCommand.fire(e))),this.raw.loadAddon(this._decorationAddon),this._shellIntegrationAddon=new Wi(a,l,this._telemetryService,this._logService),this.raw.loadAddon(this._shellIntegrationAddon),this._anyTerminalFocusContextKey=he.r.focusInAny.bindTo(S),this._anyFocusedTerminalHasSelection=he.r.textSelectedInFocused.bindTo(S),this._terminalSuggestWidgetVisibleContextKey&&(this._suggestAddon=this._instantiationService.createInstance(ln,this._terminalSuggestWidgetVisibleContextKey),this.raw.loadAddon(this._suggestAddon),this._suggestAddon.onAcceptedCompletion((async e=>{this._onDidRequestFocus.fire(),this._onDidRequestSendText.fire(e)})))}*getBufferReverseIterator(){for(let e=this.raw.buffer.active.length;e>=0;e--){const{lineData:t,lineIndex:i}=fn(e,this.raw.buffer.active);t&&(e=i,yield t)}}async getContentsAsHtml(){if(!this._serializeAddon){const e=await this._getSerializeAddonConstructor();this._serializeAddon=new e,this.raw.loadAddon(this._serializeAddon)}return this._serializeAddon.serializeAsHTML()}async getSelectionAsHtml(e){if(!this._serializeAddon){const e=await this._getSerializeAddonConstructor();this._serializeAddon=new e,this.raw.loadAddon(this._serializeAddon)}if(e){const t=e.getOutput()?.length,i=e.marker?.line;if(!t||!i)throw new Error(`No row ${i} or output length ${t} for command ${e}`);this.raw.select(0,i+1,t-Math.floor(t/this.raw.cols))}const t=this._serializeAddon.serializeAsHTML({onlySelection:!0});return e&&this.raw.clearSelection(),t}attachToElement(e,t){const i={enableGpu:!0,...t};if(this._attached||this.raw.open(e),i.enableGpu&&(this._shouldLoadWebgl()?this._enableWebglRenderer():this._shouldLoadCanvas()&&this._enableCanvasRenderer()),!this.raw.element||!this.raw.textarea)throw new Error("xterm elements not set after open");const n=this._attachedDisposables;return n.clear(),n.add(c.nm(this.raw.textarea,"focus",(()=>this._setFocused(!0)))),n.add(c.nm(this.raw.textarea,"blur",(()=>this._setFocused(!1)))),n.add(c.nm(this.raw.textarea,"focusout",(()=>this._setFocused(!1)))),this._suggestAddon?.setContainer(e),this._attached={container:e,options:i},this._attached?.container.querySelector(".xterm-screen")}_setFocused(e){this._onDidChangeFocus.fire(e),this._anyTerminalFocusContextKey.set(e),this._anyFocusedTerminalHasSelection.set(e&&this.raw.hasSelection())}write(e){this.raw.write(e)}resize(e,t){this.raw.resize(e,t)}updateConfig(){const e=this._configHelper.config;this.raw.options.altClickMovesCursor=e.altClickMovesCursor,this._setCursorBlink(e.cursorBlinking),this._setCursorStyle(e.cursorStyle),this._setCursorWidth(e.cursorWidth),this.raw.options.scrollback=e.scrollback,this.raw.options.drawBoldTextInBrightColors=e.drawBoldTextInBrightColors,this.raw.options.minimumContrastRatio=e.minimumContrastRatio,this.raw.options.tabStopWidth=e.tabStopWidth,this.raw.options.fastScrollSensitivity=e.fastScrollSensitivity,this.raw.options.scrollSensitivity=e.mouseWheelScrollSensitivity,this.raw.options.macOptionIsMeta=e.macOptionIsMeta;const t=this._configurationService.getValue("editor");this.raw.options.altClickMovesCursor=e.altClickMovesCursor&&"alt"===t.multiCursorModifier,this.raw.options.macOptionClickForcesSelection=e.macOptionClickForcesSelection,this.raw.options.rightClickSelectsWord="selectWord"===e.rightClickBehavior,this.raw.options.wordSeparator=e.wordSeparators,this.raw.options.customGlyphs=e.customGlyphs,this.raw.options.smoothScrollDuration=e.smoothScrolling?125:0,this._attached?.options.enableGpu&&(this._shouldLoadWebgl()?this._enableWebglRenderer():(this._disposeOfWebglRenderer(),this._shouldLoadCanvas()?this._enableCanvasRenderer():this._disposeOfCanvasRenderer()))}_shouldLoadWebgl(){return!wi.G6&&"auto"===this._configHelper.config.gpuAcceleration&&void 0===e._suggestedRendererType||"on"===this._configHelper.config.gpuAcceleration}_shouldLoadCanvas(){return"auto"===this._configHelper.config.gpuAcceleration&&(void 0===e._suggestedRendererType||"canvas"===e._suggestedRendererType)||"canvas"===this._configHelper.config.gpuAcceleration}forceRedraw(){this.raw.clearTextureAtlas()}clearDecorations(){this._decorationAddon?.clearDecorations()}forceRefresh(){this._core.viewport?._innerRefresh()}forceUnpause(){this._canvasAddon&&(this._core._renderService?._handleIntersectionChange({intersectionRatio:1}),this.raw.refresh(0,this.raw.rows-1))}async findNext(e,t){return this._updateFindColors(t),(await this._getSearchAddon()).findNext(e,t)}async findPrevious(e,t){return this._updateFindColors(t),(await this._getSearchAddon()).findPrevious(e,t)}_updateFindColors(e){const t=this._themeService.getColorTheme(),i=t.getColor(yi.Es)||t.getColor(Di.v9),n=t.getColor(yi.lt),s=t.getColor(yi.iP),r=t.getColor(yi.Qh),o=t.getColor(yi.UO),a=t.getColor(yi.L1),c=t.getColor(yi.$);e.decorations={activeMatchBackground:n?.toString(),activeMatchBorder:s?.toString()||"transparent",activeMatchColorOverviewRuler:r?.toString()||"transparent",matchBackground:i?o?.blend(i).toString():void 0,matchBorder:a?.toString()||"transparent",matchOverviewRuler:c?.toString()||"transparent"}}_getSearchAddon(){return this._searchAddonPromise||(this._searchAddonPromise=this._getSearchAddonConstructor().then((e=>(this._searchAddon=new e({highlightLimit:1e3}),this.raw.loadAddon(this._searchAddon),this._searchAddon.onDidChangeResults((e=>{this._lastFindResult=e,this._onDidChangeFindResults.fire(e)})),this._searchAddon)))),this._searchAddonPromise}clearSearchDecorations(){this._searchAddon?.clearDecorations()}clearActiveSearchDecoration(){this._searchAddon?.clearActiveDecoration()}getFont(){return this._configHelper.getFont(this._core)}getLongestViewportWrappedLineLength(){let e=0;for(let t=this.raw.buffer.active.length-1;t>=this.raw.buffer.active.viewportY;t--){const i=this._getWrappedLineCount(t,this.raw.buffer.active);e=Math.max(e,i.lineCount*this.raw.cols-i.endSpaces||0),t=i.currentIndex}return e}_getWrappedLineCount(e,t){let i=t.getLine(e);if(!i)throw new Error("Could not get line");let n=e,s=0;for(let e=Math.min(i.length,this.raw.cols)-1;e>=0&&!i?.getCell(e)?.getChars();e--)s++;for(;i?.isWrapped&&n>0;)n--,i=t.getLine(n);return{lineCount:e-n+1,currentIndex:n,endSpaces:s}}scrollDownLine(){this.raw.scrollLines(1)}scrollDownPage(){this.raw.scrollPages(1)}scrollToBottom(){this.raw.scrollToBottom()}scrollUpLine(){this.raw.scrollLines(-1)}scrollUpPage(){this.raw.scrollPages(-1)}scrollToTop(){this.raw.scrollToTop()}clearBuffer(){this.raw.clear(),this._capabilities.get(2)?.handlePromptStart(),this._capabilities.get(2)?.handleCommandStart()}hasSelection(){return this.raw.hasSelection()}clearSelection(){this.raw.clearSelection()}selectAll(){this.raw.focus(),this.raw.selectAll()}focus(){this.raw.focus()}async copySelection(e,t){if(this.hasSelection()||e&&t)if(e){const i=await this.getSelectionAsHtml(t);function n(e){e.clipboardData.types.includes("text/plain")||e.clipboardData.setData("text/plain",t?.getOutput()??""),e.clipboardData.setData("text/html",i),e.preventDefault()}document.addEventListener("copy",n),document.execCommand("copy"),document.removeEventListener("copy",n)}else await this._clipboardService.writeText(this.raw.getSelection());else this._notificationService.warn((0,p.NC)("terminal.integrated.copySelection.noSelection","The terminal has no selection to copy"))}_setCursorBlink(e){this.raw.options.cursorBlink!==e&&(this.raw.options.cursorBlink=e,this.raw.refresh(0,this.raw.rows-1))}_setCursorStyle(e){this.raw.options.cursorStyle!==e&&(this.raw.options.cursorStyle="line"===e?"bar":e)}_setCursorWidth(e){this.raw.options.cursorWidth!==e&&(this.raw.options.cursorWidth=e)}async _enableWebglRenderer(){if(!this.raw.element||this._webglAddon)return;const t=await this._getWebglAddonConstructor();this._webglAddon=new t,this._disposeOfCanvasRenderer();try{this.raw.loadAddon(this._webglAddon),this._logService.trace("Webgl was loaded"),this._webglAddon.onContextLoss((()=>{this._logService.info("Webgl lost context, disposing of webgl renderer"),this._disposeOfWebglRenderer()})),this._refreshImageAddon()}catch(t){this._logService.warn("Webgl could not be loaded. Falling back to the canvas renderer type.",t),this._storageService.getBoolean("terminal.integrated.neverMeasureRenderTime",-1,!1)||"off"===this._configHelper.config.gpuAcceleration||this._measureRenderTime(),e._suggestedRendererType="canvas",this._disposeOfWebglRenderer(),this._enableCanvasRenderer()}}async _enableCanvasRenderer(){if(!this.raw.element||this._canvasAddon)return;const t=await this._getCanvasAddonConstructor();this._canvasAddon=new t,this._disposeOfWebglRenderer();try{this.raw.loadAddon(this._canvasAddon),this._logService.trace("Canvas renderer was loaded")}catch(t){this._logService.warn("Canvas renderer could not be loaded, falling back to dom renderer",t),this._storageService.getBoolean("terminal.integrated.neverMeasureRenderTime",-1,!1)||"off"===this._configHelper.config.gpuAcceleration||this._measureRenderTime(),e._suggestedRendererType="dom",this._disposeOfCanvasRenderer()}this._refreshImageAddon()}async _getCanvasAddonConstructor(){return hn||(hn=(await i.e(421).then(i.t.bind(i,9421,19)).then((e=>e.default??e))).CanvasAddon),hn}async _refreshImageAddon(){if(this._configHelper.config.enableImages&&(this._canvasAddon||this._webglAddon)){if(!this._imageAddon){const e=await this._getImageAddonConstructor();this._imageAddon=new e,this.raw.loadAddon(this._imageAddon)}}else{try{this._imageAddon?.dispose()}catch{}this._imageAddon=void 0}}async _getImageAddonConstructor(){return dn||(dn=(await i.e(588).then(i.t.bind(i,45588,19)).then((e=>e.default??e))).ImageAddon),dn}async _getSearchAddonConstructor(){return un||(un=(await i.e(747).then(i.t.bind(i,747,19)).then((e=>e.default??e))).SearchAddon),un}async _getUnicode11Constructor(){return _n||(_n=(await i.e(993).then(i.t.bind(i,32993,19)).then((e=>e.default??e))).Unicode11Addon),_n}async _getWebglAddonConstructor(){return gn||(gn=(await i.e(292).then(i.t.bind(i,90292,19)).then((e=>e.default??e))).WebglAddon),gn}async _getSerializeAddonConstructor(){return mn||(mn=(await i.e(286).then(i.t.bind(i,12286,19)).then((e=>e.default??e))).SerializeAddon),mn}_disposeOfCanvasRenderer(){try{this._canvasAddon?.dispose()}catch{}this._canvasAddon=void 0,this._refreshImageAddon()}_disposeOfWebglRenderer(){try{this._webglAddon?.dispose()}catch{}this._webglAddon=void 0,this._refreshImageAddon()}async _measureRenderTime(){const t=[];if(!this._core._renderService?._renderer._renderLayers)return;const i=this._core._renderService._renderer._renderLayers[0],n=i?.onGridChanged,s=()=>{if(t.shift(),t.sort(((e,t)=>e-t))[Math.floor(t.length/2)]>50)if("auto"===this._configHelper.config.gpuAcceleration)e._suggestedRendererType="dom",this.updateConfig();else{const e=[{label:(0,p.NC)("yes","Yes"),run:()=>this._configurationService.updateValue("terminal.integrated.gpuAcceleration","off",2)},{label:(0,p.NC)("no","No"),run:()=>{}},{label:(0,p.NC)("dontShowAgain","Don't Show Again"),isSecondary:!0,run:()=>this._storageService.store("terminal.integrated.neverMeasureRenderTime",!0,-1,1)}];this._notificationService.prompt(w.zb.Warning,(0,p.NC)("terminal.slowRendering","Terminal GPU acceleration appears to be slow on your computer. Would you like to switch to disable it which may improve performance? [Read more about terminal settings](https://code.visualstudio.com/docs/editor/integrated-terminal#_changing-how-the-terminal-is-rendered)."),e)}};i.onGridChanged=(e,r,o)=>{const a=performance.now();n.call(i,e,r,o),t.push(performance.now()-a),20===t.length&&(s(),i.onGridChanged=n)}}_getXtermTheme(e){e||(e=this._themeService.getColorTheme());const t=e.getColor(yi.Y$),i=this._backgroundColorProvider.getBackgroundColor(e),n=e.getColor(yi.PY)||t,s=e.getColor(yi.oZ)||i,r=e.getColor(yi.Qr),o=e.getColor(yi.wq),a=e.getColor(yi.md)||void 0;return{background:i?.toString(),foreground:t?.toString(),cursor:n?.toString(),cursorAccent:s?.toString(),selectionBackground:r?.toString(),selectionInactiveBackground:o?.toString(),selectionForeground:a?.toString(),black:e.getColor(yi.D2[0])?.toString(),red:e.getColor(yi.D2[1])?.toString(),green:e.getColor(yi.D2[2])?.toString(),yellow:e.getColor(yi.D2[3])?.toString(),blue:e.getColor(yi.D2[4])?.toString(),magenta:e.getColor(yi.D2[5])?.toString(),cyan:e.getColor(yi.D2[6])?.toString(),white:e.getColor(yi.D2[7])?.toString(),brightBlack:e.getColor(yi.D2[8])?.toString(),brightRed:e.getColor(yi.D2[9])?.toString(),brightGreen:e.getColor(yi.D2[10])?.toString(),brightYellow:e.getColor(yi.D2[11])?.toString(),brightBlue:e.getColor(yi.D2[12])?.toString(),brightMagenta:e.getColor(yi.D2[13])?.toString(),brightCyan:e.getColor(yi.D2[14])?.toString(),brightWhite:e.getColor(yi.D2[15])?.toString()}}_updateTheme(e){this.raw.options.theme=this._getXtermTheme(e)}refresh(){this._updateTheme(),this._decorationAddon.refreshLayouts()}async _updateUnicodeVersion(){if(!this._unicode11Addon&&"11"===this._configHelper.config.unicodeVersion){const e=await this._getUnicode11Constructor();this._unicode11Addon=new e,this.raw.loadAddon(this._unicode11Addon)}this.raw.unicode.activeVersion!==this._configHelper.config.unicodeVersion&&(this.raw.unicode.activeVersion=this._configHelper.config.unicodeVersion)}_writeText(e){this.raw.write(e)}dispose(){this._anyTerminalFocusContextKey.reset(),this._anyFocusedTerminalHasSelection.reset(),this._onDidDispose.fire(),super.dispose()}};function bn(e){switch(e){case At.in.Trace:case At.in.Debug:return"debug";case At.in.Info:return"info";case At.in.Warning:return"warn";case At.in.Error:return"error";default:return"off"}}vn.__decorator=(0,a.g)([(0,h.Ds)(100)],vn.prototype,"_refreshImageAddon",null),vn=(0,a.g)([(0,a.f)(9,v.Ui),(0,a.f)(10,S.TG),(0,a.f)(11,s.DV),(0,a.f)(12,w.lT),(0,a.f)(13,ke.Uy),(0,a.f)(14,I.XE),(0,a.f)(15,Ft.bU),(0,a.f)(16,Fe.p),(0,a.f)(17,b.i6)],vn);var Sn,wn=i(23547),Cn=i(59069),yn=i(64117),xn=i(68843),kn=i(37940),In=i(16021),Dn=i(60972),Tn=i(91847),En=i(62355),An=i(33425),Ln=i(89872);function Pn(e,t){Rn.INSTANCE.registerTerminalContribution(e,t)}!function(e){e.getTerminalContributions=function(){return Rn.INSTANCE.getTerminalContributions()}}(Sn||(Sn={}));class Rn{static{this.INSTANCE=new Rn}constructor(){this._terminalContributions=[]}registerTerminalContribution(e,t){this._terminalContributions.push({id:e,ctor:t})}getTerminalContributions(){return this._terminalContributions.slice(0)}}Ln.B.add("terminal.contributions",Rn.INSTANCE);var Mn=i(57078);class Bn{constructor(e){this._process=e,this.type=1,this._cwd="",this._onDidChangeCwd=new d.Q5,this.onDidChangeCwd=this._onDidChangeCwd.event}async getCwd(){if(!this._process)return Promise.resolve("");const e=await this._process.getCwd();return e!==this._cwd&&this._onDidChangeCwd.fire(e),this._cwd=e,this._cwd}}class Nn{constructor(e,t){this._totalDataLength=0,this._entries=[{cols:e,rows:t,data:[]}]}handleResize(e,t){if(this._entries.length>0&&0===this._entries[this._entries.length-1].data.length&&this._entries.pop(),this._entries.length>0){const i=this._entries[this._entries.length-1];if(i.cols===e&&i.rows===t)return;if(0===i.cols&&0===i.rows)return i.cols=e,void(i.rows=t)}this._entries.push({cols:e,rows:t,data:[]})}handleData(e){for(this._entries[this._entries.length-1].data.push(e),this._totalDataLength+=e.length;this._totalDataLength>1048576;){const e=this._entries[0],t=this._totalDataLength-1048576;t>=e.data[0].length?(this._totalDataLength-=e.data[0].length,e.data.shift(),0===e.data.length&&this._entries.shift()):(e.data[0]=e.data[0].substr(t),this._totalDataLength-=t)}}generateReplayEventSync(){return this._entries.forEach((e=>{e.data.length>0&&(e.data=[e.data.join("")])})),{events:this._entries.map((e=>({cols:e.cols,rows:e.rows,data:e.data[0]??""}))),commands:{isWindowsPty:!1,commands:[]}}}async generateReplayEvent(){return this.generateReplayEventSync()}}let On=class{constructor(e,t,i,n,s){this._diff=e,this._terminalId=t,this._collection=i,this._terminalService=n,this._extensionService=s,this.requiresAction=!0}_getInfo(e){const t=new Set;Wn(t,this._diff.added.values()),Wn(t,this._diff.removed.values()),Wn(t,this._diff.changed.values());let i=(0,p.NC)("extensionEnvironmentContributionInfoStale","The following extensions want to relaunch the terminal to contribute to its environment:");return i+=Fn(this._collection,e,this._extensionService,t),i}_getActions(){return[{label:(0,p.NC)("relaunchTerminalLabel","Relaunch terminal"),run:()=>this._terminalService.getInstanceFromId(this._terminalId)?.relaunch(),commandId:"workbench.action.terminal.relaunch"}]}getStatus(e){return{id:"relaunch-needed",severity:ct.Z.Warning,icon:R.lA.warning,tooltip:this._getInfo(e),hoverActions:this._getActions()}}};On=(0,a.g)([(0,a.f)(3,o.x4),(0,a.f)(4,St.QS)],On);let Hn=class{constructor(e,t,i){this._collection=e,this._commandService=t,this._extensionService=i,this.requiresAction=!1}_getInfo(e){const t=new Set;Wn(t,this._collection.getVariableMap(e).values());let i=(0,p.NC)("extensionEnvironmentContributionInfoActive","The following extensions have contributed to this terminal's environment:");return i+=Fn(this._collection,e,this._extensionService,t),i}_getActions(e){return[{label:(0,p.NC)("showEnvironmentContributions","Show environment contributions"),run:()=>this._commandService.executeCommand("workbench.action.terminal.showEnvironmentContributions",e),commandId:"workbench.action.terminal.showEnvironmentContributions"}]}getStatus(e){return{id:"env-var-info-changes-active",severity:ct.Z.Info,tooltip:this._getInfo(e),hoverActions:this._getActions(e)}}};function Fn(e,t,i,n){const s=["\n"],r=e.getDescriptionMap(void 0),o=e.getDescriptionMap(t);for(const e of n){const t=r.get(e);t&&(s.push(`\n- \`${Vn(e,i)}\``),s.push(`: ${t}`));const n=o.get(e);if(n){const r=t?` (${(0,p.NC)("ScopedEnvironmentContributionInfo","workspace")})`:"";s.push(`\n- \`${Vn(e,i)}${r}\``),s.push(`: ${n}`)}t||n||s.push(`\n- \`${Vn(e,i)}\``)}return s.join("")}function Wn(e,t){for(const i of t)for(const t of i)e.add(t.extensionIdentifier)}function Vn(e,t){return t.extensions.find((t=>t.id===e))?.displayName||e}Hn=(0,a.g)([(0,a.f)(1,f.H),(0,a.f)(2,St.QS)],Hn);var $n,Un=i(91317);!function(e){e[e.Replace=1]="Replace",e[e.Append=2]="Append",e[e.Prepend=3]="Prepend"}($n||($n={}));const Gn=new Map([[$n.Append,"APPEND"],[$n.Prepend,"PREPEND"],[$n.Replace,"REPLACE"]]);class zn{constructor(e){this.collections=e,this.map=new Map,this.descriptionMap=new Map,e.forEach(((e,t)=>{this.populateDescriptionMap(e,t);const i=e.map.entries();let n=i.next();for(;!n.done;){const e=n.value[1],s=n.value[0];let r=this.map.get(s);if(r||(r=[],this.map.set(s,r)),r.length>0&&r[0].type===$n.Replace){n=i.next();continue}const o={extensionIdentifier:t,value:e.value,type:e.type,scope:e.scope,variable:e.variable,options:e.options};o.scope||delete o.scope,r.unshift(o),n=i.next()}}))}async applyToProcessEnvironment(e,t,i){let n;_.ED&&(n={},Object.keys(e).forEach((e=>n[e.toLowerCase()]=e)));for(const[s,r]of this.getVariableMap(t)){const t=_.ED&&n[s.toLowerCase()]||s;for(const n of r){const r=i?await i(n.value):n.value;if(n.options?.applyAtProcessCreation??1)switch(n.type){case $n.Append:e[t]=(e[t]||"")+r;break;case $n.Prepend:e[t]=r+(e[t]||"");break;case $n.Replace:e[t]=r}if(n.options?.applyAtShellIntegration){const t=`VSCODE_ENV_${Gn.get(n.type)}`;e[t]=(e[t]?e[t]+":":"")+s+"="+this._encodeColons(r)}}}}_encodeColons(e){return e.replaceAll(":","\\x3a")}diff(e,t){const i=new Map,n=new Map,s=new Map;if(e.getVariableMap(t).forEach(((e,n)=>{const s=qn(e,this.getVariableMap(t).get(n));s&&i.set(n,s)})),this.getVariableMap(t).forEach(((i,n)=>{const r=qn(i,e.getVariableMap(t).get(n));r&&s.set(n,r)})),this.getVariableMap(t).forEach(((i,s)=>{const r=function(e,t){if(!t)return;const i=new Map;t.forEach((e=>i.set(e.extensionIdentifier,e)));const n=[];return e.forEach((e=>{const t=i.get(e.extensionIdentifier);!t||e.type===t.type&&e.value===t.value&&e.scope?.workspaceFolder?.index===t.scope?.workspaceFolder?.index||n.push(t)})),0===n.length?void 0:n}(i,e.getVariableMap(t).get(s));r&&n.set(s,r)})),0!==i.size||0!==n.size||0!==s.size)return{added:i,changed:n,removed:s}}getVariableMap(e){const t=new Map;for(const i of this.map.values()){const n=i.filter((t=>Kn(t,e)));n.length>0&&t.set(n[0].variable,n)}return t}getDescriptionMap(e){const t=new Map;for(const i of this.descriptionMap.values()){const n=i.filter((t=>Kn(t,e,!0)));for(const e of n)t.set(e.extensionIdentifier,e.description)}return t}populateDescriptionMap(e,t){if(!e.descriptionMap)return;const i=e.descriptionMap.entries();let n=i.next();for(;!n.done;){const e=n.value[1],s=n.value[0];let r=this.descriptionMap.get(s);r||(r=[],this.descriptionMap.set(s,r));const o={extensionIdentifier:t,scope:e.scope,description:e.description};o.scope||delete o.scope,r.push(o),n=i.next()}}}function Kn(e,t,i=!1){return e.scope?!(!e.scope.workspaceFolder||!t?.workspaceFolder||e.scope.workspaceFolder.index!==t.workspaceFolder.index):!i||t===e.scope}function qn(e,t){if(!t)return e;const i=new Set;t.forEach((e=>i.add(e.extensionIdentifier)));const n=[];return e.forEach((e=>{i.has(e.extensionIdentifier)||n.push(e)})),0===n.length?void 0:n}function jn(e,t){if(t)if(_.ED)for(const i in t){let n=i;for(const t in e)if(i.toLowerCase()===t.toLowerCase()){n=t;break}const s=t[i];void 0!==s&&Qn(e,n,s)}else Object.keys(t).forEach((i=>{const n=t[i];void 0!==n&&Qn(e,i,n)}))}function Qn(e,t,i){"string"==typeof i?e[t]=i:delete e[t]}function Xn(e,t){if(t)for(const i of Object.keys(t)){const n=t[i];null!=n&&(e[i]=n)}}async function Jn(e,t){return await Promise.all(Object.entries(t).map((async([i,n])=>{if("string"==typeof n)try{t[i]=await e(n)}catch(e){t[i]=n}}))),t}async function Yn(e,t,i){if(t)try{return await t(e)}catch(e){return void i?.error("Could not resolve terminal cwd",e)}return e}function Zn(e,t,i){const n="string"==typeof e?g.ov.parse(e):e;let s=n?(0,B.f6)(t.getWorkspaceFolder(n)):void 0;if(!s){const e=i.getLastActiveWorkspaceRoot();s=e?(0,B.f6)(t.getWorkspaceFolder(e)):void 0}return s}var es=i(51858),ts=i(98e3);let is=class extends u.JT{get persistentProcessId(){return this._process?.id}get shouldPersist(){return!!this.reconnectionProperties||!!this._process&&this._process.shouldPersist}get hasWrittenData(){return this._hasWrittenData}get hasChildProcesses(){return this._hasChildProcesses}get reconnectionProperties(){return this._shellLaunchConfig?.attachPersistentProcess?.reconnectionProperties||this._shellLaunchConfig?.reconnectionProperties||void 0}get extEnvironmentVariableCollection(){return this._extEnvironmentVariableCollection}constructor(e,t,i,n,s,r,o,a,c,l,h,u,m,_,g,p,f,v,b,S){super(),this._instanceId=e,this._configHelper=t,this._historyService=r,this._instantiationService=o,this._logService=a,this._workspaceContextService=c,this._configurationResolverService=l,this._workbenchEnvironmentService=h,this._productService=u,this._remoteAgentService=m,this._pathService=_,this._environmentVariableService=g,this._terminalProfileResolverService=p,this._configurationService=f,this._terminalInstanceService=v,this._telemetryService=b,this._notificationService=S,this.processState=1,this.capabilities=new Ti,this._isDisposed=!1,this._process=null,this._processType=0,this._preLaunchInputQueue=[],this._hasWrittenData=!1,this._hasChildProcesses=!1,this._ptyListenersAttached=!1,this._isDisconnected=!1,this._dimensions={cols:0,rows:0},this._onPtyDisconnect=this._register(new d.Q5),this.onPtyDisconnect=this._onPtyDisconnect.event,this._onPtyReconnect=this._register(new d.Q5),this.onPtyReconnect=this._onPtyReconnect.event,this._onProcessReady=this._register(new d.Q5),this.onProcessReady=this._onProcessReady.event,this._onProcessStateChange=this._register(new d.Q5),this.onProcessStateChange=this._onProcessStateChange.event,this._onBeforeProcessData=this._register(new d.Q5),this.onBeforeProcessData=this._onBeforeProcessData.event,this._onProcessData=this._register(new d.Q5),this.onProcessData=this._onProcessData.event,this._onProcessReplayComplete=this._register(new d.Q5),this.onProcessReplayComplete=this._onProcessReplayComplete.event,this._onDidChangeProperty=this._register(new d.Q5),this.onDidChangeProperty=this._onDidChangeProperty.event,this._onEnvironmentVariableInfoChange=this._register(new d.Q5),this.onEnvironmentVariableInfoChanged=this._onEnvironmentVariableInfoChange.event,this._onProcessExit=this._register(new d.Q5),this.onProcessExit=this._onProcessExit.event,this._onRestoreCommands=this._register(new d.Q5),this.onRestoreCommands=this._onRestoreCommands.event,this._cwdWorkspaceFolder=Zn(i,this._workspaceContextService,this._historyService),this.ptyProcessReady=this._createPtyProcessReadyPromise(),this._ackDataBufferer=new ns((e=>this._process?.acknowledgeDataEvent(e))),this._dataFilter=this._instantiationService.createInstance(ss),this._dataFilter.onProcessData((e=>{const t={data:"string"==typeof e?e:e.data};this._onBeforeProcessData.fire(t),t.data&&t.data.length>0&&("string"!=typeof e&&(e.data=t.data),this._onProcessData.fire("string"!=typeof e?e:{data:t.data,trackCommit:!1}))})),this.remoteAuthority=i&&"object"==typeof i?(0,Mn.ik)(i):this._workbenchEnvironmentService.remoteAuthority,n&&(this._extEnvironmentVariableCollection=new zn(n),this._register(this._environmentVariableService.onDidChangeCollections((e=>this._onEnvironmentVariableCollectionChange(e)))),this.environmentVariableInfo=this._instantiationService.createInstance(Hn,this._extEnvironmentVariableCollection),this._onEnvironmentVariableInfoChange.fire(this.environmentVariableInfo)),this.shellIntegrationNonce=s??(0,ts.R)()}async freePortKillProcess(e){try{this._process?.freePortKillProcess&&await(this._process?.freePortKillProcess(e))}catch(t){this._notificationService.notify({message:(0,p.NC)("killportfailure","Could not kill process listening on port {0}, command exited with error {1}",e,t),severity:ct.Z.Warning})}}dispose(e=!1){this._isDisposed=!0,this._process&&(this._setProcessState(5),this._process.shutdown(e),this._process=null),super.dispose()}_createPtyProcessReadyPromise(){return new Promise((e=>{const t=this.onProcessReady((()=>{this._logService.debug(`Terminal process ready (shellProcessId: ${this.shellProcessId})`),t.dispose(),e(void 0)}))}))}async detachFromProcess(e){await(this._process?.detach?.(e)),this._process=null}async createProcess(e,t,i,n=!0){let s;if(this._shellLaunchConfig=e,this._dimensions.cols=t,this._dimensions.rows=i,e.customPtyImplementation)this._processType=1,s=e.customPtyImplementation(this._instanceId,t,i);else{const n=await this._terminalInstanceService.getBackend(this.remoteAuthority);if(!n)throw new Error(`No terminal backend registered for remote authority '${this.remoteAuthority}'`);this.backend=n;const r=function(e,t,i){if(i)return n=>i.resolveWithEnvironment(t,e,n)}(this._cwdWorkspaceFolder,await this._terminalProfileResolverService.getEnvironment(this.remoteAuthority),this._configurationResolverService);if(this.userHome=this._pathService.resolvedUserHome?.fsPath,this.os=_.OS,this.remoteAuthority){const o=await this._pathService.userHome();this.userHome=o.path;const a=await this._remoteAgentService.getEnvironment();if(!a)throw new Error(`Failed to get remote environment for remote authority "${this.remoteAuthority}"`);this.userHome=a.userHome.path,this.os=a.os;const c=await this._resolveEnvironment(n,r,e),l=(this._configurationService.getValue("task.reconnection")&&e.reconnectionProperties||!e.isFeatureTerminal)&&this._configHelper.config.enablePersistentSessions&&!e.isTransient;if(e.attachPersistentProcess){const t=await n.attachToProcess(e.attachPersistentProcess.id);t?s=t:(this._logService.warn("Attach to process failed for terminal",e.attachPersistentProcess),e.attachPersistentProcess=void 0)}if(!s){await this._terminalProfileResolverService.resolveShellLaunchConfig(e,{remoteAuthority:this.remoteAuthority,os:this.os});const r={shellIntegration:{enabled:this._configurationService.getValue("terminal.integrated.shellIntegration.enabled"),suggestEnabled:this._configurationService.getValue("terminal.integrated.shellIntegration.suggestEnabled"),nonce:this.shellIntegrationNonce},windowsEnableConpty:this._configHelper.config.windowsEnableConpty,environmentVariableCollections:this._extEnvironmentVariableCollection?.collections?(0,En.a)(this._extEnvironmentVariableCollection.collections):void 0,workspaceFolder:this._cwdWorkspaceFolder};try{s=await n.createProcess(e,"",t,i,this._configHelper.config.unicodeVersion,c,r,l)}catch(e){if("Could not fetch remote environment"===e?.message)return void this._logService.trace("Could not fetch remote environment, silently failing");throw e}}this._isDisposed||this._setupPtyHostListeners(n)}else{if(e.attachPersistentProcess){const t=e.attachPersistentProcess.findRevivedId?await n.attachToRevivedProcess(e.attachPersistentProcess.id):await n.attachToProcess(e.attachPersistentProcess.id);t?s=t:(this._logService.warn("Attach to process failed for terminal",e.attachPersistentProcess),e.attachPersistentProcess=void 0)}s||(s=await this._launchLocalProcess(n,e,t,i,this.userHome,r)),this._isDisposed||this._setupPtyHostListeners(n)}}if(this._isDisposed)return void s.shutdown(!1);this._process=s,this._setProcessState(2),3!==this.os&&2!==this.os||this.capabilities.add(1,new Bn(this._process)),this._dataFilter.newProcess(this._process,n),this._processListeners&&(0,u.B9)(this._processListeners),this._processListeners=[s.onProcessReady((e=>{this.shellProcessId=e.pid,this._initialCwd=e.cwd,this._onDidChangeProperty.fire({type:"initialCwd",value:this._initialCwd}),this._onProcessReady.fire(e),this._preLaunchInputQueue.length>0&&this._process&&(s.input(this._preLaunchInputQueue.join("")),this._preLaunchInputQueue.length=0)})),s.onProcessExit((e=>this._onExit(e))),s.onDidChangeProperty((({type:e,value:t})=>{switch(e){case"hasChildProcesses":this._hasChildProcesses=t;break;case"failedShellIntegrationActivation":this._telemetryService?.publicLog2("terminal/shellIntegrationActivationFailureCustomArgs")}this._onDidChangeProperty.fire({type:e,value:t})}))],s.onProcessReplayComplete&&this._processListeners.push(s.onProcessReplayComplete((()=>this._onProcessReplayComplete.fire()))),s.onRestoreCommands&&this._processListeners.push(s.onRestoreCommands((e=>this._onRestoreCommands.fire(e)))),setTimeout((()=>{2===this.processState&&this._setProcessState(3)}),500);const r=await s.start();if(r)return r;(0,l.To)((()=>{this.backend?.getLatency().then((e=>{this._logService.info(`Latency measurements for ${this.remoteAuthority??"local"} backend\n${e.map((e=>`${e.label}: ${e.latency.toFixed(2)}ms`)).join("\n")}`)}))}))}async relaunch(e,t,i,n){return this.ptyProcessReady=this._createPtyProcessReadyPromise(),this._logService.trace(`Relaunching terminal instance ${this._instanceId}`),this._isDisconnected&&(this._isDisconnected=!1,this._onPtyReconnect.fire()),this._hasWrittenData=!1,this.createProcess(e,t,i,n)}async _resolveEnvironment(e,t,i){const n=Zn(i.cwd,this._workspaceContextService,this._historyService),s=_.ED?"windows":_.dz?"osx":"linux",r=this._configurationService.getValue(`terminal.integrated.env.${s}`);let o;this._configHelper.showRecommendations(i),o=i.useShellEnvironment?await e.getShellEnvironment():await this._terminalProfileResolverService.getEnvironment(this.remoteAuthority);const a=await async function(e,t,i,n,s,r){const o={};if(e.strictEnv)Xn(o,e.env);else{Xn(o,r);const a={...t};i&&(a&&await Jn(i,a),e.env&&await Jn(i,e.env)),function(e,...t){const i=["VSCODE_IPC_HOOK_CLI"].reduce(((e,t)=>(e[t]=!0,e)),{}),n=[/^ELECTRON_.+$/,/^VSCODE_(?!(PORTABLE|SHELL_LOGIN|ENV_REPLACE|ENV_APPEND|ENV_PREPEND)).+$/,/^SNAP(|_.*)$/,/^GDK_PIXBUF_.+$/];Object.keys(e).filter((e=>!i[e])).forEach((t=>{for(let i=0;i<n.length;i++)if(-1!==t.search(n[i])){delete e[t];break}}))}(o),jn(o,a),jn(o,e.env),function(e,t,i,n){e.TERM_PROGRAM="vscode",t&&(e.TERM_PROGRAM_VERSION=t),function(e,t){if("on"===t)return!0;if("auto"===t){const t=e.LANG;return!t||-1===t.search(/\.UTF\-8$/)&&-1===t.search(/\.utf8$/)&&-1===t.search(/\.euc.+/)}return!1}(e,n)&&(e.LANG=function(e){const t=e?e.split("-"):[],i=t.length;if(0===i)return"en_US.UTF-8";if(1===i){const e={af:"ZA",am:"ET",be:"BY",bg:"BG",ca:"ES",cs:"CZ",da:"DK",de:"DE",el:"GR",en:"US",es:"ES",et:"EE",eu:"ES",fi:"FI",fr:"FR",he:"IL",hr:"HR",hu:"HU",hy:"AM",is:"IS",it:"IT",ja:"JP",kk:"KZ",ko:"KR",lt:"LT",nl:"NL",no:"NO",pl:"PL",pt:"BR",ro:"RO",ru:"RU",sk:"SK",sl:"SI",sr:"YU",sv:"SE",tr:"TR",uk:"UA",zh:"CN"};t[0]in e&&t.push(e[t[0]])}else t[1]=t[1].toUpperCase();return t.join("_")+".UTF-8"}(i)),e.COLORTERM="truecolor"}(o,n,_.dK,s)}return o}(i,r,t,this._productService.version,this._configHelper.config.detectLocale,o);return this._isDisposed||i.strictEnv||i.hideFromUser||(this._extEnvironmentVariableCollection=this._environmentVariableService.mergedCollection,this._register(this._environmentVariableService.onDidChangeCollections((e=>this._onEnvironmentVariableCollectionChange(e)))),await this._extEnvironmentVariableCollection.applyToProcessEnvironment(a,{workspaceFolder:n},t),this._extEnvironmentVariableCollection.getVariableMap({workspaceFolder:n}).size&&(this.environmentVariableInfo=this._instantiationService.createInstance(Hn,this._extEnvironmentVariableCollection),this._onEnvironmentVariableInfoChange.fire(this.environmentVariableInfo))),a}async _launchLocalProcess(e,t,i,n,s,r){await this._terminalProfileResolverService.resolveShellLaunchConfig(t,{remoteAuthority:void 0,os:_.OS});const o=this._historyService.getLastActiveWorkspaceRoot(m.lg.file),a=await async function(e,t,i,n,s,r){if(e.cwd){const t="object"==typeof e.cwd?e.cwd.fsPath:e.cwd;return Fi(await Yn(t,i)||t)}let o;return!e.ignoreConfigurationCwd&&s&&(i&&(s=await Yn(s,i,r)),s&&(Se.YP(s)?o=s:n&&(o=Se.v_(n.fsPath,s)))),o||(o=n?n.fsPath:t||""),Fi(o)}(t,s,r,o,this._configHelper.config.cwd,this._logService),c=await this._resolveEnvironment(e,r,t),l={shellIntegration:{enabled:this._configurationService.getValue("terminal.integrated.shellIntegration.enabled"),suggestEnabled:this._configurationService.getValue("terminal.integrated.shellIntegration.suggestEnabled"),nonce:this.shellIntegrationNonce},windowsEnableConpty:this._configHelper.config.windowsEnableConpty,environmentVariableCollections:this._extEnvironmentVariableCollection?(0,En.a)(this._extEnvironmentVariableCollection.collections):void 0,workspaceFolder:this._cwdWorkspaceFolder},h=(this._configurationService.getValue("task.reconnection")&&t.reconnectionProperties||!t.isFeatureTerminal)&&this._configHelper.config.enablePersistentSessions&&!t.isTransient;return await e.createProcess(t,a,i,n,this._configHelper.config.unicodeVersion,c,l,h)}_setupPtyHostListeners(e){this._ptyListenersAttached||(this._ptyListenersAttached=!0,this._register(e.onPtyHostUnresponsive((()=>{this._isDisconnected=!0,this._onPtyDisconnect.fire()}))),this._ptyResponsiveListener=e.onPtyHostResponsive((()=>{this._isDisconnected=!1,this._onPtyReconnect.fire()})),this._register((0,u.OF)((()=>this._ptyResponsiveListener?.dispose()))),this._register(e.onPtyHostRestart((async()=>{if(this._isDisconnected||(this._isDisconnected=!0,this._onPtyDisconnect.fire()),this._ptyResponsiveListener?.dispose(),this._ptyResponsiveListener=void 0,this._shellLaunchConfig)if(this._shellLaunchConfig.isFeatureTerminal&&!this.reconnectionProperties)this._onExit(-1);else{const e=(0,p.NC)("ptyHostRelaunch","Restarting the terminal because the connection to the shell process was lost...");this._onProcessData.fire({data:C(e,{loudFormatting:!0}),trackCommit:!1}),await this.relaunch(this._shellLaunchConfig,this._dimensions.cols,this._dimensions.rows,!1)}}))))}async getBackendOS(){let e=_.OS;if(this.remoteAuthority){const t=await this._remoteAgentService.getEnvironment();if(!t)throw new Error(`Failed to get remote environment for remote authority "${this.remoteAuthority}"`);e=t.os}return e}setDimensions(e,t,i){if(!i)return this.ptyProcessReady.then((()=>this._resize(e,t)));this._resize(e,t)}async setUnicodeVersion(e){return this._process?.setUnicodeVersion(e)}_resize(e,t){if(this._process){try{this._process.resize(e,t)}catch(e){if("EPIPE"!==e.code&&"ERR_IPC_CHANNEL_CLOSED"!==e.code)throw e}this._dimensions.cols=e,this._dimensions.rows=t}}async write(e){await this.ptyProcessReady,this._dataFilter.disableSeamlessRelaunch(),this._hasWrittenData=!0,this.shellProcessId||1===this._processType?this._process&&this._process.input(e):this._preLaunchInputQueue.push(e)}async processBinary(e){await this.ptyProcessReady,this._dataFilter.disableSeamlessRelaunch(),this._hasWrittenData=!0,this._process?.processBinary(e)}get initialCwd(){return this._initialCwd??""}async refreshProperty(e){if(!this._process)throw new Error("Cannot refresh property when process is not set");return this._process.refreshProperty(e)}async updateProperty(e,t){return this._process?.updateProperty(e,t)}acknowledgeDataEvent(e){this._ackDataBufferer.ack(e)}_onExit(e){this._process=null,2===this.processState&&this._setProcessState(4),3===this.processState&&this._setProcessState(6),this._onProcessExit.fire(e)}_setProcessState(e){this.processState=e,this._onProcessStateChange.fire()}_onEnvironmentVariableCollectionChange(e){const t=this._extEnvironmentVariableCollection.diff(e,{workspaceFolder:this._cwdWorkspaceFolder});void 0!==t?(this.environmentVariableInfo=this._instantiationService.createInstance(On,t,this._instanceId,e),this._onEnvironmentVariableInfoChange.fire(this.environmentVariableInfo)):this.environmentVariableInfo instanceof On&&(this.environmentVariableInfo=this._instantiationService.createInstance(Hn,this._extEnvironmentVariableCollection),this._onEnvironmentVariableInfoChange.fire(this.environmentVariableInfo))}async clearBuffer(){this._process?.clearBuffer?.()}};is=(0,a.g)([(0,a.f)(5,fe.CE),(0,a.f)(6,S.TG),(0,a.f)(7,s.DV),(0,a.f)(8,T.ec),(0,a.f)(9,ge.qb),(0,a.f)(10,pe.n),(0,a.f)(11,It.a),(0,a.f)(12,be.R),(0,a.f)(13,es.a),(0,a.f)(14,Un.M),(0,a.f)(15,r.if),(0,a.f)(16,v.Ui),(0,a.f)(17,o.N4),(0,a.f)(18,Ft.bU),(0,a.f)(19,w.lT)],is);class ns{constructor(e){this._callback=e,this._unsentCharCount=0}ack(e){for(this._unsentCharCount+=e;this._unsentCharCount>5e3;)this._unsentCharCount-=5e3,this._callback(5e3)}}let ss=class extends u.JT{get onProcessData(){return this._onProcessData.event}constructor(e){super(),this._logService=e,this._disableSeamlessRelaunch=!1,this._onProcessData=this._register(new d.Q5)}newProcess(e,t){if(this._dataListener?.dispose(),this._activeProcess?.shutdown(!1),this._activeProcess=e,!this._firstRecorder||!t||this._disableSeamlessRelaunch)return this._firstDisposable?.dispose(),[this._firstRecorder,this._firstDisposable]=this._createRecorder(e),this._disableSeamlessRelaunch&&t&&this._onProcessData.fire("c"),this._dataListener=e.onProcessData((e=>this._onProcessData.fire(e))),void(this._disableSeamlessRelaunch=!1);this._secondRecorder&&this.triggerSwap(),this._swapTimeout=window.setTimeout((()=>this.triggerSwap()),3e3),this._dataListener?.dispose(),this._firstDisposable?.dispose();const i=this._createRecorder(e);[this._secondRecorder,this._secondDisposable]=i}disableSeamlessRelaunch(){this._disableSeamlessRelaunch=!0,this._stopRecording(),this.triggerSwap()}triggerSwap(){if(this._swapTimeout&&(window.clearTimeout(this._swapTimeout),this._swapTimeout=void 0),!this._firstRecorder)return;if(!this._secondRecorder)return this._firstRecorder=void 0,void this._firstDisposable?.dispose();const e=this._getDataFromRecorder(this._firstRecorder),t=this._getDataFromRecorder(this._secondRecorder);e===t?this._logService.trace("Seamless terminal relaunch - identical content"):(this._logService.trace("Seamless terminal relaunch - resetting content"),this._onProcessData.fire({data:`c${t}`,trackCommit:!1})),this._dataListener?.dispose(),this._dataListener=this._activeProcess.onProcessData((e=>this._onProcessData.fire(e))),this._firstRecorder=this._secondRecorder,this._firstDisposable?.dispose(),this._firstDisposable=this._secondDisposable,this._secondRecorder=void 0}_stopRecording(){this._swapTimeout||(this._firstRecorder=void 0,this._firstDisposable?.dispose(),this._secondRecorder=void 0,this._secondDisposable?.dispose())}_createRecorder(e){const t=new Nn(0,0),i=e.onProcessData((e=>t.handleData("string"==typeof e?e:e.data)));return[t,i]}_getDataFromRecorder(e){return e.generateReplayEventSync().events.filter((e=>!!e.data)).map((e=>e.data)).join("")}};ss=(0,a.g)([(0,a.f)(0,s.DV)],ss);var rs=i(98892),os=i(96692);async function as(e,t,i,n,s,r){if(!t.xterm)return;const o=e.get(ae.AR),a=e.get(S.TG),c=e.get($.eJ),l=e.get(ke.Uy),h=`terminal.pinnedRecentCommands.${t.shellType}`;let d,u=[];const m=new Set,f={iconClass:D.kS.asClassName(ie),tooltip:(0,p.NC)("removeCommand","Remove from Command History")},v={iconClass:D.kS.asClassName(ne),tooltip:(0,p.NC)("viewCommandOutput","View Command Output"),alwaysVisible:!1};if("command"===n){d=_.dz?(0,p.NC)("selectRecentCommandMac","Select a command to run (hold Option-key to edit the command)"):(0,p.NC)("selectRecentCommand","Select a command to run (hold Alt-key to edit the command)");const k=t.capabilities.get(2),I=k?.commands,T=k?.executingCommand;function E(e){return e.replace(/\r?\n/g,"⏎").replace(/\s\s\s+/g,"⋯")}if(T&&m.add(T),I&&I.length>0){for(const M of I){const B=M.command.trim();if(0===B.length||m.has(B))continue;let N=Hi(M.cwd,t.userHome,1===t.os?"\\":"/");M.exitCode&&(-1===M.exitCode?N+=" failed":N+=` exitCode: ${M.exitCode}`),N=N.trim();const O=[v],H=u.length>0?u[u.length-1]:void 0;"separator"===H?.type||H?.label!==B?(u.push({label:E(B),rawLabel:B,description:N,id:M.timestamp.toString(),command:M,buttons:M.hasOutput()?O:void 0}),m.add(B)):(H.id=M.timestamp.toString(),H.description=N)}u=u.reverse()}T&&u.unshift({label:E(T),rawLabel:T,description:k.cwd}),u.length>0&&u.unshift({type:"separator",label:oe.currentSessionCategory});const A=a.invokeFunction(Te),L=[];for(const[F,W]of A.entries)m.has(F)||W.shellType!==t.shellType||(L.unshift({label:E(F),rawLabel:F,buttons:[f]}),m.add(F));L.length>0&&u.push({type:"separator",label:oe.previousSessionCategory},...L);const P=await a.invokeFunction(Le,t.shellType),R=[];for(const V of P)m.has(V)||R.unshift({label:E(V),rawLabel:V});R.length>0&&u.push({type:"separator",label:(0,p.NC)("shellFileHistoryCategory","{0} history",t.shellType)},...R)}else{d=_.dz?(0,p.NC)("selectRecentDirectoryMac","Select a directory to go to (hold Option-key to edit the command)"):(0,p.NC)("selectRecentDirectory","Select a directory to go to (hold Alt-key to edit the command)");const U=t.capabilities.get(0)?.cwds||[];if(U&&U.length>0){for(const K of U)u.push({label:K,rawLabel:K});u=u.reverse(),u.unshift({type:"separator",label:oe.currentSessionCategory})}const G=a.invokeFunction(Ee),z=[];for(const[q,j]of G.entries)null!==j&&j.remoteAuthority!==t.remoteAuthority||U.includes(q)||z.unshift({label:q,rawLabel:q,buttons:[f]});z.length>0&&u.push({type:"separator",label:oe.previousSessionCategory},...z)}if(0===u.length)return;const b=new rs.ZD({title:"Fuzzy search",icon:se,isChecked:"fuzzy"===s,inputActiveOptionBorder:(0,y.n_1)(y.PRb),inputActiveOptionForeground:(0,y.n_1)(y.Pvw),inputActiveOptionBackground:(0,y.n_1)(y.XEs)});b.onChange((()=>{a.invokeFunction(as,t,i,n,b.checked?"fuzzy":"contiguous",C.value)}));const w=a.createInstance(cs),C=c.createQuickPick(),x=u;return C.items=[...x],C.sortByLabel=!1,C.placeholder=d,C.matchOnLabelMode=s||"contiguous",C.toggles=[b],C.onDidTriggerItemButton((async e=>{if(e.button===f)"command"===n?a.invokeFunction(Te)?.remove(e.item.label):a.invokeFunction(Ee)?.remove(e.item.label);else if(e.button===v){const i=e.item.command,n=i?.getOutput();if(n&&i?.command){const e=await w.provideTextContent(g.ov.from({scheme:cs.scheme,path:`${i.command}... ${(0,Nt.Z)(i.timestamp,!0)}`,fragment:n,query:`terminal-output-${i.timestamp}-${t.instanceId}`}));e&&await o.openEditor({resource:e.uri})}}await a.invokeFunction(as,t,i,n,s,r)})),C.onDidChangeValue((async e=>{e||await a.invokeFunction(as,t,i,n,s,e)})),C.onDidAccept((async()=>{const e=C.activeItems[0];let i;i="cwd"===n?`cd ${await t.preparePathForShell(e.rawLabel)}`:e.rawLabel,C.hide(),t.runCommand(i,!C.keyMods.alt),C.keyMods.alt&&t.focus()})),r&&(C.value=r),new Promise((e=>{i.set(!0),(0,os.N)(l,h,C,!0),C.onDidHide((()=>{i.set(!1),e()}))}))}let cs=class e{static{this.scheme="TERMINAL_OUTPUT"}constructor(t,i){this._modelService=i,t.registerTextModelContentProvider(e.scheme,this)}async provideTextContent(e){const t=this._modelService.getModel(e);return t&&!t.isDisposed()?t:this._modelService.createModel(e.fragment,null,e,!1)}};cs=(0,a.g)([(0,a.f)(0,Ct.S),(0,a.f)(1,Me.q)],cs);let ls=class extends u.JT{get onDidAddStatus(){return this._onDidAddStatus.event}get onDidRemoveStatus(){return this._onDidRemoveStatus.event}get onDidChangePrimaryStatus(){return this._onDidChangePrimaryStatus.event}constructor(e){super(),this._configurationService=e,this._statuses=new Map,this._statusTimeouts=new Map,this._onDidAddStatus=this._register(new d.Q5),this._onDidRemoveStatus=this._register(new d.Q5),this._onDidChangePrimaryStatus=this._register(new d.Q5)}get primary(){let e;for(const t of this._statuses.values())(!e||t.severity>=e.severity)&&(e=t);return e}get statuses(){return Array.from(this._statuses.values())}add(e,t){e=this._applyAnimationSetting(e);const i=this._statusTimeouts.get(e.id);if(i&&(window.clearTimeout(i),this._statusTimeouts.delete(e.id)),t&&t>0){const i=window.setTimeout((()=>this.remove(e)),t);this._statusTimeouts.set(e.id,i)}const n=this._statuses.get(e.id);if(n&&n!==e&&(this._onDidRemoveStatus.fire(n),this._statuses.delete(n.id)),!this._statuses.has(e.id)){const t=this.primary;this._statuses.set(e.id,e),this._onDidAddStatus.fire(e);const i=this.primary;t!==i&&this._onDidChangePrimaryStatus.fire(i)}}remove(e){const t="string"==typeof e?this._statuses.get(e):e;if(t&&this._statuses.get(t.id)){const e=this.primary?.id===t.id;this._statuses.delete(t.id),this._onDidRemoveStatus.fire(t),e&&this._onDidChangePrimaryStatus.fire(this.primary)}}toggle(e,t){t?this.add(e):this.remove(e)}_applyAnimationSetting(e){if(!e.icon||"spin"!==D.kS.getModifier(e.icon)||this._configurationService.getValue("terminal.integrated.tabs.enableAnimation"))return e;let t;return t=e.icon.id===x.Tk.id?R.lA.play:D.kS.modify(e.icon,void 0),{...e,icon:t}}};function hs(e){switch(e){case ct.Z.Error:return y.fLH;case ct.Z.Warning:return y.J_Y;default:return""}}ls=(0,a.g)([(0,a.f)(0,v.Ui)],ls);class ds{constructor(){this._attached=new Map}attachToElement(e){this._container||(this._container=document.createElement("div"),this._container.classList.add("terminal-widget-container"),e.appendChild(this._container))}dispose(){this._container&&this._container.parentElement&&(this._container.parentElement.removeChild(this._container),this._container=void 0)}attachWidget(e){if(this._container)return this._attached.get(e.id)?.dispose(),e.attach(this._container),this._attached.set(e.id,e),{dispose:()=>{this._attached.get(e.id)===e&&(this._attached.delete(e.id),e.dispose())}}}}class us extends u.JT{constructor(e){super(),this._initializationPromise=e,this._isOsSet=!1,this._onLineData=this._register(new d.Q5),this.onLineData=this._onLineData.event}async activate(e){this._xterm=e,await this._initializationPromise,this._register(e.onLineFeed((()=>{const t=e.buffer,i=t.active.getLine(t.active.baseY+t.active.cursorY);i&&!i.isWrapped&&this._sendLineData(t.active,t.active.baseY+t.active.cursorY-1)}))),this._register((0,u.OF)((()=>{const t=e.buffer;this._sendLineData(t.active,t.active.baseY+t.active.cursorY)})))}setOperatingSystem(e){if(!this._isOsSet&&this._xterm&&(this._isOsSet=!0,1===e)){const e=this._xterm;this._register(e.parser.registerCsiHandler({final:"H"},(()=>{const t=e.buffer;return this._sendLineData(t.active,t.active.baseY+t.active.cursorY),!1})))}}_sendLineData(e,t){let i=e.getLine(t);if(!i)return;let n=i.translateToString(!0);for(;t>0&&i.isWrapped&&(i=e.getLine(--t),i);)n=i.translateToString(!1)+n;this._onLineData.fire(n)}}var ms=i(9301),_s=i(12320);let gs;const ps=["bash","zsh","pwsh","pwsh"];let fs=class e extends u.JT{static{this._instanceIdCounter=1}get domElement(){return this._wrapperElement}get usedShellIntegrationInjection(){return this._usedShellIntegrationInjection}get extEnvironmentVariableCollection(){return this._processManager.extEnvironmentVariableCollection}get waitOnExit(){return this._shellLaunchConfig.attachPersistentProcess?.waitOnExit||this._shellLaunchConfig.waitOnExit}set waitOnExit(e){this._shellLaunchConfig.waitOnExit=e}get target(){return this._target}set target(e){this._target=e}get instanceId(){return this._instanceId}get resource(){return this._resource}get cols(){return void 0!==this._fixedCols?this._fixedCols:this._dimensionsOverride&&this._dimensionsOverride.cols?this._dimensionsOverride.forceExactSize?this._dimensionsOverride.cols:Math.min(Math.max(this._dimensionsOverride.cols,2),this._cols):this._cols}get rows(){return void 0!==this._fixedRows?this._fixedRows:this._dimensionsOverride&&this._dimensionsOverride.rows?this._dimensionsOverride.forceExactSize?this._dimensionsOverride.rows:Math.min(Math.max(this._dimensionsOverride.rows,2),this._rows):this._rows}get isDisposed(){return this._isDisposed}get fixedCols(){return this._fixedCols}get fixedRows(){return this._fixedRows}get maxCols(){return this._cols}get maxRows(){return this._rows}get processId(){return this._processManager.shellProcessId}get processReady(){return this._processManager.ptyProcessReady}get hasChildProcesses(){return this.shellLaunchConfig.attachPersistentProcess?.hasChildProcesses||this._processManager.hasChildProcesses}get reconnectionProperties(){return this.shellLaunchConfig.attachPersistentProcess?.reconnectionProperties||this.shellLaunchConfig.reconnectionProperties}get areLinksReady(){return this._areLinksReady}get initialDataEvents(){return this._initialDataEvents}get exitCode(){return this._exitCode}get exitReason(){return this._exitReason}get hadFocusOnExit(){return this._hadFocusOnExit}get isTitleSetByProcess(){return!!this._messageTitleDisposable}get shellLaunchConfig(){return this._shellLaunchConfig}get shellType(){return this._shellType}get os(){return this._processManager.os}get isRemote(){return void 0!==this._processManager.remoteAuthority}get remoteAuthority(){return this._processManager.remoteAuthority}get hasFocus(){return this._wrapperElement.contains(document.activeElement)??!1}get title(){return this._title}get titleSource(){return this._titleSource}get icon(){return this._getIcon()}get color(){return this._getColor()}get processName(){return this._processName}get sequence(){return this._sequence}get staticTitle(){return this._staticTitle}get workspaceFolder(){return this._workspaceFolder}get cwd(){return this._cwd}get initialCwd(){return this._initialCwd}get description(){if(this._description)return this._description;const e=this.shellLaunchConfig.attachPersistentProcess?.type||this.shellLaunchConfig.type;return e?"Task"===e?p.NC("terminalTypeTask","Task"):p.NC("terminalTypeLocal","Local"):void 0}get userHome(){return this._userHome}get shellIntegrationNonce(){return this._processManager.shellIntegrationNonce}get injectedArgs(){return this._injectedArgs}constructor(t,i,n,r,o,a,c,h,p,f,v,S,w,C,y,x,k,I,D,T,E,A,L,P,R,M,N,O,H,F,W,V){if(super(),this._terminalShellTypeContextKey=t,this._terminalInRunCommandPicker=i,this._terminalSuggestWidgetVisibleContextKey=n,this._configHelper=r,this._shellLaunchConfig=o,this._contextKeyService=a,this._terminalProfileResolverService=h,this._pathService=p,this._keybindingService=f,this._notificationService=v,this._preferencesService=S,this._viewsService=w,this._clipboardService=C,this._themeService=y,this._configurationService=x,this._logService=k,this._dialogService=I,this._storageService=D,this._accessibilityService=T,this._productService=E,this._quickInputService=A,this._workspaceContextService=P,this._editorService=R,this._workspaceTrustRequestService=M,this._historyService=N,this._telemetryService=O,this._openerService=H,this._commandService=F,this._audioCueService=W,this._viewDescriptorService=V,this._contributions=new Map,this._latestXtermWriteData=0,this._latestXtermParseData=0,this._title="",this._titleSource=s.ev.Process,this._cols=0,this._rows=0,this._cwd=void 0,this._initialCwd=void 0,this._injectedArgs=void 0,this._layoutSettingsChanged=!0,this._areLinksReady=!1,this._initialDataEvents=[],this._widgetManager=new ds,this._processName="",this._usedShellIntegrationInjection=!1,this.capabilities=new Ei,this.disableLayout=!1,this._onExit=new d.Q5,this.onExit=this._onExit.event,this._onDisposed=this._register(new d.Q5),this.onDisposed=this._onDisposed.event,this._onProcessIdReady=this._register(new d.Q5),this.onProcessIdReady=this._onProcessIdReady.event,this._onProcessReplayComplete=this._register(new d.Q5),this.onProcessReplayComplete=this._onProcessReplayComplete.event,this._onTitleChanged=this._register(new d.Q5),this.onTitleChanged=this._onTitleChanged.event,this._onIconChanged=this._register(new d.Q5),this.onIconChanged=this._onIconChanged.event,this._onData=this._register(new d.Q5),this.onData=this._onData.event,this._onBinary=this._register(new d.Q5),this.onBinary=this._onBinary.event,this._onLineData=this._register(new d.Q5({onDidAddFirstListener:()=>this._onLineDataSetup()})),this.onLineData=this._onLineData.event,this._onRequestExtHostProcess=this._register(new d.Q5),this.onRequestExtHostProcess=this._onRequestExtHostProcess.event,this._onDimensionsChanged=this._register(new d.Q5),this.onDimensionsChanged=this._onDimensionsChanged.event,this._onMaximumDimensionsChanged=this._register(new d.Q5),this.onMaximumDimensionsChanged=this._onMaximumDimensionsChanged.event,this._onDidFocus=this._register(new d.Q5),this.onDidFocus=this._onDidFocus.event,this._onDidRequestFocus=this._register(new d.Q5),this.onDidRequestFocus=this._onDidRequestFocus.event,this._onDidBlur=this._register(new d.Q5),this.onDidBlur=this._onDidBlur.event,this._onDidInputData=this._register(new d.Q5),this.onDidInputData=this._onDidInputData.event,this._onDidChangeSelection=this._register(new d.Q5),this.onDidChangeSelection=this._onDidChangeSelection.event,this._onRequestAddInstanceToGroup=this._register(new d.Q5),this.onRequestAddInstanceToGroup=this._onRequestAddInstanceToGroup.event,this._onDidChangeHasChildProcesses=this._register(new d.Q5),this.onDidChangeHasChildProcesses=this._onDidChangeHasChildProcesses.event,this._wrapperElement=document.createElement("div"),this._wrapperElement.classList.add("terminal-wrapper"),this._skipTerminalCommands=[],this._isExiting=!1,this._hadFocusOnExit=!1,this._isVisible=!1,this._isDisposed=!1,this._instanceId=e._instanceIdCounter++,this._hasHadInput=!1,this._fixedRows=o.attachPersistentProcess?.fixedDimensions?.rows,this._fixedCols=o.attachPersistentProcess?.fixedDimensions?.cols,this._resource=gi(this._workspaceContextService.getWorkspace().id,this.instanceId,this.title),this._shellLaunchConfig.attachPersistentProcess?.hideFromUser&&(this._shellLaunchConfig.hideFromUser=this._shellLaunchConfig.attachPersistentProcess.hideFromUser),this._shellLaunchConfig.attachPersistentProcess?.isFeatureTerminal&&(this._shellLaunchConfig.isFeatureTerminal=this._shellLaunchConfig.attachPersistentProcess.isFeatureTerminal),this._shellLaunchConfig.attachPersistentProcess?.type&&(this._shellLaunchConfig.type=this._shellLaunchConfig.attachPersistentProcess.type),this.shellLaunchConfig.cwd){const e="string"==typeof this._shellLaunchConfig.cwd?g.ov.from({scheme:m.lg.file,path:this._shellLaunchConfig.cwd}):this._shellLaunchConfig.cwd;e&&(this._workspaceFolder=(0,B.f6)(this._workspaceContextService.getWorkspaceFolder(e)))}if(!this._workspaceFolder){const e=this._historyService.getLastActiveWorkspaceRoot();this._workspaceFolder=e?(0,B.f6)(this._workspaceContextService.getWorkspaceFolder(e)):void 0}const $=this._register(a.createScoped(this._wrapperElement));this._scopedInstantiationService=c.createChild(new Dn.y([b.i6,$])),this._terminalFocusContextKey=he.r.focus.bindTo($),this._terminalHasFixedWidth=he.r.terminalHasFixedWidth.bindTo($),this._terminalHasTextContextKey=he.r.textSelected.bindTo($),this._terminalAltBufferActiveContextKey=he.r.altBufferActive.bindTo($),this._terminalShellIntegrationEnabledContextKey=he.r.terminalShellIntegrationEnabled.bindTo($),this._logService.trace(`terminalInstance#ctor (instanceId: ${this.instanceId})`,this._shellLaunchConfig),this._register(this.capabilities.onDidAddCapability((e=>{if(this._logService.debug("terminalInstance added capability",e),0===e)this.capabilities.get(0)?.onDidChangeCwd((e=>{this._cwd=e,this._setTitle(this.title,s.ev.Config),this._scopedInstantiationService.invokeFunction(Ee)?.add(e,{remoteAuthority:this.remoteAuthority})}));else if(2===e){const e=this.capabilities.get(2);e?.onCommandFinished((e=>{e.command.trim().length>0&&this._scopedInstantiationService.invokeFunction(Te)?.add(e.command,{shellType:this._shellType})}))}}))),this._register(this.capabilities.onDidRemoveCapability((e=>this._logService.debug("terminalInstance removed capability",e)))),this.shellLaunchConfig.executable||L.remoteAuthority||this._terminalProfileResolverService.resolveIcon(this._shellLaunchConfig,_.OS),this._icon=o.attachPersistentProcess?.icon||o.icon,this.shellLaunchConfig.customPtyImplementation&&this._setTitle(this._shellLaunchConfig.name,s.ev.Api),this.statusList=this._scopedInstantiationService.createInstance(ls),this._initDimensions(),this._processManager=this._createProcessManager(),this._register((0,u.OF)((()=>this._dndObserver?.dispose()))),this._containerReadyBarrier=new l.Ug(100),this._attachBarrier=new l.Ug(1e3),this._xtermReadyPromise=this._createXterm(),this._xtermReadyPromise.then((async()=>{if(await this._containerReadyBarrier.wait(),!this.shellLaunchConfig.customPtyImplementation&&this._configHelper.config.shellIntegration?.enabled&&!this.shellLaunchConfig.executable){const e=await this._processManager.getBackendOS(),t=await this._terminalProfileResolverService.getDefaultProfile({remoteAuthority:this.remoteAuthority,os:e});this.shellLaunchConfig.executable=t.path,this.shellLaunchConfig.args=t.args,this.shellLaunchConfig.isExtensionOwnedTerminal?(this.shellLaunchConfig.icon??=t.icon,this.shellLaunchConfig.color??=t.color):(this.shellLaunchConfig.icon=t.icon,this.shellLaunchConfig.color=t.color)}await this._createProcess(),this.shellLaunchConfig.attachPersistentProcess&&(this._cwd=this.shellLaunchConfig.attachPersistentProcess.cwd,this._setTitle(this.shellLaunchConfig.attachPersistentProcess.title,this.shellLaunchConfig.attachPersistentProcess.titleSource),this.setShellType(this.shellType)),this._fixedCols&&await this._addScrollbar()})).catch((e=>{if(!this._isDisposed)throw e})),this._register(this._configurationService.onDidChangeConfiguration((async e=>{e.affectsConfiguration("accessibility.verbosity.terminal")&&this._setAriaLabel(this.xterm?.raw,this._instanceId,this.title),e.affectsConfiguration("terminal.integrated")&&(this.updateConfig(),this.setVisible(this._isVisible)),["terminal.integrated.fontSize","terminal.integrated.fontFamily","terminal.integrated.fontWeight","terminal.integrated.fontWeightBold","terminal.integrated.letterSpacing","terminal.integrated.lineHeight","editor.fontFamily"].some((t=>e.affectsConfiguration(t)))&&(this._layoutSettingsChanged=!0,await this._resize()),e.affectsConfiguration("terminal.integrated.unicodeVersion")&&this._updateUnicodeVersion(),e.affectsConfiguration("editor.accessibilitySupport")&&this.updateAccessibilitySupport(),(e.affectsConfiguration("terminal.integrated.tabs.title")||e.affectsConfiguration("terminal.integrated.tabs.separator")||e.affectsConfiguration("terminal.integrated.tabs.description"))&&this._labelComputer?.refreshLabel()}))),this._register(this._workspaceContextService.onDidChangeWorkspaceFolders((()=>this._labelComputer?.refreshLabel()))),this._register(this.onDidBlur((()=>this.xterm?.suggestController?.hideSuggestWidget())));let U=window.setTimeout((()=>{U=void 0,this._initialDataEvents=void 0}),1e4);this._register((0,u.OF)((()=>{U&&window.clearTimeout(U)})));const G=Sn.getTerminalContributions();for(const e of G){if(this._contributions.has(e.id)){(0,Et.dL)(new Error(`Cannot have two terminal contributions with the same id ${e.id}`));continue}let t;try{t=this._scopedInstantiationService.createInstance(e.ctor,this,this._processManager,this._widgetManager),this._contributions.set(e.id,t)}catch(e){(0,Et.dL)(e)}this._xtermReadyPromise.then((e=>{t.xtermReady?.(e)})),this.onDisposed((()=>{t.dispose()}))}}getContribution(e){return this._contributions.get(e)}_getIcon(){return this._icon||(this._icon=this._processManager.processState>=2?(0,x.Ks)().getIcon(this._configurationService.getValue("terminal.integrated.tabs.defaultIcon")):void 0),this._icon}_getColor(){return this.shellLaunchConfig.color?this.shellLaunchConfig.color:this.shellLaunchConfig?.attachPersistentProcess?.color?this.shellLaunchConfig.attachPersistentProcess.color:void this._processManager.processState}_initDimensions(){if(!this._container)return this._cols=80,void(this._rows=30);const e=window.getComputedStyle(this._container),t=parseInt(e.width),i=parseInt(e.height);this._evaluateColsAndRows(t,i)}_evaluateColsAndRows(e,t){if(!e||!t)return this._setLastKnownColsAndRows(),null;const i=this._getDimension(e,t);if(!i)return this._setLastKnownColsAndRows(),null;const n=function(e,t,i){if(!e.charWidth||!e.charHeight)return null;const n=t*window.devicePixelRatio,s=e.charWidth*window.devicePixelRatio+e.letterSpacing,r=Math.max(Math.floor(n/s),1),o=i*window.devicePixelRatio,a=Math.ceil(e.charHeight*window.devicePixelRatio),c=Math.floor(a*e.lineHeight);return{rows:Math.max(Math.floor(o/c),1),cols:r}}(this.xterm?this.xterm.getFont():this._configHelper.getFont(),i.width,i.height);return n?(this._cols===n.cols&&this._rows===n.rows||(this._cols=n.cols,this._rows=n.rows,this._fireMaximumDimensionsChanged()),i.width):(this._setLastKnownColsAndRows(),null)}_setLastKnownColsAndRows(){e._lastKnownGridDimensions&&(this._cols=e._lastKnownGridDimensions.cols,this._rows=e._lastKnownGridDimensions.rows)}_fireMaximumDimensionsChanged(){this._onMaximumDimensionsChanged.fire()}_getDimension(t,i){const n=this.xterm?this.xterm.getFont():this._configHelper.getFont();if(!n||!n.charWidth||!n.charHeight)return;if(!this.xterm?.raw.element)return;const s=window.getComputedStyle(this.xterm.raw.element),r=parseInt(s.paddingLeft)+parseInt(s.paddingRight),o=parseInt(s.paddingTop)+parseInt(s.paddingBottom);return e._lastKnownCanvasDimensions=new c.Ro(Math.min(8e3,t-r),i+(this._hasScrollBar&&!this._horizontalScrollbar?-5:0)-2-o),e._lastKnownCanvasDimensions}get persistentProcessId(){return this._processManager.persistentProcessId}get shouldPersist(){return this._processManager.shouldPersist&&!this.shellLaunchConfig.isTransient&&(!this.reconnectionProperties||!0===this._configurationService.getValue("task.reconnection"))}static getXtermConstructor(e,t){const i=e.lookupKeybinding("workbench.action.terminal.focusAccessibleBuffer",t);return gs||(gs=l.jT.withAsyncBody((async e=>{_s.Terminal.strings.promptLabel=p.NC("terminal.integrated.a11yPromptLabel","Terminal input"),_s.Terminal.strings.tooMuchOutput=i?p.NC("terminal.integrated.useAccessibleBuffer","Use the accessible buffer {0} to manually review output",i.getLabel()):p.NC("terminal.integrated.useAccessibleBufferNoKb","Use the Terminal: Focus Accessible Buffer command to manually review output"),e(_s.Terminal)})),gs)}async _createXterm(){const t=await e.getXtermConstructor(this._keybindingService,this._contextKeyService);if(this._isDisposed)throw new Et.QD("Terminal disposed of during xterm.js creation");const i=this.shellLaunchConfig.hideFromUser||void 0===this.shellLaunchConfig.executable||void 0===this.shellType||!ps.includes(this.shellType),n=this._scopedInstantiationService.createInstance(vn,t,this._configHelper,this._cols,this._rows,{getBackgroundColor:e=>{const t=e.getColor(yi.Es);return t||(this.target===s.i2.Editor?e.getColor(y.cvW):1===this._viewDescriptorService.getViewLocationById(r.e9)?e.getColor(Di.v9):e.getColor(Di.Qd))}},this.capabilities,this._processManager.shellIntegrationNonce,this._terminalSuggestWidgetVisibleContextKey,i);this.xterm=n,this.updateAccessibilitySupport(),this.xterm.onDidRequestRunCommand((e=>{e.copyAsHtml?this.copySelection(!0,e.command):this.sendText(e.command.command,!e.noNewLine)})),this.xterm.onDidRequestFocus((()=>this.focus())),this.xterm.onDidRequestSendText((e=>this.sendText(e,!1)));const o=this._shellLaunchConfig.initialText?new Promise((e=>this._writeInitialText(n,e))):void 0,a=new us(o);if(a.onLineData((e=>this._onLineData.fire(e))),this._lineDataEventAddon=a,setTimeout((()=>{n.raw.onBell((()=>{this._configHelper.config.enableBell&&(this.statusList.add({id:"bell",severity:w.zb.Warning,icon:R.lA.bell,tooltip:p.NC("bellStatus","Bell")},this._configHelper.config.bellDuration),this._audioCueService.playSound(Ki.y$.terminalBell.sound.getSound()))}))}),1e3),n.raw.onSelectionChange((async()=>this._onSelectionChange())),n.raw.buffer.onBufferChange((()=>this._refreshAltBufferContextKey())),this._processManager.onProcessData((e=>this._onProcessData(e))),n.raw.onData((async e=>{await this._processManager.write(e),this._onDidInputData.fire(this)})),n.raw.onBinary((e=>this._processManager.processBinary(e))),this._processManager.onProcessReady((async e=>{this._processManager.os&&a.setOperatingSystem(this._processManager.os),n.raw.options.windowsPty=e.windowsPty})),this._processManager.onRestoreCommands((e=>this.xterm?.shellIntegration.deserialize(e))),this._register(this._viewDescriptorService.onDidChangeLocation((({views:e})=>{e.some((e=>e.id===r.e9))&&n.refresh()}))),!this.capabilities.has(0)){let e=n.raw.onKey((e=>{new Cn.y1(e.domEvent).equals(3)&&this._updateProcessCwd()}));this._register(this.capabilities.onDidAddCapability((t=>{0===t&&(e?.dispose(),e=void 0)})))}return this._pathService.userHome().then((e=>{this._userHome=e.fsPath})),this._isVisible&&this._open(),n}async _onLineDataSetup(){(this.xterm||await this._xtermReadyPromise).raw.loadAddon(this._lineDataEventAddon)}async runCommand(e,t){!1!==this.capabilities.get(2)?.hasInput&&(await this.sendText("",!1),await(0,l.Vs)(100)),await this.sendText(e,t,!t)}async runRecent(e,t,i){return this._scopedInstantiationService.invokeFunction(as,this,this._terminalInRunCommandPicker,e,t,i)}detachFromElement(){this._wrapperElement.remove(),this._container=void 0}attachToElement(e){this._container!==e&&(this._attachBarrier.open(),this._container=e,this._container.appendChild(this._wrapperElement),this.xterm?.refresh(),setTimeout((()=>this._initDragAndDrop(e))))}_open(){if(!this.xterm||this.xterm.raw.element)return;if(!this._container||!this._container.isConnected)throw new Error("A container element needs to be set with `attachToElement` and be part of the DOM before calling `_open`");const e=document.createElement("div");this._wrapperElement.appendChild(e),this._container.appendChild(this._wrapperElement);const t=this.xterm;this._wrapperElement.xterm=t.raw;const i=t.attachToElement(e);if(this._register(t.shellIntegration.onDidChangeStatus((()=>{this.hasFocus?this._setShellIntegrationContextKey():this._terminalShellIntegrationEnabledContextKey.reset()}))),!t.raw.element||!t.raw.textarea)throw new Error("xterm elements not set after open");this._setAriaLabel(t.raw,this._instanceId,this._title),t.raw.attachCustomKeyEventHandler((e=>{if(this._isExiting)return!1;const t=new Cn.y1(e),i=this._keybindingService.softDispatch(t,t.target),n=1===i.kind&&this._configHelper.config.allowChords&&"Escape"!==e.key;if(this._keybindingService.inChordMode||n)return e.preventDefault(),!1;const s="terminal.integrated.showTerminalConfigPrompt";return!this._storageService.getBoolean(s,-1,!0)||["RightArrow","LeftArrow","UpArrow","DownArrow","Space","Meta","Control","Shift","Alt","","Delete","Backspace","Tab"].includes(e.key)||e.ctrlKey||e.shiftKey||e.altKey||(this._hasHadInput=!0),2===i.kind&&i.commandId&&this._skipTerminalCommands.some((e=>e===i.commandId))&&!this._configHelper.config.sendKeybindingsToShell?(this._storageService.getBoolean(s,-1,!0)&&this._hasHadInput&&!r.K6.includes(i.commandId)&&(this._notificationService.prompt(w.zb.Info,p.NC("keybindingHandling","Some keybindings don't go to the terminal by default and are handled by {0} instead.",this._productService.nameLong),[{label:p.NC("configureTerminalSettings","Configure Terminal Settings"),run:()=>{this._preferencesService.openSettings({jsonEditor:!1,query:"@id:terminal.integrated.commandsToSkipShell,terminal.integrated.sendKeybindingsToShell,terminal.integrated.allowChords"})}}]),this._storageService.store(s,!1,-1,0)),e.preventDefault(),!1):!(this._configHelper.config.allowMnemonics&&!_.dz&&e.altKey||kn.n.getTabFocusMode("terminalFocus")&&"Tab"===e.key||_.ED&&e.altKey&&"F4"===e.key&&!e.ctrlKey||!L.D.clipboard.readText&&"v"===e.key&&e.ctrlKey)})),this._register(c.nm(t.raw.element,"mousedown",(()=>{const e=c.nm(document,"mouseup",(()=>{setTimeout((()=>this._refreshSelectionContextKey()),0),e.dispose()}))}))),this._register(c.nm(t.raw.element,"touchstart",(()=>{t.raw.focus()}))),this._register(c.nm(t.raw.element,"keyup",(()=>{setTimeout((()=>this._refreshSelectionContextKey()),0)}))),this._register(c.nm(t.raw.textarea,"focus",(()=>this._setFocus(!0)))),this._register(c.nm(t.raw.textarea,"blur",(()=>this._setFocus(!1)))),this._register(c.nm(t.raw.textarea,"focusout",(()=>this._setFocus(!1)))),this._initDragAndDrop(this._container),this._widgetManager.attachToElement(i),this._lastLayoutDimensions&&this.layout(this._lastLayoutDimensions),this.updateConfig(),t.raw.options.disableStdin&&this._attachPressAnyKeyToCloseListener(t.raw)}_setFocus(e){e?(this._terminalFocusContextKey.set(!0),this._setShellIntegrationContextKey(),this._onDidFocus.fire(this)):(this.resetFocusContextKey(),this._onDidBlur.fire(this),this._refreshSelectionContextKey())}_setShellIntegrationContextKey(){this.xterm&&this._terminalShellIntegrationEnabledContextKey.set(2===this.xterm.shellIntegration.status)}resetFocusContextKey(){this._terminalFocusContextKey.reset(),this._terminalShellIntegrationEnabledContextKey.reset()}_initDragAndDrop(e){this._dndObserver?.dispose();const t=this._scopedInstantiationService.createInstance(vs,e);t.onDropTerminal((e=>this._onRequestAddInstanceToGroup.fire(e))),t.onDropFile((async e=>{this.focus(),await this.sendPath(e,!1)})),this._dndObserver=new c.eg(e,t)}hasSelection(){return!!this.xterm&&this.xterm.raw.hasSelection()}async copySelection(e,t){const i=await this._xtermReadyPromise;await i.copySelection(e,t)}get selection(){return this.xterm&&this.hasSelection()?this.xterm.raw.getSelection():void 0}clearSelection(){this.xterm?.raw.clearSelection()}_refreshAltBufferContextKey(){this._terminalAltBufferActiveContextKey.set(!(!this.xterm||this.xterm.raw.buffer.active!==this.xterm.raw.buffer.alternate))}async _shouldPasteText(e){if(this.xterm?.raw.modes.bracketedPasteMode)return!0;const t=e.split(/\r?\n/);if(2===t.length&&0===t[1].trim().length)return!0;if(1===t.length||!this._configurationService.getValue("terminal.integrated.enableMultiLinePasteWarning"))return!0;let i=p.NC("preview","Preview:");for(let e=0;e<Math.min(t.length,3);e++){const n=t[e];i+=`\n${n.length>30?`${n.slice(0,30)}…`:n}`}t.length>3&&(i+="\n…");const{confirmed:n,checkboxChecked:s}=await this._dialogService.confirm({message:p.NC("confirmMoveTrashMessageFilesAndDirectories","Are you sure you want to paste {0} lines of text into the terminal?",t.length),detail:i,primaryButton:p.NC({key:"multiLinePasteButton",comment:["&& denotes a mnemonic"]},"&&Paste"),checkbox:{label:p.NC("doNotAskAgain","Do not ask me again")}});return n&&s&&await this._configurationService.updateValue("terminal.integrated.enableMultiLinePasteWarning",!1),n}dispose(e){if(!this._isDisposed){this._isDisposed=!0,this._logService.trace(`terminalInstance#dispose (instanceId: ${this.instanceId})`),(0,u.B9)(this._widgetManager),this.xterm?.raw.element&&(this._hadFocusOnExit=this.hasFocus),this._wrapperElement.xterm&&(this._wrapperElement.xterm=void 0),this._horizontalScrollbar&&(this._horizontalScrollbar.dispose(),this._horizontalScrollbar=void 0);try{this.xterm?.dispose()}catch(e){this._logService.error("Exception occurred during xterm disposal",e)}wi.vU&&(this.resetFocusContextKey(),this._terminalHasTextContextKey.reset(),this._onDidBlur.fire(this)),this._pressAnyKeyToCloseListener&&(this._pressAnyKeyToCloseListener.dispose(),this._pressAnyKeyToCloseListener=void 0),void 0===this._exitReason&&(this._exitReason=e??s._x.Unknown),this._processManager.dispose(),this._onProcessExit(void 0),this._onDisposed.fire(this),super.dispose()}}async detachProcessAndDispose(e){await this._processManager.detachFromProcess(e===s._x.User),this.dispose(e)}focus(e){this._refreshAltBufferContextKey(),this.xterm&&(!e&&window.getSelection()?.toString()||(this.xterm.raw.focus(),this._onDidRequestFocus.fire()))}async focusWhenReady(e){await this._xtermReadyPromise,await this._attachBarrier.wait(),this.focus(e)}async paste(){if(!this.xterm)return;const e=await this._clipboardService.readText();await this._shouldPasteText(e)&&(this.focus(),this.xterm.raw.paste(e))}async pasteSelection(){if(!this.xterm)return;const e=await this._clipboardService.readText("selection");await this._shouldPasteText(e)&&(this.focus(),this.xterm.raw.paste(e))}async sendText(e,t,i){i&&this.xterm?.raw.modes.bracketedPasteMode&&(e=`[200~${e}[201~`),e=e.replace(/\r?\n/g,"\r"),t&&!e.endsWith("\r")&&(e+="\r"),await this._processManager.write(e),this._onDidInputData.fire(this),this.xterm?.suggestController?.handleNonXtermData(e),this.xterm?.scrollToBottom()}async sendPath(e,t){return this.sendText(await this.preparePathForShell(e),t)}async preparePathForShell(e){return await this.processReady,async function(e,t,i,n,s,r,o=_.ED){let a;if((0,B.HD)(e)?a=e:(a=e.fsPath,o&&1!==r?a=a.replace(/\\/g,"/"):o||1!==r||(a=a.replace(/\//g,"\\"))),!t)return a;const c=a.includes(" "),l=a.includes("(")||a.includes(")"),h=Se.EZ(t,".exe"),d="pwsh"===h||"pwsh"===i||"powershell"===h||"powershell"===i;if(d&&(c||a.includes("'")))return`& '${a.replace(/'/g,"''")}'`;if(l&&d)return`& '${a}'`;if(1===r){if(void 0!==n)return"gitbash"===n?Oi(a.replace(/\\/g,"/")):"wsl"===n?s?.getWslPath(a,"win-to-unix")||a:c?`"${a}"`:a;const e=t.toLowerCase();return e.includes("wsl")||e.includes("bash.exe")&&!e.toLowerCase().includes("git")?s?.getWslPath(a,"win-to-unix")||a:c?`"${a}"`:a}return Oi(a)}(e,this.shellLaunchConfig.executable,this.title,this.shellType,this._processManager.backend,this._processManager.os)}setVisible(e){this._isVisible=e,this._wrapperElement.classList.toggle("active",e),e&&this.xterm&&(this._open(),this._resize(),setTimeout((()=>this.xterm.forceRefresh()),0))}scrollDownLine(){this.xterm?.scrollDownLine()}scrollDownPage(){this.xterm?.scrollDownPage()}scrollToBottom(){this.xterm?.scrollToBottom()}scrollUpLine(){this.xterm?.scrollUpLine()}scrollUpPage(){this.xterm?.scrollUpPage()}scrollToTop(){this.xterm?.scrollToTop()}clearBuffer(){this._processManager.clearBuffer(),this.xterm?.clearBuffer()}_refreshSelectionContextKey(){const e=!!this._viewsService.getActiveViewWithId(r.e9);let t=!1;const i=this._editorService.activeEditor;i&&(t=i instanceof ui.S),this._terminalHasTextContextKey.set((e||t)&&this.hasSelection())}_createProcessManager(){let e;this.shellLaunchConfig.attachPersistentProcess?.environmentVariableCollections&&(e=(0,En.Vn)(this.shellLaunchConfig.attachPersistentProcess.environmentVariableCollections));const t=this._scopedInstantiationService.createInstance(is,this._instanceId,this._configHelper,this.shellLaunchConfig?.cwd,e,this.shellLaunchConfig.attachPersistentProcess?.shellIntegrationNonce);return this.capabilities.add(t.capabilities),t.onProcessReady((async e=>{this._onProcessIdReady.fire(this),this._initialCwd=await this.getInitialCwd(),this._labelComputer||(this._labelComputer=this._register(this._scopedInstantiationService.createInstance(bs,this._configHelper,this)),this._labelComputer.onDidChangeLabel((e=>{this._title=e.title,this._description=e.description,this._onTitleChanged.fire(this)}))),this._shellLaunchConfig.name?this._setTitle(this._shellLaunchConfig.name,s.ev.Api):(setTimeout((()=>{this._xtermReadyPromise.then((e=>{this._messageTitleDisposable=e.raw.onTitleChange((e=>this._onTitleChange(e)))}))})),this._setTitle(this._shellLaunchConfig.executable,s.ev.Process))})),t.onProcessExit((e=>this._onProcessExit(e))),t.onDidChangeProperty((({type:e,value:t})=>{switch(e){case"cwd":this._cwd=t,this._labelComputer?.refreshLabel();break;case"initialCwd":this._initialCwd=t,this._cwd=this._initialCwd,this._setTitle(this.title,s.ev.Config),this._icon=this._shellLaunchConfig.attachPersistentProcess?.icon||this._shellLaunchConfig.icon,this._onIconChanged.fire({instance:this,userInitiated:!1});break;case"title":this._setTitle(t??"",s.ev.Process);break;case"overrideDimensions":this.setOverrideDimensions(t,!0);break;case"resolvedShellLaunchConfig":this._setResolvedShellLaunchConfig(t);break;case"shellType":this.setShellType(t);break;case"hasChildProcesses":this._onDidChangeHasChildProcesses.fire(t);break;case"usedShellIntegrationInjection":this._usedShellIntegrationInjection=!0}})),t.onProcessData((e=>{this._initialDataEvents?.push(e.data),this._onData.fire(e.data)})),t.onProcessReplayComplete((()=>this._onProcessReplayComplete.fire())),t.onEnvironmentVariableInfoChanged((e=>this._onEnvironmentVariableInfoChanged(e))),t.onPtyDisconnect((()=>{this.xterm&&(this.xterm.raw.options.disableStdin=!0),this.statusList.add({id:"disconnected",severity:w.zb.Error,icon:R.lA.debugDisconnect,tooltip:p.NC("disconnectStatus","Lost connection to process")})})),t.onPtyReconnect((()=>{this.xterm&&(this.xterm.raw.options.disableStdin=!1),this.statusList.remove("disconnected")})),t}async _createProcess(){if(this._isDisposed)return;this._historyService.getLastActiveWorkspaceRoot(m.lg.file)?await this._trust()||this._onProcessExit({message:p.NC("workspaceNotTrustedCreateTerminal","Cannot launch a terminal process in an untrusted workspace")}):this._cwd&&this._userHome&&this._cwd!==this._userHome&&this._onProcessExit({message:p.NC("workspaceNotTrustedCreateTerminalCwd","Cannot launch a terminal process in an untrusted workspace with cwd {0} and userHome {1}",this._cwd,this._userHome)}),this._container&&0===this._cols&&0===this._rows&&(this._initDimensions(),this.xterm?.raw.resize(this._cols||80,this._rows||30));const e=this.shellLaunchConfig.icon;await this._processManager.createProcess(this._shellLaunchConfig,this._cols||80,this._rows||30).then((e=>{e&&("message"in e?this._onProcessExit(e):"injectedArgs"in e&&(this._injectedArgs=e.injectedArgs))})),this.xterm?.shellIntegration&&this.capabilities.add(this.xterm.shellIntegration.capabilities),(e!==this.shellLaunchConfig.icon||this.shellLaunchConfig.color)&&(this._icon=this._shellLaunchConfig.attachPersistentProcess?.icon||this._shellLaunchConfig.icon,this._onIconChanged.fire({instance:this,userInitiated:!1}))}registerMarker(){return this.xterm?.raw.registerMarker()}addBufferMarker(e){this.capabilities.get(4)?.addMark(e)}scrollToMark(e,t,i){this.xterm?.markTracker.scrollToClosestMarker(e,t,i)}async freePortKillProcess(e,t){await(this._processManager?.freePortKillProcess(e)),this.runCommand(t,!1)}_onProcessData(e){const t=++this._latestXtermWriteData;e.trackCommit?e.writePromise=new Promise((i=>{this.xterm?.raw.write(e.data,(()=>{this._latestXtermParseData=t,this._processManager.acknowledgeDataEvent(e.data.length),i()}))})):this.xterm?.raw.write(e.data,(()=>{this._latestXtermParseData=t,this._processManager.acknowledgeDataEvent(e.data.length)}))}async _onProcessExit(e){if(this._isExiting)return;const t=function(e,t,i,n){if(void 0===e||0===e)return{code:e,message:void 0};const s="number"==typeof e?e:e.code;let r;switch(typeof e){case"number":{let e;t.executable&&(e=t.executable,"string"==typeof t.args?e+=` ${t.args}`:t.args&&t.args.length&&(e+=t.args.map((e=>` '${e}'`)).join())),r=4===i?e?p.NC("launchFailed.exitCodeAndCommandLine",'The terminal process "{0}" failed to launch (exit code: {1}).',e,s):p.NC("launchFailed.exitCodeOnly","The terminal process failed to launch (exit code: {0}).",s):e?p.NC("terminated.exitCodeAndCommandLine",'The terminal process "{0}" terminated with exit code: {1}.',e,s):p.NC("terminated.exitCodeOnly","The terminal process terminated with exit code: {0}.",s);break}case"object":{if(e.message.toString().includes("Could not find pty with id"))break;let i=e.message;const s=e.message.match(/.*error code:\s*(\d+).*$/);if(s)switch(s.length>1?parseInt(s[1]):void 0){case 5:i=`Access was denied to the path containing your executable "${t.executable}". Manage and change your permissions to get this to work`;break;case 267:i=`Invalid starting directory "${n}", review your terminal.integrated.cwd setting`;break;case 1260:i="Windows cannot open this program because it has been prevented by a software restriction policy. For more information, open Event Viewer or contact your system Administrator"}r=p.NC("launchFailed.errorMessage","The terminal process failed to launch: {0}.",i);break}}return{code:s,message:r}}(e,this.shellLaunchConfig,this._processManager.processState,this._initialCwd);if(this._usedShellIntegrationInjection&&4===this._processManager.processState&&0!==t?.code)return this._relaunchWithShellIntegrationDisabled(t?.message),void this._onExit.fire(e);this._isExiting=!0,await this._flushXtermData(),this._exitCode=t?.code;const i=t?.message;this._logService.debug("Terminal process exit","instanceId",this.instanceId,"code",this._exitCode,"processState",this._processManager.processState);const n=this.waitOnExit;n&&5!==this._processManager.processState?this._xtermReadyPromise.then((e=>{switch(i&&e.raw.write(C(i)),typeof n){case"string":e.raw.write(C(n,{excludeLeadingNewLine:!0}));break;case"function":void 0!==this.exitCode&&e.raw.write(C(n(this.exitCode),{excludeLeadingNewLine:!0}))}e.raw.options.disableStdin=!0,e.raw.textarea&&this._attachPressAnyKeyToCloseListener(e.raw)})):(this.dispose(s._x.Process),i&&(4===this._processManager.processState||this._configHelper.config.showExitAlert?this._notificationService.notify({message:i,severity:w.zb.Error,actions:{primary:[this._scopedInstantiationService.createInstance(je)]}}):this._logService.warn(i))),this._onExit.fire(e),this._isDisposed&&this._onExit.dispose()}_relaunchWithShellIntegrationDisabled(e){this._shellLaunchConfig.ignoreShellIntegration=!0,this.relaunch(),this.statusList.add({id:"shell-integration-attention-needed",severity:w.zb.Warning,icon:R.lA.warning,tooltip:(`${e} `??0)+p.NC("launchFailed.exitCodeOnlyShellIntegration","Disabling shell integration in user settings might help."),hoverActions:[{commandId:"workbench.action.terminal.learnMore",label:p.NC("shellIntegration.learnMore","Learn more about shell integration"),run:()=>{this._openerService.open("https://code.visualstudio.com/docs/editor/integrated-terminal#_shell-integration")}},{commandId:"workbench.action.openSettings",label:p.NC("shellIntegration.openSettings","Open user settings"),run:()=>{this._commandService.executeCommand("workbench.action.openSettings","terminal.integrated.shellIntegration.enabled")}}]}),this._telemetryService.publicLog2("terminal/shellIntegrationFailureProcessExit")}_flushXtermData(){if(this._latestXtermWriteData===this._latestXtermParseData)return Promise.resolve();let e=0;return new Promise((t=>{const i=setInterval((()=>{this._latestXtermWriteData!==this._latestXtermParseData&&5!=++e||(clearInterval(i),t())}),20)}))}_attachPressAnyKeyToCloseListener(e){e.textarea&&!this._pressAnyKeyToCloseListener&&(this._pressAnyKeyToCloseListener=c.nm(e.textarea,"keypress",(e=>{this._pressAnyKeyToCloseListener&&(this._pressAnyKeyToCloseListener.dispose(),this._pressAnyKeyToCloseListener=void 0,this.dispose(s._x.Process),e.preventDefault())})))}_writeInitialText(e,t){if(!this._shellLaunchConfig.initialText)return void t?.();const i="string"==typeof this._shellLaunchConfig.initialText?this._shellLaunchConfig.initialText:this._shellLaunchConfig.initialText?.text;"string"==typeof this._shellLaunchConfig.initialText||this._shellLaunchConfig.initialText.trailingNewLine?e.raw.writeln(i,t):e.raw.write(i,t)}async reuseTerminal(e,t=!1){this._pressAnyKeyToCloseListener?.dispose(),this._pressAnyKeyToCloseListener=void 0;const i=this.xterm;i&&(t||await new Promise((e=>i.raw.write("\n[G",e))),e.initialText&&(this._shellLaunchConfig.initialText=e.initialText,await new Promise((e=>this._writeInitialText(i,e)))),this._isExiting&&this._shellLaunchConfig.waitOnExit&&(i.raw.options.disableStdin=!1,this._isExiting=!1),t&&i.clearDecorations()),this.statusList.remove("relaunch-needed"),t||(e.initialText=" "),this._shellLaunchConfig=e,await this._processManager.relaunch(this._shellLaunchConfig,this._cols||80,this._rows||30,t).then((e=>{e&&("message"in e?this._onProcessExit(e):"injectedArgs"in e&&(this._injectedArgs=e.injectedArgs))}))}relaunch(){this.reuseTerminal(this._shellLaunchConfig,!0)}_onTitleChange(e){this.isTitleSetByProcess&&this._setTitle(e,s.ev.Sequence)}async _trust(){return!0===await this._workspaceTrustRequestService.requestWorkspaceTrust({message:p.NC("terminal.requestTrust","Creating a terminal process requires executing code")})}async _onSelectionChange(){this._onDidChangeSelection.fire(this),this._configurationService.getValue("terminal.integrated.copyOnSelection")&&this.hasSelection()&&await this.copySelection()}async _updateProcessCwd(){if(!this._isDisposed&&!this.shellLaunchConfig.customPtyImplementation)try{const e=await this._refreshProperty("cwd");if("string"!=typeof e)throw new Error(`cwd is not a string ${e}`)}catch(e){if(e instanceof Error&&"Cannot refresh property when process is not set"===e.message)return;throw e}}updateConfig(){this._setCommandsToSkipShell(this._configHelper.config.commandsToSkipShell),this._refreshEnvironmentVariableInfoWidgetState(this._processManager.environmentVariableInfo)}async _updateUnicodeVersion(){this._processManager.setUnicodeVersion(this._configHelper.config.unicodeVersion)}updateAccessibilitySupport(){this.xterm.raw.options.screenReaderMode=this._accessibilityService.isScreenReaderOptimized()}_setCommandsToSkipShell(e){const t=e.filter((e=>"-"===e[0])).map((e=>e.slice(1)));this._skipTerminalCommands=r.Vq.filter((e=>!t.includes(e))).concat(e)}layout(e){if(this._lastLayoutDimensions=e,!this.disableLayout&&!(e.width<=0||e.height<=0)&&this._evaluateColsAndRows(e.width,e.height)){this._resize(),this._containerReadyBarrier.open();for(const t of this._contributions.values())this.xterm?t.layout?.(this.xterm,e):this._xtermReadyPromise.then((i=>t.layout?.(i,e)))}}async _resize(){this._resizeNow(!1)}async _resizeNow(t){let i=this.cols,n=this.rows;if(this.xterm){if(this._isVisible&&this._layoutSettingsChanged){const e=this.xterm.getFont(),t=this._configHelper.config;this.xterm.raw.options.letterSpacing=e.letterSpacing,this.xterm.raw.options.lineHeight=e.lineHeight,this.xterm.raw.options.fontSize=e.fontSize,this.xterm.raw.options.fontFamily=e.fontFamily,this.xterm.raw.options.fontWeight=t.fontWeight,this.xterm.raw.options.fontWeightBold=t.fontWeightBold,this._initDimensions(),i=this.cols,n=this.rows,this._layoutSettingsChanged=!1}if(isNaN(i)||isNaN(n))return;i===this.xterm.raw.cols&&n===this.xterm.raw.rows||((this._fixedRows||this._fixedCols)&&await this._updateProperty("fixedDimensions",{cols:this._fixedCols,rows:this._fixedRows}),this._onDimensionsChanged.fire()),this.xterm.raw.resize(i,n),e._lastKnownGridDimensions={cols:i,rows:n},this._isVisible&&this.xterm.forceUnpause()}t?this._processManager.setDimensions(i,n,!0):await this._processManager.setDimensions(i,n)}setShellType(e){this._shellType=e,e&&this._terminalShellTypeContextKey.set(e?.toString())}_setAriaLabel(e,t,i){const n=[];if(e&&e.textarea){i&&i.length>0?n.push(p.NC("terminalTextBoxAriaLabelNumberAndTitle","Terminal {0}, {1}",t,i)):n.push(p.NC("terminalTextBoxAriaLabel","Terminal {0}",t)),this._accessibilityService.isScreenReaderOptimized()||n.push(p.NC("terminalScreenReaderMode","Run the command: Toggle Screen Reader Accessibility Mode for an optimized screen reader experience"));const s=this._keybindingService.lookupKeybinding("editor.action.accessibilityHelp")?.getLabel();this._configurationService.getValue("accessibility.verbosity.terminal")&&s&&n.push(p.NC("terminalHelpAriaLabel","Use {0} for terminal accessibility help",s)),e.textarea.setAttribute("aria-label",n.join("\n"))}}_updateTitleProperties(e,t){if(!e)return this._processName;switch(t){case s.ev.Process:if(1===this._processManager.os)e=Se.Ku.parse(e).name;else{const t=e.indexOf(" ");e.startsWith("/")?e=Se.EZ(e):t>-1&&(e=e.substring(0,t))}this._processName=e;break;case s.ev.Api:this._staticTitle=e,(0,u.B9)(this._messageTitleDisposable),this._messageTitleDisposable=void 0;break;case s.ev.Sequence:this._sequence=e,1===this._processManager.os&&(e.match(/^[a-zA-Z]:\\.+\.[a-zA-Z]{1,3}/)?(e=Se.Ku.parse(e).name,this._sequence=e):this._sequence=void 0)}return this._titleSource=t,e}setOverrideDimensions(e,t=!1){this._dimensionsOverride&&this._dimensionsOverride.forceExactSize&&!e&&0===this._rows&&0===this._cols&&(this._cols=this._dimensionsOverride.cols,this._rows=this._dimensionsOverride.rows),this._dimensionsOverride=e,t?this._resizeNow(!0):this._resize()}async setFixedDimensions(){const e=await this._quickInputService.input({title:p.NC("setTerminalDimensionsColumn","Set Fixed Dimensions: Column"),placeHolder:"Enter a number of columns or leave empty for automatic width",validateInput:async e=>e.length>0&&!e.match(/^\d+$/)?{content:"Enter a number or leave empty size automatically",severity:w.zb.Error}:void 0});if(void 0===e)return;this._fixedCols=this._parseFixedDimension(e),this._labelComputer?.refreshLabel(),this._terminalHasFixedWidth.set(!!this._fixedCols);const t=await this._quickInputService.input({title:p.NC("setTerminalDimensionsRow","Set Fixed Dimensions: Row"),placeHolder:"Enter a number of rows or leave empty for automatic height",validateInput:async e=>e.length>0&&!e.match(/^\d+$/)?{content:"Enter a number or leave empty size automatically",severity:w.zb.Error}:void 0});void 0!==t&&(this._fixedRows=this._parseFixedDimension(t),this._labelComputer?.refreshLabel(),await this._refreshScrollbar(),this._resize(),this.focus())}_parseFixedDimension(e){if(""===e)return;const t=parseInt(e);if(t<=0)throw new Error(`Could not parse dimension "${e}"`);return t}async toggleSizeToContentWidth(){if(this.xterm?.raw.buffer.active){if(this._hasScrollBar)this._terminalHasFixedWidth.set(!1),this._fixedCols=void 0,this._fixedRows=void 0,this._hasScrollBar=!1,this._initDimensions(),await this._resize();else{const e=Math.max(this.maxCols,Math.min(this.xterm.getLongestViewportWrappedLineLength(),5e3));e>this.xterm.raw.cols&&(this._fixedCols=e)}await this._refreshScrollbar(),this._labelComputer?.refreshLabel(),this.focus()}}_refreshScrollbar(){return this._fixedCols||this._fixedRows?this._addScrollbar():this._removeScrollbar()}async _addScrollbar(){const e=(this.xterm?this.xterm.getFont():this._configHelper.getFont()).charWidth;if(this.xterm?.raw.element&&this._container&&e&&this._fixedCols&&(this._wrapperElement.classList.add("fixed-dims"),this._hasScrollBar=!0,this._initDimensions(),this._fixedRows=this._rows-1,await this._resize(),this._terminalHasFixedWidth.set(!0),this._horizontalScrollbar||(this._horizontalScrollbar=this._register(new yn.s$(this._wrapperElement,{vertical:2,horizontal:1,useShadows:!1,scrollYToX:!1,consumeMouseWheelIfScrollbarIsNeeded:!1})),this._container.appendChild(this._horizontalScrollbar.getDomNode())),this._horizontalScrollbar.setScrollDimensions({width:this.xterm.raw.element.clientWidth,scrollWidth:this._fixedCols*e+40}),this._horizontalScrollbar.getDomNode().style.paddingBottom="16px",_.ED))for(let e=this.xterm.raw.buffer.active.viewportY;e<this.xterm.raw.buffer.active.length;e++)this.xterm.raw.buffer.active.getLine(e)._line.isWrapped=!1}async _removeScrollbar(){this._container&&this._horizontalScrollbar&&(this._horizontalScrollbar.getDomNode().remove(),this._horizontalScrollbar.dispose(),this._horizontalScrollbar=void 0,this._wrapperElement.remove(),this._wrapperElement.classList.remove("fixed-dims"),this._container.appendChild(this._wrapperElement))}_setResolvedShellLaunchConfig(e){this._shellLaunchConfig.args=e.args,this._shellLaunchConfig.cwd=e.cwd,this._shellLaunchConfig.executable=e.executable,this._shellLaunchConfig.env=e.env}_onEnvironmentVariableInfoChanged(e){e.requiresAction&&this.xterm?.raw.textarea?.setAttribute("aria-label",p.NC("terminalStaleTextBoxAriaLabel","Terminal {0} environment is stale, run the 'Show Environment Information' command for more information",this._instanceId)),this._refreshEnvironmentVariableInfoWidgetState(e)}async _refreshEnvironmentVariableInfoWidgetState(e){if(!e)return this.statusList.remove("relaunch-needed"),void this.statusList.remove("env-var-info-changes-active");if(e.requiresAction&&this._configHelper.config.environmentChangesRelaunch&&!this._processManager.hasWrittenData&&(!this._shellLaunchConfig.isFeatureTerminal||this.reconnectionProperties&&!0===this._configurationService.getValue("task.reconnection"))&&!this._shellLaunchConfig.customPtyImplementation&&!this._shellLaunchConfig.isExtensionOwnedTerminal&&!this._shellLaunchConfig.attachPersistentProcess&&(!this._processManager.remoteAuthority||!this._configHelper.config.windowsEnableConpty||1!==await this._processManager.getBackendOS()))return void this.relaunch();const t=Zn(this.shellLaunchConfig.cwd,this._workspaceContextService,this._historyService);this.statusList.add(e.getStatus({workspaceFolder:t}))}async getInitialCwd(){return this._initialCwd||(this._initialCwd=this._processManager.initialCwd),this._initialCwd}async getCwd(){return this.capabilities.has(0)?this.capabilities.get(0).getCwd():this.capabilities.has(1)?this.capabilities.get(1).getCwd():this._processManager.initialCwd}async _refreshProperty(e){return await this.processReady,this._processManager.refreshProperty(e)}async _updateProperty(e,t){return this._processManager.updateProperty(e,t)}async rename(e){this._setTitle(e,s.ev.Api)}_setTitle(e,t){const i=!e,n=(e=this._updateTitleProperties(e,t))!==this._title;this._title=e,this._labelComputer?.refreshLabel(i),this._setAriaLabel(this.xterm?.raw,this._instanceId,this._title),n&&this._onTitleChanged.fire(this)}async changeIcon(){const e=[];for(const t of(0,R.dr)())e.push({label:`$(${t.id})`,description:`${t.id}`,icon:t});const t=await this._quickInputService.pick(e,{matchOnDescription:!0});t&&(this._icon=t.icon,this._onIconChanged.fire({instance:this,userInitiated:!0}))}async changeColor(){if(!this._getIcon())return;const e=this._themeService.getColorTheme(),t=(0,re.l3)(e),i=(0,re.m5)(e),n=[];for(const e of t){const t=(0,re.pv)(e);n.push({label:`$(${R.lA.circleFilled.id}) ${e.replace("terminal.ansi","")}`,id:e,description:e,iconClasses:[t]})}n.push({type:"separator"}),n.push({label:"Reset to default"}),document.body.appendChild(i);const s=this._quickInputService.createQuickPick();s.items=n,s.matchOnDescription=!0,s.show();const r=[],o=await new Promise((e=>{r.push(s.onDidHide((()=>e(void 0)))),r.push(s.onDidAccept((()=>e(s.selectedItems[0]))))}));(0,u.B9)(r),o&&(this.shellLaunchConfig.color=o.id,this._onIconChanged.fire({instance:this,userInitiated:!0})),s.hide(),document.body.removeChild(i)}selectPreviousSuggestion(){this.xterm?.suggestController?.selectPreviousSuggestion()}selectPreviousPageSuggestion(){this.xterm?.suggestController?.selectPreviousPageSuggestion()}selectNextSuggestion(){this.xterm?.suggestController?.selectNextSuggestion()}selectNextPageSuggestion(){this.xterm?.suggestController?.selectNextPageSuggestion()}async acceptSelectedSuggestion(e){this.xterm?.suggestController?.acceptSelectedSuggestion(e)}hideSuggestWidget(){this.xterm?.suggestController?.hideSuggestWidget()}forceScrollbarVisibility(){this._wrapperElement.classList.add("force-scrollbar")}resetScrollbarVisibility(){this._wrapperElement.classList.remove("force-scrollbar")}};fs.__decorator=(0,a.g)([(0,h.Ds)(50)],fs.prototype,"_fireMaximumDimensionsChanged",null),fs.__decorator=(0,a.g)([(0,h.Ds)(1e3)],fs.prototype,"relaunch",null),fs.__decorator=(0,a.g)([(0,h.Ds)(2e3)],fs.prototype,"_updateProcessCwd",null),fs.__decorator=(0,a.g)([(0,h.Ds)(50)],fs.prototype,"_resize",null),fs=(0,a.g)([(0,a.f)(5,b.i6),(0,a.f)(6,S.TG),(0,a.f)(7,r.if),(0,a.f)(8,es.a),(0,a.f)(9,Tn.d),(0,a.f)(10,w.lT),(0,a.f)(11,ve.UP),(0,a.f)(12,A.qC),(0,a.f)(13,Fe.p),(0,a.f)(14,I.XE),(0,a.f)(15,v.Ui),(0,a.f)(16,s.DV),(0,a.f)(17,Wt.Ss),(0,a.f)(18,ke.Uy),(0,a.f)(19,O.F7),(0,a.f)(20,It.a),(0,a.f)(21,$.eJ),(0,a.f)(22,pe.n),(0,a.f)(23,T.ec),(0,a.f)(24,ae.AR),(0,a.f)(25,An.N2),(0,a.f)(26,fe.CE),(0,a.f)(27,Ft.bU),(0,a.f)(28,V.v4),(0,a.f)(29,f.H),(0,a.f)(30,Ki.e7),(0,a.f)(31,A.XH)],fs);let vs=class extends u.JT{get onDropFile(){return this._onDropFile.event}get onDropTerminal(){return this._onDropTerminal.event}constructor(e,t,i){super(),this._container=e,this._layoutService=t,this._viewDescriptorService=i,this._onDropFile=new d.Q5,this._onDropTerminal=new d.Q5,this._register((0,u.OF)((()=>this._clearDropOverlay())))}_clearDropOverlay(){this._dropOverlay&&this._dropOverlay.parentElement&&this._dropOverlay.parentElement.removeChild(this._dropOverlay),this._dropOverlay=void 0}onDragEnter(e){if((0,In.Mq)(e,wn.go.FILES,wn.go.RESOURCES,"Terminals",In.Km.FILES)){if(this._dropOverlay||(this._dropOverlay=document.createElement("div"),this._dropOverlay.classList.add("terminal-drop-overlay")),(0,In.Mq)(e,"Terminals")){const t=this._getDropSide(e);this._dropOverlay.classList.toggle("drop-before","before"===t),this._dropOverlay.classList.toggle("drop-after","after"===t)}this._dropOverlay.parentElement||this._container.appendChild(this._dropOverlay)}}onDragLeave(e){this._clearDropOverlay()}onDragEnd(e){this._clearDropOverlay()}onDragOver(e){if(e.dataTransfer&&this._dropOverlay){if((0,In.Mq)(e,"Terminals")){const t=this._getDropSide(e);this._dropOverlay.classList.toggle("drop-before","before"===t),this._dropOverlay.classList.toggle("drop-after","after"===t)}this._dropOverlay.style.opacity="1"}}async onDrop(e){if(this._clearDropOverlay(),!e.dataTransfer)return;const t=pi(e);if(t){for(const i of t){const t=this._getDropSide(e);this._onDropTerminal.fire({uri:i,side:t})}return}let i;const n=e.dataTransfer.getData(wn.go.RESOURCES);n&&(i=g.ov.parse(JSON.parse(n)[0]));const s=e.dataTransfer.getData(In.Km.FILES);!i&&s&&(i=g.ov.file(JSON.parse(s)[0])),!i&&e.dataTransfer.files.length>0&&e.dataTransfer.files[0].path&&(i=g.ov.file(e.dataTransfer.files[0].path)),i&&this._onDropFile.fire(i)}_getDropSide(e){const t=this._container;if(!t)return"after";const i=t.getBoundingClientRect();return 1===this._getViewOrientation()?e.clientX-i.left<i.width/2?"before":"after":e.clientY-i.top<i.height/2?"before":"after"}_getViewOrientation(){const e=this._layoutService.getPanelPosition();return 1===this._viewDescriptorService.getViewLocationById(r.e9)&&2===e?1:0}};vs=(0,a.g)([(0,a.f)(1,ms.ze),(0,a.f)(2,A.XH)],vs);let bs=class extends u.JT{get title(){return this._title}get description(){return this._description}constructor(e,t,i,n){super(),this._configHelper=e,this._instance=t,this._fileService=i,this._workspaceContextService=n,this._title="",this._description="",this._onDidChangeLabel=this._register(new d.Q5),this.onDidChangeLabel=this._onDidChangeLabel.event}refreshLabel(e){this._title=this.computeLabel(this._configHelper.config.tabs.title,"title",e),this._description=this.computeLabel(this._configHelper.config.tabs.description,"description"),(this._title!==this._instance.title||this._description!==this._instance.description||e)&&this._onDidChangeLabel.fire({title:this._title,description:this._description})}computeLabel(e,t,i){const n=this._instance.shellLaunchConfig.attachPersistentProcess?.type||this._instance.shellLaunchConfig.type,s={cwd:this._instance.cwd||this._instance.initialCwd||"",cwdFolder:"",workspaceFolder:this._instance.workspaceFolder?Se.EZ(this._instance.workspaceFolder.uri.fsPath):void 0,local:"Local"===n?n:void 0,process:this._instance.processName,sequence:this._instance.sequence,task:"Task"===n?n:void 0,fixedDimensions:this._instance.fixedCols?this._instance.fixedRows?`↔${this._instance.fixedCols} ↕${this._instance.fixedRows}`:`↔${this._instance.fixedCols}`:this._instance.fixedRows?`↕${this._instance.fixedRows}`:"",separator:{label:this._configHelper.config.tabs.separator}};if(!(e=e.trim()))return"title"===t&&this._instance.processName||"";if(!i&&this._instance.staticTitle&&"title"===t)return this._instance.staticTitle.replace(/[\n\r\t]/g,"")||s.process?.replace(/[\n\r\t]/g,"")||"";const r=this._instance.capabilities.has(0)||this._instance.capabilities.has(1),o=this._workspaceContextService.getWorkspace().folders.length>1;if(s.cwd&&r&&(!this._instance.shellLaunchConfig.isFeatureTerminal||"title"===t)){const e=g.ov.from({scheme:this._instance.workspaceFolder?.uri.scheme||m.lg.file,path:this._instance.cwd?Se.DB(this._instance.cwd):void 0});let t=!1;if(o)t=!0;else if(this._instance.workspaceFolder?.uri){const i=this._fileService.hasCapability(this._instance.workspaceFolder.uri,1024);t=0!==e.fsPath.localeCompare(this._instance.workspaceFolder.uri.fsPath,void 0,{sensitivity:i?"case":"base"})}t&&(s.cwdFolder=Se.EZ(s.cwd))}const a=(0,xn.XK)(e,s).replace(/[\n\r\t]/g,"").trim();return""===a&&"title"===t?this._instance.processName||"":a}};bs=(0,a.g)([(0,a.f)(2,xe.sn),(0,a.f)(3,T.ec)],bs);var Ss=i(13272),ws=i(14117);let Cs=class{get isProcessSupportRegistered(){return!!this._processSupportContextKey.get()}get connectionState(){return this._connectionState}get whenConnected(){return this._whenConnected.p}get restoredGroupCount(){return this._restoredGroupCount}get configHelper(){return this._configHelper}get instances(){return this._terminalGroupService.instances.concat(this._terminalEditorService.instances)}get detachedXterms(){return this._detachedXterms}getReconnectedTerminals(e){return this._reconnectedTerminals.get(e)}get defaultLocation(){return"editor"===this.configHelper.config.defaultLocation?s.i2.Editor:s.i2.Panel}get activeInstance(){for(const e of this._hostActiveTerminals.values())if(e?.hasFocus)return e;return this._activeInstance}get onDidChangeActiveGroup(){return this._onDidChangeActiveGroup.event}get onDidCreateInstance(){return this._onDidCreateInstance.event}get onDidDisposeInstance(){return this._onDidDisposeInstance.event}get onDidFocusInstance(){return this._onDidFocusInstance.event}get onDidReceiveProcessId(){return this._onDidReceiveProcessId.event}get onDidRequestStartExtensionTerminal(){return this._onDidRequestStartExtensionTerminal.event}get onDidChangeInstanceDimensions(){return this._onDidChangeInstanceDimensions.event}get onDidMaximumDimensionsChange(){return this._onDidMaxiumumDimensionsChange.event}get onDidChangeInstanceCapability(){return this._onDidChangeInstanceCapability.event}get onDidChangeInstances(){return this._onDidChangeInstances.event}get onDidChangeInstanceTitle(){return this._onDidChangeInstanceTitle.event}get onDidChangeInstanceIcon(){return this._onDidChangeInstanceIcon.event}get onDidChangeInstanceColor(){return this._onDidChangeInstanceColor.event}get onDidChangeActiveInstance(){return this._onDidChangeActiveInstance.event}get onDidChangeInstancePrimaryStatus(){return this._onDidChangeInstancePrimaryStatus.event}get onDidInputInstanceData(){return this._onDidInputInstanceData.event}get onDidChangeSelection(){return this._onDidChangeSelection.event}get onDidDisposeGroup(){return this._onDidDisposeGroup.event}get onDidChangeGroups(){return this._onDidChangeGroups.event}get onDidRegisterProcessSupport(){return this._onDidRegisterProcessSupport.event}get onDidChangeConnectionState(){return this._onDidChangeConnectionState.event}constructor(e,t,i,n,r,o,a,c,h,u,m,g,p,f,v,b,S,w,C,y){this._contextKeyService=e,this._lifecycleService=t,this._logService=i,this._dialogService=n,this._instantiationService=r,this._remoteAgentService=o,this._viewsService=a,this._configurationService=c,this._environmentService=h,this._terminalEditorService=u,this._terminalGroupService=m,this._terminalInstanceService=g,this._editorGroupsService=p,this._terminalProfileService=f,this._extensionService=v,this._notificationService=b,this._workspaceContextService=S,this._commandService=w,this._keybindingService=C,this._timerService=y,this._hostActiveTerminals=new Map,this._detachedXterms=new Set,this._isShuttingDown=!1,this._backgroundedTerminalInstances=[],this._backgroundedTerminalDisposables=new Map,this._connectionState=0,this._whenConnected=new l.CR,this._restoredGroupCount=0,this._reconnectedTerminals=new Map,this._onDidChangeActiveGroup=new d.Q5,this._onDidCreateInstance=new d.Q5,this._onDidDisposeInstance=new d.Q5,this._onDidFocusInstance=new d.Q5,this._onDidReceiveProcessId=new d.Q5,this._onDidRequestStartExtensionTerminal=new d.Q5,this._onDidChangeInstanceDimensions=new d.Q5,this._onDidMaxiumumDimensionsChange=new d.Q5,this._onDidChangeInstanceCapability=new d.Q5,this._onDidChangeInstances=new d.Q5,this._onDidChangeInstanceTitle=new d.Q5,this._onDidChangeInstanceIcon=new d.Q5,this._onDidChangeInstanceColor=new d.Q5,this._onDidChangeActiveInstance=new d.Q5,this._onDidChangeInstancePrimaryStatus=new d.Q5,this._onDidInputInstanceData=new d.Q5,this._onDidChangeSelection=new d.Q5,this._onDidDisposeGroup=new d.Q5,this._onDidChangeGroups=new d.Q5,this._onDidRegisterProcessSupport=new d.Q5,this._onDidChangeConnectionState=new d.Q5,this._configHelper=this._instantiationService.createInstance(di),this.onDidCreateInstance((()=>this._terminalProfileService.refreshAvailableProfiles())),this._forwardInstanceHostEvents(this._terminalGroupService),this._forwardInstanceHostEvents(this._terminalEditorService),this._terminalGroupService.onDidChangeActiveGroup(this._onDidChangeActiveGroup.fire,this._onDidChangeActiveGroup),this._terminalInstanceService.onDidCreateInstance((e=>{this._initInstanceListeners(e),this._onDidCreateInstance.fire(e)})),this._terminalGroupService.onDidChangeActiveInstance((e=>{e||this._isShuttingDown||this._terminalGroupService.hidePanel(),e?.shellType?this._terminalShellTypeContextKey.set(e.shellType.toString()):e||this._terminalShellTypeContextKey.reset()})),this._handleInstanceContextKeys(),this._terminalShellTypeContextKey=he.r.shellType.bindTo(this._contextKeyService),this._processSupportContextKey=he.r.processSupported.bindTo(this._contextKeyService),this._processSupportContextKey.set(!_.$L||null!==this._remoteAgentService.getConnection()||void 0!==Ln.B.as(s.UU.Backend).getTerminalBackend()),this._terminalHasBeenCreated=he.r.terminalHasBeenCreated.bindTo(this._contextKeyService),this._terminalCountContextKey=he.r.count.bindTo(this._contextKeyService),this._terminalEditorActive=he.r.terminalEditorActive.bindTo(this._contextKeyService),this.onDidChangeActiveInstance((e=>{this._terminalEditorActive.set(!!e?.target&&e.target===s.i2.Editor)})),t.onBeforeShutdown((async e=>e.veto(this._onBeforeShutdown(e.reason),"veto.terminal"))),t.onWillShutdown((e=>this._onWillShutdown(e))),this.initializePrimaryBackend(),(0,l.Vs)(0).then((()=>this._instantiationService.createInstance(ys,document.head)))}async showProfileQuickPick(e,t){const i=this._instantiationService.createInstance(mi),n=await i.showAndGetResult(e);if(!n)return;if("string"==typeof n)return;const r=n.keyMods;if("createInstance"===e){const e=this.getDefaultInstanceHost().activeInstance;let i;if(n.config&&"id"in n?.config)return void await this.createContributedTerminalProfile(n.config.extensionIdentifier,n.config.id,{icon:n.config.options?.icon,color:n.config.options?.color,location:r?.alt&&e?{splitActiveTerminal:!0}:this.defaultLocation});if(n.config&&"profileName"in n.config&&(i=r?.alt&&e?await this.createTerminal({location:{parentTerminal:e},config:n.config,cwd:t}):await this.createTerminal({location:this.defaultLocation,config:n.config,cwd:t})),i&&this.defaultLocation!==s.i2.Editor)return this._terminalGroupService.showPanel(!0),this.setActiveInstance(i),i}}async initializePrimaryBackend(){(0,ws.B)("code/terminal/willGetTerminalBackend"),this._primaryBackend=await this._terminalInstanceService.getBackend(this._environmentService.remoteAuthority),(0,ws.B)("code/terminal/didGetTerminalBackend");const e=this.configHelper.config.enablePersistentSessions;this._connectionState=0;const t=!!this._environmentService.remoteAuthority&&e;let i;this._primaryBackend?.onDidRequestDetach((async e=>{const t=this.getInstanceFromResource(gi(e.workspaceId,e.instanceId));if(t){const i=t?.persistentProcessId;!i||t.shellLaunchConfig.isFeatureTerminal||t.shellLaunchConfig.customPtyImplementation?await(this._primaryBackend?.acceptDetachInstanceReply(e.requestId,void 0)):(t.target===s.i2.Editor?this._terminalEditorService.detachInstance(t):this._terminalGroupService.getGroupForInstance(t)?.removeInstance(t),await t.detachProcessAndDispose(s._x.User),await(this._primaryBackend?.acceptDetachInstanceReply(e.requestId,i)))}})),(0,ws.B)("code/terminal/willReconnect"),i=t?this._reconnectToRemoteTerminals():e?this._reconnectToLocalTerminals():Promise.resolve(),i.then((async()=>{this._setConnected(),(0,ws.B)("code/terminal/didReconnect"),(0,ws.B)("code/terminal/willReplay");const e=await(this._reconnectedTerminalGroups?.then((e=>e.map((e=>e.terminalInstances)).flat())))??[];await Promise.all(e.map((e=>new Promise((t=>d.ju.once(e.onProcessReplayComplete)(t)))))),(0,ws.B)("code/terminal/didReplay"),(0,ws.B)("code/terminal/willGetPerformanceMarks"),await Promise.all(Array.from(this._terminalInstanceService.getRegisteredBackends()).map((async e=>{this._timerService.setPerformanceMarks(void 0===e.remoteAuthority?"localPtyHost":"remotePtyHost",await e.getPerformanceMarks()),e.setReady()}))),(0,ws.B)("code/terminal/didGetPerformanceMarks"),this._whenConnected.complete()}))}getPrimaryBackend(){return this._primaryBackend}_forwardInstanceHostEvents(e){e.onDidChangeInstances(this._onDidChangeInstances.fire,this._onDidChangeInstances),e.onDidDisposeInstance(this._onDidDisposeInstance.fire,this._onDidDisposeInstance),e.onDidChangeActiveInstance((t=>this._evaluateActiveInstance(e,t))),e.onDidFocusInstance((t=>{this._onDidFocusInstance.fire(t),this._evaluateActiveInstance(e,t)})),e.onDidChangeInstanceCapability((e=>{this._onDidChangeInstanceCapability.fire(e)})),this._hostActiveTerminals.set(e,void 0)}_evaluateActiveInstance(e,t){if(this._hostActiveTerminals.set(e,t),void 0===t)for(const e of this._hostActiveTerminals.values())e&&(t=e);this._activeInstance=t,this._onDidChangeActiveInstance.fire(t)}setActiveInstance(e){e.shellLaunchConfig.hideFromUser&&this._showBackgroundTerminal(e),e.target===s.i2.Editor?this._terminalEditorService.setActiveInstance(e):this._terminalGroupService.setActiveInstance(e)}async focusActiveInstance(){if(this._activeInstance)return this._activeInstance.target===s.i2.Editor?this._terminalEditorService.focusActiveInstance():this._terminalGroupService.focusActiveInstance()}async createContributedTerminalProfile(e,t,i){await this._extensionService.activateByEvent(`onTerminalProfile:${t}`);const n=this._terminalProfileService.getContributedProfileProvider(e,t);if(n)try{await n.createContributedTerminalProfile(i),this._terminalGroupService.setActiveInstanceByIndex(this._terminalGroupService.instances.length-1),await(this._terminalGroupService.activeInstance?.focusWhenReady())}catch(e){this._notificationService.error(e.message)}else this._notificationService.error(`No terminal profile provider registered for id "${t}"`)}async safeDisposeTerminal(e){if(e.target===s.i2.Editor||!e.hasChildProcesses||"panel"!==this.configHelper.config.confirmOnKill&&"always"!==this.configHelper.config.confirmOnKill||!await this._showTerminalCloseConfirmation(!0))return new Promise((t=>{e.onExit((()=>t())),e.dispose(s._x.User)}))}_setConnected(){this._connectionState=1,this._onDidChangeConnectionState.fire(),this._logService.trace("Pty host ready")}async _reconnectToRemoteTerminals(){const e=this._environmentService.remoteAuthority;if(!e)return;const t=await this._terminalInstanceService.getBackend(e);if(!t)return;(0,ws.B)("code/terminal/willGetTerminalLayoutInfo");const i=await t.getTerminalLayoutInfo();(0,ws.B)("code/terminal/didGetTerminalLayoutInfo"),t.reduceConnectionGraceTime(),(0,ws.B)("code/terminal/willRecreateTerminalGroups"),await this._recreateTerminalGroups(i),(0,ws.B)("code/terminal/didRecreateTerminalGroups"),this._attachProcessLayoutListeners(),this._logService.trace("Reconnected to remote terminals")}async _reconnectToLocalTerminals(){const e=await this._terminalInstanceService.getBackend();if(!e)return;(0,ws.B)("code/terminal/willGetTerminalLayoutInfo");const t=await e.getTerminalLayoutInfo();(0,ws.B)("code/terminal/didGetTerminalLayoutInfo"),t&&t.tabs.length>0&&((0,ws.B)("code/terminal/willRecreateTerminalGroups"),this._reconnectedTerminalGroups=this._recreateTerminalGroups(t),(0,ws.B)("code/terminal/didRecreateTerminalGroups")),this._attachProcessLayoutListeners(),this._logService.trace("Reconnected to local terminals")}_recreateTerminalGroups(e){const t=[];let i;if(e){for(const n of e.tabs){const e=n.terminals.filter((e=>e.terminal&&e.terminal.isOrphan));if(e.length){this._restoredGroupCount+=e.length;const s=this._recreateTerminalGroup(n,e);t.push(s),n.isActive&&(i=s);const r=this.instances.find((e=>e.shellLaunchConfig.attachPersistentProcess?.id===n.activePersistentProcessId));r&&this.setActiveInstance(r)}}e.tabs.length&&i?.then((e=>this._terminalGroupService.activeGroup=e))}return Promise.all(t).then((e=>e.filter((e=>!!e))))}async _recreateTerminalGroup(e,t){let i,n;for(const e of t){const t=e.terminal;3!==this._lifecycleService.startupKind&&"Task"===t.type||((0,ws.B)(`code/terminal/willRecreateTerminal/${t.id}-${t.pid}`),i?i=this.createTerminal({config:{attachPersistentProcess:t},location:{parentTerminal:i}}):(i=this.createTerminal({config:{attachPersistentProcess:t},location:s.i2.Panel}),n=i.then((e=>this._terminalGroupService.getGroupForInstance(e)))),(0,ws.B)(`code/terminal/didRecreateTerminal/${t.id}-${t.pid}`))}return n?.then((t=>t?.resizePanes(e.terminals.map((e=>e.relativeSize))))),n}_attachProcessLayoutListeners(){this.onDidChangeActiveGroup((()=>this._saveState())),this.onDidChangeActiveInstance((()=>this._saveState())),this.onDidChangeInstances((()=>this._saveState())),this.onDidReceiveProcessId((()=>this._saveState())),this.onDidChangeInstanceTitle((e=>this._updateTitle(e))),this.onDidChangeInstanceIcon((e=>this._updateIcon(e.instance,e.userInitiated)))}_handleInstanceContextKeys(){const e=he.r.isOpen.bindTo(this._contextKeyService),t=()=>{e.set(this.instances.length>0),this._terminalCountContextKey.set(this.instances.length)};this.onDidChangeInstances((()=>t()))}async getActiveOrCreateInstance(e){const t=this.activeInstance;if(!t)return this.createTerminal();if(!e?.acceptsInput||!0!==t.xterm?.isStdinDisabled)return t;const i=await this.createTerminal();return this.setActiveInstance(i),await this.revealActiveTerminal(),i}async revealActiveTerminal(){const e=this.activeInstance;e&&(e.target===s.i2.Editor?await this._terminalEditorService.revealActiveEditor():await this._terminalGroupService.showPanel())}setEditable(e,t){this._editable=t?{instance:e,data:t}:void 0;const i=this._viewsService.getActiveViewWithId(r.e9),n=this.isEditable(e);i?.terminalTabbedView?.setEditable(n)}isEditable(e){return!(!this._editable||this._editable.instance!==e&&e)}getEditableData(e){return this._editable&&this._editable.instance===e?this._editable.data:void 0}requestStartExtensionTerminal(e,t,i){return new Promise((n=>{this._onDidRequestStartExtensionTerminal.fire({proxy:e,cols:t,rows:i,callback:n})}))}_onBeforeShutdown(e){return _.$L?(this._isShuttingDown=!0,!1):this._onBeforeShutdownAsync(e)}async _onBeforeShutdownAsync(e){if(0===this.instances.length)return!1;try{if(this._shutdownWindowCount=await(this._nativeDelegate?.getWindowCount()),this._shouldReviveProcesses(e)&&await Promise.race([this._primaryBackend?.persistTerminalState(),(0,l.Vs)(2e3)]),(!this._configHelper.config.enablePersistentSessions||3!==e)&&("always"===this.configHelper.config.confirmOnExit&&this.instances.length>0||"hasChildProcesses"===this.configHelper.config.confirmOnExit&&this.instances.some((e=>e.hasChildProcesses))))return this._onBeforeShutdownConfirmation(e)}catch(e){this._logService.warn("Exception occurred during terminal shutdown",e)}return this._isShuttingDown=!0,!1}setNativeDelegate(e){this._nativeDelegate=e}_shouldReviveProcesses(e){if(!this._configHelper.config.enablePersistentSessions)return!1;switch(this.configHelper.config.persistentSessionReviveProcess){case"onExit":return 1===e&&1===this._shutdownWindowCount&&!_.dz||4===e||2===e;case"onExitAndWindowClose":return 3!==e;default:return!1}}async _onBeforeShutdownConfirmation(e){const t=await this._showTerminalCloseConfirmation();return t||(this._isShuttingDown=!0),t}_onWillShutdown(e){const t=this._configHelper.config.enablePersistentSessions&&3===e.reason;for(const e of[...this._terminalGroupService.instances,...this._backgroundedTerminalInstances])t&&e.shouldPersist?e.detachProcessAndDispose(s._x.Shutdown):e.dispose(s._x.Shutdown);t||this._shouldReviveProcesses(e.reason)||this._primaryBackend?.setTerminalLayoutInfo(void 0)}_saveState(){if(this._isShuttingDown)return;if(!this.configHelper.config.enablePersistentSessions)return;const e={tabs:this._terminalGroupService.groups.map((e=>e.getLayoutInfo(e===this._terminalGroupService.activeGroup)))};this._primaryBackend?.setTerminalLayoutInfo(e)}_updateTitle(e){this.configHelper.config.enablePersistentSessions&&e&&e.persistentProcessId&&e.title&&!e.isDisposed&&(e.staticTitle?this._primaryBackend?.updateTitle(e.persistentProcessId,e.staticTitle,s.ev.Api):this._primaryBackend?.updateTitle(e.persistentProcessId,e.title,e.titleSource))}_updateIcon(e,t){this.configHelper.config.enablePersistentSessions&&e&&e.persistentProcessId&&e.icon&&!e.isDisposed&&this._primaryBackend?.updateIcon(e.persistentProcessId,t,e.icon,e.color)}refreshActiveGroup(){this._onDidChangeActiveGroup.fire(this._terminalGroupService.activeGroup)}getInstanceFromId(e){let t=-1;if(this._backgroundedTerminalInstances.forEach(((i,n)=>{i.instanceId===e&&(t=n)})),-1!==t)return this._backgroundedTerminalInstances[t];try{return this.instances[this._getIndexFromId(e)]}catch{return}}getInstanceFromIndex(e){return this.instances[e]}getInstanceFromResource(e){return fi(this.instances,e)}isAttachedToTerminal(e){return this.instances.some((t=>t.processId===e.pid))}moveToEditor(e){if(e.target===s.i2.Editor)return;const t=this._terminalGroupService.getGroupForInstance(e);t&&(t.removeInstance(e),this._terminalEditorService.openEditor(e))}async moveToTerminalView(e,t,i){if(g.ov.isUri(e)&&(e=this.getInstanceFromResource(e)),!e)return;if(this._terminalEditorService.detachInstance(e),e.target!==s.i2.Editor)return void await this._terminalGroupService.showPanel(!0);let n;if(e.target=s.i2.Panel,t&&(n=this._terminalGroupService.getGroupForInstance(t)),n||(n=this._terminalGroupService.createGroup()),n.addInstance(e),this.setActiveInstance(e),await this._terminalGroupService.showPanel(!0),t&&i){const s=n.terminalInstances.indexOf(t)+("after"===i?1:0);n.moveInstance(e,s)}this._onDidChangeInstances.fire(),this._onDidChangeActiveGroup.fire(this._terminalGroupService.activeGroup)}_initInstanceListeners(e){const t=[e.onTitleChanged(this._onDidChangeInstanceTitle.fire,this._onDidChangeInstanceTitle),e.onIconChanged(this._onDidChangeInstanceIcon.fire,this._onDidChangeInstanceIcon),e.onIconChanged(this._onDidChangeInstanceColor.fire,this._onDidChangeInstanceColor),e.onProcessIdReady(this._onDidReceiveProcessId.fire,this._onDidReceiveProcessId),e.statusList.onDidChangePrimaryStatus((()=>this._onDidChangeInstancePrimaryStatus.fire(e))),e.onDimensionsChanged((()=>{this._onDidChangeInstanceDimensions.fire(e),this.configHelper.config.enablePersistentSessions&&this.isProcessSupportRegistered&&this._saveState()})),e.onMaximumDimensionsChanged((()=>this._onDidMaxiumumDimensionsChange.fire(e))),e.onDidInputData(this._onDidInputInstanceData.fire,this._onDidInputInstanceData),e.onDidFocus(this._onDidChangeActiveInstance.fire,this._onDidChangeActiveInstance),e.onRequestAddInstanceToGroup((async t=>await this._addInstanceToGroup(e,t))),e.onDidChangeSelection(this._onDidChangeSelection.fire,this._onDidChangeSelection)];e.onDisposed((()=>(0,u.B9)(t)))}async _addInstanceToGroup(e,t){const i=_i(t.uri);if(void 0===i.instanceId)return;let n=this.getInstanceFromResource(t.uri);if(!n){const s=await(this._primaryBackend?.requestDetachInstance(i.workspaceId,i.instanceId));if(s)return n=await this.createTerminal({config:{attachPersistentProcess:s},resource:t.uri}),void this._terminalGroupService.moveInstance(n,e,t.side)}n=this._terminalGroupService.getInstanceFromResource(t.uri),n?this._terminalGroupService.moveInstance(n,e,t.side):(n=this._terminalEditorService.getInstanceFromResource(t.uri),n&&this.moveToTerminalView(n,e,t.side))}registerProcessSupport(e){e&&(this._processSupportContextKey.set(e),this._onDidRegisterProcessSupport.fire())}_getIndexFromId(e){let t=-1;if(this.instances.forEach(((i,n)=>{i.instanceId===e&&(t=n)})),-1===t)throw new Error(`Terminal with ID ${e} does not exist (has it already been disposed?)`);return t}async _showTerminalCloseConfirmation(e){let t;t=1===this.instances.length||e?p.NC("terminalService.terminalCloseConfirmationSingular","Do you want to terminate the active terminal session?"):p.NC("terminalService.terminalCloseConfirmationPlural","Do you want to terminate the {0} active terminal sessions?",this.instances.length);const{confirmed:i}=await this._dialogService.confirm({type:"warning",message:t,primaryButton:p.NC({key:"terminate",comment:["&& denotes a mnemonic"]},"&&Terminate")});return!i}getDefaultInstanceHost(){return this.defaultLocation===s.i2.Editor?this._terminalEditorService:this._terminalGroupService}async getInstanceHost(e){if(e){if(e===s.i2.Editor)return this._terminalEditorService;if("object"!=typeof e)return this._terminalGroupService;if("viewColumn"in e)return this._terminalEditorService;if("parentTerminal"in e)return(await e.parentTerminal).target===s.i2.Editor?this._terminalEditorService:this._terminalGroupService}return this}async createTerminal(e){if(0===this._terminalProfileService.availableProfiles.length){const t=e?.config&&"customPtyImplementation"in e.config,i=this._remoteAgentService.getConnection()&&g.ov.isUri(e?.cwd)&&e?.cwd.scheme===m.lg.vscodeFileResource;t||i||(0===this._connectionState&&(0,ws.B)("code/terminal/willGetProfiles"),await this._terminalProfileService.profilesReady,0===this._connectionState&&(0,ws.B)("code/terminal/didGetProfiles"))}const t=e?.config||this._terminalProfileService.getDefaultProfile(),i=t&&"extensionIdentifier"in t?{}:this._terminalInstanceService.convertProfileToShellLaunchConfig(t||{});let n=t&&"extensionIdentifier"in t?t:void 0;n||e&&e.config||(n=await this._terminalProfileService.getContributedDefaultProfile(i));const r="object"==typeof e?.location&&"splitActiveTerminal"in e.location?e.location.splitActiveTerminal:"object"==typeof e?.location&&"parentTerminal"in e.location;if(await this._resolveCwd(i,r,e),n){const t=await this.resolveLocation(e?.location);let i;i=r?t===s.i2.Editor?{viewColumn:ae.O3}:{splitActiveTerminal:!0}:"object"==typeof e?.location&&"viewColumn"in e.location?e.location:t,await this.createContributedTerminalProfile(n.extensionIdentifier,n.id,{icon:n.icon,color:n.color,location:i});const o=t===s.i2.Editor?this._terminalEditorService:this._terminalGroupService,a=o.instances[o.instances.length-1];return await a.focusWhenReady(),this._terminalHasBeenCreated.set(!0),a}if(!i.customPtyImplementation&&!this.isProcessSupportRegistered)throw new Error("Could not create terminal when process support is not registered");if(i.hideFromUser){const e=this._terminalInstanceService.createInstance(i,s.i2.Panel);return this._backgroundedTerminalInstances.push(e),this._backgroundedTerminalDisposables.set(e.instanceId,[e.onDisposed(this._onDidDisposeInstance.fire,this._onDidDisposeInstance)]),this._terminalHasBeenCreated.set(!0),e}this._evaluateLocalCwd(i);const o=await this.resolveLocation(e?.location)||this.defaultLocation,a=await this._getSplitParent(e?.location);return this._terminalHasBeenCreated.set(!0),a?this._splitTerminal(i,o,a):this._createTerminal(i,o,e)}async createDetachedXterm(e){const t=await fs.getXtermConstructor(this._keybindingService,this._contextKeyService),i=this._instantiationService.createInstance(vn,t,this._configHelper,e.cols,e.rows,e.colorProvider,e.capabilities||new Ti,"",void 0,!1);return e.readonly&&i.raw.attachCustomKeyEventHandler((()=>!1)),this._detachedXterms.add(i),i.onDidDispose((()=>this._detachedXterms.delete(i))),i}async _resolveCwd(e,t,i){if(!e.cwd)if(i?.cwd)e.cwd=i.cwd;else if(t&&i?.location){let t=this.activeInstance;if("object"==typeof i.location&&"parentTerminal"in i.location&&(t=await i.location.parentTerminal),!t)throw new Error("Cannot split without an active instance");e.cwd=await ze(this.configHelper,t,this._workspaceContextService.getWorkspace().folders,this._commandService)}}_splitTerminal(e,t,i){let n;if("object"!=typeof e.cwd&&"object"==typeof i.shellLaunchConfig.cwd&&(e.cwd=g.ov.from({scheme:i.shellLaunchConfig.cwd.scheme,authority:i.shellLaunchConfig.cwd.authority,path:e.cwd||i.shellLaunchConfig.cwd.path})),t===s.i2.Editor||i.target===s.i2.Editor)n=this._terminalEditorService.splitInstance(i,e);else{const t=this._terminalGroupService.getGroupForInstance(i);if(!t)throw new Error(`Cannot split a terminal without a group ${i}`);e.parentTerminalId=i.instanceId,n=t.split(e)}return this._addToReconnected(n),n}_addToReconnected(e){if(!e.reconnectionProperties?.ownerId)return;const t=this._reconnectedTerminals.get(e.reconnectionProperties.ownerId);t?t.push(e):this._reconnectedTerminals.set(e.reconnectionProperties.ownerId,[e])}_createTerminal(e,t,i){let n;const r=this._getEditorOptions(i?.location);return t===s.i2.Editor?(n=this._terminalInstanceService.createInstance(e,s.i2.Editor),this._terminalEditorService.openEditor(n,r)):n=this._terminalGroupService.createGroup(e).terminalInstances[0],this._addToReconnected(n),n}async resolveLocation(e){if(e&&"object"==typeof e){if("parentTerminal"in e){const t=await e.parentTerminal;return t.target?t.target:s.i2.Panel}if("viewColumn"in e)return s.i2.Editor;if("splitActiveTerminal"in e)return this._activeInstance?.target?this._activeInstance?.target:s.i2.Panel}return e}async _getSplitParent(e){return e&&"object"==typeof e&&"parentTerminal"in e?e.parentTerminal:e&&"object"==typeof e&&"splitActiveTerminal"in e?this.activeInstance:void 0}_getEditorOptions(e){if(e&&"object"==typeof e&&"viewColumn"in e)return e.viewColumn=(0,bi.G)(this._editorGroupsService,this._configurationService,e.viewColumn),e}_evaluateLocalCwd(e){"string"!=typeof e.cwd&&e.cwd?.scheme===m.lg.file&&(E.iN.getValue(this._contextKeyService)?(e.initialText=C(p.NC("localTerminalVirtualWorkspace","This shell is open to a {0}local{1} folder, NOT to the virtual folder","[3m","[23m"),{excludeLeadingNewLine:!0,loudFormatting:!0}),e.type="Local"):this._remoteAgentService.getConnection()&&(e.initialText=C(p.NC("localTerminalRemote","This shell is running on your {0}local{1} machine, NOT on the connected remote machine","[3m","[23m"),{excludeLeadingNewLine:!0,loudFormatting:!0}),e.type="Local"))}_showBackgroundTerminal(e){this._backgroundedTerminalInstances.splice(this._backgroundedTerminalInstances.indexOf(e),1);const t=this._backgroundedTerminalDisposables.get(e.instanceId);t&&(0,u.B9)(t),this._backgroundedTerminalDisposables.delete(e.instanceId),e.shellLaunchConfig.hideFromUser=!1,this._terminalGroupService.createGroup(e),1===this.instances.length&&this._terminalGroupService.setActiveInstanceByIndex(0),this._onDidChangeInstances.fire(),this._onDidChangeGroups.fire()}async setContainers(e,t){this._configHelper.panelContainer=e,this._terminalGroupService.setContainer(t)}getEditingTerminal(){return this._editingTerminal}setEditingTerminal(e){this._editingTerminal=e}};Cs.__decorator=(0,a.g)([(0,h.Ds)(500)],Cs.prototype,"_saveState",null),Cs.__decorator=(0,a.g)([(0,h.Ds)(500)],Cs.prototype,"_updateTitle",null),Cs.__decorator=(0,a.g)([(0,h.Ds)(500)],Cs.prototype,"_updateIcon",null),Cs=(0,a.g)([(0,a.f)(0,b.i6),(0,a.f)(1,Si.g),(0,a.f)(2,s.DV),(0,a.f)(3,Wt.Ss),(0,a.f)(4,S.TG),(0,a.f)(5,be.R),(0,a.f)(6,A.qC),(0,a.f)(7,v.Ui),(0,a.f)(8,pe.n),(0,a.f)(9,o.BZ),(0,a.f)(10,o.Qy),(0,a.f)(11,o.N4),(0,a.f)(12,We.Qw),(0,a.f)(13,r.l5),(0,a.f)(14,St.QS),(0,a.f)(15,w.lT),(0,a.f)(16,T.ec),(0,a.f)(17,f.H),(0,a.f)(18,Tn.d),(0,a.f)(19,Ss.O)],Cs);let ys=class extends I.bB{constructor(e,t,i,n,s){super(i),this._terminalService=t,this._themeService=i,this._terminalProfileService=n,this._editorService=s,this._registerListeners(),this._styleElement=document.createElement("style"),e.appendChild(this._styleElement),this._register((0,u.OF)((()=>e.removeChild(this._styleElement)))),this.updateStyles()}_registerListeners(){this._register(this._terminalService.onDidChangeInstanceIcon((()=>this.updateStyles()))),this._register(this._terminalService.onDidChangeInstanceColor((()=>this.updateStyles()))),this._register(this._terminalService.onDidCreateInstance((()=>this.updateStyles()))),this._register(this._editorService.onDidActiveEditorChange((()=>{this._editorService.activeEditor instanceof ui.S&&this.updateStyles()}))),this._register(this._editorService.onDidCloseEditor((()=>{this._editorService.activeEditor instanceof ui.S&&this.updateStyles()}))),this._register(this._terminalProfileService.onDidChangeAvailableProfiles((()=>this.updateStyles())))}updateStyles(){super.updateStyles();const e=this._themeService.getColorTheme();let t="";const i=this._themeService.getProductIconTheme();for(const n of this._terminalService.instances){const s=n.icon;if(!s)continue;let r;s instanceof g.ov?r=s:s instanceof Object&&"light"in s&&"dark"in s&&(r=e.type===k.eL.LIGHT?s.light:s.dark);const o=(0,re.A5)(n,e.type);if(r instanceof g.ov&&o&&o.length>1&&(t+=`.monaco-workbench .terminal-tab.${o[0]}::before{background-image: ${c.wY(r)};}`),D.kS.isThemeIcon(s)){const e=(0,x.Ks)().getIcon(s.id);if(e){const n=i.getIcon(e);n&&(t+=`.monaco-workbench .terminal-tab.codicon-${s.id}::before{content: '${n.fontCharacter}' !important; font-family: ${c._h(n.font?.id??"codicon")} !important;}`)}}}const n=e.getColor(y.XZx);n&&(t+=`.monaco-workbench .show-file-icons .file-icon.terminal-tab::before { color: ${n}; }`),t+=(0,re.Ip)(e,!0),this._styleElement.textContent=t}};ys=(0,a.g)([(0,a.f)(1,o.x4),(0,a.f)(2,I.XE),(0,a.f)(3,r.l5),(0,a.f)(4,ae.AR)],ys);var xs=i(22844);let ks=class extends u.JT{constructor(e,t,i,n,s,r){super(),this._editorService=e,this._editorGroupsService=t,this._terminalInstanceService=i,this._instantiationService=n,this.instances=[],this._activeInstanceIndex=-1,this._isShuttingDown=!1,this._editorInputs=new Map,this._instanceDisposables=new Map,this._onDidDisposeInstance=new d.Q5,this.onDidDisposeInstance=this._onDidDisposeInstance.event,this._onDidFocusInstance=new d.Q5,this.onDidFocusInstance=this._onDidFocusInstance.event,this._onDidChangeInstanceCapability=new d.Q5,this.onDidChangeInstanceCapability=this._onDidChangeInstanceCapability.event,this._onDidChangeActiveInstance=new d.Q5,this.onDidChangeActiveInstance=this._onDidChangeActiveInstance.event,this._onDidChangeInstances=new d.Q5,this.onDidChangeInstances=this._onDidChangeInstances.event,this._terminalEditorActive=he.r.terminalEditorActive.bindTo(r),this._register((0,u.OF)((()=>{for(const e of this._instanceDisposables.values())(0,u.B9)(e)}))),this._register(s.onWillShutdown((()=>this._isShuttingDown=!0))),this._register(this._editorService.onDidActiveEditorChange((()=>{const e=this._editorService.activeEditor,t=e instanceof ui.S?e?.terminalInstance:void 0,i=!!t&&e instanceof ui.S;if(this._terminalEditorActive.set(i),i)e?.setGroup(this._editorService.activeEditorPane?.group),this.setActiveInstance(t);else for(const e of this.instances)e.resetFocusContextKey()}))),this._register(this._editorService.onDidVisibleEditorsChange((()=>{const e=this.instances.map((e=>e.instanceId)),t=this._getActiveTerminalEditors().find((t=>{const i=t instanceof ui.S?t.terminalInstance?.instanceId:void 0;return void 0!==i&&!e.includes(i)}));t instanceof ui.S&&t.terminalInstance&&(this._editorInputs.set(t.terminalInstance.resource.path,t),this.instances.push(t.terminalInstance))}))),this._register(this._editorService.onDidCloseEditor((e=>{const t=e.editor instanceof ui.S?e.editor.terminalInstance:void 0;if(t){const e=this.instances.findIndex((e=>e===t));if(-1!==e){const i=this.instances[e]===this.activeInstance;this._removeInstance(t),i&&this.setActiveInstance(void 0)}}})))}_getActiveTerminalEditors(){return this._editorService.visibleEditors.filter((e=>e instanceof ui.S&&e.terminalInstance?.instanceId))}get activeInstance(){if(0!==this.instances.length&&-1!==this._activeInstanceIndex)return this.instances[this._activeInstanceIndex]}setActiveInstance(e){this._activeInstanceIndex=e?this.instances.findIndex((t=>t===e)):-1,this._onDidChangeActiveInstance.fire(this.activeInstance)}async focusActiveInstance(){return this.activeInstance?.focusWhenReady(!0)}async openEditor(e,t){const i=this.resolveResource(e);i&&(await(this._activeOpenEditorRequest?.promise),this._activeOpenEditorRequest={instanceId:e.instanceId,promise:this._editorService.openEditor({resource:i,description:e.description||e.shellLaunchConfig.type,options:{pinned:!0,forceReload:!0,preserveFocus:t?.preserveFocus}},t?.viewColumn??ae.LP)},await(this._activeOpenEditorRequest?.promise),this._activeOpenEditorRequest=void 0)}resolveResource(e){const t=e.resource,i=t.path,n=this._editorInputs.get(i);if(n)return n.resource;e.target=s.i2.Editor;const r=this._instantiationService.createInstance(ui.S,t,e);return this._registerInstance(i,r,e),r.resource}getInputFromResource(e){const t=this._editorInputs.get(e.path);if(!t)throw new Error(`Could not get input from resource: ${e.path}`);return t}_registerInstance(e,t,i){this._editorInputs.set(e,t),this._instanceDisposables.set(e,[i.onDidFocus(this._onDidFocusInstance.fire,this._onDidFocusInstance),i.onDisposed(this._onDidDisposeInstance.fire,this._onDidDisposeInstance),i.capabilities.onDidAddCapability((()=>this._onDidChangeInstanceCapability.fire(i))),i.capabilities.onDidRemoveCapability((()=>this._onDidChangeInstanceCapability.fire(i)))]),this.instances.push(i),this._onDidChangeInstances.fire()}_removeInstance(e){const t=e.resource.path;this._editorInputs.delete(t);const i=this.instances.findIndex((t=>t===e));-1!==i&&this.instances.splice(i,1);const n=this._instanceDisposables.get(t);this._instanceDisposables.delete(t),n&&(0,u.B9)(n),this._onDidChangeInstances.fire()}getInstanceFromResource(e){return fi(this.instances,e)}splitInstance(e,t={}){if(e.target===s.i2.Editor){const t=this._editorInputs.get(e.resource.path)?.group;t&&this._editorGroupsService.activateGroup(t)}const i=this._terminalInstanceService.createInstance(t,s.i2.Editor),n=this.resolveResource(i);return n&&this._editorService.openEditor({resource:g.ov.revive(n),description:i.description,options:{pinned:!0,forceReload:!0}},ae.O3),i}reviveInput(e){if("pid"in e){const t={...e,findRevivedId:!0},i=this._terminalInstanceService.createInstance({attachPersistentProcess:t},s.i2.Editor),n=this._instantiationService.createInstance(ui.S,i.resource,i);return this._registerInstance(i.resource.path,n,i),n}throw new Error(`Could not revive terminal editor input, ${e}`)}detachInstance(e){const t=e.resource.path,i=this._editorInputs.get(t);i?.detachInstance(),this._removeInstance(e),this._isShuttingDown||i?.dispose()}async revealActiveEditor(e){const t=this.activeInstance;if(!t)return;if(this._activeOpenEditorRequest?.instanceId===t.instanceId)return;const i=this._editorInputs.get(t.resource.path);this._editorService.openEditor(i,{pinned:!0,forceReload:!0,preserveFocus:e,activation:xs.kn.PRESERVE})}};ks=(0,a.g)([(0,a.f)(0,ae.AR),(0,a.f)(1,We.Qw),(0,a.f)(2,o.N4),(0,a.f)(3,S.TG),(0,a.f)(4,Si.g),(0,a.f)(5,b.i6)],ks);var Is=i(89782),Ds=i(98148);let Ts=class extends u.JT{get onDidChange(){return this._onDidChange}constructor(e,t,i){super(),this._container=e,this.orientation=t,this._layoutService=i,this._splitViewDisposables=this._register(new u.SL),this._children=[],this._terminalToPane=new Map,this._onDidChange=d.ju.None,this._width=this._container.offsetWidth,this._height=this._container.offsetHeight,this._createSplitView(),this._splitView.layout(1===this.orientation?this._width:this._height)}_createSplitView(){this._splitView=new Is.z(this._container,{orientation:this.orientation}),this._splitViewDisposables.clear(),this._splitViewDisposables.add(this._splitView.onDidSashReset((()=>this._splitView.distributeViewSizes())))}split(e,t){this._addChild(e,t)}resizePane(e,t,i,n){const s=0===t||1===t;if(s&&1!==this.orientation||!s&&0!==this.orientation)return(1===this.orientation&&3===t||0===this.orientation&&1===t)&&(i*=-1),void this._layoutService.resizePart(n,i,i);if(this._children.length<=1)return;const r=[];for(let e=0;e<this._splitView.length;e++)r.push(this._splitView.getViewSize(e));const o=e!==this._children.length-1,a=o?e+1:e-1;o&&0===t?i*=-1:o||1!==t?o&&2===t?i*=-1:o||3!==t||(i*=-1):i*=-1,r[e]+i<80?i=80-r[e]:r[a]-i<80&&(i=r[a]-80),r[e]+=i,r[a]-=i;for(let e=0;e<this._splitView.length-1;e++)this._splitView.resizeView(e,r[e])}resizePanes(e){if(this._children.length<=1)return;e[e.length-1]+=1-e.reduce(((e,t)=>e+t),0);let t=0;for(let e=0;e<this._splitView.length;e++)t+=this._splitView.getViewSize(e);for(let i=0;i<this._splitView.length;i++)this._splitView.resizeView(i,t*e[i])}getPaneSize(e){const t=this._terminalToPane.get(e);if(!t)return 0;const i=this._children.indexOf(t);return this._splitView.getViewSize(i)}_addChild(e,t){const i=new Es(e,1===this.orientation?this._height:this._width);i.orientation=this.orientation,"number"==typeof t?this._children.splice(t,0,i):this._children.push(i),this._terminalToPane.set(e,this._children[this._children.indexOf(i)]),this._withDisabledLayout((()=>this._splitView.addView(i,Is.M.Distribute,t))),this.layout(this._width,this._height),this._onDidChange=d.ju.any(...this._children.map((e=>e.onDidChange)))}remove(e){let t=null;for(let i=0;i<this._children.length;i++)this._children[i].instance===e&&(t=i);null!==t&&(this._children.splice(t,1),this._terminalToPane.delete(e),this._splitView.removeView(t,Is.M.Distribute),e.detachFromElement())}layout(e,t){this._width=e,this._height=t,1===this.orientation?(this._children.forEach((e=>e.orthogonalLayout(t))),this._splitView.layout(e)):(this._children.forEach((t=>t.orthogonalLayout(e))),this._splitView.layout(t))}setOrientation(e){if(this.orientation!==e){for(this.orientation=e;this._container.children.length>0;)this._container.removeChild(this._container.children[0]);this._splitViewDisposables.clear(),this._splitView.dispose(),this._createSplitView(),this._withDisabledLayout((()=>{this._children.forEach((t=>{t.orientation=e,this._splitView.addView(t,1)}))}))}}_withDisabledLayout(e){this._children.forEach((e=>e.instance.disableLayout=!0)),e(),this._children.forEach((e=>e.instance.disableLayout=!1))}};Ts=(0,a.g)([(0,a.f)(2,ms.ze)],Ts);class Es{get onDidChange(){return this._onDidChange}constructor(e,t){this.instance=e,this.orthogonalSize=t,this.minimumSize=80,this.maximumSize=Number.MAX_VALUE,this._onDidChange=d.ju.None,this.element=document.createElement("div"),this.element.className="terminal-split-pane",this.instance.attachToElement(this.element)}layout(e){e&&this.orthogonalSize&&(0===this.orientation?this.instance.layout({width:this.orthogonalSize,height:e}):this.instance.layout({width:e,height:this.orthogonalSize}))}orthogonalLayout(e){this.orthogonalSize=e}}let As=class extends u.JT{get terminalInstances(){return this._terminalInstances}constructor(e,t,i,n,s,r,o){super(),this._container=e,this._terminalService=i,this._terminalInstanceService=n,this._layoutService=s,this._viewDescriptorService=r,this._instantiationService=o,this._terminalInstances=[],this._panelPosition=2,this._terminalLocation=1,this._instanceDisposables=new Map,this._activeInstanceIndex=-1,this._onDidDisposeInstance=this._register(new d.Q5),this.onDidDisposeInstance=this._onDidDisposeInstance.event,this._onDidFocusInstance=this._register(new d.Q5),this.onDidFocusInstance=this._onDidFocusInstance.event,this._onDidChangeInstanceCapability=this._register(new d.Q5),this.onDidChangeInstanceCapability=this._onDidChangeInstanceCapability.event,this._onDisposed=this._register(new d.Q5),this.onDisposed=this._onDisposed.event,this._onInstancesChanged=this._register(new d.Q5),this.onInstancesChanged=this._onInstancesChanged.event,this._onDidChangeActiveInstance=new d.Q5,this.onDidChangeActiveInstance=this._onDidChangeActiveInstance.event,this._onPanelOrientationChanged=new d.Q5,this.onPanelOrientationChanged=this._onPanelOrientationChanged.event,t&&this.addInstance(t),this._container&&this.attachToElement(this._container),this._onPanelOrientationChanged.fire(1===this._terminalLocation&&2===this._panelPosition?1:0)}addInstance(e,t){let i;const n=t?this._terminalInstances.findIndex((e=>e.instanceId===t)):this._activeInstanceIndex;i="instanceId"in e?e:this._terminalInstanceService.createInstance(e,s.i2.Panel),0===this._terminalInstances.length?(this._terminalInstances.push(i),this._activeInstanceIndex=0):this._terminalInstances.splice(n+1,0,i),this._initInstanceListeners(i),this._splitPaneContainer&&this._splitPaneContainer.split(i,n+1),this._onInstancesChanged.fire()}dispose(){super.dispose(),this._container&&this._groupElement&&(this._container.removeChild(this._groupElement),this._groupElement=void 0),this._terminalInstances=[],this._onInstancesChanged.fire()}get activeInstance(){if(0!==this._terminalInstances.length)return this._terminalInstances[this._activeInstanceIndex]}getLayoutInfo(e){const t=this.terminalInstances.filter((e=>"number"==typeof e.persistentProcessId&&e.shouldPersist)),i=t.map((e=>this._splitPaneContainer?.getPaneSize(e)||0)).reduce(((e,t)=>e+t),0);return{isActive:e,activePersistentProcessId:this.activeInstance?this.activeInstance.persistentProcessId:void 0,terminals:t.map((e=>({relativeSize:i>0?this._splitPaneContainer.getPaneSize(e)/i:0,terminal:e.persistentProcessId||0})))}}_initInstanceListeners(e){this._instanceDisposables.set(e.instanceId,[e.onDisposed((e=>{this._onDidDisposeInstance.fire(e),this._handleOnDidDisposeInstance(e)})),e.onDidFocus((e=>{this._setActiveInstance(e),this._onDidFocusInstance.fire(e)})),e.capabilities.onDidAddCapability((()=>this._onDidChangeInstanceCapability.fire(e))),e.capabilities.onDidRemoveCapability((()=>this._onDidChangeInstanceCapability.fire(e)))])}_handleOnDidDisposeInstance(e){this._removeInstance(e)}removeInstance(e){this._removeInstance(e);const t=this._instanceDisposables.get(e.instanceId);t&&((0,u.B9)(t),this._instanceDisposables.delete(e.instanceId))}_removeInstance(e){const t=this._terminalInstances.indexOf(e);if(-1===t)return;const i=e===this.activeInstance;if(this._terminalInstances.splice(t,1),i&&this._terminalInstances.length>0){const e=t<this._terminalInstances.length?t:this._terminalInstances.length-1;this.setActiveInstanceByIndex(e),this.activeInstance?.focus(!0)}else t<this._activeInstanceIndex&&this._activeInstanceIndex--;this._splitPaneContainer?.remove(e),0===this._terminalInstances.length?(this._onDisposed.fire(this),this.dispose()):this._onInstancesChanged.fire()}moveInstance(e,t){const i=this.terminalInstances.indexOf(e);-1!==i&&(this._terminalInstances.splice(i,1),this._terminalInstances.splice(t,0,e),this._splitPaneContainer&&(this._splitPaneContainer.remove(e),this._splitPaneContainer.split(e,t)),this._onInstancesChanged.fire())}_setActiveInstance(e){this.setActiveInstanceByIndex(this._getIndexFromId(e.instanceId))}_getIndexFromId(e){let t=-1;if(this.terminalInstances.forEach(((i,n)=>{i.instanceId===e&&(t=n)})),-1===t)throw new Error(`Terminal with ID ${e} does not exist (has it already been disposed?)`);return t}setActiveInstanceByIndex(e,t){if(e<0||e>=this._terminalInstances.length)return;const i=this.activeInstance;this._activeInstanceIndex=e,(i!==this.activeInstance||t)&&(this._onInstancesChanged.fire(),this._onDidChangeActiveInstance.fire(this.activeInstance))}attachToElement(e){if(this._container=e,this._groupElement||(this._groupElement=document.createElement("div"),this._groupElement.classList.add("terminal-group")),this._container.appendChild(this._groupElement),!this._splitPaneContainer){this._panelPosition=this._layoutService.getPanelPosition(),this._terminalLocation=this._viewDescriptorService.getViewLocationById(r.e9);const e=1===this._terminalLocation&&2===this._panelPosition?1:0;this._splitPaneContainer=this._instantiationService.createInstance(Ts,this._groupElement,e),this.terminalInstances.forEach((e=>this._splitPaneContainer.split(e,this._activeInstanceIndex+1))),this._initialRelativeSizes&&(this.resizePanes(this._initialRelativeSizes),this._initialRelativeSizes=void 0)}}get title(){if(0===this._terminalInstances.length)return"";let e=this.terminalInstances[0].title+this._getBellTitle(this.terminalInstances[0]);this.terminalInstances[0].description&&(e+=` (${this.terminalInstances[0].description})`);for(let t=1;t<this.terminalInstances.length;t++){const i=this.terminalInstances[t];i.title&&(e+=`, ${i.title+this._getBellTitle(i)}`,i.description&&(e+=` (${i.description})`))}return e}_getBellTitle(e){return this._terminalService.configHelper.config.enableBell&&e.statusList.statuses.some((e=>"bell"===e.id))?"*":""}setVisible(e){this._groupElement&&(this._groupElement.style.display=e?"":"none"),this.terminalInstances.forEach((t=>t.setVisible(e)))}split(e){const t=this._terminalInstanceService.createInstance(e,s.i2.Panel);return this.addInstance(t,e.parentTerminalId),this._setActiveInstance(t),t}addDisposable(e){this._register(e)}layout(e,t){if(this._splitPaneContainer){const i=this._layoutService.getPanelPosition(),n=this._viewDescriptorService.getViewLocationById(r.e9);if(i!==this._panelPosition||n!==this._terminalLocation){const e=1===n&&2===i?1:0;this._splitPaneContainer.setOrientation(e),this._panelPosition=i,this._terminalLocation=n,this._onPanelOrientationChanged.fire(this._splitPaneContainer.orientation)}this._splitPaneContainer.layout(e,t)}}focusPreviousPane(){const e=0===this._activeInstanceIndex?this._terminalInstances.length-1:this._activeInstanceIndex-1;this.setActiveInstanceByIndex(e)}focusNextPane(){const e=this._activeInstanceIndex===this._terminalInstances.length-1?0:this._activeInstanceIndex+1;this.setActiveInstanceByIndex(e)}resizePane(e){if(!this._splitPaneContainer)return;const t=0===e||1===e,i=this._terminalService.configHelper.getFont(),n=t?i.charWidth:i.charHeight;n&&this._splitPaneContainer.resizePane(this._activeInstanceIndex,e,4*n,(0,Ds.L)(this._terminalLocation))}resizePanes(e){this._splitPaneContainer?this._splitPaneContainer.resizePanes(e):this._initialRelativeSizes=e}};As=(0,a.g)([(0,a.f)(2,o.x4),(0,a.f)(3,o.N4),(0,a.f)(4,ms.ze),(0,a.f)(5,A.XH),(0,a.f)(6,S.TG)],As);let Ls=class extends u.JT{get instances(){return this.groups.reduce(((e,t)=>e.concat(t.terminalInstances)),[])}constructor(e,t,i,n,s){super(),this._contextKeyService=e,this._instantiationService=t,this._viewsService=i,this._viewDescriptorService=n,this._configurationService=s,this.groups=[],this.activeGroupIndex=-1,this._onDidChangeActiveGroup=new d.Q5,this.onDidChangeActiveGroup=this._onDidChangeActiveGroup.event,this._onDidDisposeGroup=new d.Q5,this.onDidDisposeGroup=this._onDidDisposeGroup.event,this._onDidChangeGroups=new d.Q5,this.onDidChangeGroups=this._onDidChangeGroups.event,this._onDidShow=new d.Q5,this.onDidShow=this._onDidShow.event,this._onDidDisposeInstance=new d.Q5,this.onDidDisposeInstance=this._onDidDisposeInstance.event,this._onDidFocusInstance=new d.Q5,this.onDidFocusInstance=this._onDidFocusInstance.event,this._onDidChangeActiveInstance=new d.Q5,this.onDidChangeActiveInstance=this._onDidChangeActiveInstance.event,this._onDidChangeInstances=new d.Q5,this.onDidChangeInstances=this._onDidChangeInstances.event,this._onDidChangeInstanceCapability=new d.Q5,this.onDidChangeInstanceCapability=this._onDidChangeInstanceCapability.event,this._onDidChangePanelOrientation=new d.Q5,this.onDidChangePanelOrientation=this._onDidChangePanelOrientation.event,this.onDidDisposeGroup((e=>this._removeGroup(e))),this._terminalGroupCountContextKey=he.r.groupCount.bindTo(this._contextKeyService),this.onDidChangeGroups((()=>this._terminalGroupCountContextKey.set(this.groups.length))),d.ju.any(this.onDidChangeActiveGroup,this.onDidChangeInstances)((()=>this.updateVisibility()))}hidePanel(){const e=this._viewDescriptorService.getViewContainerByViewId(r.e9);e&&1===this._viewDescriptorService.getViewContainerModel(e).activeViewDescriptors.length&&(this._viewsService.closeView(r.e9),he.r.tabsMouse.bindTo(this._contextKeyService).set(!1))}showTabs(){this._configurationService.updateValue("terminal.integrated.tabs.enabled",!0)}get activeGroup(){if(!(this.activeGroupIndex<0||this.activeGroupIndex>=this.groups.length))return this.groups[this.activeGroupIndex]}set activeGroup(e){if(void 0===e)return;const t=this.groups.findIndex((t=>t===e));this.setActiveGroupByIndex(t)}get activeInstance(){return this.activeGroup?.activeInstance}setActiveInstance(e){this.setActiveInstanceByIndex(this._getIndexFromId(e.instanceId))}_getIndexFromId(e){const t=this.instances.findIndex((t=>t.instanceId===e));if(-1===t)throw new Error(`Terminal with ID ${e} does not exist (has it already been disposed?)`);return t}setContainer(e){this._container=e,this.groups.forEach((t=>t.attachToElement(e)))}async focusTabs(){if(0===this.instances.length)return;await this.showPanel(!0);const e=this._viewsService.getActiveViewWithId(r.e9);e?.terminalTabbedView?.focusTabs()}async focusHover(){if(0===this.instances.length)return;const e=this._viewsService.getActiveViewWithId(r.e9);e?.terminalTabbedView?.focusHover()}async focusActiveInstance(){return this.showPanel(!0)}createGroup(e){const t=this._instantiationService.createInstance(As,this._container,e);return t.onPanelOrientationChanged((e=>this._onDidChangePanelOrientation.fire(e))),this.groups.push(t),t.addDisposable(t.onDidDisposeInstance(this._onDidDisposeInstance.fire,this._onDidDisposeInstance)),t.addDisposable(t.onDidFocusInstance(this._onDidFocusInstance.fire,this._onDidFocusInstance)),t.addDisposable(t.onDidChangeActiveInstance((e=>{t===this.activeGroup&&this._onDidChangeActiveInstance.fire(e)}))),t.addDisposable(t.onDidChangeInstanceCapability(this._onDidChangeInstanceCapability.fire,this._onDidChangeInstanceCapability)),t.addDisposable(t.onInstancesChanged(this._onDidChangeInstances.fire,this._onDidChangeInstances)),t.addDisposable(t.onDisposed(this._onDidDisposeGroup.fire,this._onDidDisposeGroup)),t.terminalInstances.length>0&&this._onDidChangeInstances.fire(),1===this.instances.length&&this.setActiveInstanceByIndex(0),this._onDidChangeGroups.fire(),t}async showPanel(e){const t=this._viewsService.getActiveViewWithId(r.e9)??await this._viewsService.openView(r.e9,e);if(t?.setExpanded(!0),e){await(0,l.Vs)(0);const i=this.activeInstance;i&&(t&&!t.isVisible()&&await this._viewsService.openView(r.e9,e),await i.focusWhenReady(!0))}this._onDidShow.fire()}getInstanceFromResource(e){return fi(this.instances,e)}_removeGroup(e){const t=e===this.activeGroup,i=this.groups.indexOf(e);if(-1!==i&&(this.groups.splice(i,1),this._onDidChangeGroups.fire()),t){if(this.groups.length>0){const e=i<this.groups.length?i:this.groups.length-1;this.setActiveGroupByIndex(e,!0),this.activeInstance?.focus(!0)}}else this.activeGroupIndex>i&&this.setActiveGroupByIndex(this.activeGroupIndex-1);this.activeGroupIndex>=this.groups.length&&this.setActiveGroupByIndex(this.groups.length-1),this._onDidChangeInstances.fire(),this._onDidChangeGroups.fire(),t&&(this._onDidChangeActiveGroup.fire(this.activeGroup),this._onDidChangeActiveInstance.fire(this.activeInstance))}setActiveGroupByIndex(e,t){if(-1===e&&0===this.groups.length)return void(-1!==this.activeGroupIndex&&(this.activeGroupIndex=-1,this._onDidChangeActiveGroup.fire(this.activeGroup),this._onDidChangeActiveInstance.fire(this.activeInstance)));if(e<0||e>=this.groups.length)return;const i=this.activeGroup;this.activeGroupIndex=e,(t||i!==this.activeGroup)&&(this._onDidChangeActiveGroup.fire(this.activeGroup),this._onDidChangeActiveInstance.fire(this.activeInstance))}_getInstanceLocation(e){let t=0;for(;e>=0&&t<this.groups.length;){const i=this.groups[t],n=i.terminalInstances.length;if(e<n)return{group:i,groupIndex:t,instance:i.terminalInstances[e],instanceIndex:e};e-=n,t++}}setActiveInstanceByIndex(e){const t=this.activeInstance,i=this._getInstanceLocation(e),n=i?.group.terminalInstances[i.instanceIndex];if(!i||t===n)return;const s=i.instanceIndex;this.activeGroupIndex=i.groupIndex,this._onDidChangeActiveGroup.fire(this.activeGroup),i.group.setActiveInstanceByIndex(s,!0)}setActiveGroupToNext(){if(this.groups.length<=1)return;let e=this.activeGroupIndex+1;e>=this.groups.length&&(e=0),this.setActiveGroupByIndex(e)}setActiveGroupToPrevious(){if(this.groups.length<=1)return;let e=this.activeGroupIndex-1;e<0&&(e=this.groups.length-1),this.setActiveGroupByIndex(e)}moveGroup(e,t){const i=this.getGroupForInstance(e),n=this.getGroupForInstance(t);if(!i||!n)return;if(i===n){const n=i.terminalInstances.indexOf(t);return void(-1!==n&&i.moveInstance(e,n))}const s=this.groups.indexOf(i),r=this.groups.indexOf(n);this.groups.splice(s,1),this.groups.splice(r,0,i),this._onDidChangeInstances.fire()}moveGroupToEnd(e){const t=this.getGroupForInstance(e);if(!t)return;const i=this.groups.indexOf(t);this.groups.splice(i,1),this.groups.push(t),this._onDidChangeInstances.fire()}moveInstance(e,t,i){const n=this.getGroupForInstance(e),s=this.getGroupForInstance(t);if(!n||!s)return;n!==s&&(n.removeInstance(e),s.addInstance(e));const r=s.terminalInstances.indexOf(t)+("after"===i?1:0);s.moveInstance(e,r)}unsplitInstance(e){const t=this.getGroupForInstance(e);!t||t.terminalInstances.length<2||(t.removeInstance(e),this.createGroup(e))}joinInstances(e){const t=this.getGroupForInstance(e[0]);if(t){let i=!0;for(let n=1;n<t.terminalInstances.length;n++)if(t.terminalInstances.includes(e[n])){i=!1;break}if(!i)return}let i,n;for(const t of e){const e=this.getGroupForInstance(t);if(1===e?.terminalInstances.length){i=t,n=e;break}}n||(n=this.createGroup());const s=this.activeGroup===n;for(const t of e){if(t===i)continue;const e=this.getGroupForInstance(t);e&&(e.removeInstance(t),n.addInstance(t))}this.setActiveInstance(e[0]),this._onDidChangeInstances.fire(),s||this._onDidChangeActiveGroup.fire(this.activeGroup)}instanceIsSplit(e){const t=this.getGroupForInstance(e);return!!t&&t.terminalInstances.length>1}getGroupForInstance(e){return this.groups.find((t=>t.terminalInstances.includes(e)))}getGroupLabels(){return this.groups.filter((e=>e.terminalInstances.length>0)).map(((e,t)=>`${t+1}: ${e.title?e.title:""}`))}updateVisibility(){const e=this._viewsService.isViewVisible(r.e9);this.groups.forEach(((t,i)=>t.setVisible(e&&i===this.activeGroupIndex)))}};Ls=(0,a.g)([(0,a.f)(0,b.i6),(0,a.f)(1,S.TG),(0,a.f)(2,A.qC),(0,a.f)(3,A.XH),(0,a.f)(4,v.Ui)],Ls);let Ps=class extends u.JT{get onDidCreateInstance(){return this._onDidCreateInstance.event}constructor(e,t,i){super(),this._instantiationService=e,this._contextKeyService=t,this._environmentService=i,this._backendRegistration=new Map,this._onDidCreateInstance=new d.Q5,this._terminalShellTypeContextKey=he.r.shellType.bindTo(this._contextKeyService),this._terminalInRunCommandPicker=he.r.inTerminalRunCommandPicker.bindTo(this._contextKeyService),this._terminalSuggestWidgetVisibleContextKey=he.r.suggestWidgetVisible.bindTo(this._contextKeyService),this._configHelper=e.createInstance(di);for(const e of[void 0,i.remoteAuthority]){let t;const i=new Promise((e=>t=e));this._backendRegistration.set(e,{promise:i,resolve:t})}}createInstance(e,t){const i=this.convertProfileToShellLaunchConfig(e),n=this._instantiationService.createInstance(fs,this._terminalShellTypeContextKey,this._terminalInRunCommandPicker,this._terminalSuggestWidgetVisibleContextKey,this._configHelper,i);return n.target=t,this._onDidCreateInstance.fire(n),n}convertProfileToShellLaunchConfig(e,t){if(e&&"profileName"in e){const i=e;return i.path?{executable:i.path,args:i.args,env:i.env,icon:i.icon,color:i.color,name:i.overrideName?i.profileName:void 0,cwd:t}:e}return e?(t&&(e.cwd=t),e):{}}async getBackend(e){let t=Ln.B.as(s.UU.Backend).getTerminalBackend(e);return t||(await(this._backendRegistration.get(e)?.promise),t=Ln.B.as(s.UU.Backend).getTerminalBackend(e)),t}getRegisteredBackends(){return Ln.B.as(s.UU.Backend).backends.values()}didRegisterBackend(e){this._backendRegistration.get(e)?.resolve()}};Ps=(0,a.g)([(0,a.f)(0,S.TG),(0,a.f)(1,b.i6),(0,a.f)(2,pe.n)],Ps);var Rs=i(23193);const Ms={type:["string","null"],enum:["terminal.ansiBlack","terminal.ansiRed","terminal.ansiGreen","terminal.ansiYellow","terminal.ansiBlue","terminal.ansiMagenta","terminal.ansiCyan","terminal.ansiWhite"],default:null},Bs={type:"string",enum:Array.from((0,R.dr)(),(e=>e.id)),markdownEnumDescriptions:Array.from((0,R.dr)(),(e=>`$(${e.id})`))},Ns={args:{description:(0,p.NC)("terminalProfile.args","An optional set of arguments to run the shell executable with."),type:"array",items:{type:"string"}},overrideName:{description:(0,p.NC)("terminalProfile.overrideName","Controls whether or not the profile name overrides the auto detected one."),type:"boolean"},icon:{description:(0,p.NC)("terminalProfile.icon","A codicon ID to associate with the terminal icon."),...Bs},color:{description:(0,p.NC)("terminalProfile.color","A theme color ID to associate with the terminal icon."),...Ms},env:{markdownDescription:(0,p.NC)("terminalProfile.env","An object with environment variables that will be added to the terminal profile process. Set to `null` to delete environment variables from the base environment."),type:"object",additionalProperties:{type:["string","null"]},default:{}}},Os={type:"object",required:["path"],properties:{path:{description:(0,p.NC)("terminalProfile.path","A single path to a shell executable or an array of paths that will be used as fallbacks when one fails."),type:["string","array"],items:{type:"string"}},...Ns}},Hs={type:"object",required:["path"],properties:{path:{description:(0,p.NC)("terminalAutomationProfile.path","A single path to a shell executable."),type:["string"],items:{type:"string"}},...Ns}};function Fs(e){const t=2===e?"linux":1===e?"osx":"windows";return(0,p.NC)({key:"terminal.integrated.profile",comment:["{0} is the platform, {1} is a code block, {2} and {3} are a link start and end"]},"A set of terminal profile customizations for {0} which allows adding, removing or changing how terminals are launched. Profiles are made up of a mandatory path, optional arguments and other presentation options.\n\nTo override an existing profile use its profile name as the key, for example:\n\n{1}\n\n{2}Read more about configuring profiles{3}.",(0,_.PW)(e),'```json\n"terminal.integrated.profile.'+t+'": {\n  "bash": null\n}\n```',"[","](https://code.visualstudio.com/docs/terminal/profiles)")}const Ws={id:"terminal",order:100,title:(0,p.NC)("terminalIntegratedConfigurationTitle","Integrated Terminal"),type:"object",properties:{"terminal.integrated.automationProfile.linux":{restricted:!0,markdownDescription:(0,p.NC)("terminal.integrated.automationProfile.linux","The terminal profile to use on Linux for automation-related terminal usage like tasks and debug."),type:["object","null"],default:null,anyOf:[{type:"null"},Hs],defaultSnippets:[{body:{path:"${1}",icon:"${2}"}}]},"terminal.integrated.automationProfile.osx":{restricted:!0,markdownDescription:(0,p.NC)("terminal.integrated.automationProfile.osx","The terminal profile to use on macOS for automation-related terminal usage like tasks and debug."),type:["object","null"],default:null,anyOf:[{type:"null"},Hs],defaultSnippets:[{body:{path:"${1}",icon:"${2}"}}]},"terminal.integrated.automationProfile.windows":{restricted:!0,markdownDescription:(0,p.NC)("terminal.integrated.automationProfile.windows","The terminal profile to use for automation-related terminal usage like tasks and debug. This setting will currently be ignored if {0} (now deprecated) is set.","`terminal.integrated.automationShell.windows`"),type:["object","null"],default:null,anyOf:[{type:"null"},Hs],defaultSnippets:[{body:{path:"${1}",icon:"${2}"}}]},"terminal.integrated.profiles.windows":{restricted:!0,markdownDescription:Fs(3),type:"object",default:{PowerShell:{source:"PowerShell",icon:"terminal-powershell"},"Command Prompt":{path:["${env:windir}\\Sysnative\\cmd.exe","${env:windir}\\System32\\cmd.exe"],args:[],icon:"terminal-cmd"},"Git Bash":{source:"Git Bash"}},additionalProperties:{anyOf:[{type:"object",required:["source"],properties:{source:{description:(0,p.NC)("terminalProfile.windowsSource","A profile source that will auto detect the paths to the shell. Note that non-standard executable locations are not supported and must be created manually in a new profile."),enum:["PowerShell","Git Bash"]},...Ns}},{type:"object",required:["extensionIdentifier","id","title"],properties:{extensionIdentifier:{description:(0,p.NC)("terminalProfile.windowsExtensionIdentifier","The extension that contributed this profile."),type:"string"},id:{description:(0,p.NC)("terminalProfile.windowsExtensionId","The id of the extension terminal"),type:"string"},title:{description:(0,p.NC)("terminalProfile.windowsExtensionTitle","The name of the extension terminal"),type:"string"},...Ns}},{type:"null"},Os]}},"terminal.integrated.profiles.osx":{restricted:!0,markdownDescription:Fs(1),type:"object",default:{bash:{path:"bash",args:["-l"],icon:"terminal-bash"},zsh:{path:"zsh",args:["-l"]},fish:{path:"fish",args:["-l"]},tmux:{path:"tmux",icon:"terminal-tmux"},pwsh:{path:"pwsh",icon:"terminal-powershell"}},additionalProperties:{anyOf:[{type:"object",required:["extensionIdentifier","id","title"],properties:{extensionIdentifier:{description:(0,p.NC)("terminalProfile.osxExtensionIdentifier","The extension that contributed this profile."),type:"string"},id:{description:(0,p.NC)("terminalProfile.osxExtensionId","The id of the extension terminal"),type:"string"},title:{description:(0,p.NC)("terminalProfile.osxExtensionTitle","The name of the extension terminal"),type:"string"},...Ns}},{type:"null"},Os]}},"terminal.integrated.profiles.linux":{restricted:!0,markdownDescription:Fs(2),type:"object",default:{bash:{path:"bash",icon:"terminal-bash"},zsh:{path:"zsh"},fish:{path:"fish"},tmux:{path:"tmux",icon:"terminal-tmux"},pwsh:{path:"pwsh",icon:"terminal-powershell"}},additionalProperties:{anyOf:[{type:"object",required:["extensionIdentifier","id","title"],properties:{extensionIdentifier:{description:(0,p.NC)("terminalProfile.linuxExtensionIdentifier","The extension that contributed this profile."),type:"string"},id:{description:(0,p.NC)("terminalProfile.linuxExtensionId","The id of the extension terminal"),type:"string"},title:{description:(0,p.NC)("terminalProfile.linuxExtensionTitle","The name of the extension terminal"),type:"string"},...Ns}},{type:"null"},Os]}},"terminal.integrated.useWslProfiles":{description:(0,p.NC)("terminal.integrated.useWslProfiles","Controls whether or not WSL distros are shown in the terminal dropdown"),type:"boolean",default:!0},"terminal.integrated.inheritEnv":{scope:1,description:(0,p.NC)("terminal.integrated.inheritEnv","Whether new shells should inherit their environment from VS Code, which may source a login shell to ensure $PATH and other development variables are initialized. This has no effect on Windows."),type:"boolean",default:!0},"terminal.integrated.persistentSessionScrollback":{scope:1,markdownDescription:(0,p.NC)("terminal.integrated.persistentSessionScrollback","Controls the maximum amount of lines that will be restored when reconnecting to a persistent terminal session. Increasing this will restore more lines of scrollback at the cost of more memory and increase the time it takes to connect to terminals on start up. This setting requires a restart to take effect and should be set to a value less than or equal to `#terminal.integrated.scrollback#`."),type:"number",default:100},"terminal.integrated.showLinkHover":{scope:1,description:(0,p.NC)("terminal.integrated.showLinkHover","Whether to show hovers for links in the terminal output."),type:"boolean",default:!0},"terminal.integrated.ignoreProcessNames":{description:(0,p.NC)("terminal.integrated.confirmIgnoreProcesses","A set of process names to ignore when using the {0} setting.","`terminal.integrated.confirmOnKill`"),type:"array",items:{type:"string",uniqueItems:!0},default:["starship","oh-my-posh","bash","zsh"]}}};let Vs;function $s(e,t){const i=Ln.B.as(Rs.IP.Configuration);let n;e&&(n=de(e?.profiles,t));const s=Vs;Vs={id:"terminal",order:100,title:(0,p.NC)("terminalIntegratedConfigurationTitle","Integrated Terminal"),type:"object",properties:{"terminal.integrated.defaultProfile.linux":{restricted:!0,markdownDescription:(0,p.NC)("terminal.integrated.defaultProfile.linux","The default terminal profile on Linux."),type:["string","null"],default:null,enum:3===e?.os?n?.values:void 0,markdownEnumDescriptions:3===e?.os?n?.markdownDescriptions:void 0},"terminal.integrated.defaultProfile.osx":{restricted:!0,markdownDescription:(0,p.NC)("terminal.integrated.defaultProfile.osx","The default terminal profile on macOS."),type:["string","null"],default:null,enum:2===e?.os?n?.values:void 0,markdownEnumDescriptions:2===e?.os?n?.markdownDescriptions:void 0},"terminal.integrated.defaultProfile.windows":{restricted:!0,markdownDescription:(0,p.NC)("terminal.integrated.defaultProfile.windows","The default terminal profile on Windows."),type:["string","null"],default:null,enum:1===e?.os?n?.values:void 0,markdownEnumDescriptions:1===e?.os?n?.markdownDescriptions:void 0}}},i.updateConfigurations({add:[Vs],remove:s?[s]:[]})}var Us=i(70850);let Gs=class{get onDidChangeAvailableProfiles(){return this._onDidChangeAvailableProfiles.event}get profilesReady(){return this._profilesReadyBarrier.wait().then((()=>{}))}get availableProfiles(){return this._platformConfigJustRefreshed||this.refreshAvailableProfiles(),this._availableProfiles||[]}get contributedProfiles(){return this._contributedProfiles||[]}constructor(e,t,i,n,s,r,o){this._contextKeyService=e,this._configurationService=t,this._terminalContributionService=i,this._extensionService=n,this._remoteAgentService=s,this._environmentService=r,this._terminalInstanceService=o,this._contributedProfiles=[],this._platformConfigJustRefreshed=!1,this._profileProviders=new Map,this._onDidChangeAvailableProfiles=new d.Q5,this._extensionService.onDidChangeExtensions((()=>this.refreshAvailableProfiles())),this._webExtensionContributedProfileContextKey=he.r.webExtensionContributedProfile.bindTo(this._contextKeyService),this._updateWebContextKey(),this._profilesReadyBarrier=new l.Ug(2e4),this.refreshAvailableProfiles(),this._setupConfigListener()}async _setupConfigListener(){const e=await this.getPlatformKey();this._configurationService.onDidChangeConfiguration((async t=>{(t.affectsConfiguration("terminal.integrated.defaultProfile."+e)||t.affectsConfiguration("terminal.integrated.profiles."+e)||t.affectsConfiguration("terminal.integrated.useWslProfiles"))&&(7!==t.source?(this.refreshAvailableProfiles(),this._platformConfigJustRefreshed=!1):this._platformConfigJustRefreshed=!0)}))}getDefaultProfileName(){return this._defaultProfileName}getDefaultProfile(e){let t;if(e){if(t=this._configurationService.getValue(`terminal.integrated.defaultProfile.${this._getOsKey(e)}`),!t||"string"!=typeof t)return}else t=this._defaultProfileName;if(t)return this.availableProfiles.find((e=>e.profileName===t&&!e.isAutoDetected))}_getOsKey(e){switch(e){case 3:return"linux";case 2:return"osx";case 1:return"windows"}}refreshAvailableProfiles(){this._refreshAvailableProfilesNow()}async _refreshAvailableProfilesNow(){const e=await this._detectProfiles(!0),t=!(0,Ci.fS)(e,this._availableProfiles,zs),i=await this._updateContributedProfiles();(t||i)&&(this._availableProfiles=e,this._onDidChangeAvailableProfiles.fire(this._availableProfiles),this._profilesReadyBarrier.open(),this._updateWebContextKey(),await this._refreshPlatformConfig(this._availableProfiles))}async _updateContributedProfiles(){const e=await this.getPlatformKey(),t=[],i=this._configurationService.getValue("terminal.integrated.profiles."+e);for(const[e,n]of Object.entries(i))null===n&&t.push(e);const n=Array.from(this._terminalContributionService.terminalProfiles.filter((e=>!t.includes(e.title)))),s=!(0,Ci.fS)(n,this._contributedProfiles,Ks);return this._contributedProfiles=n,s}getContributedProfileProvider(e,t){const i=this._profileProviders.get(e);return i?.get(t)}async _detectProfiles(e){const t=await this._terminalInstanceService.getBackend(this._environmentService.remoteAuthority);if(!t)return this._availableProfiles||[];const i=await this.getPlatformKey();return this._defaultProfileName=this._configurationService.getValue(`terminal.integrated.defaultProfile.${i}`)??void 0,t.getProfiles(this._configurationService.getValue(`terminal.integrated.profiles.${i}`),this._defaultProfileName,e)}_updateWebContextKey(){this._webExtensionContributedProfileContextKey.set(_.$L&&this._contributedProfiles.length>0)}async _refreshPlatformConfig(e){const t=await this._remoteAgentService.getEnvironment();$s({os:t?.os||_.OS,profiles:e},this._contributedProfiles),tt(e)}async getPlatformKey(){const e=await this._remoteAgentService.getEnvironment();return e?1===e.os?"windows":2===e.os?"osx":"linux":_.ED?"windows":_.dz?"osx":"linux"}registerTerminalProfileProvider(e,t,i){let n=this._profileProviders.get(e);return n||(n=new Map,this._profileProviders.set(e,n)),n.set(t,i),(0,u.OF)((()=>this._profileProviders.delete(t)))}async registerContributedProfile(e){const t=await this.getPlatformKey(),i=await this._configurationService.getValue(`terminal.integrated.profiles.${t}`);if("object"==typeof i){const t={extensionIdentifier:e.extensionIdentifier,icon:e.options.icon,id:e.id,title:e.title,color:e.options.color};i[e.title]=t}await this._configurationService.updateValue(`terminal.integrated.profiles.${t}`,i,2)}async getContributedDefaultProfile(e){if(e&&!e.extHostTerminalId&&!("executable"in e)){const e=await this.getPlatformKey(),t=this._configurationService.getValue(`terminal.integrated.defaultProfile.${e}`);return this.contributedProfiles.find((e=>e.title===t))}}};function zs(e,t){return e.profileName===t.profileName&&me(e.args,t.args)&&e.color===t.color&&function(e,t){if(!e&&!t)return!0;if(!e||!t)return!1;if(D.kS.isThemeIcon(e)&&D.kS.isThemeIcon(t))return e.id===t.id&&e.color===t.color;if("object"==typeof e&&"light"in e&&"dark"in e&&"object"==typeof t&&"light"in t&&"dark"in t){const i=e,n=t;if((g.ov.isUri(i.light)||_e(i.light))&&(g.ov.isUri(i.dark)||_e(i.dark))&&(g.ov.isUri(n.light)||_e(n.light))&&(g.ov.isUri(n.dark)||_e(n.dark)))return i.light.path===n.light.path&&i.dark.path===n.dark.path}if(g.ov.isUri(e)&&g.ov.isUri(t)||_e(e)||_e(t)){const i=e,n=t;return i.path===n.path&&i.scheme===n.scheme}return!1}(e.icon,t.icon)&&e.isAutoDetected===t.isAutoDetected&&e.isDefault===t.isDefault&&e.overrideName===t.overrideName&&e.path===t.path}function Ks(e,t){return e.extensionIdentifier===t.extensionIdentifier&&e.color===t.color&&e.icon===t.icon&&e.id===t.id&&e.title===t.title}Gs.__decorator=(0,a.g)([(0,h.P2)(2e3)],Gs.prototype,"refreshAvailableProfiles",null),Gs=(0,a.g)([(0,a.f)(0,b.i6),(0,a.f)(1,v.Ui),(0,a.f)(2,Us.e),(0,a.f)(3,St.QS),(0,a.f)(4,be.R),(0,a.f)(5,pe.n),(0,a.f)(6,o.N4)],Gs);var qs=i(78539);class js{constructor(){this._linkProviders=new Set,this._onDidAddLinkProvider=new d.Q5,this._onDidRemoveLinkProvider=new d.Q5}get linkProviders(){return this._linkProviders}get onDidAddLinkProvider(){return this._onDidAddLinkProvider.event}get onDidRemoveLinkProvider(){return this._onDidRemoveLinkProvider.event}registerLinkProvider(e){const t=[];return this._linkProviders.add(e),this._onDidAddLinkProvider.fire(e),{dispose:()=>{for(const e of t)e.dispose();this._linkProviders.delete(e),this._onDidRemoveLinkProvider.fire(e)}}}}var Qs=i(36248);const Xs="Generated";class Js{get defaultProfileName(){return this._defaultProfileName}constructor(e,t,i,n,s,r,o,a){this._context=e,this._configurationService=t,this._configurationResolverService=i,this._historyService=n,this._logService=s,this._terminalProfileService=r,this._workspaceContextService=o,this._remoteAgentService=a,this._iconRegistry=(0,x.Ks)(),this._remoteAgentService.getConnection()?this._remoteAgentService.getEnvironment().then((e=>this._primaryBackendOs=e?.os||_.OS)):this._primaryBackendOs=_.OS,this._configurationService.onDidChangeConfiguration((e=>{(e.affectsConfiguration("terminal.integrated.defaultProfile.windows")||e.affectsConfiguration("terminal.integrated.defaultProfile.osx")||e.affectsConfiguration("terminal.integrated.defaultProfile.linux"))&&this._refreshDefaultProfileName()})),this._terminalProfileService.onDidChangeAvailableProfiles((()=>this._refreshDefaultProfileName()))}async _refreshDefaultProfileName(){this._primaryBackendOs&&(this._defaultProfileName=(await this.getDefaultProfile({remoteAuthority:this._remoteAgentService.getConnection()?.remoteAuthority,os:this._primaryBackendOs}))?.profileName)}resolveIcon(e,t){if(e.icon)return void(e.icon=this._getCustomIcon(e.icon)||this.getDefaultIcon());if(e.customPtyImplementation)return void(e.icon=this.getDefaultIcon());if(e.executable)return;const i=this._getUnresolvedRealDefaultProfile(t);i&&(e.icon=i.icon),e.icon||(e.icon=this.getDefaultIcon())}getDefaultIcon(e){return this._iconRegistry.getIcon(this._configurationService.getValue("terminal.integrated.tabs.defaultIcon",{resource:e}))||R.lA.terminal}async resolveShellLaunchConfig(e,t){let i;i=e.executable?await this._resolveProfile({path:e.executable,args:e.args,profileName:Xs,isDefault:!1},t):await this.getDefaultProfile(t),e.executable=i.path,e.args=i.args,i.env&&(e.env?e.env={...e.env,...i.env}:e.env=i.env);const n=void 0===e||"string"==typeof e.cwd?void 0:e.cwd;e.icon=this._getCustomIcon(e.icon)||this._getCustomIcon(i.icon)||this.getDefaultIcon(n),i.overrideName&&(e.name=i.profileName),e.color=e.color||i.color||this._configurationService.getValue("terminal.integrated.tabs.defaultColor",{resource:n}),void 0===e.useShellEnvironment&&(e.useShellEnvironment=this._configurationService.getValue("terminal.integrated.inheritEnv"))}async getDefaultShell(e){return(await this.getDefaultProfile(e)).path}async getDefaultShellArgs(e){return(await this.getDefaultProfile(e)).args||[]}async getDefaultProfile(e){return this._resolveProfile(await this._getUnresolvedDefaultProfile(e),e)}getEnvironment(e){return this._context.getEnvironment(e)}_getCustomIcon(e){if(e){if("string"==typeof e)return D.kS.fromId(e);if(D.kS.isThemeIcon(e))return e;if(g.ov.isUri(e)||_e(e))return g.ov.revive(e);if("object"==typeof e&&"light"in e&&"dark"in e){const t=e;if((g.ov.isUri(t.light)||_e(t.light))&&(g.ov.isUri(t.dark)||_e(t.dark)))return{light:g.ov.revive(t.light),dark:g.ov.revive(t.dark)}}}}async _getUnresolvedDefaultProfile(e){if(e.allowAutomationShell){const t=this._getUnresolvedAutomationShellProfile(e);if(t)return t}await this._terminalProfileService.profilesReady;const t=this._getUnresolvedRealDefaultProfile(e.os);return t?this._setIconForAutomation(e,t):this._setIconForAutomation(e,await this._getUnresolvedFallbackDefaultProfile(e))}_setIconForAutomation(e,t){if(e.allowAutomationShell){const e=(0,Qs.I8)(t);return e.icon=R.lA.tools,e}return t}_getUnresolvedRealDefaultProfile(e){return this._terminalProfileService.getDefaultProfile(e)}async _getUnresolvedFallbackDefaultProfile(e){const t=await this._context.getDefaultSystemShell(e.remoteAuthority,e.os);if(e.os===_.OS){let i=this._terminalProfileService.availableProfiles.find((e=>Se.Qc(e.path).name===Se.Qc(t).name));if(i)return e.allowAutomationShell&&(i=(0,Qs.I8)(i),i.icon=R.lA.tools),i}let i;i=2===e.os&&Se.Qc(t).name.match(/(zsh|bash)/)?["--login"]:[];const n=this._guessProfileIcon(t);return{profileName:Xs,path:t,args:i,icon:n,isDefault:!1}}_getUnresolvedAutomationShellProfile(e){const t=this._configurationService.getValue(`terminal.integrated.automationProfile.${this._getOsKey(e.os)}`);if(this._isValidAutomationProfile(t,e.os))return t.icon=this._getCustomIcon(t.icon)||R.lA.tools,t}async _resolveProfile(e,t){const i=await this._context.getEnvironment(t.remoteAuthority);if(1===t.os){const t=!!i.hasOwnProperty("PROCESSOR_ARCHITEW6432"),n=i.windir;if(!t&&n){const t=Se.v_(n,"Sysnative").replace(/\//g,"\\").toLowerCase();e.path&&0===e.path.toLowerCase().indexOf(t)&&(e.path=Se.v_(n,"System32",e.path.substr(t.length+1)))}e.path&&(e.path=e.path.replace(/\//g,"\\"))}const n=this._historyService.getLastActiveWorkspaceRoot(t.remoteAuthority?m.lg.vscodeRemote:m.lg.file),s=n?(0,B.f6)(this._workspaceContextService.getWorkspaceFolder(n)):void 0;return e.path=await this._resolveVariables(e.path,i,s),e.args&&("string"==typeof e.args?e.args=await this._resolveVariables(e.args,i,s):e.args=await Promise.all(e.args.map((e=>this._resolveVariables(e,i,s))))),e}async _resolveVariables(e,t,i){try{e=await this._configurationResolverService.resolveWithEnvironment(t,i,e)}catch(e){this._logService.error("Could not resolve shell",e)}return e}_getOsKey(e){switch(e){case 3:return"linux";case 2:return"osx";case 1:return"windows"}}_guessProfileIcon(e){switch(Se.Qc(e).name){case"bash":return R.lA.terminalBash;case"pwsh":case"powershell":return R.lA.terminalPowershell;case"tmux":return R.lA.terminalTmux;case"cmd":return R.lA.terminalCmd;default:return}}_isValidShellArgs(e,t){return void 0===e||1===t&&"string"==typeof e||!(!Array.isArray(e)||!e.every((e=>"string"==typeof e)))}async createProfileFromShellAndShellArgs(e,t){const i=this._terminalProfileService.availableProfiles?.find((i=>i.path===e&&(void 0===i.args||"string"==typeof i.args?i.args===t:i.path===e&&(0,Ci.fS)(i.args,t||[])))),n=await this.getDefaultProfile({remoteAuthority:this._remoteAgentService.getConnection()?.remoteAuthority,os:this._primaryBackendOs});n.profileName=`${n.path} (migrated)`;const s=i||n,r=this._isValidShellArgs(t,this._primaryBackendOs)?t:s.args,o={profileName:s.profileName,path:s.path,args:r,isDefault:!0};return i&&i.profileName===o.profileName&&i.path===o.path&&me(i.args,o.args)?i.profileName:o}_isValidAutomationProfile(e,t){return null!=e&&"object"==typeof e&&"path"in e&&"string"==typeof e.path}}Js.__decorator=(0,a.g)([(0,h.Ds)(200)],Js.prototype,"_refreshDefaultProfileName",null);let Ys=class extends Js{constructor(e,t,i,n,s,r,o,a){super({getDefaultSystemShell:async(e,t)=>{const i=await a.getBackend(e);if(!i)throw new Et.QD(`Cannot get default system shell when there is no backend for remote authority '${e}'`);return i.getDefaultSystemShell(t)},getEnvironment:async e=>{const t=await a.getBackend(e);if(!t)throw new Et.QD(`Cannot get environment when there is no backend for remote authority '${e}'`);return t.getEnvironment()}},t,e,i,n,r,s,o)}};Ys=(0,a.g)([(0,a.f)(0,ge.qb),(0,a.f)(1,v.Ui),(0,a.f)(2,fe.CE),(0,a.f)(3,s.DV),(0,a.f)(4,T.ec),(0,a.f)(5,r.l5),(0,a.f)(6,be.R),(0,a.f)(7,o.N4)],Ys);let Zs=class{get onDidChangeCollections(){return this._onDidChangeCollections.event}constructor(e,t){this._extensionService=e,this._storageService=t,this.collections=new Map,this._onDidChangeCollections=new d.Q5,this._storageService.remove("terminal.integrated.environmentVariableCollections",1);const i=this._storageService.get("terminal.integrated.environmentVariableCollectionsV2",1);i&&(JSON.parse(i).forEach((e=>this.collections.set(e.extensionIdentifier,{persistent:!0,map:(0,En.XC)(e.collection),descriptionMap:(0,En.w)(e.description)}))),this._invalidateExtensionCollections()),this.mergedCollection=this._resolveMergedCollection(),this._extensionService.onDidChangeExtensions((()=>this._invalidateExtensionCollections()))}set(e,t){this.collections.set(e,t),this._updateCollections()}delete(e){this.collections.delete(e),this._updateCollections()}_updateCollections(){this._persistCollectionsEventually(),this.mergedCollection=this._resolveMergedCollection(),this._notifyCollectionUpdatesEventually()}_persistCollectionsEventually(){this._persistCollections()}_persistCollections(){const e=[];this.collections.forEach(((t,i)=>{t.persistent&&e.push({extensionIdentifier:i,collection:(0,En.Fi)(this.collections.get(i).map),description:(0,En.hd)(t.descriptionMap)})}));const t=JSON.stringify(e);this._storageService.store("terminal.integrated.environmentVariableCollectionsV2",t,1,1)}_notifyCollectionUpdatesEventually(){this._notifyCollectionUpdates()}_notifyCollectionUpdates(){this._onDidChangeCollections.fire(this.mergedCollection)}_resolveMergedCollection(){return new zn(this.collections)}async _invalidateExtensionCollections(){await this._extensionService.whenInstalledExtensionsRegistered();const e=this._extensionService.extensions;let t=!1;this.collections.forEach(((i,n)=>{e.some((e=>e.identifier.value===n))||(this.collections.delete(n),t=!0)})),t&&this._updateCollections()}};Zs.__decorator=(0,a.g)([(0,h.P2)(1e3)],Zs.prototype,"_persistCollectionsEventually",null),Zs.__decorator=(0,a.g)([(0,h.Ds)(1e3)],Zs.prototype,"_notifyCollectionUpdatesEventually",null),Zs=(0,a.g)([(0,a.f)(0,St.QS),(0,a.f)(1,ke.Uy)],Zs);var er=i(78475);let tr=class extends u.JT{get onDidChangeLogLevel(){return this._logger.onDidChangeLogLevel}constructor(e,t){super(),this._loggerService=e,this._logger=this._loggerService.createLogger("terminal",{name:(0,p.NC)("terminalLoggerName","Terminal")}),this._register(d.ju.runAndSubscribe(t.onDidChangeWorkspaceFolders,(()=>{this._workspaceId=t.getWorkspace().id.substring(0,7)})))}getLevel(){return this._logger.getLevel()}setLevel(e){this._logger.setLevel(e)}flush(){this._logger.flush()}trace(e,...t){this._logger.trace(this._formatMessage(e),t)}debug(e,...t){this._logger.debug(this._formatMessage(e),t)}info(e,...t){this._logger.info(this._formatMessage(e),t)}warn(e,...t){this._logger.warn(this._formatMessage(e),t)}error(e,...t){e instanceof Error?this._logger.error(this._formatMessage(""),e,t):this._logger.error(this._formatMessage(e),t)}_formatMessage(e){return this._logger.getLevel()===At.in.Trace?`[${this._workspaceId}] ${e}`:e}};tr=(0,a.g)([(0,a.f)(0,At.yR),(0,a.f)(1,T.ec)],tr);var ir=i(26963);class nr{get providers(){return this._providers}constructor(){this._selectors=new Map,this._providers=new Map,this._onDidRegisterProvider=new d.Q5,this.onDidRegisterProvider=this._onDidRegisterProvider.event,this._onDidRegisterCommandSelector=new d.Q5,this.onDidRegisterCommandSelector=this._onDidRegisterCommandSelector.event,this._onDidUnregisterProvider=new d.Q5,this.onDidUnregisterProvider=this._onDidUnregisterProvider.event,this.extensionQuickFixes=new Promise((e=>sr.setHandler((t=>{e(t.filter((e=>(0,St.$x)(e.description,"terminalQuickFixProvider"))).map((e=>e.value?e.value.map((t=>({...t,extensionIdentifier:e.description.identifier.value}))):[])).flat())})))),this.extensionQuickFixes.then((e=>{for(const t of e)this.registerCommandSelector(t)}))}registerCommandSelector(e){this._selectors.set(e.id,e),this._onDidRegisterCommandSelector.fire(e)}registerQuickFixProvider(e,t){let i=!1;return this.extensionQuickFixes.then((()=>{if(i)return;this._providers.set(e,t);const n=this._selectors.get(e);if(!n)throw new Error(`No registered selector for ID: ${e}`);this._onDidRegisterProvider.fire({selector:n,provider:t})})),(0,u.OF)((()=>{i=!0,this._providers.delete(e);const t=this._selectors.get(e);t&&(this._selectors.delete(e),this._onDidUnregisterProvider.fire(t.id))}))}}const sr=ir.ut.registerExtensionPoint({extensionPoint:"terminalQuickFixes",defaultExtensionKind:["workspace"],activationEventsGenerator:(e,t)=>{for(const i of e??[])t.push(`onTerminalQuickFixRequest:${i.id}`)},jsonSchema:{description:(0,p.NC)("vscode.extension.contributes.terminalQuickFixes","Contributes terminal quick fixes."),type:"array",items:{type:"object",additionalProperties:!1,required:["id","commandLineMatcher","outputMatcher","commandExitResult"],defaultSnippets:[{body:{id:"$1",commandLineMatcher:"$2",outputMatcher:"$3",exitStatus:"$4"}}],properties:{id:{description:(0,p.NC)("vscode.extension.contributes.terminalQuickFixes.id","The ID of the quick fix provider"),type:"string"},commandLineMatcher:{description:(0,p.NC)("vscode.extension.contributes.terminalQuickFixes.commandLineMatcher","A regular expression or string to test the command line against"),type:"string"},outputMatcher:{markdownDescription:(0,p.NC)("vscode.extension.contributes.terminalQuickFixes.outputMatcher","A regular expression or string to match a single line of the output against, which provides groups to be referenced in terminalCommand and uri.\n\nFor example:\n\n `lineMatcher: /git push --set-upstream origin (?<branchName>[^s]+)/;`\n\n`terminalCommand: 'git push --set-upstream origin ${group:branchName}';`\n"),type:"object",required:["lineMatcher","anchor","offset","length"],properties:{lineMatcher:{description:"A regular expression or string to test the command line against",type:"string"},anchor:{description:"Where the search should begin in the buffer",enum:["top","bottom"]},offset:{description:"The number of lines vertically from the anchor in the buffer to start matching against",type:"number"},length:{description:"The number of rows to match against, this should be as small as possible for performance reasons",type:"number"}}},commandExitResult:{description:(0,p.NC)("vscode.extension.contributes.terminalQuickFixes.commandExitResult","The command exit result to match on"),enum:["success","error"],enumDescriptions:["The command exited with an exit code of zero.","The command exited with a non-zero exit code."]}}}}});var rr=i(5107);(0,ht.Z)(".monaco-workbench .xterm-viewport{-webkit-text-fill-color:transparent;-webkit-background-clip:text;background-clip:text;scrollbar-width:thin;transition:background-color .8s linear}.monaco-workbench .xterm-viewport::-webkit-scrollbar{width:10px}.monaco-workbench .xterm-viewport::-webkit-scrollbar-track{opacity:0}.monaco-workbench .xterm-viewport::-webkit-scrollbar-thumb{background-color:inherit;min-height:20px}.monaco-workbench .force-scrollbar .xterm .xterm-viewport,.monaco-workbench .xterm.focus .xterm-viewport,.monaco-workbench .xterm:focus .xterm-viewport,.monaco-workbench .xterm:hover .xterm-viewport{cursor:default;transition:opacity .1s linear}.monaco-workbench .xterm .xterm-viewport::-webkit-scrollbar-thumb:hover{transition:opacity 0ms linear}.monaco-workbench .xterm .xterm-viewport::-webkit-scrollbar-thumb:window-inactive{background-color:inherit}",{}),(0,ht.Z)('.monaco-workbench .pane-body.integrated-terminal{align-content:flex-start;align-items:baseline;background-color:transparent!important;display:flex;flex-direction:column;position:relative;user-select:auto;-webkit-user-select:initial;z-index:0}.terminal-command-decoration.hide{visibility:hidden}.monaco-workbench .part.panel .pane-body.integrated-terminal .terminal-outer-container{background-color:var(--vscode-terminal-background,--vscode-panel-background)}.monaco-workbench .pane-body.integrated-terminal .terminal-group,.monaco-workbench .pane-body.integrated-terminal .terminal-groups-container,.monaco-workbench .pane-body.integrated-terminal .terminal-outer-container,.monaco-workbench .pane-body.integrated-terminal .terminal-split-pane,.monaco-workbench .terminal-editor .terminal-outer-container,.monaco-workbench .terminal-editor .terminal-split-pane{height:100%}.monaco-workbench .part.auxiliarybar .pane-body.integrated-terminal .terminal-outer-container,.monaco-workbench .part.sidebar .pane-body.integrated-terminal .terminal-outer-container{background-color:var(--vscode-terminal-background,--vscode-sideBar-background)}.monaco-workbench .pane-body.integrated-terminal .split-view-view:not(:first-child),.monaco-workbench .pane-body.integrated-terminal .tabs-container{border-color:var(--vscode-terminal-border)}.monaco-workbench .pane-body.integrated-terminal .terminal-drop-overlay{background-color:var(--vscode-terminal-dropBackground,--vscode-editorGroup-dropBackground)}.monaco-workbench .pane-body.integrated-terminal .terminal-tabs-entry.is-active:before{background-color:var(--vscode-terminal-tab-activeBorder)}.monaco-workbench .terminal-editor .xterm textarea:focus{opacity:0!important;outline:0!important}.monaco-workbench .terminal-tab:before{font-family:codicon!important;font-size:16px!important}.monaco-workbench .terminal-tab:not(.terminal-uri-icon):before{background-image:none!important}.monaco-workbench .terminal-editor .terminal-wrapper{background-color:var(--vscode-terminal-background,--vscode-editorPane-background)}.monaco-workbench .pane-body.integrated-terminal .terminal-wrapper,.monaco-workbench .terminal-editor .terminal-wrapper{box-sizing:border-box;display:block;height:100%}.monaco-workbench .xterm{padding:0 10px 2px}.monaco-workbench .pane-body.integrated-terminal .xterm,.monaco-workbench .terminal-editor .xterm{bottom:0;left:0;position:absolute;right:0}.terminal-side-view .terminal.xterm{top:0}.monaco-workbench .pane-body.integrated-terminal .terminal-wrapper.fixed-dims .xterm,.monaco-workbench .terminal-editor .terminal-wrapper.fixed-dims .xterm{position:static}.monaco-workbench .pane-body.integrated-terminal .xterm-viewport,.monaco-workbench .terminal-editor .xterm-viewport{z-index:30}.monaco-workbench .pane-body.integrated-terminal .xterm-decoration-overview-ruler,.monaco-workbench .terminal-editor .xterm-decoration-overview-ruler{pointer-events:none;z-index:31}.monaco-workbench .pane-body.integrated-terminal .xterm-screen,.monaco-workbench .terminal-editor .xterm-screen{z-index:31}.xterm .xterm-screen{cursor:text}.monaco-workbench .simple-find-part-wrapper.result-count{z-index:33!important}.xterm .xterm-accessibility{pointer-events:none;z-index:32!important}.xterm.enable-mouse-events .xterm-screen{cursor:default}.xterm.xterm-cursor-pointer .xterm-screen{cursor:pointer}.xterm.column-select.focus .xterm-screen{cursor:crosshair}.integrated-terminal.shell-integration .xterm,.monaco-workbench .pane-body.integrated-terminal .terminal-group .monaco-split-view2.horizontal .split-view-view:first-child .xterm,.monaco-workbench .terminal-editor .xterm{padding-left:20px!important}.monaco-workbench .pane-body.integrated-terminal .terminal-group .monaco-split-view2.horizontal .split-view-view:last-child .xterm,.monaco-workbench .terminal-editor .terminal-group .monaco-split-view2.horizontal .split-view-view:last-child .xterm{padding-right:20px}.monaco-workbench .pane-body.integrated-terminal .xterm a:not(.xterm-invalid-link),.monaco-workbench .terminal-editor .xterm a:not(.xterm-invalid-link){position:relative}.monaco-workbench .pane-body.integrated-terminal .terminal-wrapper>div,.monaco-workbench .terminal-editor .terminal-wrapper>div{height:100%}.monaco-workbench .pane-body.integrated-terminal .xterm-viewport,.monaco-workbench .terminal-editor .xterm-viewport{box-sizing:border-box}.monaco-workbench .pane-body.integrated-terminal .terminal-wrapper.fixed-dims,.monaco-workbench .terminal-editor .terminal-wrapper.fixed-dims{position:relative}.monaco-workbench .pane-body.integrated-terminal .terminal-wrapper:not(.fixed-dims) .xterm-viewport,.monaco-workbench .terminal-editor .terminal-wrapper:not(.fixed-dims) .xterm-viewport{width:auto!important}.monaco-workbench .pane-body.integrated-terminal{font-variant-ligatures:none}.monaco-workbench .pane-body.integrated-terminal .split-view-view{box-sizing:border-box;overflow:hidden}.monaco-workbench .pane-body.integrated-terminal .split-view-view:first-child .tabs-container{border-right-style:solid;border-right-width:1px}.monaco-workbench .pane-body.integrated-terminal .split-view-view:last-child .tabs-container,.monaco-workbench .pane-body.integrated-terminal .terminal-group .monaco-split-view2.horizontal .split-view-view:not(:first-child){border-left-style:solid;border-left-width:1px}.monaco-workbench .pane-body.integrated-terminal .terminal-group .monaco-split-view2.vertical .split-view-view:not(:first-child){border-top-style:solid;border-top-width:1px}.monaco-workbench .pane-body.integrated-terminal .terminal-groups-container.alt-active .xterm{cursor:default}.monaco-workbench .pane-body.integrated-terminal .xterm{user-select:none;-webkit-user-select:none}.monaco-workbench .pane-body.integrated-terminal .monaco-split-view2.vertical .split-view-view:not(:last-child) .xterm{bottom:auto;top:0}.monaco-workbench .pane-body.integrated-terminal .xterm:focus{outline:none}.monaco-workbench.hc-black .pane-body.integrated-terminal .xterm.focus:before,.monaco-workbench.hc-black .pane-body.integrated-terminal .xterm:focus:before,.monaco-workbench.hc-light .pane-body.integrated-terminal .xterm.focus:before,.monaco-workbench.hc-light .pane-body.integrated-terminal .xterm:focus:before{border:1px solid;bottom:0;content:"";display:block;left:0;pointer-events:none;position:absolute;right:0;top:0;z-index:32}.monaco-workbench.hc-black .pane-body.integrated-terminal .monaco-split-view2.horizontal .split-view-view:not(:only-child) .xterm.focus:before,.monaco-workbench.hc-black .pane-body.integrated-terminal .monaco-split-view2.horizontal .split-view-view:not(:only-child) .xterm:focus:before,.monaco-workbench.hc-light .pane-body.integrated-terminal .monaco-split-view2.horizontal .split-view-view:not(:only-child) .xterm.focus:before,.monaco-workbench.hc-light .pane-body.integrated-terminal .monaco-split-view2.horizontal .split-view-view:not(:only-child) .xterm:focus:before{right:0}.monaco-workbench .pane-body.integrated-terminal .xterm .xterm-helpers{position:absolute;top:0}.monaco-workbench .xterm .xterm-helper-textarea:focus{opacity:0!important}.monaco-workbench.hc-black.mac .pane-body.integrated-terminal .terminal-groups-container:not(.alt-active) .terminal:not(.enable-mouse-events),.monaco-workbench.vs-dark.mac .pane-body.integrated-terminal .terminal-groups-container:not(.alt-active) .terminal:not(.enable-mouse-events){cursor:-webkit-image-set(url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAQAAAC1+jfqAAAAL0lEQVQoz2NgCD3x//9/BhBYBWdhgFVAiVW4JBFKGIa4AqD0//9D3pt4I4tAdAMAHTQ/j5Zom30AAAAASUVORK5CYII=") 1x,url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAQAAADZc7J/AAAAz0lEQVRIx2NgYGBY/R8I/vx5eelX3n82IJ9FxGf6tksvf/8FiTMQAcAGQMDvSwu09abffY8QYSAScNk45G198eX//yev73/4///701eh//kZSARckrNBRvz//+8+6ZohwCzjGNjdgQxkAg7B9WADeBjIBqtJCbhRA0YNoIkBSNmaPEMoNmA0FkYNoFKhapJ6FGyAH3nauaSmPfwI0v/3OukVi0CIZ+F25KrtYcx/CTIy0e+rC7R1Z4KMICVTQQ14feVXIbR695u14+Ir4gwAAD49E54wc1kWAAAAAElFTkSuQmCC") 2x) 5 8,text}.xterm .xterm-cursor-pointer,.xterm.xterm-cursor-pointer{cursor:pointer!important}.monaco-pane-view .pane>.pane-header .monaco-action-bar .switch-terminal,.monaco-workbench .part.sidebar>.title>.title-actions .switch-terminal,.part.panel>.title>.title-actions .switch-terminal>.monaco-select-box{border-style:solid;border-width:1px}.xterm-screen .xterm-decoration-container .xterm-decoration.quick-fix{z-index:7}.monaco-workbench .part.sidebar>.title>.title-actions .switch-terminal{align-items:center;display:flex;flex-shrink:1;font-size:11px;height:20px;margin-right:.3em;margin-top:7px}.monaco-workbench.mac .part.sidebar>.title>.title-actions .switch-terminal{border-radius:4px}.monaco-workbench .part.sidebar>.title>.title-actions .switch-terminal>.monaco-select-box{background-color:unset!important;border:none!important;display:block!important}.monaco-pane-view .pane>.pane-header .monaco-action-bar .switch-terminal.action-item.select-container{border:none!important}.monaco-workbench .part.sidebar>.title>.title-actions .switch-terminal>.monaco-select-box{padding:0 22px 0 6px}.monaco-workbench .pane-body.integrated-terminal .tabs-container{display:flex;flex-direction:column;height:100%}.monaco-workbench .terminal-overflow-guard{height:100%;overflow:hidden;position:relative}.monaco-workbench .pane-body.integrated-terminal .tabs-list-container{height:100%;overflow:hidden}.monaco-workbench .pane-body.integrated-terminal .tabs-container>.monaco-toolbar{margin:auto;padding:4px 0 2px}.monaco-workbench .pane-body.integrated-terminal .terminal-tabs-entry.is-active:before{bottom:0;content:"";display:block;left:0;position:absolute;top:0;width:1px}.monaco-workbench .pane-body.integrated-terminal .tabs-container.has-text>.monaco-toolbar{margin:0;padding:4px 7px 2px;text-align:left}.monaco-workbench .pane-body.integrated-terminal .tabs-list{height:100%}.monaco-workbench .pane-body.integrated-terminal .tabs-list .terminal-tabs-entry{text-align:center}.monaco-workbench .pane-body.integrated-terminal .tabs-container.has-text .tabs-list .terminal-tabs-entry{padding-left:10px;padding-right:10px;text-align:left}.monaco-workbench .pane-body.integrated-terminal .tabs-container.has-text .tabs-list .terminal-tabs-entry .monaco-icon-label:after{margin-right:0}.monaco-workbench .pane-body.integrated-terminal .tabs-container:not(.has-text) .terminal-tabs-entry .codicon{color:inherit}.monaco-workbench .pane-body.integrated-terminal .tabs-container:not(.has-text) .monaco-icon-description-container{display:none}.monaco-workbench .pane-body.integrated-terminal .tabs-list .codicon{vertical-align:text-bottom}.monaco-workbench .pane-body.integrated-terminal .tabs-list .actions,.monaco-workbench .pane-body.integrated-terminal .tabs-list .editable-tab .monaco-icon-name-container{display:none}.monaco-workbench .pane-body.integrated-terminal .tabs-list .actions .action-label{padding:2px}.monaco-workbench .pane-body.integrated-terminal .tabs-list .monaco-list-row:hover .actions,.monaco-workbench .pane-body.integrated-terminal .tabs-list:focus-within .monaco-list-row.focused .actions,.monaco-workbench .pane-body.integrated-terminal .tabs-list:focus-within .monaco-list-row.selected .actions{display:block}.monaco-action-bar .action-item .single-terminal-tab{align-items:center;display:flex!important}.monaco-action-bar .action-item .single-terminal-tab .codicon:first-child{margin-right:4px}.monaco-action-bar .action-item .single-terminal-tab .codicon:nth-child(2){color:inherit;margin-left:4px}.monaco-workbench .pane-body.integrated-terminal .tabs-container.has-text .tabs-list .terminal-tabs-entry .uri-icon{background-repeat:no-repeat;background-size:contain;height:100%;margin-right:4px}.monaco-action-bar .terminal-uri-icon.single-terminal-tab.action-label .codicon,.monaco-workbench .terminal-uri-icon .monaco-highlighted-label .codicon{background-size:16px}.monaco-action-bar .terminal-uri-icon.single-terminal-tab.action-label:not(.alt-command) .codicon:before,.monaco-workbench .terminal-uri-icon .monaco-highlighted-label .codicon:before{content:"";display:inline-block;height:16px;width:16px}.monaco-workbench .pane-body.integrated-terminal .terminal-drop-overlay{bottom:0;display:block;left:0;opacity:0;pointer-events:none;position:absolute;right:0;top:0;z-index:34}.monaco-workbench:not(.reduce-motion) .pane-body.integrated-terminal .terminal-drop-overlay{transition:left 70ms ease-out,right 70ms ease-out,top 70ms ease-out,bottom 70ms ease-out,opacity .15s ease-out}.monaco-workbench .pane-body.integrated-terminal .terminal-group>.monaco-split-view2.horizontal .terminal-drop-overlay.drop-before{right:50%}.monaco-workbench .pane-body.integrated-terminal .terminal-group>.monaco-split-view2.horizontal .terminal-drop-overlay.drop-after{left:50%}.monaco-workbench .pane-body.integrated-terminal .terminal-group>.monaco-split-view2.vertical .terminal-drop-overlay.drop-before{bottom:50%}.monaco-workbench .pane-body.integrated-terminal .terminal-group>.monaco-split-view2.vertical .terminal-drop-overlay.drop-after{top:50%}.monaco-workbench .terminal .terminal-command-decoration:not(.default):hover{background-color:var(--vscode-toolbar-hoverBackground);border-radius:5px;cursor:pointer}.monaco-workbench .terminal .terminal-command-decoration{color:var(--vscode-terminalCommandDecoration-successBackground)}.monaco-workbench .terminal .terminal-command-decoration.error{color:var(--vscode-terminalCommandDecoration-errorBackground)}.monaco-workbench .terminal .terminal-command-decoration.default{color:var(--vscode-terminalCommandDecoration-defaultBackground);pointer-events:none}.monaco-workbench .terminal .terminal-command-decoration.quick-fix{background-color:var(--vscode-terminal-background,--vscode-panel-background);color:var(--vscode-editorLightBulb-foreground)!important}.terminal-scroll-highlight{border-left:5px solid #fff;border-left-width:5px!important;left:0;pointer-events:none;right:0}.terminal-scroll-highlight-outline{border:1px solid #fff;pointer-events:none}.terminal-scroll-highlight{border-color:var(--vscode-focusBorder)}.hc-black .xterm-find-result-decoration,.hc-light .xterm-find-result-decoration{outline-style:dotted!important;outline-style:solid!important}.xterm-find-active-result-decoration{outline-style:solid!important;outline-width:2px!important;z-index:7!important}.monaco-workbench.hc-black .editor-instance .xterm.focus:before,.monaco-workbench.hc-black .editor-instance .xterm:focus:before,.monaco-workbench.hc-black .pane-body.integrated-terminal .xterm.focus:before,.monaco-workbench.hc-black .pane-body.integrated-terminal .xterm:focus:before,.monaco-workbench.hc-light .editor-instance .xterm.focus:before,.monaco-workbench.hc-light .editor-instance .xterm:focus:before,.monaco-workbench.hc-light .pane-body.integrated-terminal .xterm.focus:before,.monaco-workbench.hc-light .pane-body.integrated-terminal .xterm:focus:before{border-color:var(--vscode-contrastActiveBorder)}.monaco-workbench .integrated-terminal .hoverHighlight{background-color:var(--vscode-terminal-hoverHighlightBackground)}.force-scrollbar .xterm .xterm-viewport,.monaco-workbench .xterm.focus .xterm-viewport,.monaco-workbench .xterm:focus .xterm-viewport,.monaco-workbench .xterm:hover .xterm-viewport{background-color:var(--vscode-scrollbarSlider-background)!important}.monaco-workbench .xterm-viewport{scrollbar-color:var(--vscode-scrollbarSlider-background) transparent}.monaco-workbench .xterm .xterm-viewport::-webkit-scrollbar-thumb:hover{background-color:var(--vscode-scrollbarSlider-hoverBackground)}.monaco-workbench .xterm-viewport:hover{scrollbar-color:var(--vscode-scrollbarSlider-hoverBackground) transparent}.monaco-workbench .xterm .xterm-viewport::-webkit-scrollbar-thumb:active{background-color:var(--vscode-scrollbarSlider-activeBackground)}.monaco-workbench .terminal-accessible-widget{bottom:0;cursor:default;left:10px;opacity:0;overflow:initial;overflow-x:initial;padding:0;pointer-events:none;position:absolute;right:0;top:0;z-index:0}.monaco-workbench .terminal-accessible-widget div{white-space:pre-wrap}.monaco-workbench .terminal-accessible-widget.active,.monaco-workbench .terminal-accessible-widget.focus-within{background-color:var(--vscode-terminal-background,--vscode-panel-background);opacity:1;pointer-events:all;z-index:33}.monaco-workbench .xterm.terminal.hide{visibility:hidden}',{}),(0,ht.Z)(".monaco-workbench .terminal-widget-container{bottom:0;left:0;overflow:visible;position:absolute;right:0;top:0}.monaco-workbench .terminal-overlay-widget{bottom:0;color:#3794ff;left:0;position:absolute}.monaco-workbench .terminal-hover-target{position:absolute;z-index:33}.monaco-workbench .terminal-env-var-info{height:28px;opacity:.5;position:absolute;right:10px;text-align:center;top:0;width:28px;z-index:32}.monaco-workbench .terminal-env-var-info.requires-action,.monaco-workbench .terminal-env-var-info:hover{opacity:1}.monaco-workbench .terminal-env-var-info.codicon{line-height:28px}",{}),(0,ht.Z)(".xterm{cursor:text;position:relative;user-select:none;-ms-user-select:none;-webkit-user-select:none}.xterm.focus,.xterm:focus{outline:none}.xterm .xterm-helpers{position:absolute;top:0;z-index:5}.xterm .xterm-helper-textarea{border:0;height:0;left:-9999em;margin:0;opacity:0;overflow:hidden;padding:0;position:absolute;resize:none;top:0;white-space:nowrap;width:0;z-index:-5}.xterm .composition-view{background:#000;color:#fff;display:none;position:absolute;white-space:nowrap;z-index:1}.xterm .composition-view.active{display:block}.xterm .xterm-viewport{background-color:#000;bottom:0;cursor:default;left:0;overflow-y:scroll;position:absolute;right:0;top:0}.xterm .xterm-screen{position:relative}.xterm .xterm-screen canvas{left:0;position:absolute;top:0}.xterm .xterm-scroll-area{visibility:hidden}.xterm-char-measure-element{display:inline-block;left:-9999em;line-height:normal;position:absolute;top:0;visibility:hidden}.xterm.enable-mouse-events{cursor:default}.xterm .xterm-cursor-pointer,.xterm.xterm-cursor-pointer{cursor:pointer}.xterm.column-select.focus{cursor:crosshair}.xterm .xterm-accessibility,.xterm .xterm-message{bottom:0;color:transparent;left:0;pointer-events:none;position:absolute;right:0;top:0;z-index:10}.xterm .live-region{height:1px;left:-9999px;overflow:hidden;position:absolute;width:1px}.xterm-dim{opacity:1!important}.xterm-underline-1{text-decoration:underline}.xterm-underline-2{text-decoration:double underline}.xterm-underline-3{text-decoration:wavy underline}.xterm-underline-4{text-decoration:dotted underline}.xterm-underline-5{text-decoration:dashed underline}.xterm-overline{text-decoration:overline}.xterm-overline.xterm-underline-1{text-decoration:overline underline}.xterm-overline.xterm-underline-2{text-decoration:overline double underline}.xterm-overline.xterm-underline-3{text-decoration:overline wavy underline}.xterm-overline.xterm-underline-4{text-decoration:overline dotted underline}.xterm-overline.xterm-underline-5{text-decoration:overline dashed underline}.xterm-strikethrough{text-decoration:line-through}.xterm-screen .xterm-decoration-container .xterm-decoration{position:absolute;z-index:6}.xterm-screen .xterm-decoration-container .xterm-decoration.xterm-decoration-top-layer{z-index:7}.xterm-decoration-overview-ruler{pointer-events:none;position:absolute;right:0;top:0;z-index:8}.xterm-decoration-top{position:relative;z-index:2}",{});var or=i(49989),ar=i(39403),cr=i(70590),lr=i(90317),hr=i(60961),dr=i(66307),ur=i(27784),mr=i(25707),_r=i(90573),gr=i(88289);function pr(e){let t="";const i=e.statusList.statuses,n=[];for(const e of i)t+=`\n\n---\n\n${e.icon?`$(${e.icon?.id}) `:""}${e.tooltip||e.id}`,e.hoverActions&&n.push(...e.hoverActions);const s=function(e,t){const i=[];if(e.processId&&i.push((0,p.NC)({key:"shellProcessTooltip.processId",comment:['The first arg is "PID" which shouldn\'t be translated']},"Process ID ({0}): {1}","PID",e.processId)+"\n"),e.shellLaunchConfig.executable){let t=e.shellLaunchConfig.executable;const n=(0,Ci._2)(e.injectedArgs||e.shellLaunchConfig.args||[]).map((e=>`'${e}'`)).join(" ");n&&(t+=` ${n}`),i.push((0,p.NC)("shellProcessTooltip.commandLine","Command line: {0}",t))}return i.length?`\n\n---\n\n${i.join("\n")}`:""}(e),r=function(e,t){const i=[];e.capabilities.has(2)&&i.push(2),e.capabilities.has(0)&&i.push(0);let n="";return i.length>0?n+=`\n\n---\n\n${(0,p.NC)("shellIntegration.enabled","Shell integration activated")}`:e.shellLaunchConfig.ignoreShellIntegration?n+=`\n\n---\n\n${(0,p.NC)("launchFailed.exitCodeOnlyShellIntegration","The terminal process failed to launch. Disabling shell integration with terminal.integrated.shellIntegration.enabled might help.")}`:e.usedShellIntegrationInjection&&(n+=`\n\n---\n\n${(0,p.NC)("shellIntegration.activationFailed","Shell integration failed to activate")}`),n}(e);return{content:new Mt.W5(e.title+s+r+t,{supportThemeIcons:!0}),actions:n}}const fr=c.$;let vr=class extends W.ev{constructor(e,t,i,n,r,o,a,c,l,h,d,m){super("TerminalTabsList",e,{getHeight:()=>22,getTemplateId:()=>"terminal.tabs"},[c.createInstance(br,e,c.createInstance(dr.RX,dr.hh),(()=>this.getSelectedElements()))],{horizontalScrolling:!1,supportDynamicHeights:!1,selectionNavigation:!0,identityProvider:{getId:e=>e?.instanceId},accessibilityProvider:c.createInstance(Sr),smoothScrolling:r.getValue("workbench.list.smoothScrolling"),multipleSelectionSupport:!0,paddingBottom:22,dnd:c.createInstance(wr),openOnSingleClick:!0},t,i,r,c),this._configurationService=r,this._terminalService=o,this._terminalGroupService=a,this._themeService=h,this._hoverService=m;const _=[this._terminalGroupService.onDidChangeInstances((()=>this.refresh())),this._terminalGroupService.onDidChangeGroups((()=>this.refresh())),this._terminalGroupService.onDidShow((()=>this.refresh())),this._terminalGroupService.onDidChangeInstanceCapability((()=>this.refresh())),this._terminalService.onDidChangeInstanceTitle((()=>this.refresh())),this._terminalService.onDidChangeInstanceIcon((()=>this.refresh())),this._terminalService.onDidChangeInstancePrimaryStatus((()=>this.refresh())),this._terminalService.onDidChangeConnectionState((()=>this.refresh())),this._themeService.onDidColorThemeChange((()=>this.refresh())),this._terminalGroupService.onDidChangeActiveInstance((e=>{if(e){const t=this._terminalGroupService.instances.indexOf(e);this.setSelection([t]),this.reveal(t)}this.refresh()}))];d.onWillShutdown((e=>{(0,u.B9)(_)})),this.onMouseDblClick((async e=>{if(0===this.getFocus().length){const e=await this._terminalService.createTerminal({location:s.i2.Panel});this._terminalGroupService.setActiveInstance(e),await e.focusWhenReady()}this._terminalService.getEditingTerminal()?.instanceId!==e.element?.instanceId&&"doubleClick"===this._getFocusMode()&&1===this.getFocus().length&&e.element?.focus(!0)})),this.onMouseClick((async e=>{this._terminalService.getEditingTerminal()?.instanceId!==e.element?.instanceId&&(e.browserEvent.altKey&&e.element?await this._terminalService.createTerminal({location:{parentTerminal:e.element}}):"singleClick"===this._getFocusMode()&&this.getSelection().length<=1&&e.element?.focus(!0))})),this.onContextMenu((e=>{if(!e.element)return void this.setSelection([]);const t=this.getSelectedElements();t&&t.find((t=>e.element===t))||this.setFocus(void 0!==e.index?[e.index]:[])})),this._terminalTabsSingleSelectedContextKey=he.r.tabsSingularSelection.bindTo(t),this._isSplitContextKey=he.r.splitTerminal.bindTo(t),this.onDidChangeSelection((e=>this._updateContextKey())),this.onDidChangeFocus((()=>this._updateContextKey())),this.onDidOpen((async e=>{const t=e.element;t&&(this._terminalGroupService.setActiveInstance(t),e.editorOptions.preserveFocus||await t.focusWhenReady())})),this._decorationsProvider||(this._decorationsProvider=c.createInstance(Cr),l.registerDecorationsProvider(this._decorationsProvider)),this.refresh()}_getFocusMode(){return this._configurationService.getValue("terminal.integrated.tabs.focusMode")}refresh(e=!0){e&&this._terminalService.isEditable(void 0)&&this.domFocus(),this.splice(0,this.length,this._terminalGroupService.instances.slice())}focusHover(){const e=this.getSelectedElements()[0];e&&this._hoverService.showHover({...pr(e),target:this.getHTMLElement(),trapFocus:!0},!0)}_updateContextKey(){this._terminalTabsSingleSelectedContextKey.set(1===this.getSelectedElements().length);const e=this.getFocusedElements();this._isSplitContextKey.set(e.length>0&&this._terminalGroupService.instanceIsSplit(e[0]))}};vr=(0,a.g)([(0,a.f)(1,b.i6),(0,a.f)(2,W.Lw),(0,a.f)(3,I.XE),(0,a.f)(4,v.Ui),(0,a.f)(5,o.x4),(0,a.f)(6,o.Qy),(0,a.f)(7,S.TG),(0,a.f)(8,ur.Y),(0,a.f)(9,I.XE),(0,a.f)(10,Si.g),(0,a.f)(11,Ui.B)],vr);let br=class{constructor(e,t,i,n,s,r,o,a,c,l,h,d){this._container=e,this._labels=t,this._getSelection=i,this._instantiationService=n,this._terminalService=s,this._terminalGroupService=r,this._hoverService=o,this._configurationService=a,this._keybindingService=c,this._listService=l,this._themeService=h,this._contextViewService=d,this.templateId="terminal.tabs"}renderTemplate(e){const t=c.R3(e,fr(".terminal-tabs-entry")),i={},n=this._labels.create(t,{supportHighlights:!0,supportDescriptionHighlights:!0,supportIcons:!0,hoverDelegate:{delay:this._configurationService.getValue("workbench.hover.delay"),showHover:e=>this._hoverService.showHover({...e,actions:i.hoverActions,hideOnHover:!0})}}),s=c.R3(n.element,fr(".actions"));return{element:t,label:n,actionBar:new lr.o(s,{actionViewItemProvider:e=>e instanceof H.U8?this._instantiationService.createInstance(hr.Mm,e,void 0):void 0}),context:i,elementDisposables:new u.SL}}shouldHideText(){return!!this._container&&this._container.clientWidth<63}shouldHideActionBar(){return!!this._container&&this._container.clientWidth<=105}renderElement(e,t,i){const n=!this.shouldHideText(),s=this._terminalGroupService.getGroupForInstance(e);if(!s)throw new Error(`Could not find group for instance "${e.instanceId}"`);i.element.classList.toggle("has-text",n),i.element.classList.toggle("is-active",this._terminalGroupService.activeInstance===e);let r="";if(s.terminalInstances.length>1){const t=s.terminalInstances.indexOf(e);r=0===t?"┌ ":t===s.terminalInstances.length-1?"└ ":"├ "}const o=pr(e);i.context.hoverActions=o.actions;const a=this._instantiationService.invokeFunction(re.yX,e),l=!this.shouldHideActionBar();let h="";if(n)this.fillActionBar(e,i),h=r,e.icon&&(h+=`$(${a}) ${e.title}`);else{const t=e.statusList.primary;h=t&&t.severity>ct.Z.Ignore?`${r}$(${t.icon?.id||a})`:`${r}$(${a})`}l||i.actionBar.clear(),i.elementDisposables.add(c.nm(i.element,c.tw.AUXCLICK,(t=>{t.stopImmediatePropagation(),1===t.button&&this._terminalService.safeDisposeTerminal(e)})));const d=[],u=(0,re.pv)(e);u&&d.push(u);const m=(0,re.A5)(e,this._themeService.getColorTheme().type);m&&d.push(...m),i.label.setResource({resource:e.resource,name:h,description:n?e.description:void 0},{fileDecorations:{colors:!0,badges:n},title:{markdown:o.content,markdownNotSupportedFallback:void 0},extraClasses:d});const _=this._terminalService.getEditableData(e);i.label.element.classList.toggle("editable-tab",!!_),_&&(i.elementDisposables.add(this._renderInputBox(i.label.element.querySelector(".monaco-icon-label-container"),e,_)),i.actionBar.clear())}_renderInputBox(e,t,i){const n=t.title||"",s=new _r.Wz(e,this._contextViewService,{validationOptions:{validation:e=>{const t=i.validationMessage(e);return t&&t.severity===ct.Z.Error?{content:t.content,formatContent:!0,type:3}:null}},ariaLabel:(0,p.NC)("terminalInputAriaLabel","Type terminal name. Press Enter to confirm or Escape to cancel."),inputBoxStyles:an.Hc});s.element.style.height="22px",s.value=n,s.focus(),s.select({start:0,end:n.length});const r=(0,gr.I)(((e,t)=>{s.element.style.display="none";const n=s.value;(0,u.B9)(a),s.element.remove(),t&&i.onFinish(n,e)})),o=()=>{if(s.isInputValid()){const e=i.validationMessage(s.value);e?s.showMessage({content:e.content,formatContent:!0,type:e.severity===ct.Z.Info?1:e.severity===ct.Z.Warning?2:3}):s.hideMessage()}};o();const a=[s,c.mu(s.inputElement,c.tw.KEY_DOWN,(e=>{e.stopPropagation(),e.equals(3)?r(s.isInputValid(),!0):e.equals(9)&&r(!1,!0)})),c.mu(s.inputElement,c.tw.KEY_UP,(e=>{o()})),c.nm(s.inputElement,c.tw.BLUR,(()=>{r(s.isInputValid(),!0)}))];return(0,u.OF)((()=>{r(!1,!1)}))}disposeElement(e,t,i){i.elementDisposables.clear(),i.actionBar.clear()}disposeTemplate(e){e.elementDisposables.dispose(),e.label.dispose(),e.actionBar.dispose()}fillActionBar(e,t){const i=[new P.aU("workbench.action.terminal.splitInstance",oe.split.short,D.kS.asClassName(R.lA.splitHorizontal),!0,(async()=>{this._runForSelectionOrInstance(e,(async e=>{this._terminalService.createTerminal({location:{parentTerminal:e}})}))})),new P.aU("workbench.action.terminal.killInstance",oe.kill.short,D.kS.asClassName(R.lA.trashcan),!0,(async()=>{this._runForSelectionOrInstance(e,(e=>this._terminalService.safeDisposeTerminal(e)))}))];t.actionBar.clear();for(const e of i)t.actionBar.push(e,{icon:!0,label:!1,keybinding:this._keybindingService.lookupKeybinding(e.id)?.getLabel()})}_runForSelectionOrInstance(e,t){const i=this._getSelection();if(i.includes(e))for(const e of i)e&&t(e);else t(e);this._terminalGroupService.focusTabs(),this._listService.lastFocusedList?.focusNext()}};br=(0,a.g)([(0,a.f)(3,S.TG),(0,a.f)(4,o.x4),(0,a.f)(5,o.Qy),(0,a.f)(6,Ui.B),(0,a.f)(7,v.Ui),(0,a.f)(8,Tn.d),(0,a.f)(9,W.Lw),(0,a.f)(10,I.XE),(0,a.f)(11,ut.u)],br);let Sr=class{constructor(e){this._terminalGroupService=e}getWidgetAriaLabel(){return(0,p.NC)("terminal.tabs","Terminal tabs")}getAriaLabel(e){let t="";const i=this._terminalGroupService.getGroupForInstance(e);if(i&&i.terminalInstances?.length>1){const n=i.terminalInstances.indexOf(e);t=(0,p.NC)({key:"splitTerminalAriaLabel",comment:["The terminal's ID","The terminal's title","The terminal's split number","The terminal group's total split number"]},"Terminal {0} {1}, split {2} of {3}",e.instanceId,e.title,n+1,i.terminalInstances.length)}else t=(0,p.NC)({key:"terminalAriaLabel",comment:["The terminal's ID","The terminal's title"]},"Terminal {0} {1}",e.instanceId,e.title);return t}};Sr=(0,a.g)([(0,a.f)(0,o.Qy)],Sr);let wr=class{constructor(e,t){this._terminalService=e,this._terminalGroupService=t,this._autoFocusDisposable=u.JT.None,this._primaryBackend=this._terminalService.getPrimaryBackend()}getDragURI(e){return this._terminalService.getEditingTerminal()?.instanceId===e.instanceId?null:e.resource.toString()}getDragLabel(e,t){return 1===e.length?e[0].title:void 0}onDragLeave(){this._autoFocusInstance=void 0,this._autoFocusDisposable.dispose(),this._autoFocusDisposable=u.JT.None}onDragStart(e,t){if(!t.dataTransfer)return;const i=e.getData();if(!Array.isArray(i))return;const n=i.filter((e=>"instanceId"in e));n.length>0&&t.dataTransfer.setData("Terminals",JSON.stringify(n.map((e=>e.resource.toString()))))}onDragOver(e,t,i,n){if(e instanceof mr.s2&&!(0,In.Mq)(n,wn.go.FILES,wn.go.RESOURCES,"Terminals",In.Km.FILES))return!1;const s=this._autoFocusInstance!==t;return s&&(this._autoFocusDisposable.dispose(),this._autoFocusInstance=t),t||(0,In.Mq)(n,"Terminals")?(s&&t&&(this._autoFocusDisposable=(0,l.Vg)((()=>{this._terminalService.setActiveInstance(t),this._autoFocusInstance=void 0}),500)),{feedback:i?[i]:void 0,accept:!0,effect:1}):e instanceof mr.kX}async drop(e,t,i,n){let s;this._autoFocusDisposable.dispose(),this._autoFocusInstance=void 0;const r=[],o=pi(n);if(o)for(const e of o){const t=this._terminalService.getInstanceFromResource(e);if(t)s=[t],this._terminalService.moveToTerminalView(t);else if(this._primaryBackend){const t=_i(e);t.instanceId&&r.push(this._primaryBackend.requestDetachInstance(t.workspaceId,t.instanceId))}}if(r.length){let e,t=await Promise.all(r);t=t.filter((e=>void 0!==e));for(const i of t)e=await this._terminalService.createTerminal({config:{attachPersistentProcess:i}});return void(e&&this._terminalService.setActiveInstance(e))}if(void 0===s){if(!(e instanceof mr.kX))return void this._handleExternalDrop(t,n);const i=e.getData();if(!i||!Array.isArray(i))return;s=[];for(const e of i)"instanceId"in e&&s.push(e)}if(!t)return this._terminalGroupService.moveGroupToEnd(s[0]),void this._terminalService.setActiveInstance(s[0]);let a=!1;for(const e of s)this._terminalGroupService.moveGroup(e,t),a||(this._terminalService.setActiveInstance(e),a=!0)}async _handleExternalDrop(e,t){if(!e||!t.dataTransfer)return;let i;const n=t.dataTransfer.getData(wn.go.RESOURCES);n&&(i=g.ov.parse(JSON.parse(n)[0]));const s=t.dataTransfer.getData(In.Km.FILES);!i&&s&&(i=g.ov.file(JSON.parse(s)[0])),!i&&t.dataTransfer.files.length>0&&t.dataTransfer.files[0].path&&(i=g.ov.file(t.dataTransfer.files[0].path)),i&&(this._terminalService.setActiveInstance(e),e.focus(),await e.sendPath(i,!1))}};wr=(0,a.g)([(0,a.f)(0,o.x4),(0,a.f)(1,o.Qy)],wr);let Cr=class{constructor(e){this._terminalService=e,this.label=(0,p.NC)("label","Terminal"),this._onDidChange=new d.Q5,this._terminalService.onDidChangeInstancePrimaryStatus((e=>this._onDidChange.fire([e.resource])))}get onDidChange(){return this._onDidChange.event}provideDecorations(e){if(e.scheme!==m.lg.vscodeTerminal)return;const t=this._terminalService.getInstanceFromResource(e);if(!t)return;const i=t?.statusList?.primary;return i?.icon?{color:hs(i.severity),letter:i.icon,tooltip:i.tooltip}:void 0}dispose(){this.dispose()}};Cr=(0,a.g)([(0,a.f)(0,o.x4)],Cr);var yr=i(7448);function xr(e,t,i,n,s){const r=new yr.nV(e),o=[];(0,hr.LJ)(i,void 0,o),s&&o.push(...s),n.showContextMenu({getAnchor:()=>r,getActions:()=>o,getActionsContext:()=>t})}const kr=c.$;let Ir=class extends u.JT{constructor(e,t,i,n,s,r,o,a,c,l,h){super(),this._terminalService=t,this._terminalGroupService=i,this._instantiationService=n,this._notificationService=s,this._contextMenuService=r,this._configurationService=o,this._storageService=c,this._hoverService=h,this._cancelContextMenu=!1,this._parentElement=e,this._tabContainer=kr(".tabs-container");const d=kr(".tabs-list-container");this._tabListElement=kr(".tabs-list"),d.appendChild(this._tabListElement),this._tabContainer.appendChild(d),this._instanceMenu=this._register(a.createMenu(H.eH.TerminalInstanceContext,l)),this._tabsListMenu=this._register(a.createMenu(H.eH.TerminalTabContext,l)),this._tabsListEmptyMenu=this._register(a.createMenu(H.eH.TerminalTabEmptyAreaContext,l)),this._tabList=this._register(this._instantiationService.createInstance(vr,this._tabListElement));const u=kr(".terminal-outer-container");this._terminalContainer=kr(".terminal-groups-container"),u.appendChild(this._terminalContainer),this._terminalService.setContainers(e,this._terminalContainer),this._terminalIsTabsNarrowContextKey=he.r.tabsNarrow.bindTo(l),this._terminalTabsFocusContextKey=he.r.tabsFocus.bindTo(l),this._terminalTabsMouseContextKey=he.r.tabsMouse.bindTo(l),this._tabTreeIndex="left"===this._terminalService.configHelper.config.tabs.location?0:1,this._terminalContainerIndex="left"===this._terminalService.configHelper.config.tabs.location?1:0,o.onDidChangeConfiguration((e=>{e.affectsConfiguration("terminal.integrated.tabs.enabled")||e.affectsConfiguration("terminal.integrated.tabs.hideCondition")?this._refreshShowTabs():e.affectsConfiguration("terminal.integrated.tabs.location")&&(this._tabTreeIndex="left"===this._terminalService.configHelper.config.tabs.location?0:1,this._terminalContainerIndex="left"===this._terminalService.configHelper.config.tabs.location?1:0,this._shouldShowTabs()&&(this._splitView.swapViews(0,1),this._removeSashListener(),this._addSashListener(),this._splitView.resizeView(this._tabTreeIndex,this._getLastListWidth())))})),this._register(this._terminalGroupService.onDidChangeInstances((()=>this._refreshShowTabs()))),this._register(this._terminalGroupService.onDidChangeGroups((()=>this._refreshShowTabs()))),this._attachEventListeners(e,this._terminalContainer),this._terminalGroupService.onDidChangePanelOrientation((e=>{this._panelOrientation=e,0===this._panelOrientation?this._terminalContainer.classList.add("terminal-side-view"):this._terminalContainer.classList.remove("terminal-side-view")})),this._splitView=new Is.z(e,{orientation:1,proportionalLayout:!1}),this._setupSplitView(u)}_shouldShowTabs(){const e=this._terminalService.configHelper.config.tabs.enabled,t=this._terminalService.configHelper.config.tabs.hideCondition;return!!e&&("never"===t||"singleTerminal"===t&&this._terminalGroupService.instances.length>1||"singleGroup"===t&&this._terminalGroupService.groups.length>1)}_refreshShowTabs(){this._shouldShowTabs()?1===this._splitView.length&&(this._addTabTree(),this._addSashListener(),this._splitView.resizeView(this._tabTreeIndex,this._getLastListWidth()),this.rerenderTabs()):2!==this._splitView.length||this._terminalTabsMouseContextKey.get()||(this._splitView.removeView(this._tabTreeIndex),this._plusButton&&this._tabContainer.removeChild(this._plusButton),this._removeSashListener())}_getLastListWidth(){const e=0===this._panelOrientation?"tabs-list-width-vertical":"tabs-list-width-horizontal",t=this._storageService.get(e,0);return t&&parseInt(t)?parseInt(t):0===this._panelOrientation?46:120}_handleOnDidSashReset(){let e=80;const t=document.createElement("canvas");t.width=1,t.height=1;const i=t.getContext("2d");if(i){const t=window.getComputedStyle(this._tabListElement);i.font=`${t.fontStyle} ${t.fontSize} ${t.fontFamily}`;const n=this._terminalGroupService.instances.reduce(((e,t)=>Math.max(e,i.measureText(t.title+(t.description||"")).width+this._getAdditionalWidth(t))),0);e=Math.ceil(Math.max(n,80))}Math.ceil(this._splitView.getViewSize(this._tabTreeIndex))===e&&(e=46),this._splitView.resizeView(this._tabTreeIndex,e),this._updateListWidth(e)}_getAdditionalWidth(e){const t=e.statusList.statuses.length>0?30:0;return 40+((this._terminalGroupService.getGroupForInstance(e)?.terminalInstances.length||0)>1?30:0)+t}_handleOnDidSashChange(){const e=this._splitView.getViewSize(this._tabTreeIndex);!this._width||e<=0||this._updateListWidth(e)}_updateListWidth(e){e<63&&e>=46?(e=46,this._splitView.resizeView(this._tabTreeIndex,e)):e>=63&&e<80&&(e=80,this._splitView.resizeView(this._tabTreeIndex,e)),this.rerenderTabs();const t=0===this._panelOrientation?"tabs-list-width-vertical":"tabs-list-width-horizontal";this._storageService.store(t,e,0,0)}_setupSplitView(e){this._register(this._splitView.onDidSashReset((()=>this._handleOnDidSashReset()))),this._register(this._splitView.onDidSashChange((()=>this._handleOnDidSashChange()))),this._shouldShowTabs()&&this._addTabTree(),this._splitView.addView({element:e,layout:e=>this._terminalGroupService.groups.forEach((t=>t.layout(e,this._height||0))),minimumSize:120,maximumSize:Number.POSITIVE_INFINITY,onDidChange:()=>u.JT.None,priority:2},Is.M.Distribute,this._terminalContainerIndex),this._shouldShowTabs()&&this._addSashListener()}_addTabTree(){this._splitView.addView({element:this._tabContainer,layout:e=>this._tabList.layout(this._height||0,e),minimumSize:46,maximumSize:500,onDidChange:()=>u.JT.None,priority:1},Is.M.Distribute,this._tabTreeIndex),this.rerenderTabs()}rerenderTabs(){this._updateHasText(),this._tabList.refresh()}_addSashListener(){let e;this._sashDisposables=[this._splitView.sashes[0].onDidStart((t=>{e=window.setInterval((()=>{this.rerenderTabs()}),100)})),this._splitView.sashes[0].onDidEnd((t=>{window.clearInterval(e),e=0}))]}_removeSashListener(){this._sashDisposables&&((0,u.B9)(this._sashDisposables),this._sashDisposables=void 0)}_updateHasText(){const e=this._tabListElement.clientWidth>63;this._tabContainer.classList.toggle("has-text",e),this._terminalIsTabsNarrowContextKey.set(!e)}layout(e,t){this._height=t,this._width=e,this._splitView.layout(e),this._shouldShowTabs()&&this._splitView.resizeView(this._tabTreeIndex,this._getLastListWidth()),this._updateHasText()}_attachEventListeners(e,t){this._register(c.nm(this._tabContainer,"mouseleave",(async e=>{this._terminalTabsMouseContextKey.set(!1),this._refreshShowTabs(),e.stopPropagation()}))),this._register(c.nm(this._tabContainer,"mouseenter",(async e=>{this._terminalTabsMouseContextKey.set(!0),e.stopPropagation()}))),this._register(c.nm(t,"mousedown",(async e=>{const t=this._terminalGroupService.activeInstance;if(0!==this._terminalGroupService.instances.length&&t){if(2===e.which&&_.IJ)t.focus();else if(3===e.which){const i=this._terminalService.configHelper.config.rightClickBehavior;if("nothing"===i)return void(e.shiftKey||(this._cancelContextMenu=!0));if("copyPaste"===i||"paste"===i){if("copyPaste"===i&&e.shiftKey)return void xr(e,this._parentElement,this._instanceMenu,this._contextMenuService);"copyPaste"===i&&t.hasSelection()?(await t.copySelection(),t.clearSelection()):L.D.clipboard.readText?t.paste():this._notificationService.info(`This browser doesn't support the clipboard.readText API needed to trigger a paste, try ${_.dz?"⌘":"Ctrl"}+V instead.`),_.dz&&setTimeout((()=>{t.clearSelection()}),0),this._cancelContextMenu=!0}}}else this._cancelContextMenu=!0}))),this._register(c.nm(t,"contextmenu",(e=>{"nothing"!==this._terminalService.configHelper.config.rightClickBehavior||e.shiftKey||(this._cancelContextMenu=!0),this._cancelContextMenu||xr(e,this._parentElement,this._instanceMenu,this._contextMenuService),e.preventDefault(),e.stopImmediatePropagation(),this._cancelContextMenu=!1}))),this._register(c.nm(this._tabContainer,"contextmenu",(e=>{if("nothing"!==this._terminalService.configHelper.config.rightClickBehavior||e.shiftKey||(this._cancelContextMenu=!0),!this._cancelContextMenu){const t=0===this._tabList.getFocus().length;xr(e,this._parentElement,t?this._tabsListEmptyMenu:this._tabsListMenu,this._contextMenuService,t?this._getTabActions():void 0)}e.preventDefault(),e.stopImmediatePropagation(),this._cancelContextMenu=!1}))),this._register(c.nm(document,"keydown",(e=>{t.classList.toggle("alt-active",!!e.altKey)}))),this._register(c.nm(document,"keyup",(e=>{t.classList.toggle("alt-active",!!e.altKey)}))),this._register(c.nm(e,"keyup",(e=>{27===e.keyCode&&e.stopPropagation()}))),this._register(c.nm(this._tabContainer,c.tw.FOCUS_IN,(()=>{this._terminalTabsFocusContextKey.set(!0)}))),this._register(c.nm(this._tabContainer,c.tw.FOCUS_OUT,(()=>{this._terminalTabsFocusContextKey.set(!1)})))}_getTabActions(){return[new P.Z0,"left"===this._configurationService.inspect("terminal.integrated.tabs.location").userValue?new P.aU("moveRight",(0,p.NC)("moveTabsRight","Move Tabs Right"),void 0,void 0,(async()=>{this._configurationService.updateValue("terminal.integrated.tabs.location","right")})):new P.aU("moveLeft",(0,p.NC)("moveTabsLeft","Move Tabs Left"),void 0,void 0,(async()=>{this._configurationService.updateValue("terminal.integrated.tabs.location","left")})),new P.aU("hideTabs",(0,p.NC)("hideTabs","Hide Tabs"),void 0,void 0,(async()=>{this._configurationService.updateValue("terminal.integrated.tabs.enabled",!1)}))]}setEditable(e){e||this._tabList.domFocus(),this._tabList.refresh(!1)}focusTabs(){if(!this._shouldShowTabs())return;this._terminalTabsFocusContextKey.set(!0);const e=this._tabList.getSelection();this._tabList.domFocus(),e&&this._tabList.setFocus(e)}focus(){if(0!==this._terminalService.connectionState)this._focus();else{const e=document.activeElement;this._register(this._terminalService.onDidChangeConnectionState((()=>{document.activeElement===e&&this._focus()})))}}focusHover(){if(this._shouldShowTabs())return void this._tabList.focusHover();const e=this._terminalGroupService.activeInstance;e&&this._hoverService.showHover({...pr(e),target:this._terminalContainer,trapFocus:!0},!0)}_focus(){this._terminalGroupService.activeInstance?.focusWhenReady()}};Ir=(0,a.g)([(0,a.f)(1,o.x4),(0,a.f)(2,o.Qy),(0,a.f)(3,S.TG),(0,a.f)(4,w.lT),(0,a.f)(5,ut.i),(0,a.f)(6,v.Ui),(0,a.f)(7,H.co),(0,a.f)(8,ke.Uy),(0,a.f)(9,b.i6),(0,a.f)(10,Ui.B)],Ir);var Dr=i(56811),Tr=i(92846),Er=i(4038);function Ar(e,t,i,n,r,o){let a=[],c=[];t=t.filter((e=>!e.isAutoDetected));const l=e===s.i2.Editor||"object"==typeof e&&"viewColumn"in e&&e.viewColumn===ae.LP?{viewColumn:ae.O3}:{splitActiveTerminal:!0};for(const n of t){const t=n.profileName===i,s={config:n,location:e},o={config:n,location:l},h=n.profileName.replace(/[\n\r\t]/g,"");a.push(new P.aU("workbench.action.terminal.newWithProfile",t?(0,p.NC)("defaultTerminalProfile","{0} (Default)",h):h,void 0,!0,(async()=>{const e=await r.createTerminal(s);r.setActiveInstance(e),await r.focusActiveInstance()}))),c.push(new P.aU("workbench.action.terminal.split",t?(0,p.NC)("defaultTerminalProfile","{0} (Default)",h):h,void 0,!0,(async()=>{const e=await r.createTerminal(o);r.setActiveInstance(e),await r.focusActiveInstance()})))}for(const t of n){const n=t.title===i?(0,p.NC)("defaultTerminalProfile","{0} (Default)",t.title.replace(/[\n\r\t]/g,"")):t.title.replace(/[\n\r\t]/g,"");a.push(new P.aU("contributed",n,void 0,!0,(()=>r.createTerminal({config:{extensionIdentifier:t.extensionIdentifier,id:t.id,title:n},location:e})))),c.push(new P.aU("contributed-split",n,void 0,!0,(()=>r.createTerminal({config:{extensionIdentifier:t.extensionIdentifier,id:t.id,title:n},location:l}))))}const h=a.find((e=>e.label.endsWith("(Default)")));h&&(a=a.filter((e=>e!==h)).sort(((e,t)=>e.label.localeCompare(t.label))),a.unshift(h)),a.length>0&&(a.push(new P.wY("split.profile",(0,p.NC)("splitTerminal","Split Terminal"),c)),a.push(new P.Z0));const d=o.getActions();a.push(...P.Z0.join(...d.map((e=>e[1]))));const u=c.find((e=>e.label.endsWith("(Default)")));return u&&(c=c.filter((e=>e!==u)).sort(((e,t)=>e.label.localeCompare(t.label))),c.unshift(u)),{dropdownAction:new P.aU("refresh profiles","Launch Profile...","codicon-chevron-down",!0),dropdownMenuActions:a,className:`terminal-tab-actions-${r.resolveLocation(e)}`}}let Lr=class extends cr.qV{get terminalTabbedView(){return this._terminalTabbedView}constructor(e,t,i,n,s,r,o,a,c,l,h,d,u,m,_,g,p,f,v){super(e,t,r,s,i,n,o,m,l,h),this._contextKeyService=i,this._configurationService=s,this._contextMenuService=r,this._instantiationService=o,this._terminalService=a,this._terminalGroupService=c,this._notificationService=d,this._keybindingService=u,this._menuService=_,this._terminalProfileService=g,this._terminalProfileResolverService=p,this._themeService=f,this._accessibilityService=v,this._isWelcomeShowing=!1,this._register(this._terminalService.onDidRegisterProcessSupport((()=>{this._onDidChangeViewWelcomeState.fire()}))),this._register(this._terminalService.onDidChangeInstances((()=>{this._isWelcomeShowing&&(this._isWelcomeShowing=!0,this._onDidChangeViewWelcomeState.fire(),!this._terminalTabbedView&&this._parentDomElement&&(this._createTabsView(),this.layoutBody(this._parentDomElement.offsetHeight,this._parentDomElement.offsetWidth)))}))),this._dropdownMenu=this._register(this._menuService.createMenu(H.eH.TerminalNewDropdownContext,this._contextKeyService)),this._singleTabMenu=this._register(this._menuService.createMenu(H.eH.TerminalInlineTabContext,this._contextKeyService)),this._register(this._terminalProfileService.onDidChangeAvailableProfiles((e=>this._updateTabActionBar(e)))),this._viewShowing=he.r.viewShowing.bindTo(this._contextKeyService),this._register(this.onDidChangeBodyVisibility((e=>{e&&this._terminalTabbedView?.rerenderTabs()}))),this._register(this._configurationService.onDidChangeConfiguration((e=>{this._parentDomElement&&(e.affectsConfiguration("terminal.integrated.shellIntegration.decorationsEnabled")||e.affectsConfiguration("terminal.integrated.shellIntegration.enabled"))&&this._updateForShellIntegration(this._parentDomElement)}))),this._register(this._terminalService.onDidCreateInstance((e=>{e.capabilities.onDidAddCapability((e=>{2===e&&this._gutterDecorationsEnabled()&&this._parentDomElement?.classList.add("shell-integration")}))})))}_updateForShellIntegration(e){e.classList.toggle("shell-integration",this._gutterDecorationsEnabled())}_gutterDecorationsEnabled(){const e=this._configurationService.getValue("terminal.integrated.shellIntegration.decorationsEnabled");return("both"===e||"gutter"===e)&&this._configurationService.getValue("terminal.integrated.shellIntegration.enabled")}_initializeTerminal(e){if(this.isBodyVisible()&&this._terminalService.isProcessSupportRegistered&&1===this._terminalService.connectionState){let t=0===this._terminalGroupService.groups.length;e&&(t&&=0===this._terminalService.restoredGroupCount),t&&this._terminalService.createTerminal({location:s.i2.Panel})}}renderBody(e){super.renderBody(e),this._parentDomElement||this._updateForShellIntegration(e),this._parentDomElement=e,this._parentDomElement.classList.add("integrated-terminal"),this._fontStyleElement=document.createElement("style"),this._instantiationService.createInstance(Nr,this._parentDomElement),this.shouldShowWelcome()||this._createTabsView(),this._parentDomElement.appendChild(this._fontStyleElement),this._register(this.configurationService.onDidChangeConfiguration((e=>{if((e.affectsConfiguration("terminal.integrated.fontFamily")||e.affectsConfiguration("editor.fontFamily"))&&!this._terminalService.configHelper.configFontIsMonospace()){const e=[{label:p.NC("terminal.useMonospace","Use 'monospace'"),run:()=>this.configurationService.updateValue("terminal.integrated.fontFamily","monospace")}];this._notificationService.prompt(w.zb.Warning,p.NC("terminal.monospaceOnly","The terminal only supports monospace fonts. Be sure to restart VS Code if this is a newly installed font."),e)}}))),this._register(this.onDidChangeBodyVisibility((async e=>{if(this._viewShowing.set(e),e)this._terminalService.isProcessSupportRegistered||this._onDidChangeViewWelcomeState.fire(),this._initializeTerminal(!1),this._terminalGroupService.showPanel(!1);else for(const e of this._terminalGroupService.instances)e.resetFocusContextKey();this._terminalGroupService.updateVisibility()}))),this._register(this._terminalService.onDidChangeConnectionState((()=>this._initializeTerminal(!0)))),this.layoutBody(this._parentDomElement.offsetHeight,this._parentDomElement.offsetWidth)}_createTabsView(){this._parentDomElement&&(this._terminalTabbedView=this.instantiationService.createInstance(Ir,this._parentDomElement))}layoutBody(e,t){super.layoutBody(e,t),this._terminalTabbedView?.layout(t,e)}getActionViewItem(e){switch(e.id){case"workbench.action.terminal.split":{const t=this,i=new class extends P.aU{constructor(){super(e.id,e.label,e.class,e.enabled),this.checked=e.checked,this.tooltip=e.tooltip}dispose(){e.dispose()}async run(){const e=t._terminalGroupService.activeInstance;if(e){const i=await t._terminalService.createTerminal({location:{parentTerminal:e}});return i?.focusWhenReady()}}};return new Dt.gU(e,i,{icon:!0,label:!1,keybinding:this._getKeybindingLabel(e)})}case"workbench.action.terminal.switchTerminal":return this._instantiationService.createInstance(Pr,e);case"workbench.action.terminal.focus":if(e instanceof H.U8){const t=[];return(0,hr.LJ)(this._singleTabMenu,void 0,t),this._instantiationService.createInstance(Mr,e,t)}case"workbench.action.terminal.new":if(e instanceof H.U8){const t=Ar(s.i2.Panel,this._terminalProfileService.availableProfiles,this._getDefaultProfileName(),this._terminalProfileService.contributedProfiles,this._terminalService,this._dropdownMenu);return this._newDropdown?.dispose(),this._newDropdown=new Tr.C(e,t.dropdownAction,t.dropdownMenuActions,t.className,this._contextMenuService,{},this._keybindingService,this._notificationService,this._contextKeyService,this._themeService,this._accessibilityService),this._updateTabActionBar(this._terminalProfileService.availableProfiles),this._newDropdown}}return super.getActionViewItem(e)}_getDefaultProfileName(){let e;try{e=this._terminalProfileService.getDefaultProfileName()}catch(t){e=this._terminalProfileResolverService.defaultProfileName}return e}_getKeybindingLabel(e){return(0,B.f6)(this._keybindingService.lookupKeybinding(e.id)?.getLabel())}_updateTabActionBar(e){const t=Ar(s.i2.Panel,e,this._getDefaultProfileName(),this._terminalProfileService.contributedProfiles,this._terminalService,this._dropdownMenu);this._newDropdown?.update(t.dropdownAction,t.dropdownMenuActions)}focus(){if(0!==this._terminalService.connectionState)this._terminalGroupService.showPanel(!0);else{const e=document.activeElement;this._register(this._terminalService.onDidChangeConnectionState((()=>{document.activeElement===e&&this._terminalGroupService.showPanel(!0)})))}}shouldShowWelcome(){return this._isWelcomeShowing=!this._terminalService.isProcessSupportRegistered&&0===this._terminalService.instances.length,this._isWelcomeShowing}};Lr=(0,a.g)([(0,a.f)(1,Tn.d),(0,a.f)(2,b.i6),(0,a.f)(3,A.XH),(0,a.f)(4,v.Ui),(0,a.f)(5,ut.i),(0,a.f)(6,S.TG),(0,a.f)(7,o.x4),(0,a.f)(8,o.Qy),(0,a.f)(9,I.XE),(0,a.f)(10,Ft.bU),(0,a.f)(11,w.lT),(0,a.f)(12,Tn.d),(0,a.f)(13,V.v4),(0,a.f)(14,H.co),(0,a.f)(15,r.l5),(0,a.f)(16,r.if),(0,a.f)(17,I.XE),(0,a.f)(18,O.F7)],Lr);let Pr=class extends Dt.Lc{constructor(e,t,i,n,s){super(null,e,Rr(t,i),i.activeGroupIndex,n,an.BM,{ariaLabel:p.NC("terminals","Open Terminals."),optionsAsChildren:!0}),this._terminalService=t,this._terminalGroupService=i,this._register(t.onDidChangeInstances((()=>this._updateItems()),this)),this._register(t.onDidChangeActiveGroup((()=>this._updateItems()),this)),this._register(t.onDidChangeActiveInstance((()=>this._updateItems()),this)),this._register(t.onDidChangeInstanceTitle((()=>this._updateItems()),this)),this._register(i.onDidChangeGroups((()=>this._updateItems()),this)),this._register(t.onDidChangeConnectionState((()=>this._updateItems()),this)),this._register(s.onDidChangeAvailableProfiles((()=>this._updateItems()),this)),this._register(t.onDidChangeInstancePrimaryStatus((()=>this._updateItems()),this))}render(e){super.render(e),e.classList.add("switch-terminal"),e.style.borderColor=(0,y.n_1)(y.a9O)}_updateItems(){const e=Rr(this._terminalService,this._terminalGroupService);this.setOptions(e,this._terminalGroupService.activeGroupIndex)}};function Rr(e,t){let i;return i=1===e.connectionState?t.getGroupLabels().map((e=>({text:e}))):[{text:p.NC("terminalConnectingLabel","Starting...")}],i.push({text:$e,isDisabled:!0}),i.push({text:Ue}),i}Pr=(0,a.g)([(0,a.f)(1,o.x4),(0,a.f)(2,o.Qy),(0,a.f)(3,ut.u),(0,a.f)(4,r.l5)],Pr);let Mr=class extends hr.Mm{constructor(e,t,i,n,s,r,o,a,c,l,h,m){super(e,{draggable:!0,hoverDelegate:h.createInstance(Or)},i,n,s,r,c,m),this._actions=t,this._terminalService=o,this._terminalGroupService=a,this._commandService=l,this._instantiationService=h,this._elementDisposables=[],this._register(d.ju.debounce(d.ju.any(this._terminalService.onDidChangeInstancePrimaryStatus,this._terminalGroupService.onDidChangeActiveInstance,d.ju.map(this._terminalService.onDidChangeInstanceIcon,(e=>e.instance)),d.ju.map(this._terminalService.onDidChangeInstanceColor,(e=>e.instance)),this._terminalService.onDidChangeInstanceTitle,this._terminalService.onDidChangeInstanceCapability),((e,t)=>(e||(e=new Set),t&&e.add(t),e)))((e=>{for(const t of e)this.updateLabel(t)}))),this._register((0,u.OF)((()=>(0,u.B9)(this._elementDisposables))))}async onClick(e){e.altKey&&this._menuItemAction.alt?this._commandService.executeCommand(this._menuItemAction.alt.id,{target:s.i2.Panel}):this._openContextMenu()}updateLabel(e){if((!e||e===this._terminalGroupService.activeInstance)&&(0===this._elementDisposables.length&&this.element&&this.label&&(this._elementDisposables.push(c.nm(this.element,c.tw.CONTEXT_MENU,(e=>{2===e.button&&(this._openContextMenu(),e.preventDefault())}))),this._elementDisposables.push(c.nm(this.element,c.tw.AUXCLICK,(e=>{if(1===e.button){const t=this._terminalGroupService.activeInstance;t&&this._terminalService.safeDisposeTerminal(t),e.preventDefault()}}))),this._elementDisposables.push(c.nm(this.element,c.tw.DRAG_START,(e=>{const t=this._terminalGroupService.activeInstance;e.dataTransfer&&t&&e.dataTransfer.setData("Terminals",JSON.stringify([t.resource.toString()]))})))),this.label)){const e=this.label,t=this._terminalGroupService.activeInstance;if(!t)return void c.mc(e,"");e.classList.add("single-terminal-tab");let i="";const n=t.statusList.primary;if(n){const e=hs(n.severity);this._themeService.getColorTheme();const t=this._themeService.getColorTheme().getColor(e);t&&(i=t.toString())}e.style.color=i,c.mc(e,...(0,Dr.T)(this._instantiationService.invokeFunction(Br,t,this._terminalService.configHelper.config.tabs.separator,D.kS.isThemeIcon(this._commandAction.item.icon)?this._commandAction.item.icon:void 0))),this._altCommand&&(e.classList.remove(this._altCommand),this._altCommand=void 0),this._color&&(e.classList.remove(this._color),this._color=void 0),this._class&&(e.classList.remove(this._class),e.classList.remove("terminal-uri-icon"),this._class=void 0);const s=(0,re.pv)(t);s&&(this._color=s,e.classList.add(s));const r=(0,re.A5)(t,this._themeService.getColorTheme().type);r&&(this._class=r?.[0],e.classList.add(...r)),this._commandAction.item.icon&&(this._altCommand="alt-command",e.classList.add(this._altCommand)),this.updateTooltip()}}_openContextMenu(){this._contextMenuService.showContextMenu({getAnchor:()=>this.element,getActions:()=>this._actions,getActionsContext:()=>this.label})}};function Br(e,t,i,n){if(!t||!t.title)return"";const s=D.kS.isThemeIcon(t.icon)?t.icon.id:e.get(r.if).getDefaultIcon().id,o=`$(${n?.id||s}) ${function(e,t){return e?e.description?`${e.title} ${t} ${e.description}`:e.title:""}(t,i)}`,a=t.statusList.primary;return a?.icon?`${o} $(${a.icon.id})`:o}Mr=(0,a.g)([(0,a.f)(2,Tn.d),(0,a.f)(3,w.lT),(0,a.f)(4,b.i6),(0,a.f)(5,I.XE),(0,a.f)(6,o.x4),(0,a.f)(7,o.Qy),(0,a.f)(8,ut.i),(0,a.f)(9,f.H),(0,a.f)(10,S.TG),(0,a.f)(11,O.F7)],Mr);let Nr=class extends I.bB{constructor(e,t,i,n){super(t),this._themeService=t,this._terminalService=i,this._terminalGroupService=n,this._registerListeners(),this._styleElement=document.createElement("style"),e.appendChild(this._styleElement),this._register((0,u.OF)((()=>e.removeChild(this._styleElement)))),this.updateStyles()}_registerListeners(){this._register(this._terminalService.onDidChangeInstanceIcon((()=>this.updateStyles()))),this._register(this._terminalService.onDidChangeInstanceColor((()=>this.updateStyles()))),this._register(this._terminalService.onDidChangeInstances((()=>this.updateStyles()))),this._register(this._terminalGroupService.onDidChangeGroups((()=>this.updateStyles())))}updateStyles(){super.updateStyles();const e=this._themeService.getColorTheme();let t="";for(const i of this._terminalService.instances){const n=i.icon;if(!n)continue;let s;n instanceof g.ov?s=n:n instanceof Object&&"light"in n&&"dark"in n&&(s=e.type===k.eL.LIGHT?n.light:n.dark);const r=(0,re.A5)(i,e.type);s instanceof g.ov&&r&&r.length>1&&(t+=`.monaco-workbench .${r[0]} .monaco-highlighted-label .codicon, .monaco-action-bar .terminal-uri-icon.single-terminal-tab.action-label:not(.alt-command) .codicon{background-image: ${c.wY(s)};}`)}for(const i of this._terminalService.instances){const n=(0,re.pv)(i);if(!n||!i.color)continue;const s=e.getColor(i.color);s&&(t+=`.monaco-workbench .${n} .codicon:first-child:not(.codicon-split-horizontal):not(.codicon-trashcan):not(.file-icon){ color: ${s} !important; }`)}this._styleElement.textContent=t}};Nr=(0,a.g)([(0,a.f)(1,I.XE),(0,a.f)(2,o.x4),(0,a.f)(3,o.Qy)],Nr);let Or=class{constructor(e,t,i){this._configurationService=e,this._hoverService=t,this._terminalGroupService=i,this._lastHoverHideTime=0,this.placement="element"}get delay(){return Date.now()-this._lastHoverHideTime<200?0:this._configurationService.getValue("workbench.hover.delay")}showHover(e,t){const i=this._terminalGroupService.activeInstance;if(!i)return;const n=pr(i);return this._hoverService.showHover({...e,content:n.content,actions:n.actions},t)}onDidHideHover(){this._lastHoverHideTime=Date.now()}};Or=(0,a.g)([(0,a.f)(0,v.Ui),(0,a.f)(1,Ui.B),(0,a.f)(2,o.Qy)],Or);var Hr=i(28194),Fr=i(90725);const Wr="\n- "+["`${cwd}`: "+(0,p.NC)("cwd","the terminal's current working directory"),"`${cwdFolder}`: "+(0,p.NC)("cwdFolder","the terminal's current working directory, displayed for multi-root workspaces or in a single root workspace when the value differs from the initial working directory. On Windows, this will only be displayed when shell integration is enabled."),"`${workspaceFolder}`: "+(0,p.NC)("workspaceFolder","the workspace in which the terminal was launched"),"`${local}`: "+(0,p.NC)("local","indicates a local terminal in a remote workspace"),"`${process}`: "+(0,p.NC)("process","the name of the terminal process"),"`${separator}`: "+(0,p.NC)("separator","a conditional separator {0} that only shows when surrounded by variables with values or static text.","(` - `)"),"`${sequence}`: "+(0,p.NC)("sequence","the name provided to the terminal by the process"),"`${task}`: "+(0,p.NC)("task","indicates this terminal is associated with a task")].join("\n- ");let Vr=(0,p.NC)("terminalTitle","Controls the terminal title. Variables are substituted based on the context:");Vr+=Wr;let $r=(0,p.NC)("terminalDescription","Controls the terminal description, which appears to the right of the title. Variables are substituted based on the context:");$r+=Wr;const Ur={id:"terminal",order:100,title:(0,p.NC)("terminalIntegratedConfigurationTitle","Integrated Terminal"),type:"object",properties:{"terminal.integrated.sendKeybindingsToShell":{markdownDescription:(0,p.NC)("terminal.integrated.sendKeybindingsToShell","Dispatches most keybindings to the terminal instead of the workbench, overriding {0}, which can be used alternatively for fine tuning.","`#terminal.integrated.commandsToSkipShell#`"),type:"boolean",default:!1},"terminal.integrated.tabs.defaultColor":{description:(0,p.NC)("terminal.integrated.tabs.defaultColor","A theme color ID to associate with terminal icons by default."),...Ms,scope:4},"terminal.integrated.tabs.defaultIcon":{description:(0,p.NC)("terminal.integrated.tabs.defaultIcon","A codicon ID to associate with terminal icons by default."),...Bs,default:R.lA.terminal.id,scope:4},"terminal.integrated.tabs.enabled":{description:(0,p.NC)("terminal.integrated.tabs.enabled","Controls whether terminal tabs display as a list to the side of the terminal. When this is disabled a dropdown will display instead."),type:"boolean",default:!0},"terminal.integrated.tabs.enableAnimation":{description:(0,p.NC)("terminal.integrated.tabs.enableAnimation","Controls whether terminal tab statuses support animation (eg. in progress tasks)."),type:"boolean",default:!0},"terminal.integrated.tabs.hideCondition":{description:(0,p.NC)("terminal.integrated.tabs.hideCondition","Controls whether the terminal tabs view will hide under certain conditions."),type:"string",enum:["never","singleTerminal","singleGroup"],enumDescriptions:[(0,p.NC)("terminal.integrated.tabs.hideCondition.never","Never hide the terminal tabs view"),(0,p.NC)("terminal.integrated.tabs.hideCondition.singleTerminal","Hide the terminal tabs view when there is only a single terminal opened"),(0,p.NC)("terminal.integrated.tabs.hideCondition.singleGroup","Hide the terminal tabs view when there is only a single terminal group opened")],default:"singleTerminal"},"terminal.integrated.tabs.showActiveTerminal":{description:(0,p.NC)("terminal.integrated.tabs.showActiveTerminal","Shows the active terminal information in the view. This is particularly useful when the title within the tabs aren't visible."),type:"string",enum:["always","singleTerminal","singleTerminalOrNarrow","never"],enumDescriptions:[(0,p.NC)("terminal.integrated.tabs.showActiveTerminal.always","Always show the active terminal"),(0,p.NC)("terminal.integrated.tabs.showActiveTerminal.singleTerminal","Show the active terminal when it is the only terminal opened"),(0,p.NC)("terminal.integrated.tabs.showActiveTerminal.singleTerminalOrNarrow","Show the active terminal when it is the only terminal opened or when the tabs view is in its narrow textless state"),(0,p.NC)("terminal.integrated.tabs.showActiveTerminal.never","Never show the active terminal")],default:"singleTerminalOrNarrow"},"terminal.integrated.tabs.showActions":{description:(0,p.NC)("terminal.integrated.tabs.showActions","Controls whether terminal split and kill buttons are displays next to the new terminal button."),type:"string",enum:["always","singleTerminal","singleTerminalOrNarrow","never"],enumDescriptions:[(0,p.NC)("terminal.integrated.tabs.showActions.always","Always show the actions"),(0,p.NC)("terminal.integrated.tabs.showActions.singleTerminal","Show the actions when it is the only terminal opened"),(0,p.NC)("terminal.integrated.tabs.showActions.singleTerminalOrNarrow","Show the actions when it is the only terminal opened or when the tabs view is in its narrow textless state"),(0,p.NC)("terminal.integrated.tabs.showActions.never","Never show the actions")],default:"singleTerminalOrNarrow"},"terminal.integrated.tabs.location":{type:"string",enum:["left","right"],enumDescriptions:[(0,p.NC)("terminal.integrated.tabs.location.left","Show the terminal tabs view to the left of the terminal"),(0,p.NC)("terminal.integrated.tabs.location.right","Show the terminal tabs view to the right of the terminal")],default:"right",description:(0,p.NC)("terminal.integrated.tabs.location","Controls the location of the terminal tabs, either to the left or right of the actual terminal(s).")},"terminal.integrated.tabFocusMode":{markdownDescription:(0,p.NC)("tabFocusMode","Controls whether the terminal receives tabs or defers them to the workbench for navigation. When set, this overrides {0} when the terminal is focused.","`#editor.tabFocusMode#`"),type:["boolean","null"],default:null},"terminal.integrated.defaultLocation":{type:"string",enum:["editor","view"],enumDescriptions:[(0,p.NC)("terminal.integrated.defaultLocation.editor","Create terminals in the editor"),(0,p.NC)("terminal.integrated.defaultLocation.view","Create terminals in the terminal view")],default:"view",description:(0,p.NC)("terminal.integrated.defaultLocation","Controls where newly created terminals will appear.")},"terminal.integrated.tabs.focusMode":{type:"string",enum:["singleClick","doubleClick"],enumDescriptions:[(0,p.NC)("terminal.integrated.tabs.focusMode.singleClick","Focus the terminal when clicking a terminal tab"),(0,p.NC)("terminal.integrated.tabs.focusMode.doubleClick","Focus the terminal when double-clicking a terminal tab")],default:"doubleClick",description:(0,p.NC)("terminal.integrated.tabs.focusMode","Controls whether focusing the terminal of a tab happens on double or single click.")},"terminal.integrated.macOptionIsMeta":{description:(0,p.NC)("terminal.integrated.macOptionIsMeta","Controls whether to treat the option key as the meta key in the terminal on macOS."),type:"boolean",default:!1},"terminal.integrated.macOptionClickForcesSelection":{description:(0,p.NC)("terminal.integrated.macOptionClickForcesSelection","Controls whether to force selection when using Option+click on macOS. This will force a regular (line) selection and disallow the use of column selection mode. This enables copying and pasting using the regular terminal selection, for example, when mouse mode is enabled in tmux."),type:"boolean",default:!1},"terminal.integrated.altClickMovesCursor":{markdownDescription:(0,p.NC)("terminal.integrated.altClickMovesCursor","If enabled, alt/option + click will reposition the prompt cursor to underneath the mouse when {0} is set to {1} (the default value). This may not work reliably depending on your shell.","`#editor.multiCursorModifier#`","`'alt'`"),type:"boolean",default:!0},"terminal.integrated.copyOnSelection":{description:(0,p.NC)("terminal.integrated.copyOnSelection","Controls whether text selected in the terminal will be copied to the clipboard."),type:"boolean",default:!1},"terminal.integrated.enableMultiLinePasteWarning":{markdownDescription:(0,p.NC)("terminal.integrated.enableMultiLinePasteWarning","Show a warning dialog when pasting multiple lines into the terminal. The dialog does not show when:\n\n- Bracketed paste mode is enabled (the shell supports multi-line paste natively)\n- The paste is handled by the shell's readline (in the case of pwsh)"),type:"boolean",default:!0},"terminal.integrated.drawBoldTextInBrightColors":{description:(0,p.NC)("terminal.integrated.drawBoldTextInBrightColors",'Controls whether bold text in the terminal will always use the "bright" ANSI color variant.'),type:"boolean",default:!0},"terminal.integrated.fontFamily":{markdownDescription:(0,p.NC)("terminal.integrated.fontFamily","Controls the font family of the terminal. Defaults to {0}'s value.","`#editor.fontFamily#`"),type:"string"},"terminal.integrated.fontSize":{description:(0,p.NC)("terminal.integrated.fontSize","Controls the font size in pixels of the terminal."),type:"number",default:_.dz?12:14,minimum:6,maximum:100},"terminal.integrated.letterSpacing":{description:(0,p.NC)("terminal.integrated.letterSpacing","Controls the letter spacing of the terminal. This is an integer value which represents the number of additional pixels to add between characters."),type:"number",default:r.dd},"terminal.integrated.lineHeight":{description:(0,p.NC)("terminal.integrated.lineHeight","Controls the line height of the terminal. This number is multiplied by the terminal font size to get the actual line-height in pixels."),type:"number",default:r.fr},"terminal.integrated.minimumContrastRatio":{markdownDescription:(0,p.NC)("terminal.integrated.minimumContrastRatio","When set, the foreground color of each cell will change to try meet the contrast ratio specified. Note that this will not apply to `powerline` characters per #146406. Example values:\n\n- 1: Do nothing and use the standard theme colors.\n- 4.5: [WCAG AA compliance (minimum)](https://www.w3.org/TR/UNDERSTANDING-WCAG20/visual-audio-contrast-contrast.html) (default).\n- 7: [WCAG AAA compliance (enhanced)](https://www.w3.org/TR/UNDERSTANDING-WCAG20/visual-audio-contrast7.html).\n- 21: White on black or black on white."),type:"number",default:4.5,tags:["accessibility"]},"terminal.integrated.tabStopWidth":{markdownDescription:(0,p.NC)("terminal.integrated.tabStopWidth","The number of cells in a tab stop."),type:"number",minimum:1,default:8},"terminal.integrated.fastScrollSensitivity":{markdownDescription:(0,p.NC)("terminal.integrated.fastScrollSensitivity","Scrolling speed multiplier when pressing `Alt`."),type:"number",default:5},"terminal.integrated.mouseWheelScrollSensitivity":{markdownDescription:(0,p.NC)("terminal.integrated.mouseWheelScrollSensitivity","A multiplier to be used on the `deltaY` of mouse wheel scroll events."),type:"number",default:1},"terminal.integrated.bellDuration":{markdownDescription:(0,p.NC)("terminal.integrated.bellDuration","The number of milliseconds to show the bell within a terminal tab when triggered."),type:"number",default:1e3},"terminal.integrated.fontWeight":{anyOf:[{type:"number",minimum:r.fc,maximum:r.ig,errorMessage:(0,p.NC)("terminal.integrated.fontWeightError",'Only "normal" and "bold" keywords or numbers between 1 and 1000 are allowed.')},{type:"string",pattern:"^(normal|bold|1000|[1-9][0-9]{0,2})$"},{enum:r.oE}],description:(0,p.NC)("terminal.integrated.fontWeight",'The font weight to use within the terminal for non-bold text. Accepts "normal" and "bold" keywords or numbers between 1 and 1000.'),default:"normal"},"terminal.integrated.fontWeightBold":{anyOf:[{type:"number",minimum:r.fc,maximum:r.ig,errorMessage:(0,p.NC)("terminal.integrated.fontWeightError",'Only "normal" and "bold" keywords or numbers between 1 and 1000 are allowed.')},{type:"string",pattern:"^(normal|bold|1000|[1-9][0-9]{0,2})$"},{enum:r.oE}],description:(0,p.NC)("terminal.integrated.fontWeightBold",'The font weight to use within the terminal for bold text. Accepts "normal" and "bold" keywords or numbers between 1 and 1000.'),default:"bold"},"terminal.integrated.cursorBlinking":{description:(0,p.NC)("terminal.integrated.cursorBlinking","Controls whether the terminal cursor blinks."),type:"boolean",default:!1},"terminal.integrated.cursorStyle":{description:(0,p.NC)("terminal.integrated.cursorStyle","Controls the style of terminal cursor."),enum:[r.CW.BLOCK,r.CW.LINE,r.CW.UNDERLINE],default:r.CW.BLOCK},"terminal.integrated.cursorWidth":{markdownDescription:(0,p.NC)("terminal.integrated.cursorWidth","Controls the width of the cursor when {0} is set to {1}.","`#terminal.integrated.cursorStyle#`","`line`"),type:"number",default:1},"terminal.integrated.scrollback":{description:(0,p.NC)("terminal.integrated.scrollback","Controls the maximum number of lines the terminal keeps in its buffer. We pre-allocate memory based on this value in order to ensure a smooth experience. As such, as the value increases, so will the amount of memory."),type:"number",default:1e3},"terminal.integrated.detectLocale":{markdownDescription:(0,p.NC)("terminal.integrated.detectLocale","Controls whether to detect and set the `$LANG` environment variable to a UTF-8 compliant option since VS Code's terminal only supports UTF-8 encoded data coming from the shell."),type:"string",enum:["auto","off","on"],markdownEnumDescriptions:[(0,p.NC)("terminal.integrated.detectLocale.auto","Set the `$LANG` environment variable if the existing variable does not exist or it does not end in `'.UTF-8'`."),(0,p.NC)("terminal.integrated.detectLocale.off","Do not set the `$LANG` environment variable."),(0,p.NC)("terminal.integrated.detectLocale.on","Always set the `$LANG` environment variable.")],default:"auto"},"terminal.integrated.gpuAcceleration":{type:"string",enum:["auto","on","off","canvas"],markdownEnumDescriptions:[(0,p.NC)("terminal.integrated.gpuAcceleration.auto","Let VS Code detect which renderer will give the best experience."),(0,p.NC)("terminal.integrated.gpuAcceleration.on","Enable GPU acceleration within the terminal."),(0,p.NC)("terminal.integrated.gpuAcceleration.off","Disable GPU acceleration within the terminal. The terminal will render much slower when GPU acceleration is off but it should reliably work on all systems."),(0,p.NC)("terminal.integrated.gpuAcceleration.canvas","Use the terminal's fallback canvas renderer which uses a 2d context instead of webgl which may perform better on some systems. Note that some features are limited in the canvas renderer like opaque selection.")],default:"auto",description:(0,p.NC)("terminal.integrated.gpuAcceleration","Controls whether the terminal will leverage the GPU to do its rendering.")},"terminal.integrated.tabs.separator":{type:"string",default:" - ",markdownDescription:(0,p.NC)("terminal.integrated.tabs.separator","Separator used by {0} and {0}.","`terminal.integrated.tabs.title`","`terminal.integrated.tabs.description`")},"terminal.integrated.tabs.title":{type:"string",default:"${process}",markdownDescription:Vr},"terminal.integrated.tabs.description":{type:"string",default:"${task}${separator}${local}${separator}${cwdFolder}",markdownDescription:$r},"terminal.integrated.rightClickBehavior":{type:"string",enum:["default","copyPaste","paste","selectWord","nothing"],enumDescriptions:[(0,p.NC)("terminal.integrated.rightClickBehavior.default","Show the context menu."),(0,p.NC)("terminal.integrated.rightClickBehavior.copyPaste","Copy when there is a selection, otherwise paste."),(0,p.NC)("terminal.integrated.rightClickBehavior.paste","Paste on right click."),(0,p.NC)("terminal.integrated.rightClickBehavior.selectWord","Select the word under the cursor and show the context menu."),(0,p.NC)("terminal.integrated.rightClickBehavior.nothing","Do nothing and pass event to terminal.")],default:_.dz?"selectWord":_.ED?"copyPaste":"default",description:(0,p.NC)("terminal.integrated.rightClickBehavior","Controls how terminal reacts to right click.")},"terminal.integrated.cwd":{restricted:!0,description:(0,p.NC)("terminal.integrated.cwd","An explicit start path where the terminal will be launched, this is used as the current working directory (cwd) for the shell process. This may be particularly useful in workspace settings if the root directory is not a convenient cwd."),type:"string",default:void 0,scope:4},"terminal.integrated.confirmOnExit":{description:(0,p.NC)("terminal.integrated.confirmOnExit","Controls whether to confirm when the window closes if there are active terminal sessions."),type:"string",enum:["never","always","hasChildProcesses"],enumDescriptions:[(0,p.NC)("terminal.integrated.confirmOnExit.never","Never confirm."),(0,p.NC)("terminal.integrated.confirmOnExit.always","Always confirm if there are terminals."),(0,p.NC)("terminal.integrated.confirmOnExit.hasChildProcesses","Confirm if there are any terminals that have child processes.")],default:"never"},"terminal.integrated.confirmOnKill":{description:(0,p.NC)("terminal.integrated.confirmOnKill","Controls whether to confirm killing terminals when they have child processes. When set to editor, terminals in the editor area will be marked as changed when they have child processes. Note that child process detection may not work well for shells like Git Bash which don't run their processes as child processes of the shell."),type:"string",enum:["never","editor","panel","always"],enumDescriptions:[(0,p.NC)("terminal.integrated.confirmOnKill.never","Never confirm."),(0,p.NC)("terminal.integrated.confirmOnKill.editor","Confirm if the terminal is in the editor."),(0,p.NC)("terminal.integrated.confirmOnKill.panel","Confirm if the terminal is in the panel."),(0,p.NC)("terminal.integrated.confirmOnKill.always","Confirm if the terminal is either in the editor or panel.")],default:"editor"},"terminal.integrated.enableBell":{description:(0,p.NC)("terminal.integrated.enableBell","Controls whether the terminal bell is enabled. This shows up as a visual bell next to the terminal's name."),type:"boolean",default:!1},"terminal.integrated.commandsToSkipShell":{markdownDescription:(0,p.NC)("terminal.integrated.commandsToSkipShell","A set of command IDs whose keybindings will not be sent to the shell but instead always be handled by VS Code. This allows keybindings that would normally be consumed by the shell to act instead the same as when the terminal is not focused, for example `Ctrl+P` to launch Quick Open.\n\n&nbsp;\n\nMany commands are skipped by default. To override a default and pass that command's keybinding to the shell instead, add the command prefixed with the `-` character. For example add `-workbench.action.quickOpen` to allow `Ctrl+P` to reach the shell.\n\n&nbsp;\n\nThe following list of default skipped commands is truncated when viewed in Settings Editor. To see the full list, {1} and search for the first command from the list below.\n\n&nbsp;\n\nDefault Skipped Commands:\n\n{0}",r.Vq.sort().map((e=>`- ${e}`)).join("\n"),`[${(0,p.NC)("openDefaultSettingsJson","open the default settings JSON")}](command:workbench.action.openRawDefaultSettings '${(0,p.NC)("openDefaultSettingsJson.capitalized","Open Default Settings (JSON)")}')`),type:"array",items:{type:"string"},default:[]},"terminal.integrated.allowChords":{markdownDescription:(0,p.NC)("terminal.integrated.allowChords","Whether or not to allow chord keybindings in the terminal. Note that when this is true and the keystroke results in a chord it will bypass {0}, setting this to false is particularly useful when you want ctrl+k to go to your shell (not VS Code).","`#terminal.integrated.commandsToSkipShell#`"),type:"boolean",default:!0},"terminal.integrated.allowMnemonics":{markdownDescription:(0,p.NC)("terminal.integrated.allowMnemonics","Whether to allow menubar mnemonics (for example Alt+F) to trigger the open of the menubar. Note that this will cause all alt keystrokes to skip the shell when true. This does nothing on macOS."),type:"boolean",default:!1},"terminal.integrated.env.osx":{restricted:!0,markdownDescription:(0,p.NC)("terminal.integrated.env.osx","Object with environment variables that will be added to the VS Code process to be used by the terminal on macOS. Set to `null` to delete the environment variable."),type:"object",additionalProperties:{type:["string","null"]},default:{}},"terminal.integrated.env.linux":{restricted:!0,markdownDescription:(0,p.NC)("terminal.integrated.env.linux","Object with environment variables that will be added to the VS Code process to be used by the terminal on Linux. Set to `null` to delete the environment variable."),type:"object",additionalProperties:{type:["string","null"]},default:{}},"terminal.integrated.env.windows":{restricted:!0,markdownDescription:(0,p.NC)("terminal.integrated.env.windows","Object with environment variables that will be added to the VS Code process to be used by the terminal on Windows. Set to `null` to delete the environment variable."),type:"object",additionalProperties:{type:["string","null"]},default:{}},"terminal.integrated.environmentChangesIndicator":{markdownDescription:(0,p.NC)("terminal.integrated.environmentChangesIndicator","Whether to display the environment changes indicator on each terminal which explains whether extensions have made, or want to make changes to the terminal's environment."),type:"string",enum:["off","on","warnonly"],enumDescriptions:[(0,p.NC)("terminal.integrated.environmentChangesIndicator.off","Disable the indicator."),(0,p.NC)("terminal.integrated.environmentChangesIndicator.on","Enable the indicator."),(0,p.NC)("terminal.integrated.environmentChangesIndicator.warnonly","Only show the warning indicator when a terminal's environment is 'stale', not the information indicator that shows a terminal has had its environment modified by an extension.")],default:"warnonly"},"terminal.integrated.environmentChangesRelaunch":{markdownDescription:(0,p.NC)("terminal.integrated.environmentChangesRelaunch","Whether to relaunch terminals automatically if extension want to contribute to their environment and have not been interacted with yet."),type:"boolean",default:!0},"terminal.integrated.showExitAlert":{description:(0,p.NC)("terminal.integrated.showExitAlert",'Controls whether to show the alert "The terminal process terminated with exit code" when exit code is non-zero.'),type:"boolean",default:!0},"terminal.integrated.splitCwd":{description:(0,p.NC)("terminal.integrated.splitCwd","Controls the working directory a split terminal starts with."),type:"string",enum:["workspaceRoot","initial","inherited"],enumDescriptions:[(0,p.NC)("terminal.integrated.splitCwd.workspaceRoot","A new split terminal will use the workspace root as the working directory. In a multi-root workspace a choice for which root folder to use is offered."),(0,p.NC)("terminal.integrated.splitCwd.initial","A new split terminal will use the working directory that the parent terminal started with."),(0,p.NC)("terminal.integrated.splitCwd.inherited","On macOS and Linux, a new split terminal will use the working directory of the parent terminal. On Windows, this behaves the same as initial.")],default:"inherited"},"terminal.integrated.windowsEnableConpty":{description:(0,p.NC)("terminal.integrated.windowsEnableConpty","Whether to use ConPTY for Windows terminal process communication (requires Windows 10 build number 18309+). Winpty will be used if this is false."),type:"boolean",default:!0},"terminal.integrated.wordSeparators":{markdownDescription:(0,p.NC)("terminal.integrated.wordSeparators","A string containing all characters to be considered word separators when double-clicking to select word and in the fallback 'word' link detection. Since this is used for link detection, including characters such as `:` that are used when detecting links will cause the line and column part of links like `file:10:5` to be ignored."),type:"string",default:" ()[]{}',\"`─‘’|"},"terminal.integrated.enableFileLinks":{description:(0,p.NC)("terminal.integrated.enableFileLinks","Whether to enable file links in terminals. Links can be slow when working on a network drive in particular because each file link is verified against the file system. Changing this will take effect only in new terminals."),type:"string",enum:["off","on","notRemote"],enumDescriptions:[(0,p.NC)("enableFileLinks.off","Always off."),(0,p.NC)("enableFileLinks.on","Always on."),(0,p.NC)("enableFileLinks.notRemote","Enable only when not in a remote workspace.")],default:"on"},"terminal.integrated.unicodeVersion":{type:"string",enum:["6","11"],enumDescriptions:[(0,p.NC)("terminal.integrated.unicodeVersion.six","Version 6 of Unicode. This is an older version which should work better on older systems."),(0,p.NC)("terminal.integrated.unicodeVersion.eleven","Version 11 of Unicode. This version provides better support on modern systems that use modern versions of Unicode.")],default:"11",description:(0,p.NC)("terminal.integrated.unicodeVersion","Controls what version of Unicode to use when evaluating the width of characters in the terminal. If you experience emoji or other wide characters not taking up the right amount of space or backspace either deleting too much or too little then you may want to try tweaking this setting.")},"terminal.integrated.localEchoLatencyThreshold":{description:(0,p.NC)("terminal.integrated.localEchoLatencyThreshold","Length of network delay, in milliseconds, where local edits will be echoed on the terminal without waiting for server acknowledgement. If '0', local echo will always be on, and if '-1' it will be disabled."),type:"integer",minimum:-1,default:30},"terminal.integrated.localEchoEnabled":{markdownDescription:(0,p.NC)("terminal.integrated.localEchoEnabled","When local echo should be enabled. This will override {0}","`#terminal.integrated.localEchoLatencyThreshold#`"),type:"string",enum:["on","off","auto"],enumDescriptions:[(0,p.NC)("terminal.integrated.localEchoEnabled.on","Always enabled"),(0,p.NC)("terminal.integrated.localEchoEnabled.off","Always disabled"),(0,p.NC)("terminal.integrated.localEchoEnabled.auto","Enabled only for remote workspaces")],default:"auto"},"terminal.integrated.localEchoExcludePrograms":{description:(0,p.NC)("terminal.integrated.localEchoExcludePrograms","Local echo will be disabled when any of these program names are found in the terminal title."),type:"array",items:{type:"string",uniqueItems:!0},default:r.gM},"terminal.integrated.localEchoStyle":{description:(0,p.NC)("terminal.integrated.localEchoStyle","Terminal style of locally echoed text; either a font style or an RGB color."),default:"dim",oneOf:[{type:"string",default:"dim",enum:["bold","dim","italic","underlined","inverted"]},{type:"string",format:"color-hex",default:"#ff0000"}]},"terminal.integrated.enablePersistentSessions":{description:(0,p.NC)("terminal.integrated.enablePersistentSessions","Persist terminal sessions/history for the workspace across window reloads."),type:"boolean",default:!0},"terminal.integrated.persistentSessionReviveProcess":{markdownDescription:(0,p.NC)("terminal.integrated.persistentSessionReviveProcess","When the terminal process must be shut down (for example on window or application close), this determines when the previous terminal session contents/history should be restored and processes be recreated when the workspace is next opened.\n\nCaveats:\n\n- Restoring of the process current working directory depends on whether it is supported by the shell.\n- Time to persist the session during shutdown is limited, so it may be aborted when using high-latency remote connections."),type:"string",enum:["onExit","onExitAndWindowClose","never"],markdownEnumDescriptions:[(0,p.NC)("terminal.integrated.persistentSessionReviveProcess.onExit","Revive the processes after the last window is closed on Windows/Linux or when the `workbench.action.quit` command is triggered (command palette, keybinding, menu)."),(0,p.NC)("terminal.integrated.persistentSessionReviveProcess.onExitAndWindowClose","Revive the processes after the last window is closed on Windows/Linux or when the `workbench.action.quit` command is triggered (command palette, keybinding, menu), or when the window is closed."),(0,p.NC)("terminal.integrated.persistentSessionReviveProcess.never","Never restore the terminal buffers or recreate the process.")],default:"onExit"},"terminal.integrated.customGlyphs":{description:(0,p.NC)("terminal.integrated.customGlyphs","Whether to draw custom glyphs for block element and box drawing characters instead of using the font, which typically yields better rendering with continuous lines. Note that this doesn't work when {0} is disabled.","`#terminal.integrated.gpuAcceleration#`"),type:"boolean",default:!0},"terminal.integrated.autoReplies":{markdownDescription:(0,p.NC)("terminal.integrated.autoReplies","A set of messages that, when encountered in the terminal, will be automatically responded to. Provided the message is specific enough, this can help automate away common responses.\n\nRemarks:\n\n- Use {0} to automatically respond to the terminate batch job prompt on Windows.\n- The message includes escape sequences so the reply might not happen with styled text.\n- Each reply can only happen once every second.\n- Use {1} in the reply to mean the enter key.\n- To unset a default key, set the value to null.\n- Restart VS Code if new don't apply.",'`"Terminate batch job (Y/N)": "Y\\r"`','`"\\r"`'),type:"object",additionalProperties:{oneOf:[{type:"string",description:(0,p.NC)("terminal.integrated.autoReplies.reply","The reply to send to the process.")},{type:"null"}]},default:{}},"terminal.integrated.shellIntegration.enabled":{restricted:!0,markdownDescription:(0,p.NC)("terminal.integrated.shellIntegration.enabled","Determines whether or not shell integration is auto-injected to support features like enhanced command tracking and current working directory detection. \n\nShell integration works by injecting the shell with a startup script. The script gives VS Code insight into what is happening within the terminal.\n\nSupported shells:\n\n- Linux/macOS: bash, fish, pwsh, zsh\n - Windows: pwsh\n\nThis setting applies only when terminals are created, so you will need to restart your terminals for it to take effect.\n\n Note that the script injection may not work if you have custom arguments defined in the terminal profile, have enabled {1}, have a [complex bash `PROMPT_COMMAND`](https://code.visualstudio.com/docs/editor/integrated-terminal#_complex-bash-promptcommand), or other unsupported setup. To disable decorations, see {0}","`#terminal.integrated.shellIntegrations.decorationsEnabled#`","`#editor.accessibilitySupport#`"),type:"boolean",default:!0},"terminal.integrated.shellIntegration.decorationsEnabled":{restricted:!0,markdownDescription:(0,p.NC)("terminal.integrated.shellIntegration.decorationsEnabled","When shell integration is enabled, adds a decoration for each command."),type:"string",enum:["both","gutter","overviewRuler","never"],enumDescriptions:[(0,p.NC)("terminal.integrated.shellIntegration.decorationsEnabled.both","Show decorations in the gutter (left) and overview ruler (right)"),(0,p.NC)("terminal.integrated.shellIntegration.decorationsEnabled.gutter","Show gutter decorations to the left of the terminal"),(0,p.NC)("terminal.integrated.shellIntegration.decorationsEnabled.overviewRuler","Show overview ruler decorations to the right of the terminal"),(0,p.NC)("terminal.integrated.shellIntegration.decorationsEnabled.never","Do not show decorations")],default:"both"},"terminal.integrated.shellIntegration.history":{restricted:!0,markdownDescription:(0,p.NC)("terminal.integrated.shellIntegration.history","Controls the number of recently used commands to keep in the terminal command history. Set to 0 to disable terminal command history."),type:"number",default:100},"terminal.integrated.shellIntegration.suggestEnabled":{restricted:!0,markdownDescription:(0,p.NC)("terminal.integrated.shellIntegration.suggestEnabled","Enables experimental terminal Intellisense suggestions for supported shells when {0} is set to {1}. If shell integration is installed manually, {2} needs to be set to {3} before calling the script.","`#terminal.integrated.shellIntegration.enabled#`","`true`","`VSCODE_SUGGEST`","`1`"),type:"boolean",default:!1},"terminal.integrated.smoothScrolling":{markdownDescription:(0,p.NC)("terminal.integrated.smoothScrolling","Controls whether the terminal will scroll using an animation."),type:"boolean",default:!1},"terminal.integrated.enableImages":{restricted:!0,markdownDescription:(0,p.NC)("terminal.integrated.enableImages","Enables image support in the terminal, this will only work when {0} is enabled. Both sixel and iTerm's inline image protocol are supported on Linux and macOS, Windows support will light up automatically when ConPTY passes through the sequences. Images will currently not be restored between window reloads/reconnects.","`#terminal.integrated.gpuAcceleration#`"),type:"boolean",default:!0}}};var Gr=i(41122),zr=i(83240),Kr=i(23627);let qr=class extends Kr.J{constructor(e,t,i,n,s,r,a,c,l,h,d,u,m){super(o.VR,e,t,i),this._terminalEditorService=n,this._terminalProfileResolverService=s,this._terminalService=r,this._instantiationService=l,this._contextMenuService=h,this._notificationService=d,this._terminalProfileService=u,this._workbenchLayoutService=m,this._editorInput=void 0,this._cancelContextMenu=!1,this._dropdownMenu=this._register(c.createMenu(H.eH.TerminalNewDropdownContext,a)),this._instanceMenu=this._register(c.createMenu(H.eH.TerminalEditorInstanceContext,a))}async setInput(e,t,i,n){this._editorInput?.terminalInstance?.detachFromElement(),this._editorInput=e,await super.setInput(e,t,i,n),this._editorInput.terminalInstance?.attachToElement(this._overflowGuardElement),this._lastDimension&&this.layout(this._lastDimension),this._editorInput.terminalInstance?.setVisible(this.isVisible()&&this._workbenchLayoutService.isVisible("workbench.parts.editor")),this._editorInput.terminalInstance&&(this._register(this._editorInput.terminalInstance.onDidFocus((()=>this._setActiveInstance()))),this._editorInput.setCopyLaunchConfig(this._editorInput.terminalInstance.shellLaunchConfig))}clearInput(){super.clearInput(),this._editorInput?.terminalInstance?.detachFromElement(),this._editorInput=void 0}_setActiveInstance(){this._editorInput?.terminalInstance&&this._terminalEditorService.setActiveInstance(this._editorInput.terminalInstance)}focus(){this._editorInput?.terminalInstance?.focus()}createEditor(e){this._editorInstanceElement=e,this._overflowGuardElement=c.$(".terminal-overflow-guard.terminal-editor"),this._editorInstanceElement.appendChild(this._overflowGuardElement),this._registerListeners()}_registerListeners(){this._editorInstanceElement&&(this._register(c.nm(this._editorInstanceElement,"mousedown",(async e=>{if(0!==this._terminalEditorService.instances.length)if(2===e.which&&_.IJ){const e=this._terminalEditorService.activeInstance;e?.focus()}else if(3===e.which){const t=this._terminalService.configHelper.config.rightClickBehavior;if("nothing"===t)return void(e.shiftKey||(this._cancelContextMenu=!0));if("copyPaste"===t||"paste"===t){const i=this._terminalEditorService.activeInstance;if(!i)return;if("copyPaste"===t&&e.shiftKey)return void xr(e,this._editorInstanceElement,this._instanceMenu,this._contextMenuService);"copyPaste"===t&&i.hasSelection()?(await i.copySelection(),i.clearSelection()):L.D.clipboard.readText?i.paste():this._notificationService.info(`This browser doesn't support the clipboard.readText API needed to trigger a paste, try ${_.dz?"⌘":"Ctrl"}+V instead.`),_.dz&&setTimeout((()=>{i.clearSelection()}),0),this._cancelContextMenu=!0}}}))),this._register(c.nm(this._editorInstanceElement,"contextmenu",(e=>{const t=this._terminalService.configHelper.config.rightClickBehavior;if("nothing"===t&&!e.shiftKey)return e.preventDefault(),e.stopImmediatePropagation(),void(this._cancelContextMenu=!1);this._cancelContextMenu||"copyPaste"===t||"paste"===t||(this._cancelContextMenu||xr(e,this._editorInstanceElement,this._instanceMenu,this._contextMenuService),e.preventDefault(),e.stopImmediatePropagation(),this._cancelContextMenu=!1)}))))}layout(e){this._editorInput?.terminalInstance?.layout(e),this._lastDimension=e}setVisible(e,t){super.setVisible(e,t),this._editorInput?.terminalInstance?.setVisible(e&&this._workbenchLayoutService.isVisible("workbench.parts.editor"))}getActionViewItem(e){if("workbench.action.createTerminalEditor"===e.id&&e instanceof H.U8){const t=Ar({viewColumn:ae.LP},this._terminalProfileService.availableProfiles,this._getDefaultProfileName(),this._terminalProfileService.contributedProfiles,this._terminalService,this._dropdownMenu);return this._instantiationService.createInstance(Tr.C,e,t.dropdownAction,t.dropdownMenuActions,t.className,this._contextMenuService,{})}return super.getActionViewItem(e)}_getDefaultProfileName(){let e;try{e=this._terminalProfileService.getDefaultProfileName()}catch(t){e=this._terminalProfileResolverService.defaultProfileName}return e}};qr=(0,a.g)([(0,a.f)(0,Ft.bU),(0,a.f)(1,I.XE),(0,a.f)(2,ke.Uy),(0,a.f)(3,o.BZ),(0,a.f)(4,r.if),(0,a.f)(5,o.x4),(0,a.f)(6,b.i6),(0,a.f)(7,H.co),(0,a.f)(8,S.TG),(0,a.f)(9,ut.i),(0,a.f)(10,w.lT),(0,a.f)(11,r.l5),(0,a.f)(12,ms.ze)],qr);var jr=i(63809),Qr=i(32049),Xr=i(45089);let Jr=class extends u.JT{constructor(e,t,i,n,r,a,c){super(),e.registerEditor(`${m.lg.vscodeTerminal}:/**`,{id:o.VR,label:oe.terminal,priority:Qr.OP.exclusive},{canSupportResource:e=>e.scheme===m.lg.vscodeTerminal,singlePerResource:!0},{createEditorInput:async({resource:e,options:t})=>{let i=n.getInstanceFromResource(e);if(i){const e=a.getGroupForInstance(i);e?.removeInstance(i)}else{const t=_i(e);if(!t.instanceId)throw new Error("Terminal identifier without instanceId");const r=n.getPrimaryBackend();if(!r)throw new Error("No terminal primary backend");const o=await r.requestDetachInstance(t.workspaceId,t.instanceId);if(!o)throw new Error("No terminal persistent process to attach");i=c.createInstance({attachPersistentProcess:o},s.i2.Editor)}const l=r.resolveResource(i);return{editor:r.getInputFromResource(l),options:{...t,pinned:!0,forceReload:!0,override:o.VR}}}}),i.registerFormatter({scheme:m.lg.vscodeTerminal,formatting:{label:"${path}",separator:""}}),t.onDidCreateTerminal((async e=>{const t=await n.createTerminal({config:e,location:s.i2.Panel});n.setActiveInstance(t),await n.revealActiveTerminal()}))}};Jr=(0,a.g)([(0,a.f)(0,Qr.es),(0,a.f)(1,Xr.b),(0,a.f)(2,F.e),(0,a.f)(3,o.x4),(0,a.f)(4,o.BZ),(0,a.f)(5,o.Qy),(0,a.f)(6,o.N4)],Jr),Ln.B.as(Fr.IP.Quickaccess).registerQuickAccessProvider({ctor:le,prefix:le.PREFIX,contextKey:"inTerminalPicker",placeholder:p.NC("tasksQuickAccessPlaceholder","Type the name of a terminal to open."),helpEntries:[{description:p.NC("tasksQuickAccessHelp","Show All Opened Terminals"),commandId:"workbench.action.quickOpenTerm"}]});const Yr="workbench.action.quickOpenNavigateNextInTerminalPicker";f.P.registerCommand({id:Yr,handler:(0,ar.x8)(Yr,!0)});const Zr="workbench.action.quickOpenNavigatePreviousInTerminalPicker";f.P.registerCommand({id:Zr,handler:(0,ar.x8)(Zr,!1)}),Ln.B.as(jr.I.Workbench).registerWorkbenchContribution(Jr,3),Ln.B.as(Rs.IP.Configuration).registerConfiguration(Ws),$s(),Ln.B.as(Rs.IP.Configuration).registerConfiguration(Ur),Ln.B.as(Gr.bS.EditorPane).registerEditorPane(zr.gS.create(qr,o.VR,oe.terminal),[new n.M(ui.S)]),Ln.B.as(In.IP.DragAndDropContribution).register({dataFormatKey:"Terminals",getEditorInputs(e){const t=[];try{const i=JSON.parse(e);for(const e of i)t.push({resource:g.ov.parse(e)})}catch(e){}return t},setData(e,t){const i=e.filter((({resource:e})=>e.scheme===m.lg.vscodeTerminal));i.length&&t.dataTransfer?.setData("Terminals",JSON.stringify(i.map((({resource:e})=>e.toString()))))}});const eo=Ln.B.as(A.IP.ViewContainersRegistry).registerViewContainer({id:r.e9,title:p.NC("terminal","Terminal"),icon:q,ctorDescriptor:new n.M(Hr.XV,[r.e9,{mergeViewWithContainerWhenSingleView:!0}]),storageId:r.e9,hideIfEmpty:!0,order:3},1,{doNotRegisterOpenCommand:!0,isDefault:!0});function to(e,t){or.W.registerCommandAndKeybindingRule({id:"workbench.action.terminal.sendSequence",weight:200,when:t.when||he.r.focus,primary:t.primary,mac:t.mac,linux:t.linux,win:t.win,handler:Ke,args:{text:e}})}Ln.B.as(A.IP.ViewsRegistry).registerViews([{id:r.e9,name:p.NC("terminal","Terminal"),containerIcon:q,canToggleVisibility:!1,canMoveView:!0,ctorDescriptor:new n.M(Lr),openCommandActionDescriptor:{id:"workbench.action.terminal.toggleTerminal",mnemonicTitle:p.NC({key:"miToggleIntegratedTerminal",comment:["&& denotes a mnemonic"]},"&&Terminal"),keybindings:{primary:2139,mac:{primary:347}},order:3}}],eo),Qe({id:"workbench.action.terminal.newInActiveWorkspace",title:{value:(0,p.NC)("workbench.action.terminal.newInActiveWorkspace","Create New Terminal (In Active Workspace)"),original:"Create New Terminal (In Active Workspace)"},run:async e=>{if(e.service.isProcessSupportRegistered){const t=await e.service.createTerminal({location:e.service.defaultLocation});if(!t)return;e.service.setActiveInstance(t)}await e.groupService.showPanel(!0)}}),tt([]),Qe({id:"workbench.action.createTerminalEditor",title:{value:(0,p.NC)("workbench.action.terminal.createTerminalEditor","Create New Terminal in Editor Area"),original:"Create New Terminal in Editor Area"},run:async(e,t,i)=>{const n=(0,B.Kn)(i)&&"location"in i?i:{location:s.i2.Editor};(await e.service.createTerminal(n)).focusWhenReady()}}),Qe({id:"workbench.action.createTerminalEditorSameGroup",title:{value:(0,p.NC)("workbench.action.terminal.createTerminalEditor","Create New Terminal in Editor Area"),original:"Create New Terminal in Editor Area"},f1:!1,run:async(e,t,i)=>{const n=t.get(We.Qw);(await e.service.createTerminal({location:{viewColumn:n.activeGroup.index}})).focusWhenReady()}}),Qe({id:"workbench.action.createTerminalEditorSide",title:{value:(0,p.NC)("workbench.action.terminal.createTerminalEditorSide","Create New Terminal in Editor Area to the Side"),original:"Create New Terminal in Editor Area to the Side"},run:async e=>{(await e.service.createTerminal({location:{viewColumn:ae.O3}})).focusWhenReady()}}),Xe({id:"workbench.action.terminal.moveToEditor",title:oe.moveToEditor,precondition:b.Ao.and(b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),he.r.terminalEditorActive.toNegated(),he.r.viewShowing),run:(e,t)=>t.service.moveToEditor(e)}),Qe({id:"workbench.action.terminal.moveToEditorInstance",title:oe.moveToEditor,f1:!1,precondition:b.Ao.and(b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),he.r.isOpen),run:async(e,t)=>{const i=Ze(t);if(i&&0!==i.length){for(const t of i)e.service.moveToEditor(t);i[i.length-1].focus()}}}),Qe({id:"workbench.action.terminal.moveToTerminalPanel",title:oe.moveToTerminalPanel,precondition:b.Ao.and(b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),he.r.terminalEditorActive),run:(e,t,i)=>{const n=rt(i)??e.editorService.activeInstance;n&&e.service.moveToTerminalView(n)}}),Qe({id:"workbench.action.terminal.showTabs",title:{value:(0,p.NC)("workbench.action.terminal.showTabs","Show Tabs"),original:"Show Tabs"},f1:!1,precondition:b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),run:e=>e.groupService.showTabs()}),Qe({id:"workbench.action.terminal.focusPreviousPane",title:{value:(0,p.NC)("workbench.action.terminal.focusPreviousPane","Focus Previous Terminal in Terminal Group"),original:"Focus Previous Terminal in Terminal Group"},keybinding:{primary:527,secondary:[528],mac:{primary:2575,secondary:[2576]},when:he.r.focus,weight:200},precondition:b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),run:async e=>{e.groupService.activeGroup?.focusPreviousPane(),await e.groupService.showPanel(!0)}}),Qe({id:"workbench.action.terminal.focusNextPane",title:{value:(0,p.NC)("workbench.action.terminal.focusNextPane","Focus Next Terminal in Terminal Group"),original:"Focus Next Terminal in Terminal Group"},keybinding:{primary:529,secondary:[530],mac:{primary:2577,secondary:[2578]},when:he.r.focus,weight:200},precondition:b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),run:async e=>{e.groupService.activeGroup?.focusNextPane(),await e.groupService.showPanel(!0)}}),Xe({id:"workbench.action.terminal.runRecentCommand",title:{value:(0,p.NC)("workbench.action.terminal.runRecentCommand","Run Recent Command..."),original:"Run Recent Command..."},precondition:b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),keybinding:[{primary:2096,mac:{primary:304},when:b.Ao.and(he.r.focus,O.UA),weight:200},{primary:2608,mac:{primary:816},when:b.Ao.and(he.r.focus,O.UA.negate()),weight:200}],run:async(e,t)=>{await e.runRecent("command"),e?.target===s.i2.Editor?await t.editorService.revealActiveEditor():await t.groupService.showPanel(!1)}}),Xe({id:"workbench.action.terminal.copyLastCommandOutput",title:{value:(0,p.NC)("workbench.action.terminal.copyLastCommand","Copy Last Command Output"),original:"Copy Last Command Output"},precondition:b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),run:async(e,t,i)=>{const n=i.get(Fe.p),s=e.capabilities.get(2)?.commands;if(!s||0===s.length)return;const r=s[s.length-1];if(!r?.hasOutput())return;const o=r.getOutput();(0,B.HD)(o)&&await n.writeText(o)}}),Xe({id:"workbench.action.terminal.goToRecentDirectory",title:{value:(0,p.NC)("workbench.action.terminal.goToRecentDirectory","Go to Recent Directory..."),original:"Go to Recent Directory..."},precondition:b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),keybinding:{primary:2085,when:he.r.focus,weight:200},run:async(e,t)=>{await e.runRecent("cwd"),e?.target===s.i2.Editor?await t.editorService.revealActiveEditor():await t.groupService.showPanel(!1)}}),Qe({id:"workbench.action.terminal.resizePaneLeft",title:{value:(0,p.NC)("workbench.action.terminal.resizePaneLeft","Resize Terminal Left"),original:"Resize Terminal Left"},keybinding:{linux:{primary:3087},mac:{primary:2319},when:he.r.focus,weight:200},precondition:b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),run:e=>e.groupService.activeGroup?.resizePane(0)}),Qe({id:"workbench.action.terminal.resizePaneRight",title:{value:(0,p.NC)("workbench.action.terminal.resizePaneRight","Resize Terminal Right"),original:"Resize Terminal Right"},keybinding:{linux:{primary:3089},mac:{primary:2321},when:he.r.focus,weight:200},precondition:b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),run:e=>e.groupService.activeGroup?.resizePane(1)}),Qe({id:"workbench.action.terminal.resizePaneUp",title:{value:(0,p.NC)("workbench.action.terminal.resizePaneUp","Resize Terminal Up"),original:"Resize Terminal Up"},keybinding:{mac:{primary:2320},when:he.r.focus,weight:200},precondition:b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),run:e=>e.groupService.activeGroup?.resizePane(2)}),Qe({id:"workbench.action.terminal.resizePaneDown",title:{value:(0,p.NC)("workbench.action.terminal.resizePaneDown","Resize Terminal Down"),original:"Resize Terminal Down"},keybinding:{mac:{primary:2322},when:he.r.focus,weight:200},precondition:b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),run:e=>e.groupService.activeGroup?.resizePane(3)}),Qe({id:"workbench.action.terminal.focus",title:oe.focus,precondition:b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),run:async e=>{const t=e.service.activeInstance||await e.service.createTerminal({location:s.i2.Panel});if(t)return e.service.setActiveInstance(t),e.groupService.showPanel(!0)}}),Qe({id:"workbench.action.terminal.focusTabs",title:{value:(0,p.NC)("workbench.action.terminal.focus.tabsView","Focus Terminal Tabs View"),original:"Focus Terminal Tabs View"},keybinding:{primary:3165,weight:200,when:b.Ao.or(he.r.tabsFocus,he.r.focus)},precondition:b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),run:e=>e.groupService.focusTabs()}),Qe({id:"workbench.action.terminal.focusNext",title:{value:(0,p.NC)("workbench.action.terminal.focusNext","Focus Next Terminal Group"),original:"Focus Next Terminal Group"},precondition:b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),keybinding:{primary:2060,mac:{primary:3166},when:b.Ao.and(he.r.focus,he.r.editorFocus.negate()),weight:200},run:async e=>{e.groupService.setActiveGroupToNext(),await e.groupService.showPanel(!0)}}),Qe({id:"workbench.action.terminal.focusPrevious",title:{value:(0,p.NC)("workbench.action.terminal.focusPrevious","Focus Previous Terminal Group"),original:"Focus Previous Terminal Group"},precondition:b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),keybinding:{primary:2059,mac:{primary:3164},when:b.Ao.and(he.r.focus,he.r.editorFocus.negate()),weight:200},run:async e=>{e.groupService.setActiveGroupToPrevious(),await e.groupService.showPanel(!0)}}),Qe({id:"workbench.action.terminal.runSelectedText",title:{value:(0,p.NC)("workbench.action.terminal.runSelectedText","Run Selected Text In Active Terminal"),original:"Run Selected Text In Active Terminal"},run:async(e,t)=>{const i=t.get(N.$).getActiveCodeEditor();if(!i||!i.hasModel())return;const n=await e.service.getActiveOrCreateInstance({acceptsInput:!0}),s=i.getSelection();let r;if(s.isEmpty())r=i.getModel().getLineContent(s.selectionStartLineNumber).trim();else{const e=_.ED?1:2;r=i.getModel().getValueInRange(s,e)}n.sendText(r,!0,!0),await e.service.revealActiveTerminal()}}),Qe({id:"workbench.action.terminal.runActiveFile",title:{value:(0,p.NC)("workbench.action.terminal.runActiveFile","Run Active File In Active Terminal"),original:"Run Active File In Active Terminal"},precondition:b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),run:async(e,t)=>{const i=t.get(N.$),n=t.get(w.lT),s=t.get(pe.n),r=i.getActiveCodeEditor();if(!r||!r.hasModel())return;const o=await e.service.getActiveOrCreateInstance({acceptsInput:!0}),a=o?o.isRemote:!!s.remoteAuthority,c=r.getModel().uri;if(!(!a&&c.scheme!==m.lg.file&&c.scheme!==m.lg.vscodeUserData||a&&c.scheme!==m.lg.vscodeRemote))return await o.sendPath(c,!0),e.groupService.showPanel();n.warn((0,p.NC)("workbench.action.terminal.runActiveFile.noFile","Only files on disk can be run in the terminal"))}}),Je({id:"workbench.action.terminal.scrollDown",title:{value:(0,p.NC)("workbench.action.terminal.scrollDown","Scroll Down (Line)"),original:"Scroll Down (Line)"},keybinding:{primary:2572,linux:{primary:3090},when:b.Ao.and(he.r.focusInAny,he.r.altBufferActive.negate()),weight:200},precondition:b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),run:e=>e.scrollDownLine()}),Je({id:"workbench.action.terminal.scrollDownPage",title:{value:(0,p.NC)("workbench.action.terminal.scrollDownPage","Scroll Down (Page)"),original:"Scroll Down (Page)"},keybinding:{primary:1036,mac:{primary:12},when:b.Ao.and(he.r.focusInAny,he.r.altBufferActive.negate()),weight:200},precondition:b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),run:e=>e.scrollDownPage()}),Je({id:"workbench.action.terminal.scrollToBottom",title:{value:(0,p.NC)("workbench.action.terminal.scrollToBottom","Scroll to Bottom"),original:"Scroll to Bottom"},keybinding:{primary:2061,linux:{primary:1037},when:b.Ao.and(he.r.focusInAny,he.r.altBufferActive.negate()),weight:200},precondition:b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),run:e=>e.scrollToBottom()}),Je({id:"workbench.action.terminal.scrollUp",title:{value:(0,p.NC)("workbench.action.terminal.scrollUp","Scroll Up (Line)"),original:"Scroll Up (Line)"},keybinding:{primary:2571,linux:{primary:3088},when:b.Ao.and(he.r.focusInAny,he.r.altBufferActive.negate()),weight:200},precondition:b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),run:e=>e.scrollUpLine()}),Je({id:"workbench.action.terminal.scrollUpPage",title:{value:(0,p.NC)("workbench.action.terminal.scrollUpPage","Scroll Up (Page)"),original:"Scroll Up (Page)"},f1:!0,category:Ge,keybinding:{primary:1035,mac:{primary:11},when:b.Ao.and(he.r.focusInAny,he.r.altBufferActive.negate()),weight:200},precondition:b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),run:e=>e.scrollUpPage()}),Je({id:"workbench.action.terminal.scrollToTop",title:{value:(0,p.NC)("workbench.action.terminal.scrollToTop","Scroll to Top"),original:"Scroll to Top"},keybinding:{primary:2062,linux:{primary:1038},when:b.Ao.and(he.r.focusInAny,he.r.altBufferActive.negate()),weight:200},precondition:b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),run:e=>e.scrollToTop()}),Je({id:"workbench.action.terminal.clearSelection",title:{value:(0,p.NC)("workbench.action.terminal.clearSelection","Clear Selection"),original:"Clear Selection"},keybinding:{primary:9,when:b.Ao.and(he.r.focusInAny,he.r.textSelected,he.r.notFindVisible),weight:200},precondition:b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),run:e=>{e.hasSelection()&&e.clearSelection()}}),Qe({id:"workbench.action.terminal.changeIcon",title:oe.changeIcon,precondition:b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),run:(e,t,i)=>it(e,i)?.changeIcon()}),Qe({id:"workbench.action.terminal.changeIconPanel",title:oe.changeIcon,f1:!1,precondition:b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),run:e=>e.groupService.activeInstance?.changeIcon()}),Qe({id:"workbench.action.terminal.changeIconInstance",title:oe.changeIcon,f1:!1,precondition:b.Ao.and(b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),he.r.tabsSingularSelection),run:(e,t)=>Ze(t)?.[0].changeIcon()}),Qe({id:"workbench.action.terminal.changeColor",title:oe.changeColor,precondition:b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),run:(e,t,i)=>it(e,i)?.changeColor()}),Qe({id:"workbench.action.terminal.changeColorPanel",title:oe.changeColor,f1:!1,precondition:b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),run:e=>e.groupService.activeInstance?.changeColor()}),Qe({id:"workbench.action.terminal.changeColorInstance",title:oe.changeColor,f1:!1,precondition:b.Ao.and(b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),he.r.tabsSingularSelection),run:(e,t)=>Ze(t)?.[0].changeColor()}),Qe({id:"workbench.action.terminal.rename",title:oe.rename,precondition:b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),run:(e,t,i)=>st(e,t,i)}),Qe({id:"workbench.action.terminal.renamePanel",title:oe.rename,f1:!1,precondition:b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),run:(e,t)=>st(e,t)}),Qe({id:"workbench.action.terminal.renameInstance",title:oe.rename,f1:!1,keybinding:{primary:60,mac:{primary:3},when:b.Ao.and(he.r.tabsFocus),weight:200},precondition:b.Ao.and(b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),he.r.tabsSingularSelection),run:async(e,t)=>{const i=t.get(w.lT),n=Ze(t)?.[0];n&&(e.service.setEditingTerminal(n),e.service.setEditable(n,{validationMessage:e=>{return(t=e)&&0!==t.trim().length?null:{content:(0,p.NC)("emptyTerminalNameInfo","Providing no name will reset it to the default value"),severity:w.zb.Info};var t},onFinish:async(t,s)=>{if(e.service.setEditable(n,null),e.service.setEditingTerminal(void 0),s)try{await n.rename(t)}catch(e){i.error(e)}}}))}}),Xe({id:"workbench.action.terminal.detachSession",title:{value:(0,p.NC)("workbench.action.terminal.detachSession","Detach Session"),original:"Detach Session"},run:e=>e.detachProcessAndDispose(s._x.User)}),Qe({id:"workbench.action.terminal.attachToSession",title:{value:(0,p.NC)("workbench.action.terminal.attachToSession","Attach to Session"),original:"Attach to Session"},run:async(e,t)=>{const i=t.get($.eJ),n=t.get(F.e),s=t.get(be.R),r=t.get(w.lT),a=s.getConnection()?.remoteAuthority??void 0,c=await t.get(o.N4).getBackend(a);if(!c)throw new Error(`No backend registered for remote authority '${a}'`);const l=await c.listProcesses();c.reduceConnectionGraceTime();const h=l.filter((t=>!e.service.isAttachedToTerminal(t))).map((e=>{const t=n.getUriLabel(g.ov.file(e.cwd));return{label:e.title,detail:e.workspaceName?`${e.workspaceName} ⸱ ${t}`:t,description:e.pid?String(e.pid):"",term:e}}));if(0===h.length)return void r.info((0,p.NC)("noUnattachedTerminals","There are no unattached terminals to attach to"));const d=await i.pick(h,{canPickMany:!1});if(d){const t=await e.service.createTerminal({config:{attachPersistentProcess:d.term}});e.service.setActiveInstance(t),await nt(t,e)}}}),Qe({id:"workbench.action.quickOpenTerm",title:{value:(0,p.NC)("quickAccessTerminal","Switch Active Terminal"),original:"Switch Active Terminal"},precondition:b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),run:(e,t)=>t.get($.eJ).quickAccess.show(le.PREFIX)}),Xe({id:"workbench.action.terminal.scrollToPreviousCommand",title:{value:(0,p.NC)("workbench.action.terminal.scrollToPreviousCommand","Scroll To Previous Command"),original:"Scroll To Previous Command"},keybinding:{primary:2064,when:b.Ao.and(he.r.focus,O.UA.negate()),weight:200},precondition:b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),run:e=>e.xterm?.markTracker.scrollToPreviousMark(void 0,void 0,e.capabilities.has(2))}),Xe({id:"workbench.action.terminal.scrollToNextCommand",title:{value:(0,p.NC)("workbench.action.terminal.scrollToNextCommand","Scroll To Next Command"),original:"Scroll To Next Command"},keybinding:{primary:2066,when:b.Ao.and(he.r.focus,O.UA.negate()),weight:200},precondition:b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),run:e=>{e.xterm?.markTracker.scrollToNextMark(),e.focus()}}),Xe({id:"workbench.action.terminal.selectToPreviousCommand",title:{value:(0,p.NC)("workbench.action.terminal.selectToPreviousCommand","Select To Previous Command"),original:"Select To Previous Command"},keybinding:{primary:3088,when:he.r.focus,weight:200},precondition:b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),run:e=>{e.xterm?.markTracker.selectToPreviousMark(),e.focus()}}),Xe({id:"workbench.action.terminal.selectToNextCommand",title:{value:(0,p.NC)("workbench.action.terminal.selectToNextCommand","Select To Next Command"),original:"Select To Next Command"},keybinding:{primary:3090,when:he.r.focus,weight:200},precondition:b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),run:e=>{e.xterm?.markTracker.selectToNextMark(),e.focus()}}),Je({id:"workbench.action.terminal.selectToPreviousLine",title:{value:(0,p.NC)("workbench.action.terminal.selectToPreviousLine","Select To Previous Line"),original:"Select To Previous Line"},precondition:b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),run:async(e,t,i)=>{e.markTracker.selectToPreviousLine(),(i||e).focus()}}),Je({id:"workbench.action.terminal.selectToNextLine",title:{value:(0,p.NC)("workbench.action.terminal.selectToNextLine","Select To Next Line"),original:"Select To Next Line"},precondition:b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),run:async(e,t,i)=>{e.markTracker.selectToNextLine(),(i||e).focus()}}),Qe({id:"workbench.action.terminal.sendSequence",title:oe.sendSequence,f1:!1,description:{description:oe.sendSequence.value,args:[{name:"args",schema:{type:"object",required:["text"],properties:{text:{description:(0,p.NC)("sendSequence","The sequence of text to send to the terminal"),type:"string"}}}}]},run:(e,t,i)=>Ke(t,i)}),Qe({id:"workbench.action.terminal.newWithCwd",title:oe.newWithCwd,description:{description:oe.newWithCwd.value,args:[{name:"args",schema:{type:"object",required:["cwd"],properties:{cwd:{description:(0,p.NC)("workbench.action.terminal.newWithCwd.cwd","The directory to start the terminal at"),type:"string"}}}}]},run:async(e,t,i)=>{const n=(0,B.Kn)(i)&&"cwd"in i?ot(i.cwd):void 0,s=await e.service.createTerminal({cwd:n});s&&(e.service.setActiveInstance(s),await nt(s,e))}}),Xe({id:"workbench.action.terminal.renameWithArg",title:oe.renameWithArgs,description:{description:oe.renameWithArgs.value,args:[{name:"args",schema:{type:"object",required:["name"],properties:{name:{description:(0,p.NC)("workbench.action.terminal.renameWithArg.name","The new name for the terminal"),type:"string",minLength:1}}}}]},precondition:b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),run:async(e,t,i,n)=>{const s=i.get(w.lT),r=(0,B.Kn)(n)&&"name"in n?ot(n.name):void 0;r?e.rename(r):s.warn((0,p.NC)("workbench.action.terminal.renameWithArg.noName","No name argument provided"))}}),Xe({id:"workbench.action.terminal.relaunch",title:{value:(0,p.NC)("workbench.action.terminal.relaunch","Relaunch Active Terminal"),original:"Relaunch Active Terminal"},run:e=>e.relaunch()}),Qe({id:"workbench.action.terminal.split",title:oe.split,precondition:b.Ao.or(he.r.processSupported,he.r.webExtensionContributedProfile),keybinding:{primary:3098,weight:200,mac:{primary:2141,secondary:[1306]},when:he.r.focus},icon:R.lA.splitHorizontal,run:async(e,t,i)=>{const n=(0,B.Kn)(i)?i:void 0,s=t.get(f.H),r=t.get(T.ec),o=et(n),a=(await e.service.getInstanceHost(o?.location)).activeInstance;if(!a)return;const c=await ze(e.service.configHelper,a,r.getWorkspace().folders,s);if(void 0===c)return;const l=await e.service.createTerminal({location:{parentTerminal:a},config:o?.config,cwd:c});await nt(l,e)}}),Qe({id:"workbench.action.terminal.splitInstance",title:oe.split,f1:!1,keybinding:{primary:3098,mac:{primary:2141,secondary:[1306]},weight:200,when:he.r.tabsFocus},run:async(e,t)=>{const i=Ze(t);if(i){const t=[];for(const n of i)t.push((async()=>{await e.service.createTerminal({location:{parentTerminal:n}}),await e.groupService.showPanel(!0)})());await Promise.all(t)}}}),Xe({id:"workbench.action.terminal.unsplit",title:oe.unsplit,precondition:b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),run:(e,t)=>t.groupService.unsplitInstance(e)}),Qe({id:"workbench.action.terminal.unsplitInstance",title:oe.unsplit,f1:!1,precondition:b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),run:async(e,t)=>{const i=Ze(t);if(1===i?.length){const t=e.groupService.getGroupForInstance(i[0]);t&&t?.terminalInstances.length>1&&e.groupService.unsplitInstance(i[0])}}}),Qe({id:"workbench.action.terminal.joinInstance",title:{value:(0,p.NC)("workbench.action.terminal.joinInstance","Join Terminals"),original:"Join Terminals"},precondition:b.Ao.and(b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),he.r.tabsSingularSelection.toNegated()),run:async(e,t)=>{const i=Ze(t);i&&i.length>1&&e.groupService.joinInstances(i)}}),Qe({id:"workbench.action.terminal.join",title:{value:(0,p.NC)("workbench.action.terminal.join","Join Terminals"),original:"Join Terminals"},precondition:b.Ao.and(b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated)),run:async(e,t)=>{const i=t.get(I.XE),n=t.get(w.lT),s=t.get($.eJ),r=[];if(e.groupService.instances.length<=1)return void n.warn((0,p.NC)("workbench.action.terminal.join.insufficientTerminals","Insufficient terminals for the join action"));const o=e.groupService.instances.filter((t=>t.instanceId!==e.groupService.activeInstance?.instanceId));for(const n of o){const s=e.groupService.getGroupForInstance(n);if(1===s?.terminalInstances.length){const e=`$(${(0,re.yX)(t,n)}): ${n.title}`,s=[],o=(0,re.pv)(n);o&&s.push(o);const a=(0,re.A5)(n,i.getColorTheme().type);a&&s.push(...a),r.push({terminal:n,label:e,iconClasses:s})}}if(0===r.length)return void n.warn((0,p.NC)("workbench.action.terminal.join.onlySplits","All terminals are joined already"));const a=await s.pick(r,{});a&&e.groupService.joinInstances([a.terminal,e.groupService.activeInstance])}}),Xe({id:"workbench.action.terminal.splitInActiveWorkspace",title:{value:(0,p.NC)("workbench.action.terminal.splitInActiveWorkspace","Split Terminal (In Active Workspace)"),original:"Split Terminal (In Active Workspace)"},run:async(e,t)=>{const i=await t.service.createTerminal({location:{parentTerminal:e}});i?.target!==s.i2.Editor&&await t.groupService.showPanel(!0)}}),Je({id:"workbench.action.terminal.selectAll",title:{value:(0,p.NC)("workbench.action.terminal.selectAll","Select All"),original:"Select All"},precondition:b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),keybinding:[{primary:0,mac:{primary:2079},weight:200,when:he.r.focusInAny}],run:e=>e.selectAll()}),Qe({id:"workbench.action.terminal.new",title:{value:(0,p.NC)("workbench.action.terminal.new","Create New Terminal"),original:"Create New Terminal"},precondition:b.Ao.or(he.r.processSupported,he.r.webExtensionContributedProfile),icon:X,keybinding:{primary:3163,mac:{primary:1371},weight:200},run:async(e,t,i)=>{let n=(0,B.Kn)(i)?i:void 0;const s=t.get(T.ec),r=t.get(f.H),o=s.getWorkspace().folders;if(n&&n instanceof MouseEvent&&(n.altKey||n.ctrlKey))await e.service.createTerminal({location:{splitActiveTerminal:!0}});else if(e.service.isProcessSupportRegistered){let i;if(n=!n||n instanceof MouseEvent?{}:n,o.length<=1)i=await e.service.createTerminal(n);else{const s=(await async function(e,t){const i=e.get($.eJ),n=e.get(F.e),s=e.get(T.ec),r=e.get(Me.q),o=e.get(Be.O),a=e.get(v.Ui),c=e.get(ge.qb),l=s.getWorkspace().folders;if(!l.length)return;const h=await Promise.all(l.map((e=>async function(e,t,i){const n=t.getValue("terminal.integrated.cwd",{resource:e.uri});if(!(0,B.HD)(n)||0===n.length)return{folder:e,cwd:e.uri,isAbsolute:!1,isOverridden:!1};const s=await i.resolveAsync(e,n);return(0,Se.YP)(s)||s.startsWith(we.N.VARIABLE_LHS)?{folder:e,isAbsolute:!0,isOverridden:!0,cwd:g.ov.from({scheme:e.uri.scheme,path:s})}:{folder:e,isAbsolute:!1,isOverridden:!0,cwd:g.ov.joinPath(e.uri,s)}}(e,a,c)))),d=function(e){const t=new Map;for(const i of e){const e=i.cwd.toString();t.get(e)&&e!==i.folder.uri.toString()||t.set(e,i)}const i=new Set(t.values());return e.filter((e=>i.has(e)))}(h);if(1===d.length)return d[0];const u=d.map((e=>{const t=e.folder.name,i=e.isOverridden?(0,p.NC)("workbench.action.terminal.overriddenCwdDescription","(Overriden) {0}",n.getUriLabel(e.cwd,{relative:!e.isAbsolute})):n.getUriLabel((0,Oe.XX)(e.cwd),{relative:!0});return{label:t,description:i!==t?i:void 0,pair:e,iconClasses:(0,He.r)(r,o,e.cwd,xe.RR.ROOT_FOLDER)}})),m={placeHolder:(0,p.NC)("workbench.action.terminal.newWorkspacePlaceholder","Select current working directory for new terminal"),matchOnDescription:!0,canPickMany:!1},_=Ne.T.None,f=await i.pick(u,m,_);return f?.pair}(t))?.cwd;if(!s)return;n.cwd=s,i=await e.service.createTerminal(n)}e.service.setActiveInstance(i),await nt(i,e)}else e.profileService.contributedProfiles.length>0?r.executeCommand("workbench.action.terminal.newWithProfile"):r.executeCommand("workbench.action.terminal.toggleTerminal")}}),Qe({id:"workbench.action.terminal.kill",title:{value:(0,p.NC)("workbench.action.terminal.kill","Kill the Active Terminal Instance"),original:"Kill the Active Terminal Instance"},precondition:b.Ao.or(b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),he.r.isOpen),icon:Q,run:async e=>{const t=e.groupService.activeInstance;t&&(await e.service.safeDisposeTerminal(t),e.groupService.instances.length>0&&await e.groupService.showPanel(!0))}}),Qe({id:"workbench.action.terminal.killAll",title:{value:(0,p.NC)("workbench.action.terminal.killAll","Kill All Terminals"),original:"Kill All Terminals"},precondition:b.Ao.or(b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),he.r.isOpen),icon:R.lA.trash,run:async e=>{const t=[];for(const i of e.service.instances)t.push(e.service.safeDisposeTerminal(i));await Promise.all(t)}}),Qe({id:"workbench.action.terminal.killEditor",title:{value:(0,p.NC)("workbench.action.terminal.killEditor","Kill the Active Terminal in Editor Area"),original:"Kill the Active Terminal in Editor Area"},precondition:b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),keybinding:{primary:2101,win:{primary:2110,secondary:[2101]},weight:200,when:b.Ao.and(he.r.focus,E.f1.Scheme.isEqualTo(m.lg.vscodeTerminal),he.r.editorFocus)},run:(e,t)=>t.get(f.H).executeCommand(G.$Z)}),Qe({id:"workbench.action.terminal.killInstance",title:oe.kill,f1:!1,precondition:b.Ao.or(b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),he.r.isOpen),keybinding:{primary:20,mac:{primary:2049,secondary:[20]},weight:200,when:he.r.tabsFocus},run:async(e,t)=>{const i=Ze(t);if(!i)return;const n=t.get(W.Lw),s=[];for(const t of i)s.push(e.service.safeDisposeTerminal(t));await Promise.all(s),e.service.instances.length>0&&(e.groupService.focusTabs(),n.lastFocusedList?.focusNext())}}),Qe({id:"workbench.action.terminal.focusHover",title:oe.focusHover,precondition:b.Ao.or(b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),he.r.isOpen),keybinding:{primary:(0,M.gx)(2089,2087),weight:200,when:b.Ao.or(he.r.tabsFocus,he.r.focus)},run:e=>e.groupService.focusHover()}),Xe({id:"workbench.action.terminal.clear",title:{value:(0,p.NC)("workbench.action.terminal.clear","Clear"),original:"Clear"},precondition:b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),keybinding:[{primary:0,mac:{primary:2089},weight:201,when:b.Ao.and(he.r.focus,O.UA.negate())}],run:e=>e.clearBuffer()}),Qe({id:"workbench.action.terminal.selectDefaultShell",title:{value:(0,p.NC)("workbench.action.terminal.selectDefaultShell","Select Default Profile"),original:"Select Default Profile"},run:e=>e.service.showProfileQuickPick("setDefault")}),Qe({id:"workbench.action.terminal.openSettings",title:{value:(0,p.NC)("workbench.action.terminal.openSettings","Configure Terminal Settings"),original:"Configure Terminal Settings"},precondition:b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),run:(e,t)=>t.get(ve.UP).openSettings({jsonEditor:!1,query:"@feature:terminal"})}),Xe({id:"workbench.action.terminal.setDimensions",title:{value:(0,p.NC)("workbench.action.terminal.setFixedDimensions","Set Fixed Dimensions"),original:"Set Fixed Dimensions"},precondition:b.Ao.and(b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),he.r.isOpen),run:e=>e.setFixedDimensions()}),Xe({id:"workbench.action.terminal.sizeToContentWidth",title:{value:(0,p.NC)("workbench.action.terminal.sizeToContentWidth","Toggle Size to Content Width"),original:"Toggle Size to Content Width"},precondition:b.Ao.and(b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),he.r.isOpen),keybinding:{primary:568,weight:200,when:he.r.focus},run:e=>e.toggleSizeToContentWidth()}),Qe({id:"workbench.action.terminal.sizeToContentWidthInstance",title:oe.toggleSizeToContentWidth,f1:!1,precondition:b.Ao.and(b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),he.r.focus),run:(e,t)=>Ze(t)?.[0].toggleSizeToContentWidth()}),Qe({id:"workbench.action.terminal.clearPreviousSessionHistory",title:{value:(0,p.NC)("workbench.action.terminal.clearPreviousSessionHistory","Clear Previous Session History"),original:"Clear Previous Session History"},precondition:b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),run:async(e,t)=>{Te(t).clear(),Ae.clear()}}),Xe({id:"workbench.action.terminal.selectPrevSuggestion",title:{value:(0,p.NC)("workbench.action.terminal.selectPrevSuggestion","Select the Previous Suggestion"),original:"Select the Previous Suggestion"},f1:!1,precondition:b.Ao.and(b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),he.r.focus,he.r.isOpen,he.r.suggestWidgetVisible),keybinding:{primary:16,weight:201},run:e=>e.selectPreviousSuggestion()}),Xe({id:"workbench.action.terminal.selectPrevPageSuggestion",title:{value:(0,p.NC)("workbench.action.terminal.selectPrevPageSuggestion","Select the Previous Page Suggestion"),original:"Select the Previous Page Suggestion"},f1:!1,precondition:b.Ao.and(b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),he.r.focus,he.r.isOpen,he.r.suggestWidgetVisible),keybinding:{primary:11,weight:201},run:e=>e.selectPreviousPageSuggestion()}),Xe({id:"workbench.action.terminal.selectNextSuggestion",title:{value:(0,p.NC)("workbench.action.terminal.selectNextSuggestion","Select the Next Suggestion"),original:"Select the Next Suggestion"},f1:!1,precondition:b.Ao.and(b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),he.r.focus,he.r.isOpen,he.r.suggestWidgetVisible),keybinding:{primary:18,weight:201},run:e=>e.selectNextSuggestion()}),Xe({id:"workbench.action.terminal.selectNextPageSuggestion",title:{value:(0,p.NC)("workbench.action.terminal.selectNextPageSuggestion","Select the Next Page Suggestion"),original:"Select the Next Page Suggestion"},f1:!1,precondition:b.Ao.and(b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),he.r.focus,he.r.isOpen,he.r.suggestWidgetVisible),keybinding:{primary:12,weight:201},run:e=>e.selectNextPageSuggestion()}),Xe({id:"workbench.action.terminal.acceptSelectedSuggestion",title:{value:(0,p.NC)("workbench.action.terminal.acceptSelectedSuggestion","Accept Selected Suggestion"),original:"Accept Selected Suggestion"},f1:!1,precondition:b.Ao.and(b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),he.r.focus,he.r.isOpen,he.r.suggestWidgetVisible),keybinding:{primary:3,secondary:[2],weight:201},run:e=>e.acceptSelectedSuggestion()}),Xe({id:"workbench.action.terminal.hideSuggestWidget",title:{value:(0,p.NC)("workbench.action.terminal.hideSuggestWidget","Hide Suggest Widget"),original:"Hide Suggest Widget"},f1:!1,precondition:b.Ao.and(b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),he.r.focus,he.r.isOpen,he.r.suggestWidgetVisible),keybinding:{primary:9,weight:201},run:e=>e.hideSuggestWidget()}),L.D.clipboard.writeText&&(Je({id:"workbench.action.terminal.copySelection",title:{value:(0,p.NC)("workbench.action.terminal.copySelection","Copy Selection"),original:"Copy Selection"},precondition:b.Ao.or(he.r.textSelectedInFocused,b.Ao.and(b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),he.r.textSelected)),keybinding:[{primary:3105,mac:{primary:2081},weight:200,when:b.Ao.or(b.Ao.and(he.r.textSelected,he.r.focus),he.r.textSelectedInFocused)}],run:e=>e.copySelection()}),Je({id:"workbench.action.terminal.copyAndClearSelection",title:{value:(0,p.NC)("workbench.action.terminal.copyAndClearSelection","Copy and Clear Selection"),original:"Copy and Clear Selection"},precondition:b.Ao.or(he.r.textSelectedInFocused,b.Ao.and(b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),he.r.textSelected)),keybinding:[{win:{primary:2081},weight:200,when:b.Ao.or(b.Ao.and(he.r.textSelected,he.r.focus),he.r.textSelectedInFocused)}],run:async e=>{await e.copySelection(),e.clearSelection()}}),Je({id:"workbench.action.terminal.copySelectionAsHtml",title:{value:(0,p.NC)("workbench.action.terminal.copySelectionAsHtml","Copy Selection as HTML"),original:"Copy Selection as HTML"},f1:!0,category:Ge,precondition:b.Ao.or(he.r.textSelectedInFocused,b.Ao.and(b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),he.r.textSelected)),run:e=>e.copySelection(!0)})),L.D.clipboard.readText&&Xe({id:"workbench.action.terminal.paste",title:{value:(0,p.NC)("workbench.action.terminal.paste","Paste into Active Terminal"),original:"Paste into Active Terminal"},precondition:b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),keybinding:[{primary:2100,win:{primary:2100,secondary:[3124]},linux:{primary:3124},weight:200,when:he.r.focus}],run:e=>e.paste()}),L.D.clipboard.readText&&_.IJ&&Xe({id:"workbench.action.terminal.pasteSelection",title:{value:(0,p.NC)("workbench.action.terminal.pasteSelection","Paste Selection into Active Terminal"),original:"Paste Selection into Active Terminal"},precondition:b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),keybinding:[{linux:{primary:1043},weight:200,when:he.r.focus}],run:e=>e.pasteSelection()}),Qe({id:"workbench.action.terminal.switchTerminal",title:{value:(0,p.NC)("workbench.action.terminal.switchTerminal","Switch Terminal"),original:"Switch Terminal"},precondition:b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),run:async(e,t,i)=>{const n=ot(i);if(!n)return;if(n===$e)return void e.service.refreshActiveGroup();if(n===Ue)return void t.get(v.Ui).updateValue("terminal.integrated.tabs.enabled",!0);const s=/^([0-9]+): /.exec(n);if(s)return e.groupService.setActiveGroupByIndex(Number(s[1])-1),e.groupService.showPanel(!0);const r=e.profileService.availableProfiles,o=n.substring(4);if(r){const t=r.find((e=>e.profileName===o));if(t){const i=await e.service.createTerminal({config:t});e.service.setActiveInstance(i)}else console.warn(`No profile with name "${o}"`)}else console.warn(`Unmatched terminal item: "${n}"`)}}),_.ED&&to(String.fromCharCode("V".charCodeAt(0)-64),{when:b.Ao.and(he.r.focus,b.Ao.equals("terminalShellType","pwsh"),O.UA.negate()),primary:2100}),to("[24~a",{when:b.Ao.and(he.r.focus,b.Ao.equals("terminalShellType","pwsh"),he.r.terminalShellIntegrationEnabled,O.UA.negate()),primary:2058,mac:{primary:266}}),to("[24~b",{when:b.Ao.and(he.r.focus,b.Ao.equals("terminalShellType","pwsh"),he.r.terminalShellIntegrationEnabled,O.UA.negate()),primary:522}),to("[24~c",{when:b.Ao.and(he.r.focus,b.Ao.equals("terminalShellType","pwsh"),he.r.terminalShellIntegrationEnabled,O.UA.negate()),primary:1027}),to("[24~d",{when:b.Ao.and(he.r.focus,b.Ao.equals("terminalShellType","pwsh"),he.r.terminalShellIntegrationEnabled,O.UA.negate()),mac:{primary:3089}}),to("[24~e",{when:b.Ao.and(he.r.focus,b.Ao.equals("terminalShellType","pwsh"),he.r.terminalShellIntegrationEnabled,O.UA.negate(),b.Ao.equals("config.terminal.integrated.shellIntegration.suggestEnabled",!0)),primary:2058,mac:{primary:266}}),to("[1;2H",{when:b.Ao.and(he.r.focus,b.Ao.equals("terminalShellType","pwsh")),mac:{primary:3087}}),to("",{when:b.Ao.and(he.r.focus,O.UA),primary:2608,mac:{primary:816}}),to("",{when:he.r.focus,primary:2597,mac:{primary:805}}),_.gn&&to(String.fromCharCode("C".charCodeAt(0)-64),{when:b.Ao.and(he.r.focus),primary:289}),to(String.fromCharCode("W".charCodeAt(0)-64),{primary:2049,mac:{primary:513}}),_.ED&&to(String.fromCharCode("H".charCodeAt(0)-64),{when:b.Ao.and(he.r.focus,b.Ao.equals("terminalShellType","cmd")),primary:2049}),to("d",{primary:2068,mac:{primary:532}}),to("",{mac:{primary:2049}}),to(String.fromCharCode("A".charCodeAt(0)-64),{mac:{primary:2063}}),to(String.fromCharCode("E".charCodeAt(0)-64),{mac:{primary:2065}}),to("\0",{primary:3095,mac:{primary:1303}}),to("",{primary:3099,mac:{primary:1307}}),to("",{primary:2138,mac:{primary:346}}),function(){for(let e=0;e<9;e++){const t=e,i=e+1;or.W.registerCommandAndKeybindingRule({id:`workbench.action.terminal.focusAtIndex${i}`,weight:200,when:void 0,primary:0,handler:e=>(e.get(o.Qy).setActiveInstanceByIndex(t),e.get(o.Qy).showPanel(!0))})}}(),H.BH.appendMenuItems([{id:H.eH.MenubarTerminalMenu,item:{group:"1_create",command:{id:"workbench.action.terminal.new",title:(0,p.NC)({key:"miNewTerminal",comment:["&& denotes a mnemonic"]},"&&New Terminal")},order:1}},{id:H.eH.MenubarTerminalMenu,item:{group:"1_create",command:{id:"workbench.action.terminal.split",title:(0,p.NC)({key:"miSplitTerminal",comment:["&& denotes a mnemonic"]},"&&Split Terminal"),precondition:b.Ao.has("terminalIsOpen")},order:2,when:he.r.processSupported}},{id:H.eH.MenubarTerminalMenu,item:{group:"2_run",command:{id:"workbench.action.terminal.runActiveFile",title:(0,p.NC)({key:"miRunActiveFile",comment:["&& denotes a mnemonic"]},"Run &&Active File")},order:3,when:he.r.processSupported}},{id:H.eH.MenubarTerminalMenu,item:{group:"2_run",command:{id:"workbench.action.terminal.runSelectedText",title:(0,p.NC)({key:"miRunSelectedText",comment:["&& denotes a mnemonic"]},"Run &&Selected Text")},order:4,when:he.r.processSupported}}]),H.BH.appendMenuItems([{id:H.eH.TerminalInstanceContext,item:{group:"1_create",command:{id:"workbench.action.terminal.split",title:oe.split.value}}},{id:H.eH.TerminalInstanceContext,item:{command:{id:"workbench.action.terminal.new",title:oe.new},group:"1_create"}},{id:H.eH.TerminalInstanceContext,item:{command:{id:"workbench.action.terminal.kill",title:oe.kill.value},group:"4_kill"}},{id:H.eH.TerminalInstanceContext,item:{command:{id:"workbench.action.terminal.copySelection",title:(0,p.NC)("workbench.action.terminal.copySelection.short","Copy")},group:"2_edit",order:1}},{id:H.eH.TerminalInstanceContext,item:{command:{id:"workbench.action.terminal.copySelectionAsHtml",title:(0,p.NC)("workbench.action.terminal.copySelectionAsHtml","Copy as HTML")},group:"2_edit",order:2}},{id:H.eH.TerminalInstanceContext,item:{command:{id:"workbench.action.terminal.paste",title:(0,p.NC)("workbench.action.terminal.paste.short","Paste")},group:"2_edit",order:3}},{id:H.eH.TerminalInstanceContext,item:{command:{id:"workbench.action.terminal.clear",title:(0,p.NC)("workbench.action.terminal.clear","Clear")},group:"3_clear"}},{id:H.eH.TerminalInstanceContext,item:{command:{id:"workbench.action.terminal.showTabs",title:(0,p.NC)("workbench.action.terminal.showsTabs","Show Tabs")},when:b.Ao.not("config.terminal.integrated.tabs.enabled"),group:"5_config"}},{id:H.eH.TerminalInstanceContext,item:{command:{id:"workbench.action.terminal.sizeToContentWidth",title:oe.toggleSizeToContentWidth},group:"5_config"}},{id:H.eH.TerminalInstanceContext,item:{command:{id:"workbench.action.terminal.selectAll",title:(0,p.NC)("workbench.action.terminal.selectAll","Select All")},group:"2_edit",order:3}}]),H.BH.appendMenuItems([{id:H.eH.TerminalEditorInstanceContext,item:{group:"1_create",command:{id:"workbench.action.terminal.split",title:oe.split.value}}},{id:H.eH.TerminalEditorInstanceContext,item:{command:{id:"workbench.action.terminal.new",title:oe.new},group:"1_create"}},{id:H.eH.TerminalEditorInstanceContext,item:{command:{id:"workbench.action.terminal.killEditor",title:oe.kill.value},group:"4_kill"}},{id:H.eH.TerminalEditorInstanceContext,item:{command:{id:"workbench.action.terminal.copySelection",title:(0,p.NC)("workbench.action.terminal.copySelection.short","Copy")},group:"2_edit",order:1}},{id:H.eH.TerminalEditorInstanceContext,item:{command:{id:"workbench.action.terminal.copySelectionAsHtml",title:(0,p.NC)("workbench.action.terminal.copySelectionAsHtml","Copy as HTML")},group:"2_edit",order:2}},{id:H.eH.TerminalEditorInstanceContext,item:{command:{id:"workbench.action.terminal.paste",title:(0,p.NC)("workbench.action.terminal.paste.short","Paste")},group:"2_edit",order:3}},{id:H.eH.TerminalEditorInstanceContext,item:{command:{id:"workbench.action.terminal.clear",title:(0,p.NC)("workbench.action.terminal.clear","Clear")},group:"3_clear"}},{id:H.eH.TerminalEditorInstanceContext,item:{command:{id:"workbench.action.terminal.selectAll",title:(0,p.NC)("workbench.action.terminal.selectAll","Select All")},group:"2_edit",order:3}},{id:H.eH.TerminalEditorInstanceContext,item:{command:{id:"workbench.action.terminal.sizeToContentWidth",title:oe.toggleSizeToContentWidth},group:"5_config"}}]),H.BH.appendMenuItems([{id:H.eH.TerminalTabEmptyAreaContext,item:{command:{id:"workbench.action.terminal.newWithProfile",title:(0,p.NC)("workbench.action.terminal.newWithProfile.short","New Terminal With Profile")},group:"1_create"}},{id:H.eH.TerminalTabEmptyAreaContext,item:{command:{id:"workbench.action.terminal.new",title:oe.new},group:"1_create"}}]),H.BH.appendMenuItems([{id:H.eH.TerminalNewDropdownContext,item:{command:{id:"workbench.action.terminal.selectDefaultShell",title:{value:(0,p.NC)("workbench.action.terminal.selectDefaultProfile","Select Default Profile"),original:"Select Default Profile"}},group:"3_configure"}},{id:H.eH.TerminalNewDropdownContext,item:{command:{id:"workbench.action.terminal.openSettings",title:(0,p.NC)("workbench.action.terminal.openSettings","Configure Terminal Settings")},group:"3_configure"}},{id:H.eH.TerminalNewDropdownContext,item:{command:{id:"workbench.action.tasks.runTask",title:(0,p.NC)("workbench.action.tasks.runTask","Run Task...")},when:Er.M0,group:"4_tasks",order:1}},{id:H.eH.TerminalNewDropdownContext,item:{command:{id:"workbench.action.tasks.configureTaskRunner",title:(0,p.NC)("workbench.action.tasks.configureTaskRunner","Configure Tasks...")},when:Er.M0,group:"4_tasks",order:2}}]),H.BH.appendMenuItems([{id:H.eH.ViewTitle,item:{command:{id:"workbench.action.terminal.switchTerminal",title:{value:(0,p.NC)("workbench.action.terminal.switchTerminal","Switch Terminal"),original:"Switch Terminal"}},group:"navigation",order:0,when:b.Ao.and(b.Ao.equals("view",r.e9),b.Ao.not("config.terminal.integrated.tabs.enabled"))}},{id:H.eH.ViewTitle,item:{command:{id:"workbench.action.terminal.focus",title:oe.focus},alt:{id:"workbench.action.terminal.split",title:oe.split.value,icon:R.lA.splitHorizontal},group:"navigation",order:0,when:b.Ao.and(b.Ao.equals("view",r.e9),b.Ao.has("config.terminal.integrated.tabs.enabled"),b.Ao.or(b.Ao.and(b.Ao.equals("config.terminal.integrated.tabs.showActiveTerminal","singleTerminal"),b.Ao.equals("terminalCount",1)),b.Ao.and(b.Ao.equals("config.terminal.integrated.tabs.showActiveTerminal","singleTerminalOrNarrow"),b.Ao.or(b.Ao.equals("terminalCount",1),b.Ao.has("isTerminalTabsNarrow"))),b.Ao.and(b.Ao.equals("config.terminal.integrated.tabs.showActiveTerminal","singleGroup"),b.Ao.equals("terminalGroupCount",1)),b.Ao.equals("config.terminal.integrated.tabs.showActiveTerminal","always")))}},{id:H.eH.ViewTitle,item:{command:{id:"workbench.action.terminal.split",title:oe.split,icon:R.lA.splitHorizontal},group:"navigation",order:2,when:b.Ao.and(b.Ao.equals("view",r.e9),b.Ao.notEquals("config.terminal.integrated.tabs.hideCondition","never"),b.Ao.or(b.Ao.not("config.terminal.integrated.tabs.enabled"),b.Ao.and(b.Ao.equals("config.terminal.integrated.tabs.showActions","singleTerminal"),b.Ao.equals("terminalCount",1)),b.Ao.and(b.Ao.equals("config.terminal.integrated.tabs.showActions","singleTerminalOrNarrow"),b.Ao.or(b.Ao.equals("terminalCount",1),b.Ao.has("isTerminalTabsNarrow"))),b.Ao.and(b.Ao.equals("config.terminal.integrated.tabs.showActions","singleGroup"),b.Ao.equals("terminalGroupCount",1)),b.Ao.equals("config.terminal.integrated.tabs.showActions","always")))}},{id:H.eH.ViewTitle,item:{command:{id:"workbench.action.terminal.kill",title:oe.kill,icon:R.lA.trash},group:"navigation",order:3,when:b.Ao.and(b.Ao.equals("view",r.e9),b.Ao.notEquals("config.terminal.integrated.tabs.hideCondition","never"),b.Ao.or(b.Ao.not("config.terminal.integrated.tabs.enabled"),b.Ao.and(b.Ao.equals("config.terminal.integrated.tabs.showActions","singleTerminal"),b.Ao.equals("terminalCount",1)),b.Ao.and(b.Ao.equals("config.terminal.integrated.tabs.showActions","singleTerminalOrNarrow"),b.Ao.or(b.Ao.equals("terminalCount",1),b.Ao.has("isTerminalTabsNarrow"))),b.Ao.and(b.Ao.equals("config.terminal.integrated.tabs.showActions","singleGroup"),b.Ao.equals("terminalGroupCount",1)),b.Ao.equals("config.terminal.integrated.tabs.showActions","always")))}},{id:H.eH.ViewTitle,item:{command:{id:"workbench.action.terminal.new",title:oe.new,icon:R.lA.plus},alt:{id:"workbench.action.terminal.split",title:oe.split.value,icon:R.lA.splitHorizontal},group:"navigation",order:0,when:b.Ao.and(b.Ao.equals("view",r.e9),b.Ao.or(he.r.webExtensionContributedProfile,he.r.processSupported))}},{id:H.eH.ViewTitle,item:{command:{id:"workbench.action.terminal.clear",title:(0,p.NC)("workbench.action.terminal.clearLong","Clear Terminal"),icon:R.lA.clearAll},group:"navigation",order:4,when:b.Ao.equals("view",r.e9),isHiddenByDefault:!0}},{id:H.eH.ViewTitle,item:{command:{id:"workbench.action.terminal.runActiveFile",title:(0,p.NC)("workbench.action.terminal.runActiveFile","Run Active File"),icon:R.lA.run},group:"navigation",order:5,when:b.Ao.equals("view",r.e9),isHiddenByDefault:!0}},{id:H.eH.ViewTitle,item:{command:{id:"workbench.action.terminal.runSelectedText",title:(0,p.NC)("workbench.action.terminal.runSelectedText","Run Selected Text"),icon:R.lA.selection},group:"navigation",order:6,when:b.Ao.equals("view",r.e9),isHiddenByDefault:!0}}]),H.BH.appendMenuItems([{id:H.eH.TerminalInlineTabContext,item:{command:{id:"workbench.action.terminal.split",title:oe.split.value},group:"1_create",order:1}},{id:H.eH.TerminalInlineTabContext,item:{command:{id:"workbench.action.terminal.moveToEditor",title:oe.moveToEditor.value},group:"1_create",order:2}},{id:H.eH.TerminalInlineTabContext,item:{command:{id:"workbench.action.terminal.changeIconPanel",title:oe.changeIcon.value},group:"2_edit"}},{id:H.eH.TerminalInlineTabContext,item:{command:{id:"workbench.action.terminal.changeColorPanel",title:oe.changeColor.value},group:"2_edit"}},{id:H.eH.TerminalInlineTabContext,item:{command:{id:"workbench.action.terminal.renamePanel",title:oe.rename.value},group:"2_edit"}},{id:H.eH.TerminalInlineTabContext,item:{command:{id:"workbench.action.terminal.sizeToContentWidthInstance",title:(0,p.NC)("workbench.action.terminal.sizeToContentWidthInstance","Toggle Size to Content Width")},group:"2_edit"}},{id:H.eH.TerminalInlineTabContext,item:{command:{id:"workbench.action.terminal.kill",title:oe.kill.value},group:"4_kill"}}]),H.BH.appendMenuItems([{id:H.eH.TerminalTabContext,item:{command:{id:"workbench.action.terminal.splitInstance",title:oe.split.value},group:"1_create",order:1}},{id:H.eH.TerminalTabContext,item:{command:{id:"workbench.action.terminal.moveToEditorInstance",title:oe.moveToEditor.value},group:"1_create",order:2}},{id:H.eH.TerminalTabContext,item:{command:{id:"workbench.action.terminal.renameInstance",title:(0,p.NC)("workbench.action.terminal.renameInstance","Rename...")},group:"2_edit"}},{id:H.eH.TerminalTabContext,item:{command:{id:"workbench.action.terminal.changeIconInstance",title:(0,p.NC)("workbench.action.terminal.changeIcon","Change Icon...")},group:"2_edit"}},{id:H.eH.TerminalTabContext,item:{command:{id:"workbench.action.terminal.changeColorInstance",title:(0,p.NC)("workbench.action.terminal.changeColor","Change Color...")},group:"2_edit"}},{id:H.eH.TerminalTabContext,item:{command:{id:"workbench.action.terminal.sizeToContentWidthInstance",title:(0,p.NC)("workbench.action.terminal.sizeToContentWidthInstance","Toggle Size to Content Width")},group:"2_edit"}},{id:H.eH.TerminalTabContext,item:{group:"5_config",command:{id:"workbench.action.terminal.joinInstance",title:(0,p.NC)("workbench.action.terminal.joinInstance","Join Terminals")},when:he.r.tabsSingularSelection.toNegated()}},{id:H.eH.TerminalTabContext,item:{group:"5_config",command:{id:"workbench.action.terminal.unsplitInstance",title:oe.unsplit.value},when:b.Ao.and(he.r.tabsSingularSelection,he.r.splitTerminal)}},{id:H.eH.TerminalTabContext,item:{command:{id:"workbench.action.terminal.killInstance",title:oe.kill.value},group:"4_kill"}}]),H.BH.appendMenuItem(H.eH.EditorTitleContext,{command:{id:"workbench.action.terminal.moveToTerminalPanel",title:oe.moveToTerminalPanel},when:E.f1.Scheme.isEqualTo(m.lg.vscodeTerminal),group:"2_files"}),H.BH.appendMenuItem(H.eH.EditorTitleContext,{command:{id:"workbench.action.terminal.rename",title:oe.rename},when:E.f1.Scheme.isEqualTo(m.lg.vscodeTerminal),group:"3_files"}),H.BH.appendMenuItem(H.eH.EditorTitleContext,{command:{id:"workbench.action.terminal.changeColor",title:oe.changeColor},when:E.f1.Scheme.isEqualTo(m.lg.vscodeTerminal),group:"3_files"}),H.BH.appendMenuItem(H.eH.EditorTitleContext,{command:{id:"workbench.action.terminal.changeIcon",title:oe.changeIcon},when:E.f1.Scheme.isEqualTo(m.lg.vscodeTerminal),group:"3_files"}),H.BH.appendMenuItem(H.eH.EditorTitleContext,{command:{id:"workbench.action.terminal.sizeToContentWidth",title:oe.toggleSizeToContentWidth},when:E.f1.Scheme.isEqualTo(m.lg.vscodeTerminal),group:"3_files"}),H.BH.appendMenuItem(H.eH.EditorTitle,{command:{id:"workbench.action.createTerminalEditorSameGroup",title:oe.new,icon:R.lA.plus},alt:{id:"workbench.action.terminal.split",title:oe.split.value,icon:R.lA.splitHorizontal},group:"navigation",order:0,when:E.f1.Scheme.isEqualTo(m.lg.vscodeTerminal)}),(0,yi.OG)();var io=i(40748),no=i(83022),so=i(97295);let ro=class extends u.JT{onClose(){this._instance.focus(),this.dispose()}constructor(e,t,i,n,s){super(),this._instance=e,this._keybindingService=n,this._accessibilityService=s,this._hasShellIntegration=!1,this.options={type:"help",ariaLabel:(0,p.NC)("terminal-help-label","terminal accessibility help"),readMoreUrl:"https://code.visualstudio.com/docs/editor/accessibility#_terminal-accessibility"},this.verbositySettingKey="accessibility.verbosity.terminal",this._hasShellIntegration=2===t.shellIntegration.status}_descriptionForCommand(e,t,i){const n=this._keybindingService.lookupKeybindings(e);switch(n.length){case 0:return(0,so.WU)(i,e);case 1:return(0,so.WU)(t,n[0].getAriaLabel())}return this._accessibilityService.isScreenReaderOptimized()?(0,so.WU)(t,n[1].getAriaLabel()):(0,so.WU)(t,n[0].getAriaLabel())}provideContent(){const e=[];return e.push(this._descriptionForCommand("workbench.action.terminal.focusAccessibleBuffer",(0,p.NC)("focusAccessibleBuffer","The Focus Accessible Buffer ({0}) command enables screen readers to read terminal contents."),(0,p.NC)("focusAccessibleBufferNoKb","The Focus Accessible Buffer command enables screen readers to read terminal contents and is currently not triggerable by a keybinding."))),"cmd"===this._instance.shellType&&e.push((0,p.NC)("commandPromptMigration","Consider using powershell instead of command prompt for an improved experience")),this._hasShellIntegration?(e.push((0,p.NC)("shellIntegration","The terminal has a feature called shell integration that offers an enhanced experience and provides useful commands for screen readers such as:")),e.push("- "+this._descriptionForCommand("workbench.action.terminal.accessibleBufferGoToNextCommand",(0,p.NC)("goToNextCommand","Go to Next Command ({0})"),(0,p.NC)("goToNextCommandNoKb","Go to Next Command is currently not triggerable by a keybinding."))),e.push("- "+this._descriptionForCommand("workbench.action.terminal.accessibleBufferGoToPreviousCommand",(0,p.NC)("goToPreviousCommand","Go to Previous Command ({0})"),(0,p.NC)("goToPreviousCommandNoKb","Go to Previous Command is currently not triggerable by a keybinding."))),e.push("- "+this._descriptionForCommand("workbench.action.terminal.navigateAccessibleBuffer",(0,p.NC)("navigateAccessibleBuffer","Navigate Accessible Buffer ({0})"),(0,p.NC)("navigateAccessibleBufferNoKb","Navigate Accessible Buffer is currently not triggerable by a keybinding."))),e.push("- "+this._descriptionForCommand("workbench.action.terminal.runRecentCommand",(0,p.NC)("runRecentCommand","Run Recent Command ({0})"),(0,p.NC)("runRecentCommandNoKb","Run Recent Command is currently not triggerable by a keybinding."))),e.push("- "+this._descriptionForCommand("workbench.action.terminal.goToRecentDirectory",(0,p.NC)("goToRecentDirectory","Go to Recent Directory ({0})"),(0,p.NC)("goToRecentDirectoryNoKb","Go to Recent Directory is currently not triggerable by a keybinding.")))):e.push(this._descriptionForCommand("workbench.action.terminal.runRecentCommand",(0,p.NC)("goToRecentDirectoryNoShellIntegration","The Go to Recent Directory command ({0}) enables screen readers to easily navigate to a directory that has been used in the terminal."),(0,p.NC)("goToRecentDirectoryNoKbNoShellIntegration","The Go to Recent Directory command enables screen readers to easily navigate to a directory that has been used in the terminal and is currently not triggerable by a keybinding."))),e.push(this._descriptionForCommand("workbench.action.terminal.openDetectedLink",(0,p.NC)("openDetectedLink","The Open Detected Link ({0}) command enables screen readers to easily open links found in the terminal."),(0,p.NC)("openDetectedLinkNoKb","The Open Detected Link command enables screen readers to easily open links found in the terminal and is currently not triggerable by a keybinding."))),e.push(this._descriptionForCommand("workbench.action.terminal.newWithProfile",(0,p.NC)("newWithProfile","The Create New Terminal (With Profile) ({0}) command allows for easy terminal creation using a specific profile."),(0,p.NC)("newWithProfileNoKb","The Create New Terminal (With Profile) command allows for easy terminal creation using a specific profile and is currently not triggerable by a keybinding."))),e.push((0,p.NC)("accessibilitySettings","Access accessibility settings such as `terminal.integrated.tabFocusMode` via the Preferences: Open Accessibility Settings command.")),e.join("\n")}};ro=(0,a.g)([(0,a.f)(2,S.TG),(0,a.f)(3,Tn.d),(0,a.f)(4,O.F7)],ro);let oo=class{get lines(){return this._lines}constructor(e,t,i){this._xterm=e,this._logService=t,this._configurationService=i,this._priorEditorViewportLineCount=0,this._lines=[],this.bufferToEditorLineMapping=new Map}reset(){this._lines=[],this._lastCachedMarker=void 0,this.update()}update(){this._lastCachedMarker?.isDisposed&&(this._lines=[],this._lastCachedMarker=void 0),this._removeViewportContent(),this._updateCachedContent(),this._updateViewportContent(),this._lastCachedMarker=this._xterm.raw.registerMarker(),this._logService.debug("Buffer content tracker: set ",this._lines.length," lines")}_updateCachedContent(){const e=this._xterm.raw.buffer.active,t=this._lastCachedMarker?.line?this._lastCachedMarker.line-this._xterm.raw.rows+1:0,i=e.baseY;if(t<0||t>i)return;const n=this._configurationService.getValue("terminal.integrated.scrollback")+this._xterm.raw.rows-1,s=i-t;if(s+this._lines.length>n){const e=s+this._lines.length-n;for(let t=0;t<e;t++)this._lines.shift();this._logService.debug("Buffer content tracker: removed ",e," lines from top of cached lines, now ",this._lines.length," lines")}const r=[];let o="";for(let n=t;n<i;n++){const t=e.getLine(n);if(!t)continue;this.bufferToEditorLineMapping.set(n,this._lines.length+r.length);const i=e.getLine(n+1)?.isWrapped;o+=t.translateToString(!i),(o&&!i||n===e.baseY+this._xterm.raw.rows-1)&&t.length&&(r.push(o),o="")}this._logService.debug("Buffer content tracker:",r.length," lines cached"),this._lines.push(...r)}_removeViewportContent(){if(!this._lines.length)return;let e=this._priorEditorViewportLineCount,t=1;for(;e;)this.bufferToEditorLineMapping.forEach(((e,i)=>{e===this._lines.length-t&&this.bufferToEditorLineMapping.delete(i)})),this._lines.pop(),t++,e--;this._logService.debug("Buffer content tracker: removed lines from viewport, now ",this._lines.length," lines cached")}_updateViewportContent(){const e=this._xterm.raw.buffer.active;this._priorEditorViewportLineCount=0;let t="";for(let i=e.baseY;i<e.baseY+this._xterm.raw.rows;i++){const n=e.getLine(i);if(!n)continue;this.bufferToEditorLineMapping.set(i,this._lines.length);const s=e.getLine(i+1)?.isWrapped;t+=n.translateToString(!s),(t&&!s||i===e.baseY+this._xterm.raw.rows-1)&&t.length&&(this._priorEditorViewportLineCount++,this._lines.push(t),t="")}this._logService.debug("Viewport content update complete, ",this._lines.length," lines in the viewport")}};oo=(0,a.g)([(0,a.f)(1,s.DV),(0,a.f)(2,v.Ui)],oo);var ao=i(16830),co=i(95099),lo=i(91526),ho=i(92069);let uo=class extends u.SL{get element(){return this._element}get editorWidget(){return this._editorWidget}constructor(e,t,i,n,s,r,o,a,l){super(),this._className=e,this._instance=t,this._xterm=i,this._focusContextKey=n,this._instantiationService=s,this._modelService=r,this._configurationService=o,this._contextKeyService=a,this._terminalService=l,this._listeners=[],this._xtermElement=i.raw.element,this._element=document.createElement("div"),this._element.setAttribute("role","document"),this._element.classList.add(e),this._element.classList.add("terminal-accessible-widget"),this._editorContainer=document.createElement("div");const h={contributions:ao.Uc.getEditorContributions().filter((e=>e.id!==ho.G.ID))},u=i.getFont(),m={...(0,lo.e)(this._configurationService),lineDecorationsWidth:6,dragAndDrop:!0,cursorWidth:1,fontSize:u.fontSize,lineHeight:u.charHeight?u.charHeight*u.lineHeight:1,letterSpacing:u.letterSpacing,fontFamily:u.fontFamily,wrappingStrategy:"advanced",wrappingIndent:"none",padding:{top:2,bottom:2},quickSuggestions:!1,renderWhitespace:"none",dropIntoEditor:{enabled:!0},readOnly:!0};this._editorWidget=this.add(this._instantiationService.createInstance(co.Gm,this._editorContainer,m,h)),this._element.replaceChildren(this._editorContainer),this._xtermElement.insertAdjacentElement("beforebegin",this._element),this._focusContextKey&&(this._focusTracker=this.add(c.go(this._editorContainer)),this._focusedContextKey=this._focusContextKey.bindTo(this._contextKeyService),this.add(this._focusTracker.onDidFocus((()=>this._focusedContextKey?.set(!0)))),this.add(this._focusTracker.onDidBlur((()=>this._focusedContextKey?.reset())))),this.add(d.ju.runAndSubscribe(this._xterm.raw.onResize,(()=>this.layout()))),this.add(this._configurationService.onDidChangeConfiguration((e=>{if(e.affectedKeys.has("terminal.integrated.fontFamily")||e.affectedKeys.has("terminal.integrated.fontSize")||e.affectedKeys.has("terminal.integrated.lineHeight")||e.affectedKeys.has("terminal.integrated.letterSpacing")){const e=this._xterm.getFont();this._editorWidget.updateOptions({fontFamily:e.fontFamily,fontSize:e.fontSize,lineHeight:e.charHeight?e.charHeight*e.lineHeight:1,letterSpacing:e.letterSpacing})}}))),this.add(this._editorWidget.onKeyDown((e=>{switch(e.keyCode){case 9:this.hide(),this._xterm.raw.focus();break;case 2:this.hide()}}))),this.add(this._editorWidget.onDidFocusEditorText((async()=>{this._terminalService.setActiveInstance(this._instance),this._xtermElement.classList.add("hide")})))}registerListeners(){this._listeners.push(this._instance.onDidRequestFocus((()=>this.editorWidget.focus())))}layout(){this._editorWidget.layout({width:this._xtermElement.clientWidth,height:this._xtermElement.clientHeight})}async show(){this.registerListeners(),await this.updateEditor(),this.element.tabIndex=-1,this.layout(),this.element.classList.add("active"),this._xtermElement.classList.add("hide"),this.editorWidget.focus()}dispose(){this._disposeListeners(),super.dispose()}_disposeListeners(){for(const e of this._listeners)e.dispose()}hide(){this._disposeListeners(),this.element.classList.remove("active"),this._xtermElement.classList.remove("hide")}async getTextModel(e){const t=this._modelService.getModel(e);return t&&!t.isDisposed()?t:this._modelService.createModel(`${this._className}-${e.fragment}`,null,e,!1)}};uo=(0,a.g)([(0,a.f)(4,S.TG),(0,a.f)(5,Me.q),(0,a.f)(6,v.Ui),(0,a.f)(7,b.i6),(0,a.f)(8,o.x4)],uo);let mo=class extends uo{constructor(e,t,i,n,s,r,o,a,c,l){super("accessible-buffer",e,t,he.r.accessibleBufferFocus,i,n,s,a,l),this._quickInputService=r,this._audioCueService=o,this._logService=c,this._isUpdating=!1,this._pendingUpdates=0,this._bufferTracker=i.createInstance(oo,t),this.element.ariaRoleDescription=(0,p.NC)("terminal.integrated.accessibleBuffer","Terminal buffer"),this.updateEditor(),this.add(this.editorWidget.onDidFocusEditorText((async()=>{this.element.classList.contains("active")||(this.registerListeners(),await this.updateEditor(),this.element.classList.add("active"))}))),this.layout()}navigateToCommand(e){const t=this.editorWidget.getPosition()?.lineNumber||this._getDefaultCursorPosition()?.lineNumber,i=this._getCommandsWithEditorLine();if(!i?.length||!t)return;const n="previous"===e?i.filter((e=>e.lineNumber<t)).sort(((e,t)=>t.lineNumber-e.lineNumber)):i.filter((e=>e.lineNumber>t)).sort(((e,t)=>e.lineNumber-t.lineNumber));n.length&&(this._cursorPosition={lineNumber:n[0].lineNumber,column:1},this._resetPosition())}_getEditorLineForCommand(e){let t=e.marker?.line;if(void 0!==t&&e.command.length&&!(t<0)&&(t=this._bufferTracker.bufferToEditorLineMapping.get(t),void 0!==t))return t+1}_getCommandsWithEditorLine(){const e=this._instance.capabilities.get(2)?.commands;if(!e?.length)return;const t=[];for(const i of e){const e=this._getEditorLineForCommand(i);e&&t.push({command:i,lineNumber:e})}return t}async createQuickPick(){this._cursorPosition=(0,B.f6)(this.editorWidget.getPosition());const e=this._getCommandsWithEditorLine();if(!e)return;const t=[];for(const{command:i,lineNumber:n}of e)this._getEditorLineForCommand(i)&&t.push({label:(0,p.NC)("terminal.integrated.symbolQuickPick.labelNoExitCode","{0}",i.command),lineNumber:n,exitCode:i.exitCode});const i=this._quickInputService.createQuickPick();return i.canSelectMany=!1,i.onDidChangeActive((()=>{const e=i.activeItems[0];e&&(e.exitCode&&this._audioCueService.playAudioCue(Ki.y$.error,!0),this.editorWidget.revealLine(e.lineNumber,0))})),i.onDidHide((()=>{this._resetPosition(),i.dispose()})),i.onDidAccept((()=>{const e=i.activeItems[0];this.editorWidget.getModel()&&(!e&&this._cursorPosition?this._resetPosition():this._cursorPosition={lineNumber:e.lineNumber,column:1},i.dispose(),this.editorWidget.focus())})),i.items=t.reverse(),i}_resetPosition(){this._cursorPosition=this._cursorPosition??this._getDefaultCursorPosition(),this._cursorPosition&&(this.editorWidget.setPosition(this._cursorPosition),this.editorWidget.setScrollPosition({scrollTop:this.editorWidget.getTopForLineNumber(this._cursorPosition.lineNumber)}))}layout(){this._bufferTracker&&this._bufferTracker.reset(),super.layout()}async updateEditor(e){this._isUpdating?this._pendingUpdates++:(this._isUpdating=!0,await this._updateModel(e)&&(this._isUpdating=!1,this._pendingUpdates&&(this._logService.debug("TerminalAccessibleBuffer._updateEditor: pending updates",this._pendingUpdates),this._pendingUpdates--,await this.updateEditor(e))))}registerListeners(){super.registerListeners(),this._xterm.raw.onWriteParsed((async()=>{0===this._xterm.raw.buffer.active.baseY&&await this.updateEditor(!0)}));const e=d.ju.latch(this._xterm.raw.onScroll);this._listeners.push(e((async()=>await this.updateEditor(!0))))}_getDefaultCursorPosition(){const e=this.editorWidget.getModel()?.getLineCount();return e?{lineNumber:e,column:1}:void 0}async _updateModel(e){const t=this._bufferTracker.lines.length;this._bufferTracker.update();const i=t!==this._bufferTracker.lines.length;let n;e&&(n=(0,B.f6)(this.editorWidget.saveViewState()));let s=this.editorWidget.getModel();const r=this._bufferTracker.lines.join("\n");s?s.setValue(r):s=await this.getTextModel(this._instance.resource.with({fragment:`accessible-buffer-${r}`})),this.editorWidget.setModel(s);const o=1===this.editorWidget.getPosition()?.lineNumber&&1===this.editorWidget.getPosition()?.column;if(n)this.editorWidget.restoreViewState(n);else if(i||o){const e=this._getDefaultCursorPosition();e&&(this.editorWidget.setPosition(e),this.editorWidget.setScrollPosition({scrollTop:this.editorWidget.getTopForLineNumber(e.lineNumber)}))}return s}};mo=(0,a.g)([(0,a.f)(2,S.TG),(0,a.f)(3,Me.q),(0,a.f)(4,v.Ui),(0,a.f)(5,$.eJ),(0,a.f)(6,Ki.e7),(0,a.f)(7,b.i6),(0,a.f)(8,s.DV),(0,a.f)(9,o.x4)],mo);let _o=class e extends u.SL{static{this.ID="terminal.accessible-buffer"}static get(t){return t.getContribution(e.ID)}constructor(e,t,i,n){super(),this._instance=e,this._instantiationService=n}layout(e){this._xterm=e}async show(){this._xterm&&(this._accessibleBufferWidget||(this._accessibleBufferWidget=this.add(this._instantiationService.createInstance(mo,this._instance,this._xterm))),await this._accessibleBufferWidget.show())}async createCommandQuickPick(){return this._accessibleBufferWidget?.createQuickPick()}navigateToCommand(e){return this._accessibleBufferWidget?.navigateToCommand(e)}};_o=(0,a.g)([(0,a.f)(3,S.TG)],_o),Pn(_o.ID,_o);class go extends u.JT{constructor(){super(),this._register(io.l.addImplementation(105,"terminal",(async e=>{const t=e.get(S.TG),i=e.get(o.x4),n=e.get(no.W),s=await i.getActiveOrCreateInstance();await i.revealActiveTerminal();const r=s?.xterm;r&&n.show(t.createInstance(ro,s,r))}),he.r.focus))}}Pn(go.ID,go),Qe({id:"workbench.action.terminal.focusAccessibleBuffer",title:{value:(0,p.NC)("workbench.action.terminal.focusAccessibleBuffer","Focus Accessible Buffer"),original:"Focus Accessible Buffer"},precondition:b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),keybinding:[{primary:1026,weight:200,when:b.Ao.and(O.UA,he.r.focus,b.Ao.or(s.sm,he.r.accessibleBufferFocus.negate()))}],run:async e=>{const t=await e.service.getActiveOrCreateInstance();await e.service.revealActiveTerminal(),t&&await(_o.get(t)?.show())}}),Qe({id:"workbench.action.terminal.navigateAccessibleBuffer",title:{value:(0,p.NC)("workbench.action.terminal.navigateAccessibleBuffer","Navigate Accessible Buffer"),original:"Navigate Accessible Buffer"},precondition:b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),keybinding:[{primary:3109,weight:202,when:he.r.accessibleBufferFocus}],run:async e=>{const t=await e.service.getActiveOrCreateInstance();if(await e.service.revealActiveTerminal(),!t)return;const i=await(_o.get(t)?.createCommandQuickPick());i?.show()}}),Qe({id:"workbench.action.terminal.accessibleBufferGoToNextCommand",title:{value:(0,p.NC)("workbench.action.terminal.accessibleBufferGoToNextCommand","Accessible Buffer Go to Next Command"),original:"Accessible Buffer Go to Next Command"},precondition:b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated,he.r.accessibleBufferFocus),keybinding:[{primary:2066,when:b.Ao.and(he.r.accessibleBufferFocus,O.UA.negate()),weight:202},{primary:2066,mac:{primary:530},when:b.Ao.and(he.r.accessibleBufferFocus,O.UA),weight:202}],run:async e=>{const t=await e.service.getActiveOrCreateInstance();await e.service.revealActiveTerminal(),t&&await(_o.get(t)?.navigateToCommand("next"))}}),Qe({id:"workbench.action.terminal.accessibleBufferGoToPreviousCommand",title:{value:(0,p.NC)("workbench.action.terminal.accessibleBufferGoToPreviousCommand","Accessible Buffer Go to Previous Command"),original:"Accessible Buffer Go to Previous Command"},precondition:b.Ao.and(b.Ao.or(he.r.processSupported,he.r.terminalHasBeenCreated),he.r.accessibleBufferFocus),keybinding:[{primary:2064,when:b.Ao.and(he.r.accessibleBufferFocus,O.UA.negate()),weight:202},{primary:2064,mac:{primary:528},when:b.Ao.and(he.r.accessibleBufferFocus,O.UA),weight:202}],run:async e=>{const t=await e.service.getActiveOrCreateInstance();await e.service.revealActiveTerminal(),t&&await(_o.get(t)?.navigateToCommand("previous"))}});class po{constructor(){this.getLatency=async()=>[],this.isResponsive=!0,this._whenConnected=new l.CR,this.restartPtyHost=rr.Jc,this.remoteAuthority=void 0,this.onPtyHostUnresponsive=d.ju.None,this.onPtyHostResponsive=d.ju.None,this.onPtyHostRestart=d.ju.None,this.onDidRequestDetach=d.ju.None,this.attachToProcess=rr.Jc,this.attachToRevivedProcess=rr.Jc,this.listProcesses=rr.Jc,this.getProfiles=async()=>[],this.getWslPath=rr.Jc,this.getEnvironment=async()=>({}),this.getShellEnvironment=async()=>{},this.setTerminalLayoutInfo=async()=>{},this.updateTitle=async()=>{},this.updateIcon=async()=>{},this.getTerminalLayoutInfo=async()=>{},this.reduceConnectionGraceTime=rr.Jc,this.requestDetachInstance=rr.Jc,this.acceptDetachInstanceReply=rr.Jc,this.persistTerminalState=rr.Jc}get whenReady(){return this._whenConnected.p}setReady(){this._whenConnected.complete()}async getPerformanceMarks(){return[]}}class fo{constructor(e,t,i,n){this.id=e,this.pid=t,this.cwd=i,this.onData=n,this.onReady=new d.Q5,this.shouldPersist=!1,this.onProcessData=this.onData,this.onProcessReady=this.onReady.event,this.onDidChangeProperty=d.ju.None,this.onProcessExit=d.ju.None,this.processBinary=rr.Jc,this.refreshProperty=async()=>{},setTimeout((()=>{this.onReady.fire({cwd:i,pid:t,windowsPty:void 0})}))}acknowledgeDataEvent(){}async setUnicodeVersion(){}async getInitialCwd(){return this.cwd}async getCwd(){return this.cwd}async getLatency(){return 0}async updateProperty(){}}function vo(e){return Ln.B.as(s.UU.Backend).registerTerminalBackend(e),{[o.x4.toString()]:new n.M(Cs,[],!0),[s.DV.toString()]:new n.M(tr,[],!0),[o.BZ.toString()]:new n.M(ks,[],!0),[o.Qy.toString()]:new n.M(Ls,[],!0),[o.N4.toString()]:new n.M(Ps,[],!0),[r.l5.toString()]:new n.M(Gs,[],!0),[Us.e.toString()]:new n.M(Us.u,[],!0),[qs.g.toString()]:new n.M(js,[],!0),[r.if.toString()]:new n.M(Ys,[],!0),[Un.M.toString()]:new n.M(Zs,[],!0),[er.s.toString()]:new n.M(nr,[],!0)}}},92846:(e,t,i)=>{"use strict";i.d(t,{C:()=>_});var n=i(80855),s=i(65321),r=i(59069),o=i(76033),a=i(98324),c=i(60961),l=i(93983),h=i(91847),d=i(59422),u=i(97781),m=i(31106);let _=class extends o.YH{get onDidChangeDropdownVisibility(){return this._dropdown.onDidChangeVisibility}constructor(e,t,i,n,s,r,o,l,h,d,u){super(null,e),this._contextMenuProvider=s,this._options=r,this._container=null,this._dropdownContainer=null,this._primaryAction=new c.Mm(e,void 0,o,l,h,d,s,u),this._dropdown=new a.C(t,i,this._contextMenuProvider,{menuAsChild:!0,classNames:n?["codicon","codicon-chevron-down",n]:["codicon","codicon-chevron-down"],keybindingProvider:this._options?.getKeyBinding})}setActionContext(e){super.setActionContext(e),this._primaryAction.setActionContext(e),this._dropdown.setActionContext(e)}render(e){this._container=e,super.render(this._container),this._container.classList.add("monaco-dropdown-with-primary");const t=s.$(".action-container");this._primaryAction.render(s.R3(this._container,t)),this._dropdownContainer=s.$(".dropdown-action-container"),this._dropdown.render(s.R3(this._container,this._dropdownContainer)),this._register(s.nm(t,s.tw.KEY_DOWN,(e=>{const t=new r.y1(e);t.equals(17)&&(this._primaryAction.element.tabIndex=-1,this._dropdown.focus(),t.stopPropagation())}))),this._register(s.nm(this._dropdownContainer,s.tw.KEY_DOWN,(e=>{const t=new r.y1(e);t.equals(15)&&(this._primaryAction.element.tabIndex=0,this._dropdown.setFocusable(!1),this._primaryAction.element?.focus(),t.stopPropagation())})))}focus(e){e?this._dropdown.focus():(this._primaryAction.element.tabIndex=0,this._primaryAction.element.focus())}blur(){this._primaryAction.element.tabIndex=-1,this._dropdown.blur(),this._container.blur()}setFocusable(e){e?this._primaryAction.element.tabIndex=0:(this._primaryAction.element.tabIndex=-1,this._dropdown.setFocusable(!1))}update(e,t,i){this._dropdown.dispose(),this._dropdown=new a.C(e,t,this._contextMenuProvider,{menuAsChild:!0,classNames:["codicon",i||"codicon-chevron-down"]}),this._dropdownContainer&&this._dropdown.render(this._dropdownContainer)}dispose(){this._primaryAction.dispose(),this._dropdown.dispose(),super.dispose()}};_=(0,n.g)([(0,n.f)(6,h.d),(0,n.f)(7,d.lT),(0,n.f)(8,l.i6),(0,n.f)(9,u.XE),(0,n.f)(10,m.F7)],_)},96692:(e,t,i)=>{"use strict";i.d(t,{N:()=>l});var n=i(73046),s=i(63580),r=i(25670);const o=r.kS.asClassName(n.lA.pin),a=r.kS.asClassName(n.lA.pinned),c=[o,a];async function l(e,t,i,n){const s=i.items;let r=h(t,i,e,void 0,n);i.onDidTriggerItemButton((async o=>{o.button.iconClass&&c.includes(o.button.iconClass)&&(i.items=s,r=h(t,i,e,o.item,n),i.items=i.value?s:r)})),i.onDidChangeValue((async e=>{i.items===r&&e?i.items=s:i.items!==s||e||(i.items=r)})),i.items=i.value?s:r,i.show()}function h(e,t,i,n,r){const o=[];let c;c=n?function(e,t,i){const n=t.buttons?.find((e=>e.iconClass===a));let s=m(e,i);return n?s=s.filter((e=>d(e)!==d(t))):s.push(t),i.store(e,JSON.stringify(s),1,1),s}(e,n,i):m(e,i),c.length&&o.push({type:"separator",label:(0,s.NC)("terminal.commands.pinned","pinned")});const l=new Set;for(const e of c){const i=t.items.find((t=>{return i=e,d(t)===d(i);var i}));if(i){const e=d(i),t=Object.assign({},i);r&&l.has(e)||(l.add(e),u(t,!1),o.push(t))}}for(const e of t.items)u(e,!0),o.push(e);return o}function d(e){return"separator"===e.type?"":e.id||`${e.label}${e.description}${e.detail}}`}function u(e,t){if("separator"===e.type)return;const i=e.buttons?.filter((e=>e.iconClass&&!c.includes(e.iconClass)))??[];i.unshift({iconClass:t?o:a,tooltip:t?(0,s.NC)("pinCommand","Pin command"):(0,s.NC)("pinnedCommand","Pinned command"),alwaysVisible:!1}),e.buttons=i}function m(e,t){const i=t.get(e,1);return i?JSON.parse(i):[]}},52433:(e,t,i)=>{"use strict";i.d(t,{$m:()=>_,Bl:()=>o,DJ:()=>m,QR:()=>a,j8:()=>c,jO:()=>l,mb:()=>d,qT:()=>h,tO:()=>u});var n=i(73046),s=i(63580),r=i(59554);(0,r.q5)("extensions-view-icon",n.lA.extensions,(0,s.NC)("extensionsViewIcon","View icon of the extensions view."));const o=(0,r.q5)("extensions-manage",n.lA.gear,(0,s.NC)("manageExtensionIcon","Icon for the 'Manage' action in the extensions view."));(0,r.q5)("extensions-clear-search-results",n.lA.clearAll,(0,s.NC)("clearSearchResultsIcon","Icon for the 'Clear Search Result' action in the extensions view.")),(0,r.q5)("extensions-refresh",n.lA.refresh,(0,s.NC)("refreshIcon","Icon for the 'Refresh' action in the extensions view."));const a=(0,r.q5)("extensions-filter",n.lA.filter,(0,s.NC)("filterIcon","Icon for the 'Filter' action in the extensions view."));(0,r.q5)("extensions-install-local-in-remote",n.lA.cloudDownload,(0,s.NC)("installLocalInRemoteIcon","Icon for the 'Install Local Extension in Remote' action in the extensions view.")),(0,r.q5)("extensions-install-workspace-recommended",n.lA.cloudDownload,(0,s.NC)("installWorkspaceRecommendedIcon","Icon for the 'Install Workspace Recommended Extensions' action in the extensions view.")),(0,r.q5)("extensions-configure-recommended",n.lA.pencil,(0,s.NC)("configureRecommendedIcon","Icon for the 'Configure Recommended Extensions' action in the extensions view."));const c=(0,r.q5)("extensions-sync-enabled",n.lA.sync,(0,s.NC)("syncEnabledIcon","Icon to indicate that an extension is synced.")),l=(0,r.q5)("extensions-sync-ignored",n.lA.syncIgnored,(0,s.NC)("syncIgnoredIcon","Icon to indicate that an extension is ignored when syncing."));(0,r.q5)("extensions-remote",n.lA.remote,(0,s.NC)("remoteIcon","Icon to indicate that an extension is remote in the extensions view and editor.")),(0,r.q5)("extensions-install-count",n.lA.cloudDownload,(0,s.NC)("installCountIcon","Icon shown along with the install count in the extensions view and editor.")),(0,r.q5)("extensions-rating",n.lA.star,(0,s.NC)("ratingIcon","Icon shown along with the rating in the extensions view and editor.")),(0,r.q5)("extensions-verified-publisher",n.lA.verifiedFilled,(0,s.NC)("verifiedPublisher","Icon used for the verified extension publisher in the extensions view and editor."));const h=(0,r.q5)("extensions-pre-release",n.lA.versions,(0,s.NC)("preReleaseIcon","Icon shown for extensions having pre-release versions in extensions view and editor."));(0,r.q5)("extensions-sponsor",n.lA.heartFilled,(0,s.NC)("sponsorIcon","Icon used for sponsoring extensions in the extensions view and editor.")),(0,r.q5)("extensions-star-full",n.lA.starFull,(0,s.NC)("starFullIcon","Full star icon used for the rating in the extensions editor.")),(0,r.q5)("extensions-star-half",n.lA.starHalf,(0,s.NC)("starHalfIcon","Half star icon used for the rating in the extensions editor.")),(0,r.q5)("extensions-star-empty",n.lA.starEmpty,(0,s.NC)("starEmptyIcon","Empty star icon used for the rating in the extensions editor."));const d=(0,r.q5)("extensions-error-message",n.lA.error,(0,s.NC)("errorIcon","Icon shown with a error message in the extensions editor.")),u=(0,r.q5)("extensions-warning-message",n.lA.warning,(0,s.NC)("warningIcon","Icon shown with a warning message in the extensions editor.")),m=(0,r.q5)("extensions-info-message",n.lA.info,(0,s.NC)("infoIcon","Icon shown with an info message in the extensions editor.")),_=(0,r.q5)("extension-workspace-trust",n.lA.shield,(0,s.NC)("trustIcon","Icon shown with a workspace trust message in the extension editor."));(0,r.q5)("extension-activation-time",n.lA.history,(0,s.NC)("activationtimeIcon","Icon shown with a activation time message in the extension editor."))},41443:(e,t,i)=>{"use strict";i.d(t,{X:()=>n});const n="workbench.action.showWindowLog"}}]);
//# sourceMappingURL=685.bundle.js.map