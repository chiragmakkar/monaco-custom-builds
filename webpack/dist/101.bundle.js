"use strict";(self.webpackChunkmonaco_custom_bundle=self.webpackChunkmonaco_custom_bundle||[]).push([[101],{68875:(e,t,i)=>{i.d(t,{Z:()=>a});var s=i(87537),r=i.n(s),o=i(23645),n=i.n(o)()(r());n.push([e.id,"/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\n.monaco-editor .findOptionsWidget {\n\tbackground-color: var(--vscode-editorWidget-background);\n\tcolor: var(--vscode-editorWidget-foreground);\n\tbox-shadow: 0 0 8px 2px var(--vscode-widget-shadow);\n\tborder: 2px solid var(--vscode-contrastBorder);\n}\n","",{version:3,sources:["webpack://./node_modules/monaco-editor/esm/vs/editor/contrib/find/browser/findOptionsWidget.css"],names:[],mappings:"AAAA;;;+FAG+F;;AAE/F;CACC,uDAAuD;CACvD,4CAA4C;CAC5C,mDAAmD;CACnD,8CAA8C;AAC/C",sourcesContent:["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\n.monaco-editor .findOptionsWidget {\n\tbackground-color: var(--vscode-editorWidget-background);\n\tcolor: var(--vscode-editorWidget-foreground);\n\tbox-shadow: 0 0 8px 2px var(--vscode-widget-shadow);\n\tborder: 2px solid var(--vscode-contrastBorder);\n}\n"],sourceRoot:""}]);const a=n},19620:(e,t,i)=>{i.d(t,{Z:()=>a});var s=i(87537),r=i.n(s),o=i(23645),n=i.n(o)()(r());n.push([e.id,"/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\n.monaco-editor .focused .selectionHighlight {\n\tbackground-color: var(--vscode-editor-selectionHighlightBackground);\n\tbox-sizing: border-box;\n\tborder: 1px solid var(--vscode-editor-selectionHighlightBorder);\n}\n.monaco-editor.hc-black .focused .selectionHighlight, .monaco-editor.hc-light .focused .selectionHighlight {\n\tborder-style: dotted;\n}\n\n.monaco-editor .wordHighlight {\n\tbackground-color: var(--vscode-editor-wordHighlightBackground);\n\tbox-sizing: border-box;\n\tborder: 1px solid var(--vscode-editor-wordHighlightBorder);\n}\n.monaco-editor.hc-black .wordHighlight, .monaco-editor.hc-light .wordHighlight {\n\tborder-style: dotted;\n}\n\n.monaco-editor .wordHighlightStrong {\n\tbackground-color: var(--vscode-editor-wordHighlightStrongBackground);\n\tbox-sizing: border-box;\n\tborder: 1px solid var(--vscode-editor-wordHighlightStrongBorder);\n}\n.monaco-editor.hc-black .wordHighlightStrong, .monaco-editor.hc-light .wordHighlightStrong {\n\tborder-style: dotted;\n}\n\n.monaco-editor .wordHighlightText {\n\tbackground-color: var(--vscode-editor-wordHighlightTextBackground);\n\tbox-sizing: border-box;\n\tborder: 1px solid var(--vscode-editor-wordHighlightTextBorder);\n}\n.monaco-editor.hc-black .wordHighlightText, .monaco-editor.hc-light .wordHighlightText {\n\tborder-style: dotted;\n}\n","",{version:3,sources:["webpack://./node_modules/monaco-editor/esm/vs/editor/contrib/wordHighlighter/browser/highlightDecorations.css"],names:[],mappings:"AAAA;;;+FAG+F;;AAE/F;CACC,mEAAmE;CACnE,sBAAsB;CACtB,+DAA+D;AAChE;AACA;CACC,oBAAoB;AACrB;;AAEA;CACC,8DAA8D;CAC9D,sBAAsB;CACtB,0DAA0D;AAC3D;AACA;CACC,oBAAoB;AACrB;;AAEA;CACC,oEAAoE;CACpE,sBAAsB;CACtB,gEAAgE;AACjE;AACA;CACC,oBAAoB;AACrB;;AAEA;CACC,kEAAkE;CAClE,sBAAsB;CACtB,8DAA8D;AAC/D;AACA;CACC,oBAAoB;AACrB",sourcesContent:["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\n.monaco-editor .focused .selectionHighlight {\n\tbackground-color: var(--vscode-editor-selectionHighlightBackground);\n\tbox-sizing: border-box;\n\tborder: 1px solid var(--vscode-editor-selectionHighlightBorder);\n}\n.monaco-editor.hc-black .focused .selectionHighlight, .monaco-editor.hc-light .focused .selectionHighlight {\n\tborder-style: dotted;\n}\n\n.monaco-editor .wordHighlight {\n\tbackground-color: var(--vscode-editor-wordHighlightBackground);\n\tbox-sizing: border-box;\n\tborder: 1px solid var(--vscode-editor-wordHighlightBorder);\n}\n.monaco-editor.hc-black .wordHighlight, .monaco-editor.hc-light .wordHighlight {\n\tborder-style: dotted;\n}\n\n.monaco-editor .wordHighlightStrong {\n\tbackground-color: var(--vscode-editor-wordHighlightStrongBackground);\n\tbox-sizing: border-box;\n\tborder: 1px solid var(--vscode-editor-wordHighlightStrongBorder);\n}\n.monaco-editor.hc-black .wordHighlightStrong, .monaco-editor.hc-light .wordHighlightStrong {\n\tborder-style: dotted;\n}\n\n.monaco-editor .wordHighlightText {\n\tbackground-color: var(--vscode-editor-wordHighlightTextBackground);\n\tbox-sizing: border-box;\n\tborder: 1px solid var(--vscode-editor-wordHighlightTextBorder);\n}\n.monaco-editor.hc-black .wordHighlightText, .monaco-editor.hc-light .wordHighlightText {\n\tborder-style: dotted;\n}\n"],sourceRoot:""}]);const a=n},52101:(e,t,i)=>{i.r(t),i.d(t,{default:()=>Uo}),i(29769);var s=i(97108),r=i(82524),o=i(80855),n=i(9488),a=i(15393),c=i(17301),l=i(5976),h=i(43702),d=i(66663),u=i(84013),g=i(98401),p=i(73733),f=i(75761),m=i(43557),v=i(10829),S=i(48205),y=i(41122),w=i(24448),C=i(12021),b=i(10742);let x=class extends l.JT{constructor(e,t,i,s,r,o,n){super(),this.modelService=e,this.editorService=t,this.telemetryService=i,this.logService=s,this.extensionService=r,this.fileService=o,this.uriIdentityService=n,this.fileSearchProviders=new Map,this.textSearchProviders=new Map,this.deferredFileSearchesByScheme=new Map,this.deferredTextSearchesByScheme=new Map,this.loggedSchemesMissingProviders=new Set}registerSearchResultProvider(e,t,i){let s,r;if(0===t)s=this.fileSearchProviders,r=this.deferredFileSearchesByScheme;else{if(1!==t)throw new Error("Unknown SearchProviderType");s=this.textSearchProviders,r=this.deferredTextSearchesByScheme}return s.set(e,i),r.has(e)&&(r.get(e).complete(i),r.delete(e)),(0,l.OF)((()=>{s.delete(e)}))}async textSearch(e,t,i,s){const o=this.getLocalResults(e);i&&n.kX([...o.results.values()]).forEach(i);const a=await this.doSearch(e,t,(e=>{(0,r.Es)(e)?o.results.has(e.resource)||s&&s.has(e.resource)||!i||i(e):i&&i(e),(0,r.d3)(e)&&this.logService.debug("SearchService#search",e.message)}));return{...a,limitHit:a.limitHit||o.limitHit,results:[...a.results,...n.kX([...o.results.values()])]}}fileSearch(e,t){return this.doSearch(e,t)}doSearch(e,t,i){this.logService.trace("SearchService#search",JSON.stringify(e));const s=this.getSchemesInQuery(e),r=[Promise.resolve(null)];s.forEach((e=>r.push(this.extensionService.activateByEvent(`onSearch:${e}`)))),r.push(this.extensionService.activateByEvent("onSearch:file"));const o=(async()=>{if(await Promise.all(r),await this.extensionService.whenInstalledExtensionsRegistered(),t&&t.isCancellationRequested)return Promise.reject(new c.FU);const s=await Promise.all(e.folderQueries.map((e=>this.fileService.exists(e.folder))));e.folderQueries=e.folderQueries.filter(((e,t)=>s[t]));let o=await this.searchWithProviders(e,(e=>{t&&t.isCancellationRequested||i?.(e)}),t);return o=n.kX(o),o.length?{limitHit:o[0]&&o[0].limitHit,stats:o[0].stats,messages:n.kX(n.xH(o.map((e=>e.messages)))).filter(n.In((e=>e.type+e.text+e.trusted))),results:n.xH(o.map((e=>e.results)))}:{limitHit:!1,results:[],messages:[]}})();return new Promise(((e,i)=>{t&&t.onCancellationRequested((()=>{i(new c.FU)})),o.then(e,i)}))}getSchemesInQuery(e){const t=new Set;return e.folderQueries?.forEach((e=>t.add(e.folder.scheme))),e.extraFileResources?.forEach((e=>t.add(e.scheme))),t}async waitForProvider(e,t){const i=1===e?this.deferredFileSearchesByScheme:this.deferredTextSearchesByScheme;if(i.has(t))return i.get(t).p;{const e=new a.CR;return i.set(t,e),e.p}}async searchWithProviders(e,t,i){const s=u.G.create(!1),o=[],n=this.groupFolderQueriesByScheme(e),a=[...n.keys()].some((t=>1===e.type?this.fileSearchProviders.has(t):this.textSearchProviders.has(t)));return await Promise.all([...n.keys()].map((async s=>{const r=n.get(s);let c=1===e.type?this.fileSearchProviders.get(s):this.textSearchProviders.get(s);if(!c){if(a)return void(this.loggedSchemesMissingProviders.has(s)||(this.logService.warn(`No search provider registered for scheme: ${s}. Another scheme has a provider, not waiting for ${s}`),this.loggedSchemesMissingProviders.add(s)));this.loggedSchemesMissingProviders.has(s)||(this.logService.warn(`No search provider registered for scheme: ${s}, waiting`),this.loggedSchemesMissingProviders.add(s)),c=await this.waitForProvider(e.type,s)}const l={...e,folderQueries:r};o.push(1===e.type?c.fileSearch(l,i):c.textSearch(l,t,i))}))),Promise.all(o).then((t=>{const i=s.elapsed();return this.logService.trace(`SearchService#search: ${i}ms`),t.forEach((t=>{this.sendTelemetry(e,i,t)})),t}),(t=>{const i=s.elapsed();this.logService.trace(`SearchService#search: ${i}ms`);const o=(0,r.qe)(t);throw this.logService.trace(`SearchService#searchError: ${o.message}`),this.sendTelemetry(e,i,void 0,o),o}))}groupFolderQueriesByScheme(e){const t=new Map;return e.folderQueries.forEach((e=>{const i=t.get(e.folder.scheme)||[];i.push(e),t.set(e.folder.scheme,i)})),t}sendTelemetry(e,t,i,s){const o=e.folderQueries.every((e=>e.folder.scheme===d.lg.file)),n=e.folderQueries.every((e=>e.folder.scheme!==d.lg.file)),a=o?d.lg.file:n?"other":"mixed";if(1===e.type&&i&&i.stats){const s=i.stats;if(s.fromCache){const i=s.detailStats;this.telemetryService.publicLog2("cachedSearchComplete",{reason:e._reason,resultCount:s.resultCount,workspaceFolderCount:e.folderQueries.length,endToEndTime:t,sortingTime:s.sortingTime,cacheWasResolved:i.cacheWasResolved,cacheLookupTime:i.cacheLookupTime,cacheFilterTime:i.cacheFilterTime,cacheEntryCount:i.cacheEntryCount,scheme:a})}else{const i=s.detailStats;this.telemetryService.publicLog2("searchComplete",{reason:e._reason,resultCount:s.resultCount,workspaceFolderCount:e.folderQueries.length,endToEndTime:t,sortingTime:s.sortingTime,fileWalkTime:i.fileWalkTime,directoriesWalked:i.directoriesWalked,filesWalked:i.filesWalked,cmdTime:i.cmdTime,cmdResultCount:i.cmdResultCount,scheme:a})}}else if(2===e.type){let i;s&&(i=s.code===r.eq.regexParseError?"regex":s.code===r.eq.unknownEncoding?"encoding":s.code===r.eq.globParseError?"glob":s.code===r.eq.invalidLiteral?"literal":s.code===r.eq.other?"other":s.code===r.eq.canceled?"canceled":"unknown"),this.telemetryService.publicLog2("textSearchComplete",{reason:e._reason,workspaceFolderCount:e.folderQueries.length,endToEndTime:t,scheme:a,error:i})}}getLocalResults(e){const t=new h.Y9((e=>this.uriIdentityService.extUri.getComparisonKey(e)));let i=!1;if(2===e.type){const s=new h.Y9;for(const e of this.editorService.editors){const t=y.zK.getCanonicalUri(e,{supportSideBySide:y.YX.PRIMARY}),i=y.zK.getOriginalUri(e,{supportSideBySide:y.YX.PRIMARY});t&&s.set(t,i??t)}this.modelService.getModels().forEach((o=>{const n=o.uri;if(!n)return;if(i)return;const a=s.get(n);if(!a)return;if(!("search-result"!==o.getLanguageId()||e.includePattern&&e.includePattern["**/*.code-search"]))return;if(a.scheme!==d.lg.untitled&&!this.fileService.hasProvider(a))return;if("git"===a.scheme)return;if(!this.matches(a,e))return;const c=(0,g.hj)(e.maxResults)?e.maxResults+1:Number.MAX_SAFE_INTEGER;let l=o.findMatches(e.contentPattern.pattern,!1,!!e.contentPattern.isRegExp,!!e.contentPattern.isCaseSensitive,e.contentPattern.isWordMatch?e.contentPattern.wordSeparators:null,!1,c);if(l.length){c&&l.length>=c&&(i=!0,l=l.slice(0,c-1));const s=new r.ut(a);t.set(a,s);const n=(0,b.X)(l,o,e.previewOptions);s.results=(0,b.Z)(n,o,e)}else t.set(a,null)}))}return{results:t,limitHit:i}}matches(e,t){return(0,r.tQ)(t,e.fsPath)}async clearCache(e){const t=Array.from(this.fileSearchProviders.values()).map((t=>t&&t.clearCache(e)));await Promise.all(t)}};x=(0,o.g)([(0,o.f)(0,p.q),(0,o.f)(1,w.AR),(0,o.f)(2,v.bU),(0,o.f)(3,m.VZ),(0,o.f)(4,C.QS),(0,o.f)(5,f.sn),(0,o.f)(6,S.v)],x);var E=i(39183),k=i(9486),I=i(4598),R=i(63580),_=i(72042),F=i(88216),A=i(72065),N=i(71083),T=i(5826),M=i(66007),P=i(24314),O=i(69386),W=i(44349),L=i(95935),D=i(77084),B=i(59745);const q="replacePreview",H=e=>e.with({scheme:d.lg.internal,fragment:q,query:JSON.stringify({scheme:e.scheme})});let V=class{constructor(e,t){this.instantiationService=e,this.textModelResolverService=t,this.textModelResolverService.registerTextModelContentProvider(d.lg.internal,this)}provideTextContent(e){return e.fragment===q?this.instantiationService.createInstance(K).resolve(e):null}};V=(0,o.g)([(0,o.f)(0,A.TG),(0,o.f)(1,F.S)],V);let K=class extends l.JT{constructor(e,t,i,s,r){super(),this.modelService=e,this.languageService=t,this.textModelResolverService=i,this.replaceService=s,this.searchWorkbenchService=r}async resolve(e){const t=(i=e).with({scheme:JSON.parse(i.query).scheme,fragment:"",query:""});var i;const s=this.searchWorkbenchService.searchModel.searchResult.matches().filter((e=>e.resource.toString()===t.toString()))[0],r=this._register(await this.textModelResolverService.createModelReference(t)).object.textEditorModel,o=r.getLanguageId(),n=this.modelService.createModel((0,N.N1)(r.createSnapshot()),this.languageService.createById(o),e);return this._register(s.onChange((({forceUpdateModel:e})=>this.update(r,n,s,e)))),this._register(this.searchWorkbenchService.searchModel.onReplaceTermChanged((()=>this.update(r,n,s)))),this._register(s.onDispose((()=>n.dispose()))),this._register(n.onWillDispose((()=>this.dispose()))),this._register(r.onWillDispose((()=>this.dispose()))),n}update(e,t,i,s=!1){e.isDisposed()||t.isDisposed()||this.replaceService.updateReplacePreview(i,s)}};K=(0,o.g)([(0,o.f)(0,p.q),(0,o.f)(1,_.O),(0,o.f)(2,F.S),(0,o.f)(3,I.H),(0,o.f)(4,E.Zj)],K);let Q=class e{static{this.REPLACE_SAVE_SOURCE=y.dY.registerSource("searchReplace.source",R.NC("searchReplace.source","Search and Replace"))}constructor(e,t,i,s,r,o){this.textFileService=e,this.editorService=t,this.textModelResolverService=i,this.bulkEditorService=s,this.labelService=r,this.notebookEditorModelResolverService=o}async replace(t,i=void 0,s=null){const r=this.createEdits(t,s);await this.bulkEditorService.apply(r,{progress:i});const o=r.map((async t=>{if(t.resource.scheme!==d.lg.vscodeNotebookCell)return this.textFileService.files.get(t.resource)?.save({source:e.REPLACE_SAVE_SOURCE});{const i=D.Uu.parse(t.resource)?.notebook;if(i){let t;try{t=await this.notebookEditorModelResolverService.resolve(i),await t.object.save({source:e.REPLACE_SAVE_SOURCE})}finally{t?.dispose()}}}}));return a.jT.settled(o)}async openReplacePreview(e,t,i,s){const r=e instanceof E.qE?e.parent():e,o=await this.editorService.openEditor({original:{resource:r.resource},modified:{resource:H(r.resource)},label:R.NC("fileReplaceChanges","{0} ↔ {1} (Replace Preview)",r.name(),r.name()),description:this.labelService.getUriLabel((0,L.XX)(r.resource),{relative:!0}),options:{preserveFocus:t,pinned:s,revealIfVisible:!0}}),n=o?.input,a=r.onDispose((()=>{n?.dispose(),a.dispose()}));if(await this.updateReplacePreview(r),o){const t=o.getControl();e instanceof E.qE&&t&&t.revealLineInCenter(e.range().startLineNumber,1)}}async updateReplacePreview(e,t=!1){const i=H(e.resource),[s,r]=await Promise.all([this.textModelResolverService.createModelReference(e.resource),this.textModelResolverService.createModelReference(i)]),o=s.object.textEditorModel,n=r.object.textEditorModel;try{o&&n&&(t?n.setValue(o.getValue()):n.undo(),this.applyEditsToPreview(e,n))}finally{s.dispose(),r.dispose()}}applyEditsToPreview(e,t){const i=this.createEdits(e,t.uri),s=[];for(const e of i)s.push(O.h.replaceMove(P.e.lift(e.textEdit.range),e.textEdit.text));t.pushEditOperations([],s.sort(((e,t)=>P.e.compareRangesUsingStarts(e.range,t.range))),(()=>[]))}createEdits(e,t=null){const i=[];if(e instanceof E.qE)if(e instanceof E.YT){if(!e.isWebviewMatch()){const t=e;i.push(this.createEdit(t,t.replaceString,t.cell.uri))}}else{const s=e;i.push(this.createEdit(s,s.replaceString,t))}return e instanceof E.ut&&(e=[e]),e instanceof Array&&e.forEach((e=>{const s=e;s.count()>0&&i.push(...s.matches().flatMap((e=>this.createEdits(e,t))))})),i}createEdit(e,t,i=null){const s=e.parent();return new M.Gl(i??s.resource,{range:e.range(),text:t},void 0,void 0)}};Q=(0,o.g)([(0,o.f)(0,T.MM),(0,o.f)(1,w.AR),(0,o.f)(2,F.S),(0,o.f)(3,M.vu),(0,o.f)(4,W.e),(0,o.f)(5,B.M)],Q);var U=i(1432),$=i(84298),G=i(23193),z=i(93983),j=i(90725),Y=i(89872),X=i(28194),J=i(39403),Z=i(8321),ee=i(89670),te=i(3277);(0,te.Z)('.quick-input-list .quick-input-list-entry.has-actions:hover .quick-input-list-entry-action-bar .action-label.dirty-anything:before{content:"\\ea76"}',{});var ie,se=i(41157),re=i(55061),oe=i(53192),ne=i(71403),ae=i(45104),ce=i(40382),le=i(68843),he=i(51858),de=i(70666),ue=i(78787),ge=i(22016),pe=i(63651),fe=i(33108),me=i(44742),ve=i(36248);!function(e){e[e.Created=1]="Created",e[e.Loading=2]="Loading",e[e.Loaded=3]="Loaded",e[e.Errored=4]="Errored",e[e.Disposed=5]="Disposed"}(ie||(ie={}));class Se{get cacheKey(){return this.loadingPhase!==ie.Loaded&&this.previousCacheState?this.previousCacheState.cacheKey:this._cacheKey}get isLoaded(){const e=this.loadingPhase===ie.Loaded;return e||!this.previousCacheState?e:this.previousCacheState.isLoaded}get isUpdating(){const e=this.loadingPhase===ie.Loading;return e||!this.previousCacheState?e:this.previousCacheState.isUpdating}constructor(e,t,i,s){if(this.cacheQuery=e,this.loadFn=t,this.disposeFn=i,this.previousCacheState=s,this._cacheKey=me.a.nextId(),this.query=this.cacheQuery(this._cacheKey),this.loadingPhase=ie.Created,this.previousCacheState){const e=Object.assign({},this.query,{cacheKey:null}),t=Object.assign({},this.previousCacheState.query,{cacheKey:null});(0,ve.fS)(e,t)||(this.previousCacheState.dispose(),this.previousCacheState=void 0)}}load(){return this.isUpdating||(this.loadingPhase=ie.Loading,this.loadPromise=(async()=>{try{await this.loadFn(this.query),this.loadingPhase=ie.Loaded,this.previousCacheState&&(this.previousCacheState.dispose(),this.previousCacheState=void 0)}catch(e){throw this.loadingPhase=ie.Errored,e}})()),this}dispose(){this.loadPromise?(async()=>{try{await this.loadPromise}catch(e){}this.loadingPhase=ie.Disposed,this.disposeFn(this._cacheKey)})():this.loadingPhase=ie.Disposed,this.previousCacheState&&(this.previousCacheState.dispose(),this.previousCacheState=void 0)}}var ye=i(43202),we=i(5882),Ce=i(96887),be=i(50988),xe=i(11640),Ee=i(97295),ke=i(16830),Ie=i(8625),Re=i(29102),_e=i(84973),Fe=i(46970),Ae=i(65321),Ne=i(93379),Te=i.n(Ne),Me=i(7795),Pe=i.n(Me),Oe=i(90569),We=i.n(Oe),Le=i(3565),De=i.n(Le),Be=i(19216),qe=i.n(Be),He=i(44589),Ve=i.n(He),Ke=i(68875),Qe={};Qe.styleTagTransform=Ve(),Qe.setAttributes=De(),Qe.insert=We().bind(null,"head"),Qe.domAPI=Pe(),Qe.insertStyleElement=qe(),Te()(Ke.Z,Qe),Ke.Z&&Ke.Z.locals&&Ke.Z.locals;var Ue=i(51307),$e=i(93794),Ge=i(73910);class ze extends $e.${constructor(e,t,i){super(),this._hideSoon=this._register(new a.pY((()=>this._hide()),2e3)),this._isVisible=!1,this._editor=e,this._state=t,this._keybindingService=i,this._domNode=document.createElement("div"),this._domNode.className="findOptionsWidget",this._domNode.style.display="none",this._domNode.style.top="10px",this._domNode.style.zIndex="12",this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true");const s={inputActiveOptionBorder:(0,Ge.n_1)(Ge.PRb),inputActiveOptionForeground:(0,Ge.n_1)(Ge.Pvw),inputActiveOptionBackground:(0,Ge.n_1)(Ge.XEs)};this.caseSensitive=this._register(new Ue.rk(Object.assign({appendTitle:this._keybindingLabelFor(Fe.kR.ToggleCaseSensitiveCommand),isChecked:this._state.matchCase},s))),this._domNode.appendChild(this.caseSensitive.domNode),this._register(this.caseSensitive.onChange((()=>{this._state.change({matchCase:this.caseSensitive.checked},!1)}))),this.wholeWords=this._register(new Ue.Qx(Object.assign({appendTitle:this._keybindingLabelFor(Fe.kR.ToggleWholeWordCommand),isChecked:this._state.wholeWord},s))),this._domNode.appendChild(this.wholeWords.domNode),this._register(this.wholeWords.onChange((()=>{this._state.change({wholeWord:this.wholeWords.checked},!1)}))),this.regex=this._register(new Ue.eH(Object.assign({appendTitle:this._keybindingLabelFor(Fe.kR.ToggleRegexCommand),isChecked:this._state.isRegex},s))),this._domNode.appendChild(this.regex.domNode),this._register(this.regex.onChange((()=>{this._state.change({isRegex:this.regex.checked},!1)}))),this._editor.addOverlayWidget(this),this._register(this._state.onFindReplaceStateChange((e=>{let t=!1;e.isRegex&&(this.regex.checked=this._state.isRegex,t=!0),e.wholeWord&&(this.wholeWords.checked=this._state.wholeWord,t=!0),e.matchCase&&(this.caseSensitive.checked=this._state.matchCase,t=!0),!this._state.isRevealed&&t&&this._revealTemporarily()}))),this._register(Ae.nm(this._domNode,Ae.tw.MOUSE_LEAVE,(e=>this._onMouseLeave()))),this._register(Ae.nm(this._domNode,"mouseover",(e=>this._onMouseOver())))}_keybindingLabelFor(e){const t=this._keybindingService.lookupKeybinding(e);return t?` (${t.getLabel()})`:""}dispose(){this._editor.removeOverlayWidget(this),super.dispose()}getId(){return ze.ID}getDomNode(){return this._domNode}getPosition(){return{preference:0}}highlightFindOptions(){this._revealTemporarily()}_revealTemporarily(){this._show(),this._hideSoon.schedule()}_onMouseLeave(){this._hideSoon.schedule()}_onMouseOver(){this._hideSoon.cancel()}_show(){this._isVisible||(this._isVisible=!0,this._domNode.style.display="block")}_hide(){this._isVisible&&(this._isVisible=!1,this._domNode.style.display="none")}}ze.ID="editor.contrib.findOptionsWidget";var je=i(51730),Ye=i(90667),Xe=i(84144),Je=i(84972),Ze=i(5606),et=i(91847),tt=i(59422),it=i(26904),st=i(97781),rt=function(e,t,i,s){var r,o=arguments.length,n=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(n=(o<3?r(n):o>3?r(t,i,n):r(t,i))||n);return o>3&&n&&Object.defineProperty(t,i,n),n},ot=function(e,t){return function(i,s){t(i,s,e)}},nt=function(e,t,i,s){return new(i||(i=Promise))((function(r,o){function n(e){try{c(s.next(e))}catch(e){o(e)}}function a(e){try{c(s.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(n,a)}c((s=s.apply(e,t||[])).next())}))};function at(e,t="single",i=!1){if(!e.hasModel())return null;const s=e.getSelection();if("single"===t&&s.startLineNumber===s.endLineNumber||"multiple"===t)if(s.isEmpty()){const t=e.getConfiguredWordAtPosition(s.getStartPosition());if(t&&!1===i)return t.word}else if(e.getModel().getValueLengthInRange(s)<524288)return e.getModel().getValueInRange(s);return null}let ct=class e extends l.JT{get editor(){return this._editor}static get(t){return t.getContribution(e.ID)}constructor(e,t,i,s){super(),this._editor=e,this._findWidgetVisible=Fe.a_.bindTo(t),this._contextKeyService=t,this._storageService=i,this._clipboardService=s,this._updateHistoryDelayer=new a.vp(500),this._state=this._register(new je.P),this.loadQueryState(),this._register(this._state.onFindReplaceStateChange((e=>this._onStateChanged(e)))),this._model=null,this._register(this._editor.onDidChangeModel((()=>{const e=this._editor.getModel()&&this._state.isRevealed;this.disposeModel(),this._state.change({searchScope:null,matchCase:this._storageService.getBoolean("editor.matchCase",1,!1),wholeWord:this._storageService.getBoolean("editor.wholeWord",1,!1),isRegex:this._storageService.getBoolean("editor.isRegex",1,!1),preserveCase:this._storageService.getBoolean("editor.preserveCase",1,!1)},!1),e&&this._start({forceRevealReplace:!1,seedSearchStringFromSelection:"none",seedSearchStringFromNonEmptySelection:!1,seedSearchStringFromGlobalClipboard:!1,shouldFocus:0,shouldAnimate:!1,updateSearchScope:!1,loop:this._editor.getOption(40).loop})})))}dispose(){this.disposeModel(),super.dispose()}disposeModel(){this._model&&(this._model.dispose(),this._model=null)}_onStateChanged(e){this.saveQueryState(e),e.isRevealed&&(this._state.isRevealed?this._findWidgetVisible.set(!0):(this._findWidgetVisible.reset(),this.disposeModel())),e.searchString&&this.setGlobalBufferTerm(this._state.searchString)}saveQueryState(e){e.isRegex&&this._storageService.store("editor.isRegex",this._state.actualIsRegex,1,1),e.wholeWord&&this._storageService.store("editor.wholeWord",this._state.actualWholeWord,1,1),e.matchCase&&this._storageService.store("editor.matchCase",this._state.actualMatchCase,1,1),e.preserveCase&&this._storageService.store("editor.preserveCase",this._state.actualPreserveCase,1,1)}loadQueryState(){this._state.change({matchCase:this._storageService.getBoolean("editor.matchCase",1,this._state.matchCase),wholeWord:this._storageService.getBoolean("editor.wholeWord",1,this._state.wholeWord),isRegex:this._storageService.getBoolean("editor.isRegex",1,this._state.isRegex),preserveCase:this._storageService.getBoolean("editor.preserveCase",1,this._state.preserveCase)},!1)}isFindInputFocused(){return!!Fe.qm.getValue(this._contextKeyService)}getState(){return this._state}closeFindWidget(){this._state.change({isRevealed:!1,searchScope:null},!1),this._editor.focus()}toggleCaseSensitive(){this._state.change({matchCase:!this._state.matchCase},!1),this._state.isRevealed||this.highlightFindOptions()}toggleWholeWords(){this._state.change({wholeWord:!this._state.wholeWord},!1),this._state.isRevealed||this.highlightFindOptions()}toggleRegex(){this._state.change({isRegex:!this._state.isRegex},!1),this._state.isRevealed||this.highlightFindOptions()}togglePreserveCase(){this._state.change({preserveCase:!this._state.preserveCase},!1),this._state.isRevealed||this.highlightFindOptions()}toggleSearchScope(){if(this._state.searchScope)this._state.change({searchScope:null},!0);else if(this._editor.hasModel()){const e=this._editor.getSelections();e.map((e=>(1===e.endColumn&&e.endLineNumber>e.startLineNumber&&(e=e.setEndPosition(e.endLineNumber-1,this._editor.getModel().getLineMaxColumn(e.endLineNumber-1))),e.isEmpty()?null:e))).filter((e=>!!e)),e.length&&this._state.change({searchScope:e},!0)}}setSearchString(e){this._state.isRegex&&(e=Ee.ec(e)),this._state.change({searchString:e},!1)}highlightFindOptions(e=!1){}_start(e,t){return nt(this,void 0,void 0,(function*(){if(this.disposeModel(),!this._editor.hasModel())return;const i=Object.assign(Object.assign({},t),{isRevealed:!0});if("single"===e.seedSearchStringFromSelection){const t=at(this._editor,e.seedSearchStringFromSelection,e.seedSearchStringFromNonEmptySelection);t&&(this._state.isRegex?i.searchString=Ee.ec(t):i.searchString=t)}else if("multiple"===e.seedSearchStringFromSelection&&!e.updateSearchScope){const t=at(this._editor,e.seedSearchStringFromSelection);t&&(i.searchString=t)}if(!i.searchString&&e.seedSearchStringFromGlobalClipboard){const e=yield this.getGlobalBufferTerm();if(!this._editor.hasModel())return;e&&(i.searchString=e)}if(e.forceRevealReplace||i.isReplaceRevealed?i.isReplaceRevealed=!0:this._findWidgetVisible.get()||(i.isReplaceRevealed=!1),e.updateSearchScope){const e=this._editor.getSelections();e.some((e=>!e.isEmpty()))&&(i.searchScope=e)}i.loop=e.loop,this._state.change(i,!1),this._model||(this._model=new Fe.Xu(this._editor,this._state))}))}start(e,t){return this._start(e,t)}moveToNextMatch(){return!!this._model&&(this._model.moveToNextMatch(),!0)}moveToPrevMatch(){return!!this._model&&(this._model.moveToPrevMatch(),!0)}goToMatch(e){return!!this._model&&(this._model.moveToMatch(e),!0)}replace(){return!!this._model&&(this._model.replace(),!0)}replaceAll(){return!!this._model&&(this._model.replaceAll(),!0)}selectAllMatches(){return!!this._model&&(this._model.selectAllMatches(),this._editor.focus(),!0)}getGlobalBufferTerm(){return nt(this,void 0,void 0,(function*(){return this._editor.getOption(40).globalFindClipboard&&this._editor.hasModel()&&!this._editor.getModel().isTooLargeForSyncing()?this._clipboardService.readFindText():""}))}setGlobalBufferTerm(e){this._editor.getOption(40).globalFindClipboard&&this._editor.hasModel()&&!this._editor.getModel().isTooLargeForSyncing()&&this._clipboardService.writeFindText(e)}};ct.ID="editor.contrib.findController",ct=rt([ot(1,z.i6),ot(2,it.Uy),ot(3,Je.p)],ct);let lt=class extends ct{constructor(e,t,i,s,r,o,n,a){super(e,i,n,a),this._contextViewService=t,this._keybindingService=s,this._themeService=r,this._notificationService=o,this._widget=null,this._findOptionsWidget=null}_start(e,t){const i=Object.create(null,{_start:{get:()=>super._start}});return nt(this,void 0,void 0,(function*(){this._widget||this._createFindWidget();const s=this._editor.getSelection();let r=!1;switch(this._editor.getOption(40).autoFindInSelection){case"always":r=!0;break;case"never":r=!1;break;case"multiline":r=!!s&&s.startLineNumber!==s.endLineNumber}e.updateSearchScope=e.updateSearchScope||r,yield i._start.call(this,e,t),this._widget&&(2===e.shouldFocus?this._widget.focusReplaceInput():1===e.shouldFocus&&this._widget.focusFindInput())}))}highlightFindOptions(e=!1){this._widget||this._createFindWidget(),this._state.isRevealed&&!e?this._widget.highlightFindOptions():this._findOptionsWidget.highlightFindOptions()}_createFindWidget(){this._widget=this._register(new Ye.V4(this._editor,this,this._state,this._contextViewService,this._keybindingService,this._contextKeyService,this._themeService,this._storageService,this._notificationService)),this._findOptionsWidget=this._register(new ze(this._editor,this._state,this._keybindingService))}saveViewState(){var e;return null===(e=this._widget)||void 0===e?void 0:e.getViewState()}restoreViewState(e){var t;null===(t=this._widget)||void 0===t||t.setViewState(e)}};lt=rt([ot(1,Ze.u),ot(2,z.i6),ot(3,et.d),ot(4,st.XE),ot(5,tt.lT),ot(6,it.Uy),ot(7,Je.p)],lt),(0,ke.rn)(new ke.jY({id:Fe.kR.StartFindAction,label:R.NC("startFindAction","Find"),alias:"Find",precondition:z.Ao.or(Re.u.focus,z.Ao.has("editorIsOpen")),kbOpts:{kbExpr:null,primary:2084,weight:100},menuOpts:{menuId:Xe.eH.MenubarEditMenu,group:"3_find",title:R.NC({key:"miFind",comment:["&& denotes a mnemonic"]},"&&Find"),order:1}})).addImplementation(0,((e,t,i)=>{const s=ct.get(t);return!!s&&s.start({forceRevealReplace:!1,seedSearchStringFromSelection:"never"!==t.getOption(40).seedSearchStringFromSelection?"single":"none",seedSearchStringFromNonEmptySelection:"selection"===t.getOption(40).seedSearchStringFromSelection,seedSearchStringFromGlobalClipboard:t.getOption(40).globalFindClipboard,shouldFocus:1,shouldAnimate:!0,updateSearchScope:!1,loop:t.getOption(40).loop})}));const ht={description:"Open a new In-Editor Find Widget.",args:[{name:"Open a new In-Editor Find Widget args",schema:{properties:{searchString:{type:"string"},replaceString:{type:"string"},regex:{type:"boolean"},regexOverride:{type:"number",description:R.NC("actions.find.isRegexOverride",'Overrides "Use Regular Expression" flag.\nThe flag will not be saved for the future.\n0: Do Nothing\n1: True\n2: False')},wholeWord:{type:"boolean"},wholeWordOverride:{type:"number",description:R.NC("actions.find.wholeWordOverride",'Overrides "Match Whole Word" flag.\nThe flag will not be saved for the future.\n0: Do Nothing\n1: True\n2: False')},matchCase:{type:"boolean"},matchCaseOverride:{type:"number",description:R.NC("actions.find.matchCaseOverride",'Overrides "Math Case" flag.\nThe flag will not be saved for the future.\n0: Do Nothing\n1: True\n2: False')},preserveCase:{type:"boolean"},preserveCaseOverride:{type:"number",description:R.NC("actions.find.preserveCaseOverride",'Overrides "Preserve Case" flag.\nThe flag will not be saved for the future.\n0: Do Nothing\n1: True\n2: False')},findInSelection:{type:"boolean"}}}}]};class dt extends ke.R6{constructor(){super({id:Fe.kR.StartFindWithArgs,label:R.NC("startFindWithArgsAction","Find With Arguments"),alias:"Find With Arguments",precondition:void 0,kbOpts:{kbExpr:null,primary:0,weight:100},description:ht})}run(e,t,i){return nt(this,void 0,void 0,(function*(){const e=ct.get(t);if(e){const s=i?{searchString:i.searchString,replaceString:i.replaceString,isReplaceRevealed:void 0!==i.replaceString,isRegex:i.isRegex,wholeWord:i.matchWholeWord,matchCase:i.isCaseSensitive,preserveCase:i.preserveCase}:{};yield e.start({forceRevealReplace:!1,seedSearchStringFromSelection:0===e.getState().searchString.length&&"never"!==t.getOption(40).seedSearchStringFromSelection?"single":"none",seedSearchStringFromNonEmptySelection:"selection"===t.getOption(40).seedSearchStringFromSelection,seedSearchStringFromGlobalClipboard:!0,shouldFocus:1,shouldAnimate:!0,updateSearchScope:(null==i?void 0:i.findInSelection)||!1,loop:t.getOption(40).loop},s),e.setGlobalBufferTerm(e.getState().searchString)}}))}}class ut extends ke.R6{constructor(){super({id:Fe.kR.StartFindWithSelection,label:R.NC("startFindWithSelectionAction","Find With Selection"),alias:"Find With Selection",precondition:void 0,kbOpts:{kbExpr:null,primary:0,mac:{primary:2083},weight:100}})}run(e,t){return nt(this,void 0,void 0,(function*(){const e=ct.get(t);e&&(yield e.start({forceRevealReplace:!1,seedSearchStringFromSelection:"multiple",seedSearchStringFromNonEmptySelection:!1,seedSearchStringFromGlobalClipboard:!1,shouldFocus:0,shouldAnimate:!0,updateSearchScope:!1,loop:t.getOption(40).loop}),e.setGlobalBufferTerm(e.getState().searchString))}))}}class gt extends ke.R6{run(e,t){return nt(this,void 0,void 0,(function*(){const e=ct.get(t);e&&!this._run(e)&&(yield e.start({forceRevealReplace:!1,seedSearchStringFromSelection:0===e.getState().searchString.length&&"never"!==t.getOption(40).seedSearchStringFromSelection?"single":"none",seedSearchStringFromNonEmptySelection:"selection"===t.getOption(40).seedSearchStringFromSelection,seedSearchStringFromGlobalClipboard:!0,shouldFocus:0,shouldAnimate:!0,updateSearchScope:!1,loop:t.getOption(40).loop}),this._run(e))}))}}class pt extends ke.R6{constructor(){super({id:Fe.kR.GoToMatchFindAction,label:R.NC("findMatchAction.goToMatch","Go to Match..."),alias:"Go to Match...",precondition:Fe.a_}),this._highlightDecorations=[]}run(e,t,i){const s=ct.get(t);if(!s)return;const r=s.getState().matchesCount;if(r<1)return void e.get(tt.lT).notify({severity:tt.zb.Warning,message:R.NC("findMatchAction.noResults","No matches. Try searching for something else.")});const o=e.get(se.eJ).createInputBox();o.placeholder=R.NC("findMatchAction.inputPlaceHolder","Type a number to go to a specific match (between 1 and {0})",r);const n=e=>{const t=parseInt(e);if(isNaN(t))return;const i=s.getState().matchesCount;return t>0&&t<=i?t-1:t<0&&t>=-i?i+t:void 0},a=e=>{const i=n(e);if("number"==typeof i){o.validationMessage=void 0,s.goToMatch(i);const e=s.getState().currentMatch;e&&this.addDecorations(t,e)}else o.validationMessage=R.NC("findMatchAction.inputValidationMessage","Please type a number between 1 and {0}",s.getState().matchesCount),this.clearDecorations(t)};o.onDidChangeValue((e=>{a(e)})),o.onDidAccept((()=>{const e=n(o.value);"number"==typeof e?(s.goToMatch(e),o.hide()):o.validationMessage=R.NC("findMatchAction.inputValidationMessage","Please type a number between 1 and {0}",s.getState().matchesCount)})),o.onDidHide((()=>{this.clearDecorations(t),o.dispose()})),o.show()}clearDecorations(e){e.changeDecorations((e=>{this._highlightDecorations=e.deltaDecorations(this._highlightDecorations,[])}))}addDecorations(e,t){e.changeDecorations((e=>{this._highlightDecorations=e.deltaDecorations(this._highlightDecorations,[{range:t,options:{description:"find-match-quick-access-range-highlight",className:"rangeHighlight",isWholeLine:!0}},{range:t,options:{description:"find-match-quick-access-range-highlight-overview",overviewRuler:{color:(0,st.EN)(Ie.m9),position:_e.sh.Full}}}])}))}}class ft extends ke.R6{run(e,t){return nt(this,void 0,void 0,(function*(){const e=ct.get(t);if(!e)return;const i=at(t,"single",!1);i&&e.setSearchString(i),this._run(e)||(yield e.start({forceRevealReplace:!1,seedSearchStringFromSelection:"none",seedSearchStringFromNonEmptySelection:!1,seedSearchStringFromGlobalClipboard:!1,shouldFocus:0,shouldAnimate:!0,updateSearchScope:!1,loop:t.getOption(40).loop}),this._run(e))}))}}(0,ke.rn)(new ke.jY({id:Fe.kR.StartFindReplaceAction,label:R.NC("startReplace","Replace"),alias:"Replace",precondition:z.Ao.or(Re.u.focus,z.Ao.has("editorIsOpen")),kbOpts:{kbExpr:null,primary:2086,mac:{primary:2596},weight:100},menuOpts:{menuId:Xe.eH.MenubarEditMenu,group:"3_find",title:R.NC({key:"miReplace",comment:["&& denotes a mnemonic"]},"&&Replace"),order:2}})).addImplementation(0,((e,t,i)=>{if(!t.hasModel()||t.getOption(89))return!1;const s=ct.get(t);if(!s)return!1;const r=t.getSelection(),o=s.isFindInputFocused(),n=!r.isEmpty()&&r.startLineNumber===r.endLineNumber&&"never"!==t.getOption(40).seedSearchStringFromSelection&&!o,a=o||n?2:1;return s.start({forceRevealReplace:!0,seedSearchStringFromSelection:n?"single":"none",seedSearchStringFromNonEmptySelection:"selection"===t.getOption(40).seedSearchStringFromSelection,seedSearchStringFromGlobalClipboard:"never"!==t.getOption(40).seedSearchStringFromSelection,shouldFocus:a,shouldAnimate:!0,updateSearchScope:!1,loop:t.getOption(40).loop})})),(0,ke._K)(ct.ID,lt,0),(0,ke.Qr)(dt),(0,ke.Qr)(ut),(0,ke.Qr)(class extends gt{constructor(){super({id:Fe.kR.NextMatchFindAction,label:R.NC("findNextMatchAction","Find Next"),alias:"Find Next",precondition:void 0,kbOpts:[{kbExpr:Re.u.focus,primary:61,mac:{primary:2085,secondary:[61]},weight:100},{kbExpr:z.Ao.and(Re.u.focus,Fe.qm),primary:3,weight:100}]})}_run(e){return!!e.moveToNextMatch()&&(e.editor.pushUndoStop(),!0)}}),(0,ke.Qr)(class extends gt{constructor(){super({id:Fe.kR.PreviousMatchFindAction,label:R.NC("findPreviousMatchAction","Find Previous"),alias:"Find Previous",precondition:void 0,kbOpts:[{kbExpr:Re.u.focus,primary:1085,mac:{primary:3109,secondary:[1085]},weight:100},{kbExpr:z.Ao.and(Re.u.focus,Fe.qm),primary:1027,weight:100}]})}_run(e){return e.moveToPrevMatch()}}),(0,ke.Qr)(pt),(0,ke.Qr)(class extends ft{constructor(){super({id:Fe.kR.NextSelectionMatchFindAction,label:R.NC("nextSelectionMatchFindAction","Find Next Selection"),alias:"Find Next Selection",precondition:void 0,kbOpts:{kbExpr:Re.u.focus,primary:2109,weight:100}})}_run(e){return e.moveToNextMatch()}}),(0,ke.Qr)(class extends ft{constructor(){super({id:Fe.kR.PreviousSelectionMatchFindAction,label:R.NC("previousSelectionMatchFindAction","Find Previous Selection"),alias:"Find Previous Selection",precondition:void 0,kbOpts:{kbExpr:Re.u.focus,primary:3133,weight:100}})}_run(e){return e.moveToPrevMatch()}});const mt=ke._l.bindToContribution(ct.get);(0,ke.fK)(new mt({id:Fe.kR.CloseFindWidgetCommand,precondition:Fe.a_,handler:e=>e.closeFindWidget(),kbOpts:{weight:105,kbExpr:z.Ao.and(Re.u.focus,z.Ao.not("isComposing")),primary:9,secondary:[1033]}})),(0,ke.fK)(new mt({id:Fe.kR.ToggleCaseSensitiveCommand,precondition:void 0,handler:e=>e.toggleCaseSensitive(),kbOpts:{weight:105,kbExpr:Re.u.focus,primary:Fe.Dt.primary,mac:Fe.Dt.mac,win:Fe.Dt.win,linux:Fe.Dt.linux}})),(0,ke.fK)(new mt({id:Fe.kR.ToggleWholeWordCommand,precondition:void 0,handler:e=>e.toggleWholeWords(),kbOpts:{weight:105,kbExpr:Re.u.focus,primary:Fe.CP.primary,mac:Fe.CP.mac,win:Fe.CP.win,linux:Fe.CP.linux}})),(0,ke.fK)(new mt({id:Fe.kR.ToggleRegexCommand,precondition:void 0,handler:e=>e.toggleRegex(),kbOpts:{weight:105,kbExpr:Re.u.focus,primary:Fe.LM.primary,mac:Fe.LM.mac,win:Fe.LM.win,linux:Fe.LM.linux}})),(0,ke.fK)(new mt({id:Fe.kR.ToggleSearchScopeCommand,precondition:void 0,handler:e=>e.toggleSearchScope(),kbOpts:{weight:105,kbExpr:Re.u.focus,primary:Fe.M9.primary,mac:Fe.M9.mac,win:Fe.M9.win,linux:Fe.M9.linux}})),(0,ke.fK)(new mt({id:Fe.kR.TogglePreserveCaseCommand,precondition:void 0,handler:e=>e.togglePreserveCase(),kbOpts:{weight:105,kbExpr:Re.u.focus,primary:Fe.mt.primary,mac:Fe.mt.mac,win:Fe.mt.win,linux:Fe.mt.linux}})),(0,ke.fK)(new mt({id:Fe.kR.ReplaceOneAction,precondition:Fe.a_,handler:e=>e.replace(),kbOpts:{weight:105,kbExpr:Re.u.focus,primary:3094}})),(0,ke.fK)(new mt({id:Fe.kR.ReplaceOneAction,precondition:Fe.a_,handler:e=>e.replace(),kbOpts:{weight:105,kbExpr:z.Ao.and(Re.u.focus,Fe.P$),primary:3}})),(0,ke.fK)(new mt({id:Fe.kR.ReplaceAllAction,precondition:Fe.a_,handler:e=>e.replaceAll(),kbOpts:{weight:105,kbExpr:Re.u.focus,primary:2563}})),(0,ke.fK)(new mt({id:Fe.kR.ReplaceAllAction,precondition:Fe.a_,handler:e=>e.replaceAll(),kbOpts:{weight:105,kbExpr:z.Ao.and(Re.u.focus,Fe.P$),primary:void 0,mac:{primary:2051}}})),(0,ke.fK)(new mt({id:Fe.kR.SelectAllMatchesAction,precondition:Fe.a_,handler:e=>e.selectAllMatches(),kbOpts:{weight:105,kbExpr:Re.u.focus,primary:515}}));var vt=i(73046),St=i(25670);let yt=class e extends re.${static{this.PREFIX="#"}static{this.TYPING_SEARCH_DELAY=200}static{this.TREAT_AS_GLOBAL_SYMBOL_TYPES=new Set([4,9,0,10,2,3,1])}get defaultFilterValue(){const e=this.codeEditorService.getFocusedCodeEditor();if(e)return(0,g.f6)(at(e))}constructor(t,i,s,r,o){super(e.PREFIX,{canAcceptInBackground:!0,noResultsPick:{label:(0,R.NC)("noSymbolResults","No matching workspace symbols")}}),this.labelService=t,this.openerService=i,this.editorService=s,this.configurationService=r,this.codeEditorService=o,this.delayer=this._register(new a.rH(e.TYPING_SEARCH_DELAY))}get configuration(){const e=this.configurationService.getValue().workbench?.editor;return{openEditorPinned:!e?.enablePreviewFromQuickOpen||!e?.enablePreview,openSideBySideDirection:e?.openSideBySideDirection}}_getPicks(e,t,i){return this.getSymbolPicks(e,void 0,i)}async getSymbolPicks(e,t,i){return this.delayer.trigger((async()=>i.isCancellationRequested?[]:this.doGetSymbolPicks((0,oe.AO)(e),t,i)),t?.delay)}async doGetSymbolPicks(t,i,s){let r,o;t.values&&t.values.length>1?(r=(0,oe.Ic)(t.values[0]),o=(0,oe.Ic)(t.values.slice(1))):r=t;const n=await(0,ae.$g)(r.original,s);if(s.isCancellationRequested)return[];const a=[],c=this.configuration.openSideBySideDirection;for(const{symbol:l,provider:h}of n){if(i?.skipLocal&&!e.TREAT_AS_GLOBAL_SYMBOL_TYPES.has(l.kind)&&l.containerName)continue;const n=l.name,d=`$(${Ce.uZ.toIcon(l.kind).id}) ${n}`,u=d.length-n.length;let g,p,f=!1;if(r.original.length>0&&(r!==t&&([g,p]=(0,oe.mt)(d,{...t,values:void 0},0,u),"number"==typeof g&&(f=!0)),"number"!=typeof g&&([g,p]=(0,oe.mt)(d,r,0,u),"number"!=typeof g)))continue;const m=l.location.uri;let v,S,y;if(m){const e=this.labelService.getUriLabel(m,{relative:!0});v=l.containerName?`${l.containerName} • ${e}`:e}if(!f&&o&&o.original.length>0){if(v&&([S,y]=(0,oe.mt)(v,o)),"number"!=typeof S)continue;"number"==typeof g&&(g+=S)}const w=!!l.tags&&l.tags.indexOf(1)>=0;a.push({symbol:l,resource:m,score:g,label:d,ariaLabel:n,highlights:w?void 0:{label:p,description:y},description:v,strikethrough:w,buttons:[{iconClass:"right"===c?St.kS.asClassName(vt.lA.splitHorizontal):St.kS.asClassName(vt.lA.splitVertical),tooltip:"right"===c?(0,R.NC)("openToSide","Open to the Side"):(0,R.NC)("openToBottom","Open to the Bottom")}],trigger:(e,t)=>(this.openSymbol(h,l,s,{keyMods:t,forceOpenSideBySide:!0}),re.L.CLOSE_PICKER),accept:async(e,t)=>this.openSymbol(h,l,s,{keyMods:e,preserveFocus:t.inBackground,forcePinned:t.inBackground})})}return i?.skipSorting||a.sort(((e,t)=>this.compareSymbols(e,t))),a}async openSymbol(e,t,i,s){let r=t;"function"==typeof e.resolveWorkspaceSymbol&&(r=await e.resolveWorkspaceSymbol(t,i)||t,i.isCancellationRequested)||(r.location.uri.scheme===d.lg.http||r.location.uri.scheme===d.lg.https?await this.openerService.open(r.location.uri,{fromUserGesture:!0,allowContributedOpeners:!0}):await this.editorService.openEditor({resource:r.location.uri,options:{preserveFocus:s?.preserveFocus,pinned:s.keyMods.ctrlCmd||s.forcePinned||this.configuration.openEditorPinned,selection:r.location.range?P.e.collapseToStart(r.location.range):void 0}},s.keyMods.alt||this.configuration.openEditorPinned&&s.keyMods.ctrlCmd||s?.forceOpenSideBySide?w.O3:w.LP))}compareSymbols(e,t){if("number"==typeof e.score&&"number"==typeof t.score){if(e.score>t.score)return-1;if(e.score<t.score)return 1}if(e.symbol&&t.symbol){const i=e.symbol.name.toLowerCase(),s=t.symbol.name.toLowerCase(),r=i.localeCompare(s);if(0!==r)return r}if(e.symbol&&t.symbol){const i=Ce.uZ.toIcon(e.symbol.kind).id,s=Ce.uZ.toIcon(t.symbol.kind).id;return i.localeCompare(s)}return 0}};yt=(0,o.g)([(0,o.f)(0,W.e),(0,o.f)(1,be.v4),(0,o.f)(2,w.AR),(0,o.f)(3,fe.Ui),(0,o.f)(4,xe.$)],yt);var wt=i(88289),Ct=i(65520),bt=i(21212),xt=i(54090),Et=i(54225),kt=i(67894),It=i(75392),Rt=i(4038),_t=i(31803),Ft=i(4669),At=i(59554),Nt=(i(49953),i(20013)),Tt=i(96692),Mt=i(76446);const Pt=R.NC("taskQuickPick.showAll","Show All Tasks..."),Ot=(0,At.q5)("tasks-list-configure",vt.lA.gear,R.NC("configureTaskIcon","Configuration icon in the tasks selection list.")),Wt=(0,At.q5)("tasks-remove",vt.lA.close,R.NC("removeTaskIcon","Icon for remove in the tasks selection list."));let Lt=class e extends l.JT{constructor(e,t,i,s,r,o,n){super(),this._taskService=e,this._configurationService=t,this._quickInputService=i,this._notificationService=s,this._themeService=r,this._dialogService=o,this._storageService=n,this._sorter=this._taskService.createSorter()}_showDetail(){return!!this._configurationService.getValue("task.quickOpen.detail")}_guessTaskLabel(e){if(e._label)return e._label;if(_t.Xg.is(e)){let t=e.configures.type;const i=ve.I8(e.configures);return delete i._key,delete i.type,Object.keys(i).forEach((e=>t+=`: ${i[e]}`)),t}return""}static getTaskLabelWithIcon(e,t){const i=t||e._label,s=e.configurationProperties.icon;return s?s.id?`$(${s.id}) ${i}`:`$(${vt.lA.tools.id}) ${i}`:`${i}`}static applyColorStyles(e,t,i){if(e.configurationProperties.icon?.color){const s=i.getColorTheme(),r=(0,Nt.m5)(s);t.iconClasses=[(0,Nt.pv)(e.configurationProperties.icon.color)],document.body.appendChild(r)}}_createTaskEntry(t,i=[]){const s=[{iconClass:St.kS.asClassName(Ot),tooltip:R.NC("configureTask","Configure Task")},...i],r={label:e.getTaskLabelWithIcon(t,this._guessTaskLabel(t)),description:this._taskService.getTaskDescription(t),task:t,detail:this._showDetail()?t.configurationProperties.detail:void 0,buttons:s};return e.applyColorStyles(t,r,this._themeService),r}_createEntriesForGroup(e,t,i,s=[]){e.push({type:"separator",label:i}),t.forEach((t=>{t.configurationProperties.hide||e.push(this._createTaskEntry(t,s))}))}_createTypeEntries(e,t){e.push({type:"separator",label:R.NC("contributedTasks","contributed")}),t.forEach((t=>{e.push({label:`$(folder) ${t}`,task:t,ariaLabel:R.NC("taskType","All {0} tasks",t)})})),e.push({label:Pt,task:Pt,alwaysShow:!0})}_handleFolderTaskResult(e){const t=[];return Array.from(e).forEach((([e,i])=>{if(i.set&&t.push(...i.set.tasks),i.configurations)for(const e in i.configurations.byIdentifier)t.push(i.configurations.byIdentifier[e])})),t}_dedupeConfiguredAndRecent(e,t){let i=[];const s=Array(e.length).fill(!1);for(let r=0;r<t.length;r++){const o=t[r].getWorkspaceFolder()?.uri.toString(),n=t[r].getDefinition()?._key,a=t[r].type,c=t[r]._label,l=t[r].getRecentlyUsedKey(),h=e.findIndex((e=>o&&n&&e.getWorkspaceFolder()?.uri.toString()===o&&(e.getDefinition()?._key===n||e.type===a&&e._label===c)||l&&e.getRecentlyUsedKey()===l));-1===h?i.push(t[r]):(e[h]=t[r],s[h]=!0)}i=i.sort(((e,t)=>this._sorter.compare(e,t)));const r=[];for(let t=0;t<e.length;t++)(s[t]||_t.Xg.is(e[t]))&&r.push(e[t]);return{configuredTasks:i,recentTasks:r}}async getTopLevelEntries(e){if(void 0!==this._topLevelEntries)return{entries:this._topLevelEntries};let t=(await this._taskService.getSavedTasks("historical")).reverse();const i=this._handleFolderTaskResult(await this._taskService.getWorkspaceTasks()),s=this._taskService.taskTypes();this._topLevelEntries=[];const r=this._dedupeConfiguredAndRecent(t,i),o=r.configuredTasks;if(t=r.recentTasks,t.length>0){const e={iconClass:St.kS.asClassName(Wt),tooltip:R.NC("removeRecent","Remove Recently Used Task")};this._createEntriesForGroup(this._topLevelEntries,t,R.NC("recentlyUsed","recently used"),[e])}return i.length>0&&o.length>0&&this._createEntriesForGroup(this._topLevelEntries,o,R.NC("configured","configured")),e&&0===i.length&&(this._topLevelEntries.push({type:"separator",label:R.NC("configured","configured")}),this._topLevelEntries.push(e)),s.length>0&&this._createTypeEntries(this._topLevelEntries,s),{entries:this._topLevelEntries,isSingleConfigured:1===i.length?i[0]:void 0}}async handleSettingOption(e){const{confirmed:t}=await this._dialogService.confirm({type:tt.zb.Warning,message:R.NC("TaskQuickPick.changeSettingDetails","Task detection for {0} tasks causes files in any workspace you open to be run as code. Enabling {0} task detection is a user setting and will apply to any workspace you open. \n\n Do you want to enable {0} task detection for all workspaces?",e),cancelButton:R.NC("TaskQuickPick.changeSettingNo","No")});if(t)return await this._configurationService.updateValue(`${e}.autoDetect`,"on"),await new Promise((e=>setTimeout((()=>e()),100))),this.show(R.NC("TaskService.pickRunTask","Select the task to run"),void 0,e)}async show(e,t,i,s){const r=this._quickInputService.createQuickPick();r.placeholder=e,r.matchOnDescription=!0,r.ignoreFocusOut=!1,r.onDidTriggerItemButton((async e=>{const t=e.item.task;if(e.button.iconClass===St.kS.asClassName(Wt)){const i=t&&!g.HD(t)?t.getRecentlyUsedKey():void 0;i&&this._taskService.removeRecentlyUsedTask(i);const s=r.items.indexOf(e.item);s>=0&&(r.items=[...r.items.slice(0,s),...r.items.slice(s+1)])}else if(e.button.iconClass===St.kS.asClassName(Ot))if(this._quickInputService.cancel(),_t.Q7.is(t))this._taskService.customize(t,void 0,!0);else if(_t.b$.is(t)||_t.Xg.is(t)){let e=!1;try{e=await this._taskService.openConfig(t)}catch(e){}e||this._taskService.customize(t,void 0,!0)}})),s&&(r.value=s);let o=i;if(!o){const e=await this.getTopLevelEntries(t);if(e.isSingleConfigured&&this._configurationService.getValue("task.quickOpen.skip"))return r.dispose(),this._toTask(e.isSingleConfigured);const i=e.entries;o=await this._doPickerFirstLevel(r,i)}for(;;){if(!g.HD(o))return o?(r.dispose(),this._toTask(o)):(r.dispose(),o);{if(s)return await this._doPickerFirstLevel(r,(await this.getTopLevelEntries(t)).entries),void r.dispose();const e=await this.doPickerSecondLevel(r,o);if(!e||e.settingType||null!==e.task)return e&&g.HD(e.settingType)?(r.dispose(),this.handleSettingOption(e.settingType)):(r.dispose(),e?.task&&!g.HD(e?.task)?this._toTask(e?.task):void 0);r.value="",o=await this._doPickerFirstLevel(r,(await this.getTopLevelEntries(t)).entries)}}}async _doPickerFirstLevel(e,t){e.items=t,(0,Tt.N)(this._storageService,"runTaskStorageKey",e,!0);const i=await new Promise((t=>{Ft.ju.once(e.onDidAccept)((async()=>{t(e.selectedItems?e.selectedItems[0]:void 0)}))}));return i?.task}async doPickerSecondLevel(t,i,s){if(t.busy=!0,i===Pt){const i=(await this._taskService.tasks()).filter((e=>!e.configurationProperties.hide)).sort(((e,t)=>this._sorter.compare(e,t))).map((e=>this._createTaskEntry(e)));i.push(...e.allSettingEntries(this._configurationService)),t.items=i}else t.value=s||"",t.items=await this._getEntriesForProvider(i);return await t.show(),t.busy=!1,await new Promise((e=>{Ft.ju.once(t.onDidAccept)((async()=>{e(t.selectedItems?t.selectedItems[0]:void 0)}))}))}static allSettingEntries(t){const i=[],s=e.getSettingEntry(t,"grunt");s&&i.push(s);const r=e.getSettingEntry(t,"gulp");r&&i.push(r);const o=e.getSettingEntry(t,"jake");return o&&i.push(o),i}static getSettingEntry(e,t){if("off"===e.getValue(`${t}.autoDetect`))return{label:R.NC("TaskQuickPick.changeSettingsOptions","$(gear) {0} task detection is turned off. Enable {1} task detection...",t[0].toUpperCase()+t.slice(1),t),task:null,settingType:t,alwaysShow:!0}}async _getEntriesForProvider(t){const i=(await this._taskService.tasks({type:t})).sort(((e,t)=>this._sorter.compare(e,t)));let s=[];if(i.length>0){for(const e of i)e.configurationProperties.hide||s.push(this._createTaskEntry(e));s.push({type:"separator"},{label:R.NC("TaskQuickPick.goBack","Go back ↩"),task:null,alwaysShow:!0})}else s=[{label:R.NC("TaskQuickPick.noTasksForType","No {0} tasks found. Go back ↩",t),task:null,alwaysShow:!0}];const r=e.getSettingEntry(this._configurationService,t);return r&&s.push(r),s}async _toTask(e){if(!_t.Xg.is(e))return e;const t=await this._taskService.tryResolveTask(e);return t||this._notificationService.error(R.NC("noProviderForTask",'There is no task provider registered for tasks of type "{0}".',e.type)),t}};Lt=(0,o.g)([(0,o.f)(0,Rt.mh),(0,o.f)(1,fe.Ui),(0,o.f)(2,se.eJ),(0,o.f)(3,tt.lT),(0,o.f)(4,st.XE),(0,o.f)(5,Mt.Ss),(0,o.f)(6,it.Uy)],Lt);let Dt=class e extends re.${static{this.PREFIX="task "}constructor(t,i,s,r,o,n,a,c){super(e.PREFIX,{noResultsPick:{label:(0,R.NC)("noTaskResults","No matching tasks")}}),this._taskService=i,this._configurationService=s,this._quickInputService=r,this._notificationService=o,this._dialogService=n,this._themeService=a,this._storageService=c}async _getPicks(e,t,i){if(i.isCancellationRequested)return[];const s=new Lt(this._taskService,this._configurationService,this._quickInputService,this._notificationService,this._themeService,this._dialogService,this._storageService),r=await s.getTopLevelEntries(),o=[];for(const t of r.entries){const i=(0,It.Oh)(e,t.label);if(!i)continue;"separator"===t.type&&o.push(t);const r=t.task,n=t;n.highlights={label:i},n.trigger=e=>{if(1===e&&2===n.buttons?.length){const e=r&&!(0,g.HD)(r)?r.getRecentlyUsedKey():void 0;return e&&this._taskService.removeRecentlyUsedTask(e),re.L.REFRESH_PICKER}return _t.Q7.is(r)?this._taskService.customize(r,void 0,!0):_t.b$.is(r)&&this._taskService.openConfig(r),re.L.CLOSE_PICKER},n.accept=async()=>{if((0,g.HD)(r)){const e=await s.show((0,R.NC)("TaskService.pickRunTask","Select the task to run"),void 0,r);e&&this._taskService.run(e,{attachProblemMatcher:!0})}else this._taskService.run(await this._toTask(r),{attachProblemMatcher:!0})},o.push(n)}return o}async _toTask(e){return _t.Xg.is(e)?this._taskService.tryResolveTask(e):e}};Dt=(0,o.g)([(0,o.f)(0,C.QS),(0,o.f)(1,Rt.mh),(0,o.f)(2,fe.Ui),(0,o.f)(3,se.eJ),(0,o.f)(4,tt.lT),(0,o.f)(5,Mt.Ss),(0,o.f)(6,st.XE),(0,o.f)(7,it.Uy)],Dt);var Bt=i(79579);function qt(e){const t=e;return!!t?.range&&!!t.resource}let Ht=class e extends re.${static{this.PREFIX=""}static{this.NO_RESULTS_PICK={label:(0,R.NC)("noAnythingResults","No matching results")}}static{this.MAX_RESULTS=512}static{this.TYPING_SEARCH_DELAY=200}static{this.SYMBOL_PICKS_MERGE_DELAY=200}get defaultFilterValue(){if(this.configuration.preserveInput)return j.Ry.LAST}constructor(t,i,s,r,o,n,c,l,h,d,u,p,f,m,v,S,y){super(e.PREFIX,{canAcceptInBackground:!0,noResultsPick:e.NO_RESULTS_PICK}),this.instantiationService=t,this.searchService=i,this.contextService=s,this.pathService=r,this.environmentService=o,this.fileService=n,this.labelService=c,this.modelService=l,this.languageService=h,this.workingCopyService=d,this.configurationService=u,this.editorService=p,this.historyService=f,this.filesConfigurationService=m,this.textModelService=v,this.uriIdentityService=S,this.quickInputService=y,this.pickState=new class{constructor(e,t){this.provider=e,this.editorService=t,this.picker=void 0,this.editorViewState=void 0,this.scorerCache=Object.create(null),this.fileQueryCache=void 0,this.lastOriginalFilter=void 0,this.lastFilter=void 0,this.lastRange=void 0,this.lastGlobalPicks=void 0,this.isQuickNavigating=void 0}set(e){this.picker=e,(0,wt.I)(e.onDispose)((()=>{e===this.picker&&(this.picker=void 0)}));const t=!!e.quickNavigate;t||(this.fileQueryCache=this.provider.createFileQueryCache(),this.scorerCache=Object.create(null)),this.isQuickNavigating=t,this.lastOriginalFilter=void 0,this.lastFilter=void 0,this.lastRange=void 0,this.lastGlobalPicks=void 0,this.editorViewState=void 0}rememberEditorViewState(){if(this.editorViewState)return;const e=this.editorService.activeEditorPane;e&&(this.editorViewState={group:e.group,editor:e.input,state:(0,g.f6)((0,Ct.aq)(e.getControl())?.saveViewState())})}async restoreEditorViewState(){if(this.editorViewState){const e={viewState:this.editorViewState.state,preserveFocus:!0};await this.editorViewState.group.openEditor(this.editorViewState.editor,e)}}}(this,this.editorService),this.labelOnlyEditorHistoryPickAccessor=new se.oP({skipDescription:!0}),this.fileQueryDelayer=this._register(new a.rH(e.TYPING_SEARCH_DELAY)),this.fileQueryBuilder=this.instantiationService.createInstance(ne.z),this.helpQuickAccess=this.instantiationService.createInstance(xt.p),this.workspaceSymbolsQuickAccess=this._register(this.instantiationService.createInstance(yt)),this.editorSymbolsQuickAccess=this.instantiationService.createInstance(ee.l)}get configuration(){const e=this.configurationService.getValue().workbench?.editor,t=this.configurationService.getValue().search,i=this.configurationService.getValue().workbench.quickOpen;return{openEditorPinned:!e?.enablePreviewFromQuickOpen||!e?.enablePreview,openSideBySideDirection:e?.openSideBySideDirection,includeSymbols:t?.quickOpen.includeSymbols,includeHistory:t?.quickOpen.includeHistory,historyFilterSortOrder:t?.quickOpen.history.filterSortOrder,shortAutoSaveDelay:1===this.filesConfigurationService.getAutoSaveMode(),preserveInput:i.preserveInput}}provide(e,t,i){const s=new l.SL;this.pickState.set(e);const r=s.add(new l.XK);return s.add(e.onDidChangeActive((()=>{r.value=void 0;const[t]=e.activeItems;qt(t)&&(r.value=this.decorateAndRevealSymbolRange(t))}))),s.add((0,wt.I)(e.onDidHide)((({reason:e})=>{e===se.Jq.Gesture&&this.pickState.restoreEditorViewState()}))),s.add(super.provide(e,t,i)),s}decorateAndRevealSymbolRange(e){const t=this.editorService.activeEditor;if(!this.uriIdentityService.extUri.isEqual(e.resource,t?.resource))return l.JT.None;const i=this.editorService.activeTextEditorControl;return i?(this.pickState.rememberEditorViewState(),i.revealRangeInCenter(e.range.selection,0),this.addDecorations(i,e.range.decoration),(0,l.OF)((()=>this.clearDecorations(i)))):l.JT.None}_getPicks(t,i,s,r){const o=(0,ae.Mm)(t,[ee.l.PREFIX]);let n;if(n=o?o.filter:t,this.pickState.lastRange=o?.range,t!==this.pickState.lastOriginalFilter&&n===this.pickState.lastFilter)return null;const a=!!this.pickState.lastOriginalFilter;this.pickState.lastOriginalFilter=t,this.pickState.lastFilter=n;const c=this.pickState.picker?.items,l=this.pickState.picker?.activeItems[0];if(c&&l){const t=qt(l),i=l===e.NO_RESULTS_PICK&&n.indexOf(ee.l.PREFIX)>=0;t||i||(this.pickState.lastGlobalPicks={items:c,active:l})}return this.doGetPicks(n,{enableEditorSymbolSearch:a,includeHelp:r?.includeHelp,from:r?.from},i,s)}doGetPicks(t,i,s,r){const o=(0,oe.AO)(t);if(i.enableEditorSymbolSearch){const e=this.getEditorSymbolPicks(o,s,r);if(e)return e}const n=this.pickState.picker?.activeItems[0];if(qt(n)&&this.pickState.lastGlobalPicks)return this.pickState.lastGlobalPicks;const a=this.getEditorHistoryPicks(o);let c;return this.pickState.isQuickNavigating?c=a:(c=[],i.includeHelp&&c.push(...this.getHelpPicks(o,r,i)),0!==a.length&&(c.push({type:"separator",label:(0,R.NC)("recentlyOpenedSeparator","recently opened")}),c.push(...a))),{picks:c,additionalPicks:(async()=>{const e=new h.Y9;for(const t of a)t.resource&&e.set(t.resource,!0);const t=await this.getAdditionalPicks(o,e,r);return r.isCancellationRequested?[]:t.length>0?[{type:"separator",label:this.configuration.includeSymbols?(0,R.NC)("fileAndSymbolResultsSeparator","file and symbol results"):(0,R.NC)("fileResultsSeparator","file results")},...t]:[]})(),mergeDelay:e.SYMBOL_PICKS_MERGE_DELAY}}async getAdditionalPicks(t,i,s){const[r,o]=await Promise.all([this.getFilePicks(t,i,s),this.getWorkspaceSymbolPicks(t,s)]);if(s.isCancellationRequested)return[];const a=(0,n.we)([...r,...o],((e,i)=>(0,oe.wq)(e,i,t,!0,se.pe,this.pickState.scorerCache)),e.MAX_RESULTS),c=[];for(const e of a)if(e.highlights)c.push(e);else{const{score:i,labelMatch:s,descriptionMatch:r}=(0,oe.EF)(e,t,!0,se.pe,this.pickState.scorerCache);if(!i)continue;e.highlights={label:s,description:r},c.push(e)}return c}getEditorHistoryPicks(e){const t=this.configuration;if(!e.normalized)return this.historyService.getHistory().map((e=>this.createAnythingPick(e,t)));if(!this.configuration.includeHistory)return[];const i=e.containsPathSeparator?se.pe:this.labelOnlyEditorHistoryPickAccessor,s=[];for(const r of this.historyService.getHistory()){const o=r.resource;if(!o||!this.fileService.hasProvider(o)&&o.scheme!==d.lg.untitled&&o.scheme!==d.lg.vscodeTerminal)continue;const n=this.createAnythingPick(r,t),{score:a,labelMatch:c,descriptionMatch:l}=(0,oe.EF)(n,e,!1,i,this.pickState.scorerCache);a&&(n.highlights={label:c,description:l},s.push(n))}return"recency"===this.configuration.historyFilterSortOrder?s:s.sort(((t,s)=>(0,oe.wq)(t,s,e,!1,i,this.pickState.scorerCache)))}createFileQueryCache(){return new Se((e=>this.fileQueryBuilder.file(this.contextService.getWorkspace().folders,this.getFileQueryOptions({cacheKey:e}))),(e=>this.searchService.fileSearch(e)),(e=>this.searchService.clearCache(e)),this.pickState.fileQueryCache).load()}async getFilePicks(e,t,i){if(!e.normalized)return[];const s=await this.getAbsolutePathFileResult(e,i);if(i.isCancellationRequested)return[];let r;if(s){if(t.has(s))return[];const e=this.createAnythingPick(s,this.configuration);return e.highlights={label:[{start:0,end:e.label.length}],description:e.description?[{start:0,end:e.description.length}]:void 0},[e]}if(r=this.pickState.fileQueryCache?.isLoaded?await this.doFileSearch(e,i):await this.fileQueryDelayer.trigger((async()=>i.isCancellationRequested?[]:this.doFileSearch(e,i))),i.isCancellationRequested)return[];const o=this.configuration;return r.filter((e=>!t.has(e))).map((e=>this.createAnythingPick(e,o)))}async doFileSearch(e,t){const[i,s]=await Promise.all([this.getFileSearchResults(e,t),this.getRelativePathFileResults(e,t)]);if(t.isCancellationRequested)return[];if(!s)return i;const r=new h.Y9;for(const e of s)r.set(e,!0);return[...i.filter((e=>!r.has(e))),...s]}async getFileSearchResults(e,t){let i="";i=e.values&&e.values.length>1?e.values[0].original:e.original;const s=await this.doGetFileSearchResults(i,t);if(t.isCancellationRequested)return[];if(s.limitHit&&e.values&&e.values.length>1){const i=await this.doGetFileSearchResults(e.original,t);if(t.isCancellationRequested)return[];const r=new h.Y9;for(const e of s.results)r.set(e.resource,!0);for(const e of i.results)r.has(e.resource)||s.results.push(e)}return s.results.map((e=>e.resource))}doGetFileSearchResults(t,i){return this.searchService.fileSearch(this.fileQueryBuilder.file(this.contextService.getWorkspace().folders,this.getFileQueryOptions({filePattern:t,cacheKey:this.pickState.fileQueryCache?.cacheKey,maxResults:e.MAX_RESULTS})),i)}getFileQueryOptions(e){return{_reason:"openFileHandler",extraFileResources:this.instantiationService.invokeFunction(ae.ek),filePattern:e.filePattern||"",cacheKey:e.cacheKey,maxResults:e.maxResults||0,sortByScore:!0}}async getAbsolutePathFileResult(e,t){if(!e.containsPathSeparator)return;const i=await this.pathService.userHome(),s=(0,le.QC)(e.original,i.scheme===d.lg.file?i.fsPath:i.path);if(t.isCancellationRequested)return;const r=(await this.pathService.path).isAbsolute(s);if(!t.isCancellationRequested&&r){const e=(0,L.bK)(await this.pathService.fileURI(s),this.environmentService.remoteAuthority,this.pathService.defaultUriScheme);if(t.isCancellationRequested)return;try{if((await this.fileService.stat(e)).isFile)return e}catch(e){}}}async getRelativePathFileResults(e,t){if(e.containsPathSeparator&&!(await this.pathService.path).isAbsolute(e.original)){const i=[];for(const s of this.contextService.getWorkspace().folders){if(t.isCancellationRequested)break;const r=(0,L.bK)(s.toResource(e.original),this.environmentService.remoteAuthority,this.pathService.defaultUriScheme);try{(await this.fileService.stat(r)).isFile&&i.push(r)}catch(e){}}return i}}getHelpPicks(t,i,s){if(t.normalized)return[];const r=this.helpQuickAccess.getQuickAccessProviders(),o=new Map;for(const e of r)o.set(e.prefix,e);const n=[],a=(t,i={})=>{if(o.has(t)){const r=o.get(t);r.label=r.description,r.description=r.prefix;const a={...s,includeHelp:r.prefix!==e.PREFIX&&s?.includeHelp};n.push({...o.get(t),...i,accept:()=>{this.quickInputService.quickAccess.show(r.prefix,{preserveValue:!0,providerOptions:a})}})}};return a(e.PREFIX),a(Et.LF.PREFIX),a(ee.l.PREFIX),a(kt.uT),a(Dt.PREFIX),a(xt.p.PREFIX,{label:(0,R.NC)("more","More")}),n}async getWorkspaceSymbolPicks(t,i){const s=this.configuration;return t.normalized&&s.includeSymbols&&!this.pickState.lastRange?this.workspaceSymbolsQuickAccess.getSymbolPicks(t.original,{skipLocal:!0,skipSorting:!0,delay:e.TYPING_SEARCH_DELAY},i):[]}getEditorSymbolPicks(e,t,i){const s=e.original.split(ee.l.PREFIX),r=s.length>1?s[s.length-1].trim():void 0;if("string"!=typeof r)return null;const o=this.pickState.lastGlobalPicks?.active;if(!o)return null;const n=o.resource;return!n||!this.fileService.hasProvider(n)&&n.scheme!==d.lg.untitled||(o.label.includes(ee.l.PREFIX)||o.description?.includes(ee.l.PREFIX))&&s.length<3?null:this.doGetEditorSymbolPicks(o,n,r,t,i)}async doGetEditorSymbolPicks(e,t,i,s,r){try{this.pickState.rememberEditorViewState(),await this.editorService.openEditor({resource:t,options:{preserveFocus:!0,revealIfOpened:!0,ignoreError:!0}})}catch(e){return[]}if(r.isCancellationRequested)return[];let o=this.modelService.getModel(t);if(!o)try{const e=s.add(await this.textModelService.createModelReference(t));if(r.isCancellationRequested)return[];o=e.object.textEditorModel}catch(e){return[]}const n=await this.editorSymbolsQuickAccess.getSymbolPicks(o,i,{extraContainerLabel:(0,bt.x$)(e.label)},s,r);return r.isCancellationRequested?[]:n.map((e=>"separator"===e.type?e:{...e,resource:t,description:e.description,trigger:(i,s)=>(this.openAnything(t,{keyMods:s,range:e.range?.selection,forceOpenSideBySide:!0}),re.L.CLOSE_PICKER),accept:(i,s)=>this.openAnything(t,{keyMods:i,range:e.range?.selection,preserveFocus:s.inBackground,forcePinned:s.inBackground})}))}addDecorations(e,t){this.editorSymbolsQuickAccess.addDecorations(e,t)}clearDecorations(e){this.editorSymbolsQuickAccess.clearDecorations(e)}createAnythingPick(e,t){const i=!de.ov.isUri(e);let s,r,o,n,a;(0,y.Xl)(e)?(s=y.zK.getOriginalUri(e),r=e.getName(),o=e.getDescription(),n=e.isDirty()&&!e.isSaving(),a=e.getLabelExtraClasses()):(s=de.ov.isUri(e)?e:e.resource,r=(0,L.Hx)(s),o=this.labelService.getUriLabel((0,L.XX)(s),{relative:!0}),n=this.workingCopyService.isDirty(s)&&!t.shortAutoSaveDelay,a=[]);const c=o?`${r} ${o}`:r,l=new Bt.o((()=>(0,ge.r)(this.modelService,this.languageService,s).concat(a))),h=new Bt.o((()=>{const e=t.openSideBySideDirection,s=[];return s.push({iconClass:"right"===e?St.kS.asClassName(vt.lA.splitHorizontal):St.kS.asClassName(vt.lA.splitVertical),tooltip:"right"===e?(0,R.NC)({key:"openToSide",comment:["Open this file in a split editor on the left/right side"]},"Open to the Side"):(0,R.NC)({key:"openToBottom",comment:["Open this file in a split editor on the bottom"]},"Open to the Bottom")}),i&&s.push({iconClass:n?"dirty-anything "+St.kS.asClassName(vt.lA.circleFilled):St.kS.asClassName(vt.lA.close),tooltip:(0,R.NC)("closeEditor","Remove from Recently Opened"),alwaysVisible:n}),s}));return{resource:s,label:r,ariaLabel:n?(0,R.NC)("filePickAriaLabelDirty","{0} unsaved changes",c):c,description:o,get iconClasses(){return l.value},get buttons(){return h.value},trigger:(t,i)=>{switch(t){case 0:return this.openAnything(e,{keyMods:i,range:this.pickState.lastRange,forceOpenSideBySide:!0}),re.L.CLOSE_PICKER;case 1:if(!de.ov.isUri(e))return this.historyService.removeFromHistory(e),re.L.REMOVE_ITEM}return re.L.NO_ACTION},accept:(t,i)=>this.openAnything(e,{keyMods:t,range:this.pickState.lastRange,preserveFocus:i.inBackground,forcePinned:i.inBackground})}}async openAnything(e,t){const i={preserveFocus:t.preserveFocus,pinned:t.keyMods?.ctrlCmd||t.forcePinned||this.configuration.openEditorPinned,selection:t.range?P.e.collapseToStart(t.range):void 0},s=t.keyMods?.alt||this.configuration.openEditorPinned&&t.keyMods?.ctrlCmd||t.forceOpenSideBySide?w.O3:w.LP;if(s===w.O3&&await this.pickState.restoreEditorViewState(),(0,y.Xl)(e))await this.editorService.openEditor(e,i,s);else{let t;t=de.ov.isUri(e)?{resource:e,options:i}:{...e,options:{...e.options,...i}},await this.editorService.openEditor(t,s)}}};Ht=(0,o.g)([(0,o.f)(0,A.TG),(0,o.f)(1,r.x1),(0,o.f)(2,ce.ec),(0,o.f)(3,he.a),(0,o.f)(4,ue.n),(0,o.f)(5,f.sn),(0,o.f)(6,W.e),(0,o.f)(7,p.q),(0,o.f)(8,_.O),(0,o.f)(9,pe.C),(0,o.f)(10,fe.Ui),(0,o.f)(11,w.AR),(0,o.f)(12,ye.CE),(0,o.f)(13,we.LM),(0,o.f)(14,F.S),(0,o.f)(15,S.v),(0,o.f)(16,se.eJ)],Ht);var Vt=i(63809);const Kt=(0,At.q5)("search-details",vt.lA.ellipsis,(0,R.NC)("searchDetailsIcon","Icon to make search details visible.")),Qt=(0,At.q5)("search-show-context",vt.lA.listSelection,(0,R.NC)("searchShowContextIcon","Icon for toggle the context in the search editor.")),Ut=(0,At.q5)("search-hide-replace",vt.lA.chevronRight,(0,R.NC)("searchHideReplaceIcon","Icon to collapse the replace section in the search view.")),$t=(0,At.q5)("search-show-replace",vt.lA.chevronDown,(0,R.NC)("searchShowReplaceIcon","Icon to expand the replace section in the search view.")),Gt=(0,At.q5)("search-replace-all",vt.lA.replaceAll,(0,R.NC)("searchReplaceAllIcon","Icon for replace all in the search view.")),zt=(0,At.q5)("search-replace",vt.lA.replace,(0,R.NC)("searchReplaceIcon","Icon for replace in the search view.")),jt=(0,At.q5)("search-remove",vt.lA.close,(0,R.NC)("searchRemoveIcon","Icon to remove a search result.")),Yt=(0,At.q5)("search-refresh",vt.lA.refresh,(0,R.NC)("searchRefreshIcon","Icon for refresh in the search view.")),Xt=(0,At.q5)("search-collapse-results",vt.lA.collapseAll,(0,R.NC)("searchCollapseAllIcon","Icon for collapse results in the search view.")),Jt=(0,At.q5)("search-expand-results",vt.lA.expandAll,(0,R.NC)("searchExpandAllIcon","Icon for expand results in the search view.")),Zt=(0,At.q5)("search-tree",vt.lA.listTree,(0,R.NC)("searchShowAsTree","Icon for viewing results as a tree in the search view.")),ei=(0,At.q5)("search-list",vt.lA.listFlat,(0,R.NC)("searchShowAsList","Icon for viewing results as a list in the search view.")),ti=(0,At.q5)("search-clear-results",vt.lA.clearAll,(0,R.NC)("searchClearIcon","Icon for clear results in the search view.")),ii=(0,At.q5)("search-stop",vt.lA.searchStop,(0,R.NC)("searchStopIcon","Icon for stop in the search view.")),si=(0,At.q5)("search-view-icon",vt.lA.search,(0,R.NC)("searchViewIcon","View icon of the search view.")),ri=(0,At.q5)("search-new-editor",vt.lA.newFile,(0,R.NC)("searchNewEditorIcon","Icon for the action to open a new search editor."));var oi=i(59069),ni=i(56346),ai=i(60350),ci=i(53725);(0,te.Z)(".search-view{display:flex;flex-direction:column;height:100%}.search-view .results{flex-grow:1;min-height:0}.search-view .search-widgets-container{margin:0 12px 0 2px;padding-bottom:6px;padding-top:6px}.search-view .search-widget .toggle-replace-button{align-items:center;background-color:unset;background-position:50%;background-repeat:no-repeat;box-sizing:border-box;color:inherit;cursor:pointer;display:flex;height:100%;justify-content:center;left:0;position:absolute;top:0;width:16px}.monaco-workbench .search-view .search-widget .toggle-replace-button:hover{background-color:var(--vscode-toolbar-hoverBackground)}.monaco-workbench .search-view .search-widget .toggle-replace-button:active{background-color:var(--vscode-toolbar-activeBackground)}.search-view .search-widget .replace-container,.search-view .search-widget .search-container{margin-left:18px}.search-view .search-widget .monaco-inputbox>.ibwrapper{height:100%}.search-view .search-widget .monaco-inputbox>.ibwrapper>.mirror,.search-view .search-widget .monaco-inputbox>.ibwrapper>textarea.input{padding:3px 0 3px 6px}.search-view .search-widget .monaco-inputbox>.ibwrapper>textarea.input{height:26px;overflow:initial}.search-view .search-widget .monaco-findInput .monaco-scrollable-element .scrollbar{opacity:0}.search-view .monaco-inputbox>.ibwrapper>textarea.input{scrollbar-width:none}.search-view .monaco-inputbox>.ibwrapper>textarea.input::-webkit-scrollbar{display:none}.search-view .monaco-findInput{display:inline-block;vertical-align:middle;width:100%}.search-view .search-widget .replace-container{display:inline-flex;margin-top:6px;position:relative}.search-view .search-widget .replace-input{display:flex;position:relative;vertical-align:middle;width:auto!important}.search-view .search-widget .replace-input>.controls{position:absolute;right:2px;top:3px}.search-view .search-widget .replace-container.disabled{display:none}.search-view .search-widget .replace-container .monaco-action-bar{height:25px;margin-left:4px}.search-view .query-details{margin:0 0 0 18px;min-height:1em;position:relative}.search-view .query-details .more{color:inherit;cursor:pointer;height:16px;position:absolute;right:-2px;width:25px;z-index:2}.search-view .query-details .file-types{display:none}.search-view .query-details .file-types>.monaco-inputbox{height:25px;width:100%}.search-view .query-details.more .file-types{display:inherit}.search-view .query-details.more .file-types:last-child{padding-bottom:4px}.search-view .query-details.more h4{font-size:11px;font-weight:400;margin:0;overflow:hidden;padding:4px 0 0;text-overflow:ellipsis;white-space:nowrap}.search-view .messages{color:var(--vscode-search-resultsInfoForeground);cursor:default;margin-top:-5px}.search-view .message{overflow-wrap:break-word;padding:0 22px 8px}.search-view .message p:first-child{margin-bottom:0;margin-top:0;padding-bottom:4px;user-select:text;-webkit-user-select:text}.search-view .message a{color:var(--vscode-textLink-foreground)}.search-view .message a:active,.search-view .message a:hover{color:var(--vscode-textLink-activeForeground)}.search-view .filematch,.search-view .foldermatch{display:flex;height:100%;line-height:22px;padding:0;position:relative}.pane-body:not(.wide) .search-view .filematch .monaco-icon-label,.pane-body:not(.wide) .search-view .foldermatch .monaco-icon-label,.pane-body:not(.wide) .search-view .monaco-list .monaco-list-row.focused .filematch .monaco-icon-label,.pane-body:not(.wide) .search-view .monaco-list .monaco-list-row.focused .foldermatch .monaco-icon-label,.pane-body:not(.wide) .search-view .monaco-list .monaco-list-row:hover:not(.highlighted) .filematch .monaco-icon-label,.pane-body:not(.wide) .search-view .monaco-list .monaco-list-row:hover:not(.highlighted) .foldermatch .monaco-icon-label{flex:1}.pane-body.wide .search-view .filematch .badge,.pane-body.wide .search-view .foldermatch .badge{margin-left:10px}.search-view .linematch{display:flex;line-height:22px;overflow:hidden;position:relative}.search-view .linematch>.match{overflow:hidden;text-overflow:ellipsis;white-space:pre}.search-view .linematch .matchLineNum{display:none;font-size:.9em;margin-left:7px;margin-right:4px;opacity:.7}.search-view .linematch .matchLineNum.show{display:block}.pane-body.wide .search-view .monaco-list .monaco-list-row .filematch .actionBarContainer,.pane-body.wide .search-view .monaco-list .monaco-list-row .foldermatch .actionBarContainer,.search-view .monaco-list .monaco-list-row .linematch .actionBarContainer{flex:1 0 auto}.pane-body:not(.wide) .search-view .monaco-list .monaco-list-row .filematch .actionBarContainer,.pane-body:not(.wide) .search-view .monaco-list .monaco-list-row .foldermatch .actionBarContainer{flex:0 0 auto}.pane-body:not(.wide) .search-view .monaco-list .monaco-list-row .linematch .actionBarContainer,.search-view.actions-right .monaco-list .monaco-list-row .filematch .actionBarContainer,.search-view.actions-right .monaco-list .monaco-list-row .foldermatch .actionBarContainer,.search-view.actions-right .monaco-list .monaco-list-row .linematch .actionBarContainer{text-align:right}.search-view .monaco-list .monaco-list-row .monaco-action-bar{display:none;line-height:1em;padding:0 .8em 0 .4em}.search-view .monaco-list .monaco-list-row .monaco-action-bar .action-item{margin:0}.search-view .monaco-list .monaco-list-row.focused .monaco-action-bar,.search-view .monaco-list .monaco-list-row.selected .monaco-action-bar,.search-view .monaco-list .monaco-list-row:hover:not(.highlighted) .monaco-action-bar{display:inline-block}.search-view .monaco-list .monaco-list-row .monaco-action-bar .action-item{margin-right:.2em}.search-view .monaco-list .monaco-list-row .monaco-action-bar .action-label{padding:2px}.monaco-workbench.hc-black .search-view .monaco-list .monaco-list-row .monaco-action-bar .action-label,.monaco-workbench.hc-light .search-view .monaco-list .monaco-list-row .monaco-action-bar .action-label{margin-top:2px}.search-view .monaco-count-badge{margin-right:12px}.pane-body:not(.wide) .search-view>.results>.monaco-list .monaco-list-row.focused .filematch .monaco-count-badge,.pane-body:not(.wide) .search-view>.results>.monaco-list .monaco-list-row.focused .foldermatch .monaco-count-badge,.pane-body:not(.wide) .search-view>.results>.monaco-list .monaco-list-row.focused .linematch .monaco-count-badge,.pane-body:not(.wide) .search-view>.results>.monaco-list .monaco-list-row:hover .filematch .monaco-count-badge,.pane-body:not(.wide) .search-view>.results>.monaco-list .monaco-list-row:hover .foldermatch .monaco-count-badge,.pane-body:not(.wide) .search-view>.results>.monaco-list .monaco-list-row:hover .linematch .monaco-count-badge{display:none}.search-view .replace.findInFileMatch{background-color:var(--vscode-diffEditor-removedTextBackground);border:1px solid var(--vscode-diffEditor-removedTextBackground);text-decoration:line-through}.monaco-workbench.hc-dark .search-view .replace.findInFileMatch,.monaco-workbench.hc-light .search-view .replace.findInFileMatch{border:1px dashed var(--vscode-diffEditor-removedTextBackground)}.search-view .findInFileMatch,.search-view .replaceMatch{white-space:pre}.search-view .findInFileMatch{background-color:var(--vscode-editor-findMatchHighlightBackground);border:1px solid var(--vscode-editor-findMatchHighlightBorder)}.monaco-workbench.hc-dark .search-view .findInFileMatch,.monaco-workbench.hc-light .search-view .findInFileMatch{border:1px dashed var(--vscode-editor-findMatchHighlightBorder)}.search-view .replaceMatch{background-color:var(--vscode-diffEditor-insertedTextBackground)}.monaco-workbench.hc-black .search-view .findInFileMatch,.monaco-workbench.hc-black .search-view .replaceMatch,.monaco-workbench.hc-light .search-view .findInFileMatch,.monaco-workbench.hc-light .search-view .replaceMatch{background:none!important;box-sizing:border-box}.search-view .replaceMatch:not(:empty){border:1px solid var(--vscode-diffEditor-insertedLineBackground)}.monaco-workbench.hc-dark .search-view .replaceMatch:not(:empty),.monaco-workbench.hc-light .search-view .replaceMatch:not(:empty){border:1px dashed var(--vscode-diffEditor-insertedLineBackground)}.monaco-workbench.hc-black .search-view .filematch,.monaco-workbench.hc-black .search-view .foldermatch,.monaco-workbench.hc-black .search-view .linematch,.monaco-workbench.hc-light .search-view .filematch,.monaco-workbench.hc-light .search-view .foldermatch,.monaco-workbench.hc-light .search-view .linematch{line-height:20px}.monaco-workbench.vs .search-panel .search-view .monaco-inputbox{border:1px solid transparent}.text-search-provider-messages .providerMessage{padding-top:4px}.text-search-provider-messages .providerMessage .codicon{padding-right:3px;position:relative;top:3px}.monaco-workbench .search-view .monaco-list.element-focused .monaco-list-row.focused.selected:not(.highlighted) .action-label:focus{outline-color:var(--vscode-list-activeSelectionForeground)}.monaco-workbench .search-container .monaco-custom-toggle.disabled{background-color:inherit!important;cursor:default;opacity:.3;pointer-events:none;user-select:none;-webkit-user-select:none}.monaco-workbench .search-container .find-filter-button{box-sizing:border-box;color:inherit;cursor:pointer;float:left;margin-left:2px;user-select:none;-webkit-user-select:none}",{});var li=i(84527),hi=i(3860),di=i(22258),ui=i(28108),gi=i(71922),pi=i(19620),fi={};fi.styleTagTransform=Ve(),fi.setAttributes=De(),fi.insert=We().bind(null,"head"),fi.domAPI=Pe(),fi.insertStyleElement=qe(),Te()(pi.Z,fi),pi.Z&&pi.Z.locals&&pi.Z.locals;const mi=(0,Ge.P6G)("editor.wordHighlightBackground",{dark:"#575757B8",light:"#57575740",hcDark:null,hcLight:null},R.NC("wordHighlight","Background color of a symbol during read-access, like reading a variable. The color must not be opaque so as not to hide underlying decorations."),!0);(0,Ge.P6G)("editor.wordHighlightStrongBackground",{dark:"#004972B8",light:"#0e639c40",hcDark:null,hcLight:null},R.NC("wordHighlightStrong","Background color of a symbol during write-access, like writing to a variable. The color must not be opaque so as not to hide underlying decorations."),!0),(0,Ge.P6G)("editor.wordHighlightTextBackground",{light:mi,dark:mi,hcDark:mi,hcLight:mi},R.NC("wordHighlightText","Background color of a textual occurrence for a symbol. The color must not be opaque so as not to hide underlying decorations."),!0);const vi=(0,Ge.P6G)("editor.wordHighlightBorder",{light:null,dark:null,hcDark:Ge.xL1,hcLight:Ge.xL1},R.NC("wordHighlightBorder","Border color of a symbol during read-access, like reading a variable."));(0,Ge.P6G)("editor.wordHighlightStrongBorder",{light:null,dark:null,hcDark:Ge.xL1,hcLight:Ge.xL1},R.NC("wordHighlightStrongBorder","Border color of a symbol during write-access, like writing to a variable.")),(0,Ge.P6G)("editor.wordHighlightTextBorder",{light:vi,dark:vi,hcDark:vi,hcLight:vi},R.NC("wordHighlightTextBorder","Border color of a textual occurrence for a symbol."));const Si=(0,Ge.P6G)("editorOverviewRuler.wordHighlightForeground",{dark:"#A0A0A0CC",light:"#A0A0A0CC",hcDark:"#A0A0A0CC",hcLight:"#A0A0A0CC"},R.NC("overviewRulerWordHighlightForeground","Overview ruler marker color for symbol highlights. The color must not be opaque so as not to hide underlying decorations."),!0),yi=(0,Ge.P6G)("editorOverviewRuler.wordHighlightStrongForeground",{dark:"#C0A0C0CC",light:"#C0A0C0CC",hcDark:"#C0A0C0CC",hcLight:"#C0A0C0CC"},R.NC("overviewRulerWordHighlightStrongForeground","Overview ruler marker color for write-access symbol highlights. The color must not be opaque so as not to hide underlying decorations."),!0),wi=(0,Ge.P6G)("editorOverviewRuler.wordHighlightTextForeground",{dark:Ge.SPM,light:Ge.SPM,hcDark:Ge.SPM,hcLight:Ge.SPM},R.NC("overviewRulerWordHighlightTextForeground","Overview ruler marker color of a textual occurrence for a symbol. The color must not be opaque so as not to hide underlying decorations."),!0),Ci=(N.qx.register({description:"word-highlight-strong",stickiness:1,className:"wordHighlightStrong",overviewRuler:{color:(0,st.EN)(yi),position:_e.sh.Center},minimap:{color:(0,st.EN)(Ge.IYc),position:_e.F5.Inline}}),N.qx.register({description:"word-highlight-text",stickiness:1,className:"wordHighlightText",overviewRuler:{color:(0,st.EN)(wi),position:_e.sh.Center},minimap:{color:(0,st.EN)(Ge.IYc),position:_e.F5.Inline}}),N.qx.register({description:"selection-highlight-overview",stickiness:1,className:"selectionHighlight",overviewRuler:{color:(0,st.EN)(Ge.SPM),position:_e.sh.Center},minimap:{color:(0,st.EN)(Ge.IYc),position:_e.F5.Inline}})),bi=N.qx.register({description:"selection-highlight",stickiness:1,className:"selectionHighlight"});function xi(e){return e?bi:Ci}N.qx.register({description:"word-highlight",stickiness:1,className:"wordHighlight",overviewRuler:{color:(0,st.EN)(Si),position:_e.sh.Center},minimap:{color:(0,st.EN)(Ge.IYc),position:_e.F5.Inline}}),(0,st.Ic)(((e,t)=>{const i=e.getColor(Ge.Rzx);i&&t.addRule(`.monaco-editor .selectionHighlight { background-color: ${i.transparent(.5)}; }`)}));function Ei(e,t){const i=t.filter((t=>!e.find((e=>e.equals(t)))));if(i.length>=1){const e=i.map((e=>`line ${e.viewState.position.lineNumber} column ${e.viewState.position.column}`)).join(", "),t=1===i.length?R.NC("cursorAdded","Cursor added: {0}",e):R.NC("cursorsAdded","Cursors added: {0}",e);(0,ni.i7)(t)}}class ki extends ke.R6{constructor(){super({id:"editor.action.insertCursorAbove",label:R.NC("mutlicursor.insertAbove","Add Cursor Above"),alias:"Add Cursor Above",precondition:void 0,kbOpts:{kbExpr:Re.u.editorTextFocus,primary:2576,linux:{primary:1552,secondary:[3088]},weight:100},menuOpts:{menuId:Xe.eH.MenubarSelectionMenu,group:"3_multi",title:R.NC({key:"miInsertCursorAbove",comment:["&& denotes a mnemonic"]},"&&Add Cursor Above"),order:2}})}run(e,t,i){if(!t.hasModel())return;let s=!0;i&&!1===i.logicalLine&&(s=!1);const r=t._getViewModel();if(r.cursorConfig.readOnly)return;r.model.pushStackElement();const o=r.getCursorStates();r.setCursorStates(i.source,3,ui.P.addCursorUp(r,o,s)),r.revealTopMostCursor(i.source),Ei(o,r.getCursorStates())}}class Ii extends ke.R6{constructor(){super({id:"editor.action.insertCursorBelow",label:R.NC("mutlicursor.insertBelow","Add Cursor Below"),alias:"Add Cursor Below",precondition:void 0,kbOpts:{kbExpr:Re.u.editorTextFocus,primary:2578,linux:{primary:1554,secondary:[3090]},weight:100},menuOpts:{menuId:Xe.eH.MenubarSelectionMenu,group:"3_multi",title:R.NC({key:"miInsertCursorBelow",comment:["&& denotes a mnemonic"]},"A&&dd Cursor Below"),order:3}})}run(e,t,i){if(!t.hasModel())return;let s=!0;i&&!1===i.logicalLine&&(s=!1);const r=t._getViewModel();if(r.cursorConfig.readOnly)return;r.model.pushStackElement();const o=r.getCursorStates();r.setCursorStates(i.source,3,ui.P.addCursorDown(r,o,s)),r.revealBottomMostCursor(i.source),Ei(o,r.getCursorStates())}}class Ri extends ke.R6{constructor(){super({id:"editor.action.insertCursorAtEndOfEachLineSelected",label:R.NC("mutlicursor.insertAtEndOfEachLineSelected","Add Cursors to Line Ends"),alias:"Add Cursors to Line Ends",precondition:void 0,kbOpts:{kbExpr:Re.u.editorTextFocus,primary:1575,weight:100},menuOpts:{menuId:Xe.eH.MenubarSelectionMenu,group:"3_multi",title:R.NC({key:"miInsertCursorAtEndOfEachLineSelected",comment:["&& denotes a mnemonic"]},"Add C&&ursors to Line Ends"),order:4}})}getCursorsForSelection(e,t,i){if(!e.isEmpty()){for(let s=e.startLineNumber;s<e.endLineNumber;s++){const e=t.getLineMaxColumn(s);i.push(new hi.Y(s,e,s,e))}e.endColumn>1&&i.push(new hi.Y(e.endLineNumber,e.endColumn,e.endLineNumber,e.endColumn))}}run(e,t){if(!t.hasModel())return;const i=t.getModel(),s=t.getSelections(),r=t._getViewModel(),o=r.getCursorStates(),n=[];s.forEach((e=>this.getCursorsForSelection(e,i,n))),n.length>0&&t.setSelections(n),Ei(o,r.getCursorStates())}}class _i extends ke.R6{constructor(){super({id:"editor.action.addCursorsToBottom",label:R.NC("mutlicursor.addCursorsToBottom","Add Cursors To Bottom"),alias:"Add Cursors To Bottom",precondition:void 0})}run(e,t){if(!t.hasModel())return;const i=t.getSelections(),s=t.getModel().getLineCount(),r=[];for(let e=i[0].startLineNumber;e<=s;e++)r.push(new hi.Y(e,i[0].startColumn,e,i[0].endColumn));const o=t._getViewModel(),n=o.getCursorStates();r.length>0&&t.setSelections(r),Ei(n,o.getCursorStates())}}class Fi extends ke.R6{constructor(){super({id:"editor.action.addCursorsToTop",label:R.NC("mutlicursor.addCursorsToTop","Add Cursors To Top"),alias:"Add Cursors To Top",precondition:void 0})}run(e,t){if(!t.hasModel())return;const i=t.getSelections(),s=[];for(let e=i[0].startLineNumber;e>=1;e--)s.push(new hi.Y(e,i[0].startColumn,e,i[0].endColumn));const r=t._getViewModel(),o=r.getCursorStates();s.length>0&&t.setSelections(s),Ei(o,r.getCursorStates())}}class Ai{constructor(e,t,i){this.selections=e,this.revealRange=t,this.revealScrollType=i}}class Ni{static create(e,t){if(!e.hasModel())return null;const i=t.getState();if(!e.hasTextFocus()&&i.isRevealed&&i.searchString.length>0)return new Ni(e,t,!1,i.searchString,i.wholeWord,i.matchCase,null);let s,r,o=!1;const n=e.getSelections();1===n.length&&n[0].isEmpty()?(o=!0,s=!0,r=!0):(s=i.wholeWord,r=i.matchCase);const a=e.getSelection();let c,l=null;if(a.isEmpty()){const t=e.getConfiguredWordAtPosition(a.getStartPosition());if(!t)return null;c=t.word,l=new hi.Y(a.startLineNumber,t.startColumn,a.startLineNumber,t.endColumn)}else c=e.getModel().getValueInRange(a).replace(/\r\n/g,"\n");return new Ni(e,t,o,c,s,r,l)}constructor(e,t,i,s,r,o,n){this._editor=e,this.findController=t,this.isDisconnectedFromFindController=i,this.searchText=s,this.wholeWord=r,this.matchCase=o,this.currentMatch=n}addSelectionToNextFindMatch(){if(!this._editor.hasModel())return null;const e=this._getNextMatch();if(!e)return null;const t=this._editor.getSelections();return new Ai(t.concat(e),e,0)}moveSelectionToNextFindMatch(){if(!this._editor.hasModel())return null;const e=this._getNextMatch();if(!e)return null;const t=this._editor.getSelections();return new Ai(t.slice(0,t.length-1).concat(e),e,0)}_getNextMatch(){if(!this._editor.hasModel())return null;if(this.currentMatch){const e=this.currentMatch;return this.currentMatch=null,e}this.findController.highlightFindOptions();const e=this._editor.getSelections(),t=e[e.length-1],i=this._editor.getModel().findNextMatch(this.searchText,t.getEndPosition(),!1,this.matchCase,this.wholeWord?this._editor.getOption(128):null,!1);return i?new hi.Y(i.range.startLineNumber,i.range.startColumn,i.range.endLineNumber,i.range.endColumn):null}addSelectionToPreviousFindMatch(){if(!this._editor.hasModel())return null;const e=this._getPreviousMatch();if(!e)return null;const t=this._editor.getSelections();return new Ai(t.concat(e),e,0)}moveSelectionToPreviousFindMatch(){if(!this._editor.hasModel())return null;const e=this._getPreviousMatch();if(!e)return null;const t=this._editor.getSelections();return new Ai(t.slice(0,t.length-1).concat(e),e,0)}_getPreviousMatch(){if(!this._editor.hasModel())return null;if(this.currentMatch){const e=this.currentMatch;return this.currentMatch=null,e}this.findController.highlightFindOptions();const e=this._editor.getSelections(),t=e[e.length-1],i=this._editor.getModel().findPreviousMatch(this.searchText,t.getStartPosition(),!1,this.matchCase,this.wholeWord?this._editor.getOption(128):null,!1);return i?new hi.Y(i.range.startLineNumber,i.range.startColumn,i.range.endLineNumber,i.range.endColumn):null}selectAll(e){if(!this._editor.hasModel())return[];this.findController.highlightFindOptions();const t=this._editor.getModel();return e?t.findMatches(this.searchText,e,!1,this.matchCase,this.wholeWord?this._editor.getOption(128):null,!1,1073741824):t.findMatches(this.searchText,!0,!1,this.matchCase,this.wholeWord?this._editor.getOption(128):null,!1,1073741824)}}class Ti extends l.JT{static get(e){return e.getContribution(Ti.ID)}constructor(e){super(),this._sessionDispose=this._register(new l.SL),this._editor=e,this._ignoreSelectionChange=!1,this._session=null}dispose(){this._endSession(),super.dispose()}_beginSessionIfNeeded(e){if(!this._session){const t=Ni.create(this._editor,e);if(!t)return;this._session=t;const i={searchString:this._session.searchText};this._session.isDisconnectedFromFindController&&(i.wholeWordOverride=1,i.matchCaseOverride=1,i.isRegexOverride=2),e.getState().change(i,!1),this._sessionDispose.add(this._editor.onDidChangeCursorSelection((e=>{this._ignoreSelectionChange||this._endSession()}))),this._sessionDispose.add(this._editor.onDidBlurEditorText((()=>{this._endSession()}))),this._sessionDispose.add(e.getState().onFindReplaceStateChange((e=>{(e.matchCase||e.wholeWord)&&this._endSession()})))}}_endSession(){if(this._sessionDispose.clear(),this._session&&this._session.isDisconnectedFromFindController){const e={wholeWordOverride:0,matchCaseOverride:0,isRegexOverride:0};this._session.findController.getState().change(e,!1)}this._session=null}_setSelections(e){this._ignoreSelectionChange=!0,this._editor.setSelections(e),this._ignoreSelectionChange=!1}_expandEmptyToWord(e,t){if(!t.isEmpty())return t;const i=this._editor.getConfiguredWordAtPosition(t.getStartPosition());return i?new hi.Y(t.startLineNumber,i.startColumn,t.startLineNumber,i.endColumn):t}_applySessionResult(e){e&&(this._setSelections(e.selections),e.revealRange&&this._editor.revealRangeInCenterIfOutsideViewport(e.revealRange,e.revealScrollType))}getSession(e){return this._session}addSelectionToNextFindMatch(e){if(this._editor.hasModel()){if(!this._session){const t=this._editor.getSelections();if(t.length>1){const i=e.getState().matchCase;if(!Wi(this._editor.getModel(),t,i)){const e=this._editor.getModel(),i=[];for(let s=0,r=t.length;s<r;s++)i[s]=this._expandEmptyToWord(e,t[s]);return void this._editor.setSelections(i)}}}this._beginSessionIfNeeded(e),this._session&&this._applySessionResult(this._session.addSelectionToNextFindMatch())}}addSelectionToPreviousFindMatch(e){this._beginSessionIfNeeded(e),this._session&&this._applySessionResult(this._session.addSelectionToPreviousFindMatch())}moveSelectionToNextFindMatch(e){this._beginSessionIfNeeded(e),this._session&&this._applySessionResult(this._session.moveSelectionToNextFindMatch())}moveSelectionToPreviousFindMatch(e){this._beginSessionIfNeeded(e),this._session&&this._applySessionResult(this._session.moveSelectionToPreviousFindMatch())}selectAll(e){if(!this._editor.hasModel())return;let t=null;const i=e.getState();if(i.isRevealed&&i.searchString.length>0&&i.isRegex){const e=this._editor.getModel();t=i.searchScope?e.findMatches(i.searchString,i.searchScope,i.isRegex,i.matchCase,i.wholeWord?this._editor.getOption(128):null,!1,1073741824):e.findMatches(i.searchString,!0,i.isRegex,i.matchCase,i.wholeWord?this._editor.getOption(128):null,!1,1073741824)}else{if(this._beginSessionIfNeeded(e),!this._session)return;t=this._session.selectAll(i.searchScope)}if(t.length>0){const e=this._editor.getSelection();for(let i=0,s=t.length;i<s;i++){const s=t[i];if(s.range.intersectRanges(e)){t[i]=t[0],t[0]=s;break}}this._setSelections(t.map((e=>new hi.Y(e.range.startLineNumber,e.range.startColumn,e.range.endLineNumber,e.range.endColumn))))}}selectAllUsingSelections(e){e.length>0&&this._setSelections(e)}}Ti.ID="editor.contrib.multiCursorController";class Mi extends ke.R6{run(e,t){const i=Ti.get(t);if(!i)return;const s=t._getViewModel();if(s){const r=s.getCursorStates(),o=ct.get(t);if(o)this._run(i,o);else{const s=e.get(A.TG).createInstance(ct,t);this._run(i,s),s.dispose()}Ei(r,s.getCursorStates())}}}class Pi{constructor(e,t,i,s,r){this._model=e,this._searchText=t,this._matchCase=i,this._wordSeparators=s,this._modelVersionId=this._model.getVersionId(),this._cachedFindMatches=null,r&&this._model===r._model&&this._searchText===r._searchText&&this._matchCase===r._matchCase&&this._wordSeparators===r._wordSeparators&&this._modelVersionId===r._modelVersionId&&(this._cachedFindMatches=r._cachedFindMatches)}findMatches(){return null===this._cachedFindMatches&&(this._cachedFindMatches=this._model.findMatches(this._searchText,!0,!1,this._matchCase,this._wordSeparators,!1).map((e=>e.range)),this._cachedFindMatches.sort(P.e.compareRangesUsingStarts)),this._cachedFindMatches}}let Oi=class e extends l.JT{constructor(e,t){super(),this._languageFeaturesService=t,this.editor=e,this._isEnabled=e.getOption(106),this._decorations=e.createDecorationsCollection(),this.updateSoon=this._register(new a.pY((()=>this._update()),300)),this.state=null,this._register(e.onDidChangeConfiguration((t=>{this._isEnabled=e.getOption(106)}))),this._register(e.onDidChangeCursorSelection((e=>{this._isEnabled&&(e.selection.isEmpty()?3===e.reason?(this.state&&this._setState(null),this.updateSoon.schedule()):this._setState(null):this._update())}))),this._register(e.onDidChangeModel((e=>{this._setState(null)}))),this._register(e.onDidChangeModelContent((e=>{this._isEnabled&&this.updateSoon.schedule()})));const i=ct.get(e);i&&this._register(i.getState().onFindReplaceStateChange((e=>{this._update()}))),this.updateSoon.schedule()}_update(){this._setState(e._createState(this.state,this._isEnabled,this.editor))}static _createState(e,t,i){if(!t)return null;if(!i.hasModel())return null;const s=i.getSelection();if(s.startLineNumber!==s.endLineNumber)return null;const r=Ti.get(i);if(!r)return null;const o=ct.get(i);if(!o)return null;let n=r.getSession(o);if(!n){const e=i.getSelections();if(e.length>1){const t=o.getState().matchCase;if(!Wi(i.getModel(),e,t))return null}n=Ni.create(i,o)}if(!n)return null;if(n.currentMatch)return null;if(/^[ \t]+$/.test(n.searchText))return null;if(n.searchText.length>200)return null;const a=o.getState(),c=a.matchCase;if(a.isRevealed){let e=a.searchString;c||(e=e.toLowerCase());let t=n.searchText;if(c||(t=t.toLowerCase()),e===t&&n.matchCase===a.matchCase&&n.wholeWord===a.wholeWord&&!a.isRegex)return null}return new Pi(i.getModel(),n.searchText,n.matchCase,n.wholeWord?i.getOption(128):null,e)}_setState(e){if(this.state=e,!this.state)return void this._decorations.clear();if(!this.editor.hasModel())return;const t=this.editor.getModel();if(t.isTooLargeForTokenization())return;const i=this.state.findMatches(),s=this.editor.getSelections();s.sort(P.e.compareRangesUsingStarts);const r=[];for(let e=0,t=0,o=i.length,n=s.length;e<o;){const o=i[e];if(t>=n)r.push(o),e++;else{const i=P.e.compareRangesUsingStarts(o,s[t]);i<0?(!s[t].isEmpty()&&P.e.areIntersecting(o,s[t])||r.push(o),e++):(i>0||e++,t++)}}const o=this._languageFeaturesService.documentHighlightProvider.has(t)&&this.editor.getOption(79),n=r.map((e=>({range:e,options:xi(o)})));this._decorations.set(n)}dispose(){this._setState(null),super.dispose()}};function Wi(e,t,i){const s=Li(e,t[0],!i);for(let r=1,o=t.length;r<o;r++){const o=t[r];if(o.isEmpty())return!1;if(s!==Li(e,o,!i))return!1}return!0}function Li(e,t,i){const s=e.getValueInRange(t);return i?s.toLowerCase():s}var Di,Bi;Oi.ID="editor.contrib.selectionHighlighter",Oi=function(e,t,i,s){var r,o=arguments.length,n=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(n=(o<3?r(n):o>3?r(t,i,n):r(t,i))||n);return o>3&&n&&Object.defineProperty(t,i,n),n}([(Di=1,Bi=gi.p,function(e,t){Bi(e,t,Di)})],Oi);class qi extends ke.R6{constructor(){super({id:"editor.action.focusNextCursor",label:R.NC("mutlicursor.focusNextCursor","Focus Next Cursor"),description:{description:R.NC("mutlicursor.focusNextCursor.description","Focuses the next cursor"),args:[]},alias:"Focus Next Cursor",precondition:void 0})}run(e,t,i){if(!t.hasModel())return;const s=t._getViewModel();if(s.cursorConfig.readOnly)return;s.model.pushStackElement();const r=Array.from(s.getCursorStates()),o=r.shift();o&&(r.push(o),s.setCursorStates(i.source,3,r),s.revealPrimaryCursor(i.source,!0),Ei(r,s.getCursorStates()))}}class Hi extends ke.R6{constructor(){super({id:"editor.action.focusPreviousCursor",label:R.NC("mutlicursor.focusPreviousCursor","Focus Previous Cursor"),description:{description:R.NC("mutlicursor.focusPreviousCursor.description","Focuses the previous cursor"),args:[]},alias:"Focus Previous Cursor",precondition:void 0})}run(e,t,i){if(!t.hasModel())return;const s=t._getViewModel();if(s.cursorConfig.readOnly)return;s.model.pushStackElement();const r=Array.from(s.getCursorStates()),o=r.pop();o&&(r.unshift(o),s.setCursorStates(i.source,3,r),s.revealPrimaryCursor(i.source,!0),Ei(r,s.getCursorStates()))}}(0,ke._K)(Ti.ID,Ti,4),(0,ke._K)(Oi.ID,Oi,1),(0,ke.Qr)(ki),(0,ke.Qr)(Ii),(0,ke.Qr)(Ri),(0,ke.Qr)(class extends Mi{constructor(){super({id:"editor.action.addSelectionToNextFindMatch",label:R.NC("addSelectionToNextFindMatch","Add Selection To Next Find Match"),alias:"Add Selection To Next Find Match",precondition:void 0,kbOpts:{kbExpr:Re.u.focus,primary:2082,weight:100},menuOpts:{menuId:Xe.eH.MenubarSelectionMenu,group:"3_multi",title:R.NC({key:"miAddSelectionToNextFindMatch",comment:["&& denotes a mnemonic"]},"Add &&Next Occurrence"),order:5}})}_run(e,t){e.addSelectionToNextFindMatch(t)}}),(0,ke.Qr)(class extends Mi{constructor(){super({id:"editor.action.addSelectionToPreviousFindMatch",label:R.NC("addSelectionToPreviousFindMatch","Add Selection To Previous Find Match"),alias:"Add Selection To Previous Find Match",precondition:void 0,menuOpts:{menuId:Xe.eH.MenubarSelectionMenu,group:"3_multi",title:R.NC({key:"miAddSelectionToPreviousFindMatch",comment:["&& denotes a mnemonic"]},"Add P&&revious Occurrence"),order:6}})}_run(e,t){e.addSelectionToPreviousFindMatch(t)}}),(0,ke.Qr)(class extends Mi{constructor(){super({id:"editor.action.moveSelectionToNextFindMatch",label:R.NC("moveSelectionToNextFindMatch","Move Last Selection To Next Find Match"),alias:"Move Last Selection To Next Find Match",precondition:void 0,kbOpts:{kbExpr:Re.u.focus,primary:(0,di.gx)(2089,2082),weight:100}})}_run(e,t){e.moveSelectionToNextFindMatch(t)}}),(0,ke.Qr)(class extends Mi{constructor(){super({id:"editor.action.moveSelectionToPreviousFindMatch",label:R.NC("moveSelectionToPreviousFindMatch","Move Last Selection To Previous Find Match"),alias:"Move Last Selection To Previous Find Match",precondition:void 0})}_run(e,t){e.moveSelectionToPreviousFindMatch(t)}}),(0,ke.Qr)(class extends Mi{constructor(){super({id:"editor.action.selectHighlights",label:R.NC("selectAllOccurrencesOfFindMatch","Select All Occurrences of Find Match"),alias:"Select All Occurrences of Find Match",precondition:void 0,kbOpts:{kbExpr:Re.u.focus,primary:3114,weight:100},menuOpts:{menuId:Xe.eH.MenubarSelectionMenu,group:"3_multi",title:R.NC({key:"miSelectHighlights",comment:["&& denotes a mnemonic"]},"Select All &&Occurrences"),order:7}})}_run(e,t){e.selectAll(t)}}),(0,ke.Qr)(class extends Mi{constructor(){super({id:"editor.action.changeAll",label:R.NC("changeAll.label","Change All Occurrences"),alias:"Change All Occurrences",precondition:z.Ao.and(Re.u.writable,Re.u.editorTextFocus),kbOpts:{kbExpr:Re.u.editorTextFocus,primary:2108,weight:100},contextMenuOpts:{group:"1_modification",order:1.2}})}_run(e,t){e.selectAll(t)}}),(0,ke.Qr)(_i),(0,ke.Qr)(Fi),(0,ke.Qr)(qi),(0,ke.Qr)(Hi);var Vi=i(31106),Ki=i(94565),Qi=i(60972),Ui=i(32414),$i=i(90535),Gi=i(86253),zi=i(7169),ji=i(93038),Yi=i(66307),Xi=i(70590),Ji=i(13994);class Zi{}var es=i(98892),ts=i(22980),is=i(97532);let ss=class extends $e.${static{this.OPTION_CHANGE="optionChange"}constructor(e,t,i,s,r,o){super(),this.contextViewProvider=t,this.contextKeyService=s,this.configurationService=r,this.keybindingService=o,this._onSubmit=this._register(new Ft.Q5),this.onSubmit=this._onSubmit.event,this._onCancel=this._register(new Ft.Q5),this.onCancel=this._onCancel.event,i={ariaLabel:R.NC("defaultLabel","input"),...i},this.width=i.width??100,this.render(i),e.appendChild(this.domNode)}dispose(){super.dispose(),this.inputFocusTracker?.dispose()}setWidth(e){this.width=e,this.contextViewProvider.layout(),this.setInputWidth()}getValue(){return this.inputBox.value}setValue(e){this.inputBox.value!==e&&(this.inputBox.value=e)}select(){this.inputBox.select()}focus(){this.inputBox.focus()}inputHasFocus(){return this.inputBox.hasFocus()}setInputWidth(){this.inputBox.width=this.width-this.getSubcontrolsWidth()-2}getSubcontrolsWidth(){return 0}getHistory(){return this.inputBox.getHistory()}clearHistory(){this.inputBox.clearHistory()}prependHistory(e){this.inputBox.prependHistory(e)}clear(){this.setValue("")}onSearchSubmit(){this.inputBox.addToHistory()}showNextTerm(){this.inputBox.showNextValue()}showPreviousTerm(){this.inputBox.showPreviousValue()}render(e){this.domNode=document.createElement("div"),this.domNode.classList.add("monaco-findInput"),this.inputBox=new ts.vF(this.domNode,this.contextViewProvider,{placeholder:e.placeholder,showPlaceholderOnFocus:e.showPlaceholderOnFocus,tooltip:e.tooltip,ariaLabel:e.ariaLabel,validationOptions:{validation:void 0},history:e.history||[],showHistoryHint:()=>(0,is.u)(this.keybindingService),inputBoxStyles:e.inputBoxStyles},this.contextKeyService),this._register(this.inputBox.onDidChange((()=>this._onSubmit.fire(!0)))),this.inputFocusTracker=Ae.go(this.inputBox.inputElement),this.onkeyup(this.inputBox.inputElement,(e=>this.onInputKeyUp(e)));const t=document.createElement("div");t.className="controls",this.renderSubcontrols(t),this.domNode.appendChild(t),this.setInputWidth()}renderSubcontrols(e){}onInputKeyUp(e){switch(e.keyCode){case 3:return this.onSearchSubmit(),void this._onSubmit.fire(!1);case 9:return void this._onCancel.fire()}}};ss=(0,o.g)([(0,o.f)(3,z.i6),(0,o.f)(4,fe.Ui),(0,o.f)(5,et.d)],ss);let rs=class extends ss{constructor(e,t,i,s,r,o){super(e,t,i,s,r,o),this._onChangeSearchInEditorsBoxEmitter=this._register(new Ft.Q5),this.onChangeSearchInEditorsBox=this._onChangeSearchInEditorsBoxEmitter.event}dispose(){super.dispose(),this.useSearchInEditorsBox.dispose()}onlySearchInOpenEditors(){return this.useSearchInEditorsBox.checked}setOnlySearchInOpenEditors(e){this.useSearchInEditorsBox.checked=e,this._onChangeSearchInEditorsBoxEmitter.fire()}getSubcontrolsWidth(){return super.getSubcontrolsWidth()+this.useSearchInEditorsBox.width()}renderSubcontrols(e){this.useSearchInEditorsBox=this._register(new es.ZD({icon:vt.lA.book,title:R.NC("onlySearchInOpenEditors","Search only in Open Editors"),isChecked:!1,...Gi.pl})),this._register(this.useSearchInEditorsBox.onChange((e=>{this._onChangeSearchInEditorsBoxEmitter.fire(),e||this.inputBox.focus()}))),e.appendChild(this.useSearchInEditorsBox.domNode),super.renderSubcontrols(e)}};rs=(0,o.g)([(0,o.f)(3,z.i6),(0,o.f)(4,fe.Ui),(0,o.f)(5,et.d)],rs);let os=class extends ss{constructor(e,t,i,s,r,o){super(e,t,i,s,r,o),this._onChangeIgnoreBoxEmitter=this._register(new Ft.Q5),this.onChangeIgnoreBox=this._onChangeIgnoreBoxEmitter.event}dispose(){super.dispose(),this.useExcludesAndIgnoreFilesBox.dispose()}useExcludesAndIgnoreFiles(){return this.useExcludesAndIgnoreFilesBox.checked}setUseExcludesAndIgnoreFiles(e){this.useExcludesAndIgnoreFilesBox.checked=e,this._onChangeIgnoreBoxEmitter.fire()}getSubcontrolsWidth(){return super.getSubcontrolsWidth()+this.useExcludesAndIgnoreFilesBox.width()}renderSubcontrols(e){this.useExcludesAndIgnoreFilesBox=this._register(new es.ZD({icon:vt.lA.exclude,actionClassName:"useExcludesAndIgnoreFiles",title:R.NC("useExcludesAndIgnoreFilesDescription","Use Exclude Settings and Ignore Files"),isChecked:!0,...Gi.pl})),this._register(this.useExcludesAndIgnoreFilesBox.onChange((e=>{this._onChangeIgnoreBoxEmitter.fire(),e||this.inputBox.focus()}))),e.appendChild(this.useExcludesAndIgnoreFilesBox.domNode),super.renderSubcontrols(e)}};os=(0,o.g)([(0,o.f)(3,z.i6),(0,o.f)(4,fe.Ui),(0,o.f)(5,et.d)],os);const ns={value:R.NC("search","Search"),original:"Search"};function as(e,t){return function(e,t){return t?e+" ("+t.getLabel()+")":e}(e,t)}function cs(e){return e.getActiveViewWithId(r.nn)}function ls(e,t,i){let s=e.getSelection().filter((e=>null!==e)).sort(((e,t)=>(0,E.j0)(e,t,i.sortOrder)));return!t||s.length>1&&s.includes(t)||(s=[t]),s}function hs(e,t){return e.openView(r.nn,t).then((e=>e??void 0))}var ds=i(17676),us=i(14603),gs=i(75742),ps=i(69272),fs=i(99106);const ms=(e,t,i,s,r,o,n)=>{const a=Ae.$("div.providerMessage"),c=(0,ds.J)(e.text);Ae.R3(a,Ae.$("."+gs.j.className(e.type===ps.a.Information?us.Z.Info:us.Z.Warning).split(" ").join(".")));for(const l of c.nodes)if("string"==typeof l)Ae.R3(a,document.createTextNode(l));else{const c=t.createInstance(fs.r,a,l,{opener:async t=>{if(!e.trusted)return;const o=de.ov.parse(t,!0);if(o.scheme===d.lg.command&&e.trusted){const e=await r.executeCommand(o.path);e?.triggerSearch&&n()}else o.scheme===d.lg.https?s.open(o):o.scheme!==d.lg.command||e.trusted?i.error(R.NC("unable to open","Unable to open unknown link: {0}",t)):i.error(R.NC("unable to open trust","Unable to open command link from untrusted source: {0}",t))}});o.add(c)}return a};var vs=i(89162),Ss=i(82663),ys=i(59856);const ws="toggleSearchCaseSensitive",Cs="toggleSearchWholeWord",bs="toggleSearchRegex",xs="toggleSearchPreserveCase",Es="workbench.action.showAllSymbols",ks=new z.uy("searchViewletVisible",!0),Is=new z.uy("searchViewletFocus",!1),Rs=new z.uy("inputBoxFocus",!1),_s=new z.uy("searchInputBoxFocus",!1),Fs=new z.uy("replaceInputBoxFocus",!1),As=new z.uy("patternIncludesInputBoxFocus",!1),Ns=new z.uy("patternExcludesInputBoxFocus",!1),Ts=new z.uy("replaceActive",!1),Ms=new z.uy("hasSearchResult",!1),Ps=new z.uy("firstMatchFocus",!1),Os=new z.uy("fileMatchOrMatchFocus",!1),Ws=new z.uy("fileMatchOrFolderMatchFocus",!1),Ls=new z.uy("fileMatchOrFolderMatchWithResourceFocus",!1),Ds=new z.uy("fileMatchFocus",!1),Bs=new z.uy("folderMatchFocus",!1),qs=new z.uy("folderMatchWithResourceFocus",!1),Hs=new z.uy("isEditableItem",!0),Vs=new z.uy("matchFocus",!1),Ks=new z.uy("viewHasSearchPattern",!1),Qs=new z.uy("viewHasReplacePattern",!1),Us=new z.uy("viewHasFilePattern",!1),$s=new z.uy("viewHasSomeCollapsibleResult",!1),Gs=new z.uy("inTreeView",!1);class zs{static{this.ITEM_HEIGHT=22}getHeight(e){return zs.ITEM_HEIGHT}getTemplateId(e){if(e instanceof E.nA)return js.TEMPLATE_ID;if(e instanceof E.ut)return Ys.TEMPLATE_ID;if(e instanceof E.qE)return Xs.TEMPLATE_ID;throw console.error("Invalid search tree element",e),new Error("Invalid search tree element")}}let js=class e extends l.JT{static{this.TEMPLATE_ID="folderMatch"}constructor(t,i,s,r,o,n){super(),this.searchView=t,this.labels=i,this.contextService=s,this.labelService=r,this.instantiationService=o,this.contextKeyService=n,this.templateId=e.TEMPLATE_ID}renderCompressedElements(e,t,i,s){const r=e.element,o=r.elements[r.elements.length-1],n=r.elements.map((e=>e.name()));if(o.resource){const e=o instanceof E.m5?f.RR.ROOT_FOLDER:f.RR.FOLDER;i.label.setResource({resource:o.resource,name:n},{fileKind:e,separator:this.labelService.getSeparator(o.resource.scheme)})}else i.label.setLabel(R.NC("searchFolderMatch.other.label","Other files"));this.renderFolderDetails(o,i)}renderTemplate(e){const t=new l.SL,i=Ae.R3(e,Ae.$(".foldermatch")),s=this.labels.create(i,{supportDescriptionHighlights:!0,supportHighlights:!0});t.add(s);const r=new vs.Z(Ae.R3(i,Ae.$(".badge")),{},Gi.ku),o=Ae.R3(i,Ae.$(".actionBarContainer")),n=new l.SL;t.add(n);const a=t.add(this.contextKeyService.createScoped(e));Vs.bindTo(a).set(!1),Ds.bindTo(a).set(!1),Bs.bindTo(a).set(!0);const c=this.instantiationService.createChild(new Qi.y([z.i6,a]));return{label:s,badge:r,actions:t.add(c.createInstance(ys.r,o,Xe.eH.SearchActionMenu,{menuOptions:{shouldForwardArgs:!0},hiddenItemStrategy:0,toolbarOptions:{primaryGroup:e=>/^inline/.test(e)}})),disposables:t,elementDisposables:n,contextKeyService:a}}renderElement(e,t,i){const s=e.element;if(s.resource){const e=this.contextService.getWorkspaceFolder(s.resource);e&&(0,L.Xy)(e.uri,s.resource)?i.label.setFile(s.resource,{fileKind:f.RR.ROOT_FOLDER,hidePath:!0}):i.label.setFile(s.resource,{fileKind:f.RR.FOLDER,hidePath:this.searchView.isTreeLayoutViewVisible})}else i.label.setLabel(R.NC("searchFolderMatch.other.label","Other files"));Hs.bindTo(i.contextKeyService).set(!s.hasOnlyReadOnlyMatches()),i.elementDisposables.add(s.onChange((()=>{Hs.bindTo(i.contextKeyService).set(!s.hasOnlyReadOnlyMatches())}))),this.renderFolderDetails(s,i)}disposeElement(e,t,i){i.elementDisposables.clear()}disposeCompressedElements(e,t,i,s){i.elementDisposables.clear()}disposeTemplate(e){e.disposables.dispose()}renderFolderDetails(e,t){const i=e.recursiveMatchCount();t.badge.setCount(i),t.badge.setTitleFormat(i>1?R.NC("searchFileMatches","{0} files found",i):R.NC("searchFileMatch","{0} file found",i)),t.actions.context={viewer:this.searchView.getControl(),element:e}}};js=(0,o.g)([(0,o.f)(2,ce.ec),(0,o.f)(3,W.e),(0,o.f)(4,A.TG),(0,o.f)(5,z.i6)],js);let Ys=class e extends l.JT{static{this.TEMPLATE_ID="fileMatch"}constructor(t,i,s,r,o,n){super(),this.searchView=t,this.labels=i,this.contextService=s,this.configurationService=r,this.instantiationService=o,this.contextKeyService=n,this.templateId=e.TEMPLATE_ID}renderCompressedElements(e,t,i,s){throw new Error("Should never happen since node is incompressible.")}renderTemplate(e){const t=new l.SL,i=new l.SL;t.add(i);const s=Ae.R3(e,Ae.$(".filematch")),r=this.labels.create(s);t.add(r);const o=new vs.Z(Ae.R3(s,Ae.$(".badge")),{},Gi.ku),n=Ae.R3(s,Ae.$(".actionBarContainer")),a=t.add(this.contextKeyService.createScoped(e));Vs.bindTo(a).set(!1),Ds.bindTo(a).set(!0),Bs.bindTo(a).set(!1);const c=this.instantiationService.createChild(new Qi.y([z.i6,a]));return{el:s,label:r,badge:o,actions:t.add(c.createInstance(ys.r,n,Xe.eH.SearchActionMenu,{menuOptions:{shouldForwardArgs:!0},hiddenItemStrategy:0,toolbarOptions:{primaryGroup:e=>/^inline/.test(e)}})),disposables:t,elementDisposables:i,contextKeyService:a}}renderElement(e,t,i){const s=e.element;i.el.setAttribute("data-resource",s.resource.toString());const r=this.configurationService.getValue("search").decorations;i.label.setFile(s.resource,{hidePath:this.searchView.isTreeLayoutViewVisible&&!(s.parent()instanceof E.uN),hideIcon:!1,fileDecorations:{colors:r.colors,badges:r.badges}});const o=s.count();i.badge.setCount(o),i.badge.setTitleFormat(o>1?R.NC("searchMatches","{0} matches found",o):R.NC("searchMatch","{0} match found",o)),i.actions.context={viewer:this.searchView.getControl(),element:s},Hs.bindTo(i.contextKeyService).set(!s.hasOnlyReadOnlyMatches()),i.elementDisposables.add(s.onChange((()=>{Hs.bindTo(i.contextKeyService).set(!s.hasOnlyReadOnlyMatches())})));const n=i.el.parentElement?.parentElement?.querySelector(".monaco-tl-twistie");n?.classList.add("force-twistie")}disposeElement(e,t,i){i.elementDisposables.clear()}disposeTemplate(e){e.disposables.dispose()}};Ys=(0,o.g)([(0,o.f)(2,ce.ec),(0,o.f)(3,fe.Ui),(0,o.f)(4,A.TG),(0,o.f)(5,z.i6)],Ys);let Xs=class e extends l.JT{static{this.TEMPLATE_ID="match"}constructor(t,i,s,r,o,n){super(),this.searchModel=t,this.searchView=i,this.contextService=s,this.configurationService=r,this.instantiationService=o,this.contextKeyService=n,this.templateId=e.TEMPLATE_ID}renderCompressedElements(e,t,i,s){throw new Error("Should never happen since node is incompressible.")}renderTemplate(e){e.classList.add("linematch");const t=Ae.R3(e,Ae.$("a.plain.match")),i=Ae.R3(t,Ae.$("span")),s=Ae.R3(t,Ae.$("span.findInFileMatch")),r=Ae.R3(t,Ae.$("span.replaceMatch")),o=Ae.R3(t,Ae.$("span")),n=Ae.R3(e,Ae.$("span.matchLineNum")),a=Ae.R3(e,Ae.$("span.actionBarContainer")),c=new l.SL,h=c.add(this.contextKeyService.createScoped(e));Vs.bindTo(h).set(!0),Ds.bindTo(h).set(!1),Bs.bindTo(h).set(!1);const d=this.instantiationService.createChild(new Qi.y([z.i6,h]));return{parent:t,before:i,match:s,replace:r,after:o,lineNumber:n,actions:c.add(d.createInstance(ys.r,a,Xe.eH.SearchActionMenu,{menuOptions:{shouldForwardArgs:!0},hiddenItemStrategy:0,toolbarOptions:{primaryGroup:e=>/^inline/.test(e)}})),disposables:c,contextKeyService:h}}renderElement(e,t,i){const s=e.element,r=s.preview(),o=this.searchModel.isReplaceActive()&&!!this.searchModel.replaceString&&!(s instanceof E.YT&&s.isWebviewMatch());i.before.textContent=r.before,i.match.textContent=r.inside,i.match.classList.toggle("replace",o),i.replace.textContent=o?s.replaceString:"",i.after.textContent=r.after,i.parent.title=(r.before+(o?s.replaceString:r.inside)+r.after).trim().substr(0,999),Hs.bindTo(i.contextKeyService).set(!(s instanceof E.YT&&s.isWebviewMatch()));const n=s.range().endLineNumber-s.range().startLineNumber,a=n>0?`+${n}`:"",c=this.configurationService.getValue("search").showLineNumbers,l=c?`:${s.range().startLineNumber}`:"";i.lineNumber.classList.toggle("show",n>0||c),i.lineNumber.textContent=l+a,i.lineNumber.setAttribute("title",this.getMatchTitle(s,c)),i.actions.context={viewer:this.searchView.getControl(),element:s}}disposeTemplate(e){e.disposables.dispose()}getMatchTitle(e,t){const i=e.range().startLineNumber,s=e.range().endLineNumber-e.range().startLineNumber;return(t?R.NC("lineNumStr","From line {0}",i,s)+" ":"")+(s>0?"+ "+R.NC("numLinesStr","{0} more lines",s):"")}};Xs=(0,o.g)([(0,o.f)(2,ce.ec),(0,o.f)(3,fe.Ui),(0,o.f)(4,A.TG),(0,o.f)(5,z.i6)],Xs);let Js=class{constructor(e,t){this.searchModel=e,this.labelService=t}getWidgetAriaLabel(){return R.NC("search","Search")}getAriaLabel(e){if(e instanceof E.nA){const t=e.allDownstreamFileMatches().reduce(((e,t)=>e+t.count()),0);return e.resource?R.NC("folderMatchAriaLabel","{0} matches in folder root {1}, Search result",t,e.name()):R.NC("otherFilesAriaLabel","{0} matches outside of the workspace, Search result",t)}if(e instanceof E.ut){const t=this.labelService.getUriLabel(e.resource,{relative:!0})||e.resource.fsPath;return R.NC("fileMatchAriaLabel","{0} matches in file {1} of folder {2}, Search result",e.count(),e.name(),Ss.XX(t))}if(e instanceof E.qE){const t=e,i=this.searchModel,s=i.isReplaceActive()&&!!i.replaceString,r=t.getMatchString(),o=t.range(),n=t.text().substr(0,o.endColumn+150);return s?R.NC("replacePreviewResultAria","'{0}' at column {1} replace {2} with {3}",n,o.startColumn,r,t.replaceString):R.NC("searchResultAria","'{0}' at column {1} found {2}",n,o.startColumn,r)}return null}};Js=(0,o.g)([(0,o.f)(1,W.e)],Js);var Zs=i(90317),er=i(32052),tr=i(90573),ir=i(74741),sr=i(49989);const rr=new z.uy("inSearchEditor",!1),or="search-editor",nr="search/editor",ar="searchEditorFindMatch",cr="workbench.editor.searchEditor",lr="search.action.openEditor",hr="toggleSearchEditorContextLines",dr="workbench.editorinputs.searchEditorInput";class ur extends l.JT{get markupInput(){return this._markupInput}set markupInput(e){this._markupInput!==e&&(this._markupInput=e,this._onDidChange.fire({markupInput:e}))}get markupPreview(){return this._markupPreview}set markupPreview(e){this._markupPreview!==e&&(this._markupPreview=e,this._onDidChange.fire({markupPreview:e}))}get codeInput(){return this._codeInput}set codeInput(e){this._codeInput!==e&&(this._codeInput=e,this._onDidChange.fire({codeInput:e}))}get codeOutput(){return this._codeOutput}set codeOutput(e){this._codeOutput!==e&&(this._codeOutput=e,this._onDidChange.fire({codeOutput:e}))}constructor(e,t,i,s){super(),this._onDidChange=this._register(new Ft.Q5),this.onDidChange=this._onDidChange.event,this._markupInput=!0,this._markupPreview=!0,this._codeInput=!0,this._codeOutput=!0,this._markupInput=e,this._markupPreview=t,this._codeInput=i,this._codeOutput=s,this._initialMarkupInput=e,this._initialMarkupPreview=t,this._initialCodeInput=i,this._initialCodeOutput=s}isModified(){return this._markupInput!==this._initialMarkupInput||this._markupPreview!==this._initialMarkupPreview||this._codeInput!==this._initialCodeInput||this._codeOutput!==this._initialCodeOutput}update(e){this._markupInput=e.markupInput,this._markupPreview=e.markupPreview,this._codeInput=e.codeInput,this._codeOutput=e.codeOutput}}var gr=i(78815);(0,te.Z)(".monaco-workbench .simple-fr-find-part-wrapper{background-color:var(--vscode-editorWidget-background)!important;border-bottom-left-radius:4px;border-bottom-right-radius:4px;box-shadow:0 0 8px 2px var(--vscode-widget-shadow);color:var(--vscode-editorWidget-foreground);max-width:calc(100% - 64px);overflow:hidden;padding:0 var(--notebook-find-horizontal-padding);position:absolute;right:18px;top:-45px;transition:top .2s linear;visibility:hidden;width:var(--notebook-find-width);z-index:10}.monaco-workbench.reduce-motion .simple-fr-find-part-wrapper{transition:top 0ms linear}.monaco-workbench .notebookOverlay .simple-fr-find-part-wrapper.visible{z-index:100}.monaco-workbench .simple-fr-find-part,.monaco-workbench .simple-fr-replace-part{align-items:center;display:flex;margin:0 0 0 17px;padding:4px;pointer-events:all;position:relative;top:0;z-index:10}.monaco-workbench .simple-fr-find-part-wrapper .find-replace-progress{height:2px;position:absolute;width:100%}.monaco-workbench .simple-fr-find-part-wrapper .find-replace-progress .monaco-progress-container{height:2px;top:0!important;z-index:100!important}.monaco-workbench .simple-fr-find-part-wrapper .find-replace-progress .monaco-progress-container .progress-bit{height:2px}.monaco-workbench .simple-fr-find-part-wrapper .monaco-findInput{width:224px}.monaco-workbench .simple-fr-find-part-wrapper .button{align-items:center;background-position:50%;background-repeat:no-repeat;cursor:pointer;display:flex;flex:initial;height:20px;justify-content:center;margin-left:3px;width:20px}.monaco-workbench .simple-fr-find-part-wrapper.visible .simple-fr-find-part{visibility:visible}.monaco-workbench .simple-fr-find-part-wrapper .toggle{align-items:center;box-sizing:border-box;display:flex;height:100%;justify-content:center;margin-left:0;pointer-events:all;position:absolute;top:0;width:18px}.monaco-workbench .simple-fr-find-part-wrapper.visible{visibility:visible}.monaco-workbench .simple-fr-find-part-wrapper.visible-transition{top:0}.monaco-workbench .simple-fr-find-part .monaco-findInput{flex:1}.monaco-workbench .simple-fr-find-part .button{background-position:50%;background-repeat:no-repeat;cursor:pointer;display:flex;flex:initial;height:20px;margin-left:3px;min-width:20px;width:20px}.monaco-workbench .simple-fr-find-part-wrapper .button.disabled{cursor:default;opacity:.3}.monaco-workbench .simple-fr-find-part-wrapper .monaco-custom-toggle.disabled{background-color:inherit!important;cursor:default;opacity:.3;pointer-events:none;user-select:none;-webkit-user-select:none}.monaco-workbench .simple-fr-find-part-wrapper .find-filter-button{box-sizing:border-box;color:inherit;cursor:pointer;float:left;margin-left:2px;user-select:none;-webkit-user-select:none}.find-filter-button .monaco-action-bar .action-label{padding:0}.monaco-workbench .simple-fr-find-part .monaco-inputbox>.ibwrapper>.input,.monaco-workbench .simple-fr-replace-part .monaco-inputbox>.ibwrapper>.input{height:24px}.monaco-workbench .simple-fr-find-part-wrapper .monaco-sash{background-color:var(--vscode-editorWidget-resizeBorder,var(--vscode-editorWidget-border));left:0!important}",{});var pr=i(98324),fr=i(52433);(0,At.q5)("find-filter",vt.lA.filter,R.NC("findFilterIcon","Icon for Find Filter in find widget."));const mr=R.NC("notebook.find.filter.filterAction","Find Filters"),vr=R.NC("notebook.find.filter.findInMarkupInput","Markdown Source"),Sr=R.NC("notebook.find.filter.findInMarkupPreview","Rendered Markdown"),yr=R.NC("notebook.find.filter.findInCodeInput","Code Cell Source"),wr=R.NC("notebook.find.filter.findInCodeOutput","Code Cell Output");let Cr=class extends pr.C{constructor(e,t,i,s){super(t,{getActions:()=>this.getActions()},s,{actionRunner:i,classNames:t.class,anchorAlignmentProvider:()=>1}),this.filters=e}render(e){super.render(e),this.updateChecked()}getActions(){const e={checked:this.filters.markupInput,class:void 0,enabled:!0,id:"findInMarkdownInput",label:vr,run:async()=>{this.filters.markupInput=!this.filters.markupInput},tooltip:""},t={checked:this.filters.markupPreview,class:void 0,enabled:!0,id:"findInMarkdownInput",label:Sr,run:async()=>{this.filters.markupPreview=!this.filters.markupPreview},tooltip:""},i={checked:this.filters.codeInput,class:void 0,enabled:!0,id:"findInCodeInput",label:yr,run:async()=>{this.filters.codeInput=!this.filters.codeInput},tooltip:""},s={checked:this.filters.codeOutput,class:void 0,enabled:!0,id:"findInCodeOutput",label:wr,run:async()=>{this.filters.codeOutput=!this.filters.codeOutput},tooltip:"",dispose:()=>null};return U.G6?[e,i]:[e,t,new ir.Z0,i,s]}updateChecked(){this.element.classList.toggle("checked",this._action.checked)}};Cr=(0,o.g)([(0,o.f)(3,Ze.i)],Cr);class br extends l.JT{constructor(e,t,i,s,r=mr){super(),this.filters=e,this.contextMenuService=t,this.instantiationService=i,this._actionbar=null,this._toggleStyles=s.toggleStyles,this._filtersAction=new ir.aU("notebookFindFilterAction",r,"notebook-filters "+St.kS.asClassName(fr.QR)),this._filtersAction.checked=!1,this._filterButtonContainer=Ae.$(".find-filter-button"),this._filterButtonContainer.classList.add("monaco-custom-toggle"),this.createFilters(this._filterButtonContainer)}get container(){return this._filterButtonContainer}get width(){return 22}applyStyles(e){const t=this._toggleStyles;this._filterButtonContainer.style.border="1px solid transparent",this._filterButtonContainer.style.borderRadius="3px",this._filterButtonContainer.style.borderColor=e&&t.inputActiveOptionBorder||"",this._filterButtonContainer.style.color=e&&t.inputActiveOptionForeground||"inherit",this._filterButtonContainer.style.backgroundColor=e&&t.inputActiveOptionBackground||""}createFilters(e){this._actionbar=this._register(new Zs.o(e,{actionViewItemProvider:e=>{if(e.id===this._filtersAction.id)return this.instantiationService.createInstance(Cr,this.filters,e,new ir.Wi)}})),this._actionbar.push(this._filtersAction,{icon:!0,label:!1})}}(0,st.Ic)(((e,t)=>{t.addRule("\n\t.notebook-editor {\n\t\t--notebook-find-width: 318px;\n\t\t--notebook-find-horizontal-padding: 4px;\n\t}\n\t")}));class xr extends ts.Yb{constructor(e,t,i,s,r,o,n,a){super(e,t,i,s),this.contextMenuService=r,this.instantiationService=o,this.filters=n,this._filterChecked=!1,this._visible=!1,this._findFilter=this._register(new br(n,r,o,i,R.NC("searchFindInputNotebookFilter.label","Notebook Find Filters"))),this.inputBox.paddingRight=(this.caseSensitive?.width()??0)+(this.wholeWords?.width()??0)+(this.regex?.width()??0)+this._findFilter.width,this.controls.appendChild(this._findFilter.container),this._findFilter.container.classList.add("monaco-custom-toggle"),this.filterVisible=a}set filterVisible(e){this._findFilter.container.style.display=e?"":"none",this._visible=e,this.updateStyles()}setEnabled(e){super.setEnabled(e),!e||this._filterChecked&&this._visible?this.regex?.disable():this.regex?.enable()}updateStyles(){this._filterChecked=!(this.filters.markupInput&&this.filters.markupPreview&&this.filters.codeInput&&this.filters.codeOutput),this._findFilter.applyStyles(this._filterChecked)}}class Er extends ir.aU{static{this.ID="search.action.replaceAll"}constructor(e){super(Er.ID,"",St.kS.asClassName(Gt),!1),this._searchWidget=e}set searchWidget(e){this._searchWidget=e}run(){return this._searchWidget?this._searchWidget.triggerReplaceAll():Promise.resolve(null)}}const kr=U.dz?256:2048;function Ir(e,t,i){const s=!!t.match(/\n/);i&&(s||i.clientHeight>26)&&i.selectionStart>0&&e.stopPropagation()}function Rr(e,t,i){const s=!!t.match(/\n/);i&&(s||i.clientHeight>26)&&i.selectionEnd<i.value.length&&e.stopPropagation()}let _r=class e extends $e.${static{this.INPUT_MAX_HEIGHT=134}static{this.REPLACE_ALL_DISABLED_LABEL=R.NC("search.action.replaceAll.disabled.label","Replace All (Submit Search to Enable)")}static{this.REPLACE_ALL_ENABLED_LABEL=e=>{const t=e.lookupKeybinding(Er.ID);return as(R.NC("search.action.replaceAll.enabled.label","Replace All"),t)}}constructor(e,t,i,s,r,o,n,c,l,h,d){super(),this.contextViewService=i,this.contextKeyService=s,this.keybindingService=r,this.clipboardServce=o,this.configurationService=n,this.accessibilityService=c,this.contextMenuService=l,this.instantiationService=h,this.editorService=d,this.ignoreGlobalFindBufferOnNextFocus=!1,this.previousGlobalFindBufferValue=null,this._onSearchSubmit=this._register(new Ft.Q5),this.onSearchSubmit=this._onSearchSubmit.event,this._onSearchCancel=this._register(new Ft.Q5),this.onSearchCancel=this._onSearchCancel.event,this._onReplaceToggled=this._register(new Ft.Q5),this.onReplaceToggled=this._onReplaceToggled.event,this._onReplaceStateChange=this._register(new Ft.Q5),this.onReplaceStateChange=this._onReplaceStateChange.event,this._onPreserveCaseChange=this._register(new Ft.Q5),this.onPreserveCaseChange=this._onPreserveCaseChange.event,this._onReplaceValueChanged=this._register(new Ft.Q5),this.onReplaceValueChanged=this._onReplaceValueChanged.event,this._onReplaceAll=this._register(new Ft.Q5),this.onReplaceAll=this._onReplaceAll.event,this._onBlur=this._register(new Ft.Q5),this.onBlur=this._onBlur.event,this._onDidHeightChange=this._register(new Ft.Q5),this.onDidHeightChange=this._onDidHeightChange.event,this._onDidToggleContext=new Ft.Q5,this.onDidToggleContext=this._onDidToggleContext.event,this.replaceActive=Ts.bindTo(this.contextKeyService),this.searchInputBoxFocused=_s.bindTo(this.contextKeyService),this.replaceInputBoxFocused=Fs.bindTo(this.contextKeyService);const u=t.notebookOptions??{isInNotebookMarkdownInput:!0,isInNotebookMarkdownPreview:!0,isInNotebookCellInput:!0,isInNotebookCellOutput:!0};this._notebookFilters=this._register(new ur(u.isInNotebookMarkdownInput,u.isInNotebookMarkdownPreview,u.isInNotebookCellInput,u.isInNotebookCellOutput)),this._register(this._notebookFilters.onDidChange((()=>{this.searchInput instanceof xr&&this.searchInput.updateStyles()}))),this._register(this.editorService.onDidEditorsChange((e=>{this.searchInput instanceof xr&&e.event.editor instanceof gr.h&&(3===e.event.kind||4===e.event.kind)&&(this.searchInput.filterVisible=this._hasNotebookOpen())}))),this._replaceHistoryDelayer=new a.vp(500),this.render(e,t),this.configurationService.onDidChangeConfiguration((e=>{e.affectsConfiguration("editor.accessibilitySupport")&&this.updateAccessibilitySupport()})),this.accessibilityService.onDidChangeScreenReaderOptimized((()=>this.updateAccessibilitySupport())),this.updateAccessibilitySupport()}_hasNotebookOpen(){return this.editorService.editors.some((e=>e instanceof gr.h))}getNotebookFilters(){return this._notebookFilters}focus(e=!0,t=!1,i=!1){this.ignoreGlobalFindBufferOnNextFocus=i,t&&this.isReplaceShown()?this.replaceInput&&(this.replaceInput.focus(),e&&this.replaceInput.select()):this.searchInput&&(this.searchInput.focus(),e&&this.searchInput.select())}setWidth(e){this.searchInput?.inputBox.layout(),this.replaceInput&&(this.replaceInput.width=e-28,this.replaceInput.inputBox.layout())}clear(){this.searchInput?.clear(),this.replaceInput?.setValue(""),this.setReplaceAllActionState(!1)}isReplaceShown(){return!!this.replaceContainer&&!this.replaceContainer.classList.contains("disabled")}isReplaceActive(){return!!this.replaceActive.get()}getReplaceValue(){return this.replaceInput?.getValue()??""}toggleReplace(e){void 0!==e&&e===this.isReplaceShown()||this.onToggleReplaceButton()}getSearchHistory(){return this.searchInput?.inputBox.getHistory()??[]}getReplaceHistory(){return this.replaceInput?.inputBox.getHistory()??[]}prependSearchHistory(e){this.searchInput?.inputBox.prependHistory(e)}prependReplaceHistory(e){this.replaceInput?.inputBox.prependHistory(e)}clearHistory(){this.searchInput?.inputBox.clearHistory(),this.replaceInput?.inputBox.clearHistory()}showNextSearchTerm(){this.searchInput?.inputBox.showNextValue()}showPreviousSearchTerm(){this.searchInput?.inputBox.showPreviousValue()}showNextReplaceTerm(){this.replaceInput?.inputBox.showNextValue()}showPreviousReplaceTerm(){this.replaceInput?.inputBox.showPreviousValue()}searchInputHasFocus(){return!!this.searchInputBoxFocused.get()}replaceInputHasFocus(){return!!this.replaceInput?.inputBox.hasFocus()}focusReplaceAllAction(){this.replaceActionBar?.focus(!0)}focusRegexAction(){this.searchInput?.focusOnRegex()}render(e,t){this.domNode=Ae.R3(e,Ae.$(".search-widget")),this.domNode.style.position="relative",t._hideReplaceToggle||this.renderToggleReplaceButton(this.domNode),this.renderSearchInput(this.domNode,t),this.renderReplaceInput(this.domNode,t)}updateAccessibilitySupport(){this.searchInput?.setFocusInputOnOptionClick(!this.accessibilityService.isScreenReaderOptimized())}renderToggleReplaceButton(e){this.toggleReplaceButton=this._register(new er.zx(e,{buttonBackground:void 0,buttonBorder:void 0,buttonForeground:void 0,buttonHoverBackground:void 0,buttonSecondaryBackground:void 0,buttonSecondaryForeground:void 0,buttonSecondaryHoverBackground:void 0,buttonSeparator:void 0})),this.toggleReplaceButton.element.setAttribute("aria-expanded","false"),this.toggleReplaceButton.element.classList.add("toggle-replace-button"),this.toggleReplaceButton.icon=Ut,this.toggleReplaceButton.onDidClick((()=>this.onToggleReplaceButton())),this.toggleReplaceButton.element.title=R.NC("search.replace.toggle.button.title","Toggle Replace")}renderSearchInput(t,i){const s={label:R.NC("label.Search","Search: Type Search Term and press Enter to search"),validation:e=>this.validateSearchInput(e),placeholder:R.NC("search.placeHolder","Search"),appendCaseSensitiveLabel:as("",this.keybindingService.lookupKeybinding(ws)),appendWholeWordsLabel:as("",this.keybindingService.lookupKeybinding(Cs)),appendRegexLabel:as("",this.keybindingService.lookupKeybinding(bs)),history:i.searchHistory,showHistoryHint:()=>(0,is.u)(this.keybindingService),flexibleHeight:!0,flexibleMaxHeight:e.INPUT_MAX_HEIGHT,showCommonFindToggles:!0,inputBoxStyles:i.inputBoxStyles,toggleStyles:i.toggleStyles},r=Ae.R3(t,Ae.$(".search-container.input-box"));this.searchInput=this._register(new xr(r,this.contextViewService,s,this.contextKeyService,this.contextMenuService,this.instantiationService,this._notebookFilters,this._hasNotebookOpen())),this.searchInput.onKeyDown((e=>this.onSearchInputKeyDown(e))),this.searchInput.setValue(i.value||""),this.searchInput.setRegex(!!i.isRegex),this.searchInput.setCaseSensitive(!!i.isCaseSensitive),this.searchInput.setWholeWords(!!i.isWholeWords),this._register(this.searchInput.onCaseSensitiveKeyDown((e=>this.onCaseSensitiveKeyDown(e)))),this._register(this.searchInput.onRegexKeyDown((e=>this.onRegexKeyDown(e)))),this._register(this.searchInput.inputBox.onDidChange((()=>this.onSearchInputChanged()))),this._register(this.searchInput.inputBox.onDidHeightChange((()=>this._onDidHeightChange.fire()))),this._register(this.onReplaceValueChanged((()=>{this._replaceHistoryDelayer.trigger((()=>this.replaceInput?.inputBox.addToHistory()))}))),this.searchInputFocusTracker=this._register(Ae.go(this.searchInput.inputBox.inputElement)),this._register(this.searchInputFocusTracker.onDidFocus((async()=>{this.searchInputBoxFocused.set(!0);const e=this.searchConfiguration.globalFindClipboard;if(!this.ignoreGlobalFindBufferOnNextFocus&&e){const e=await this.clipboardServce.readFindText();e&&this.previousGlobalFindBufferValue!==e&&(this.searchInput?.inputBox.addToHistory(),this.searchInput?.setValue(e),this.searchInput?.select()),this.previousGlobalFindBufferValue=e}this.ignoreGlobalFindBufferOnNextFocus=!1}))),this._register(this.searchInputFocusTracker.onDidBlur((()=>this.searchInputBoxFocused.set(!1)))),this.showContextToggle=new es.ZD({isChecked:!1,title:as(R.NC("showContext","Toggle Context Lines"),this.keybindingService.lookupKeybinding(hr)),icon:Qt,...Gi.pl}),this._register(this.showContextToggle.onChange((()=>this.onContextLinesChanged()))),i.showContextToggle&&(this.contextLinesInput=new tr.Wz(r,this.contextViewService,{type:"number",inputBoxStyles:Gi.Hc}),this.contextLinesInput.element.classList.add("context-lines-input"),this.contextLinesInput.value=""+(this.configurationService.getValue("search").searchEditor.defaultNumberOfContextLines??1),this._register(this.contextLinesInput.onDidChange((e=>{"0"!==e&&(this.showContextToggle.checked=!0),this.onContextLinesChanged()}))),Ae.R3(r,this.showContextToggle.domNode))}onContextLinesChanged(){this._onDidToggleContext.fire(),this.contextLinesInput.value.includes("-")&&(this.contextLinesInput.value="0"),this._onDidToggleContext.fire()}setContextLines(e){this.contextLinesInput&&(0===e?this.showContextToggle.checked=!1:(this.showContextToggle.checked=!0,this.contextLinesInput.value=""+e))}renderReplaceInput(t,i){this.replaceContainer=Ae.R3(t,Ae.$(".replace-container.disabled"));const s=Ae.R3(this.replaceContainer,Ae.$(".replace-input"));this.replaceInput=this._register(new ts.Nq(s,this.contextViewService,{label:R.NC("label.Replace","Replace: Type replace term and press Enter to preview"),placeholder:R.NC("search.replace.placeHolder","Replace"),appendPreserveCaseLabel:as("",this.keybindingService.lookupKeybinding(xs)),history:i.replaceHistory,showHistoryHint:()=>(0,is.u)(this.keybindingService),flexibleHeight:!0,flexibleMaxHeight:e.INPUT_MAX_HEIGHT,inputBoxStyles:i.inputBoxStyles,toggleStyles:i.toggleStyles},this.contextKeyService,!0)),this._register(this.replaceInput.onDidOptionChange((e=>{e||this.replaceInput&&this._onPreserveCaseChange.fire(this.replaceInput.getPreserveCase())}))),this.replaceInput.onKeyDown((e=>this.onReplaceInputKeyDown(e))),this.replaceInput.setValue(i.replaceValue||""),this._register(this.replaceInput.inputBox.onDidChange((()=>this._onReplaceValueChanged.fire()))),this._register(this.replaceInput.inputBox.onDidHeightChange((()=>this._onDidHeightChange.fire()))),this.replaceAllAction=new Er(this),this.replaceAllAction.label=e.REPLACE_ALL_DISABLED_LABEL,this.replaceActionBar=this._register(new Zs.o(this.replaceContainer)),this.replaceActionBar.push([this.replaceAllAction],{icon:!0,label:!1}),this.onkeydown(this.replaceActionBar.domNode,(e=>this.onReplaceActionbarKeyDown(e))),this.replaceInputFocusTracker=this._register(Ae.go(this.replaceInput.inputBox.inputElement)),this._register(this.replaceInputFocusTracker.onDidFocus((()=>this.replaceInputBoxFocused.set(!0)))),this._register(this.replaceInputFocusTracker.onDidBlur((()=>this.replaceInputBoxFocused.set(!1)))),this._register(this.replaceInput.onPreserveCaseKeyDown((e=>this.onPreserveCaseKeyDown(e))))}triggerReplaceAll(){return this._onReplaceAll.fire(),Promise.resolve(null)}onToggleReplaceButton(){this.replaceContainer?.classList.toggle("disabled"),this.isReplaceShown()?(this.toggleReplaceButton?.element.classList.remove(...St.kS.asClassNameArray(Ut)),this.toggleReplaceButton?.element.classList.add(...St.kS.asClassNameArray($t))):(this.toggleReplaceButton?.element.classList.remove(...St.kS.asClassNameArray($t)),this.toggleReplaceButton?.element.classList.add(...St.kS.asClassNameArray(Ut))),this.toggleReplaceButton?.element.setAttribute("aria-expanded",this.isReplaceShown()?"true":"false"),this.updateReplaceActiveState(),this._onReplaceToggled.fire()}setValue(e){this.searchInput?.setValue(e)}setReplaceAllActionState(t){this.replaceAllAction&&this.replaceAllAction.enabled!==t&&(this.replaceAllAction.enabled=t,this.replaceAllAction.label=t?e.REPLACE_ALL_ENABLED_LABEL(this.keybindingService):e.REPLACE_ALL_DISABLED_LABEL,this.updateReplaceActiveState())}updateReplaceActiveState(){const e=this.isReplaceActive(),t=this.isReplaceShown()&&!!this.replaceAllAction?.enabled;e!==t&&(this.replaceActive.set(t),this._onReplaceStateChange.fire(t),this.replaceInput?.inputBox.layout())}validateSearchInput(e){return 0===e.length||this.searchInput?.getRegex(),null}onSearchInputChanged(){if(this.searchInput?.clearMessage(),this.setReplaceAllActionState(!1),this.searchConfiguration.searchOnType)if(this.searchInput?.getRegex())try{const e=new RegExp(this.searchInput.getValue(),"ug"),t="\n\t\t\t\t\t\t\t\t~!@#$%^&*()_+\n\t\t\t\t\t\t\t\t`1234567890-=\n\t\t\t\t\t\t\t\tqwertyuiop[]\\\n\t\t\t\t\t\t\t\tQWERTYUIOP{}|\n\t\t\t\t\t\t\t\tasdfghjkl;'\n\t\t\t\t\t\t\t\tASDFGHJKL:\"\n\t\t\t\t\t\t\t\tzxcvbnm,./\n\t\t\t\t\t\t\t\tZXCVBNM<>? ".match(e)?.length??0,i=t<50?1:t<100?5:10;this.submitSearch(!0,this.searchConfiguration.searchOnTypeDebouncePeriod*i)}catch{}else this.submitSearch(!0,this.searchConfiguration.searchOnTypeDebouncePeriod)}onSearchInputKeyDown(e){e.equals(3|kr)&&(this.searchInput?.inputBox.insertAtCursor("\n"),e.preventDefault()),e.equals(3)?(this.searchInput?.onSearchSubmit(),this.submitSearch(),e.preventDefault()):e.equals(9)?(this._onSearchCancel.fire({focus:!0}),e.preventDefault()):e.equals(2)?(this.isReplaceShown()?this.replaceInput?.focus():this.searchInput?.focusOnCaseSensitive(),e.preventDefault()):e.equals(16)?Ir(e,this.searchInput?.getValue()??"",this.searchInput?.domNode.querySelector("textarea")??null):e.equals(18)&&Rr(e,this.searchInput?.getValue()??"",this.searchInput?.domNode.querySelector("textarea")??null)}onCaseSensitiveKeyDown(e){e.equals(1026)&&this.isReplaceShown()&&(this.replaceInput?.focus(),e.preventDefault())}onRegexKeyDown(e){e.equals(2)&&this.isReplaceShown()&&(this.replaceInput?.focusOnPreserve(),e.preventDefault())}onPreserveCaseKeyDown(e){e.equals(2)?(this.isReplaceActive()?this.focusReplaceAllAction():this._onBlur.fire(),e.preventDefault()):e.equals(1026)&&(this.focusRegexAction(),e.preventDefault())}onReplaceInputKeyDown(e){e.equals(3|kr)&&(this.replaceInput?.inputBox.insertAtCursor("\n"),e.preventDefault()),e.equals(3)?(this.submitSearch(),e.preventDefault()):e.equals(2)?(this.searchInput?.focusOnCaseSensitive(),e.preventDefault()):e.equals(1026)?(this.searchInput?.focus(),e.preventDefault()):e.equals(16)?Ir(e,this.replaceInput?.getValue()??"",this.replaceInput?.domNode.querySelector("textarea")??null):e.equals(18)&&Rr(e,this.replaceInput?.getValue()??"",this.replaceInput?.domNode.querySelector("textarea")??null)}onReplaceActionbarKeyDown(e){e.equals(1026)&&(this.focusRegexAction(),e.preventDefault())}async submitSearch(e=!1,t=0){if(this.searchInput?.validate(),!this.searchInput?.inputBox.isInputValid())return;const i=this.searchInput.getValue(),s=this.searchConfiguration.globalFindClipboard;i&&s&&await this.clipboardServce.writeFindText(i),this._onSearchSubmit.fire({triggeredOnType:e,delay:t})}getContextLines(){return this.showContextToggle.checked?+this.contextLinesInput.value:0}modifyContextLines(e){const t=+this.contextLinesInput.value+(e?1:-1);this.showContextToggle.checked=0!==t,this.contextLinesInput.value=""+t}toggleContextLines(){this.showContextToggle.checked=!this.showContextToggle.checked,this.onContextLinesChanged()}dispose(){this.setReplaceAllActionState(!1),super.dispose()}get searchConfiguration(){return this.configurationService.getValue("search")}};_r=(0,o.g)([(0,o.f)(2,Ze.u),(0,o.f)(3,z.i6),(0,o.f)(4,et.d),(0,o.f)(5,Je.p),(0,o.f)(6,fe.Ui),(0,o.f)(7,Vi.F7),(0,o.f)(8,Ze.i),(0,o.f)(9,A.TG),(0,o.f)(10,w.AR)],_r),(0,te.Z)(".search-editor{display:flex;flex-direction:column}.search-editor .search-results{flex:1}.search-editor .query-container{margin:0 12px 12px 19px;padding-top:6px}.search-editor .search-widget .toggle-replace-button{align-items:center;background-position:50%;background-repeat:no-repeat;box-sizing:border-box;cursor:pointer;display:flex;height:100%;justify-content:center;left:0;position:absolute;top:0;width:16px}.search-editor .search-widget .replace-container,.search-editor .search-widget .search-container{align-items:center;display:flex}.search-editor .search-widget .monaco-findInput{display:inline-block;vertical-align:middle;width:100%}.search-editor .search-widget .monaco-inputbox>.ibwrapper{height:100%}.search-editor .search-widget .monaco-inputbox>.ibwrapper>.mirror,.search-editor .search-widget .monaco-inputbox>.ibwrapper>textarea.input{padding:3px 3px 3px 6px}.search-editor .search-widget .monaco-inputbox>.ibwrapper>.mirror{max-height:134px}.search-editor .search-widget .monaco-inputbox>.ibwrapper>textarea.input{height:26px;overflow:initial}.search-editor .monaco-inputbox>.ibwrapper>textarea.input{scrollbar-width:none}.search-editor .monaco-inputbox>.ibwrapper>textarea.input::-webkit-scrollbar{display:none}.search-editor .search-widget .context-lines-input{margin-left:5px;margin-right:2px;max-width:50px}.search-editor .search-widget .context-lines-input input[type=number]::-webkit-inner-spin-button{-webkit-appearance:none!important}.search-editor .search-widget .replace-container{display:inline-flex;margin-top:6px;position:relative}.search-editor .search-widget .replace-input{display:flex;height:25px;position:relative;vertical-align:middle;width:auto!important}.search-editor .search-widget .replace-input>.controls{position:absolute;right:2px;top:3px}.search-editor .search-widget .replace-container.disabled{display:none}.search-editor .search-widget .replace-container .monaco-action-bar{height:25px;margin-left:0}.search-editor .search-widget .replace-container .monaco-action-bar .action-item .codicon{align-items:center;background-repeat:no-repeat;display:flex;height:25px;justify-content:center;margin-right:0;width:25px}.search-editor .includes-excludes{min-height:1em;position:relative}.search-editor .includes-excludes .expand{cursor:pointer;height:16px;position:absolute;right:-2px;width:25px;z-index:2}.search-editor .includes-excludes .file-types{display:none}.search-editor .includes-excludes.expanded .file-types{display:inherit}.search-editor .includes-excludes.expanded .file-types:last-child{padding-bottom:10px}.search-editor .includes-excludes.expanded h4{font-size:11px;font-weight:400;margin:0;overflow:hidden;padding:4px 0 0;text-overflow:ellipsis;white-space:nowrap}.search-editor .messages{cursor:default;margin-top:-5px}.search-editor .message{padding-left:7px;padding-right:22px;padding-top:0}.search-editor a.prominent{text-decoration:underline}.monaco-editor .searchEditorFindMatch{background-color:var(--vscode-searchEditor-findMatchBackground);border:1px solid var(--vscode-searchEditor-findMatchBorder);box-sizing:border-box}.monaco-editor.hc-black .searchEditorFindMatch,.monaco-editor.hc-light .searchEditorFindMatch{border:1px dotted var(--vscode-searchEditor-findMatchBorder)}",{});const Fr=e=>t=>new P.e(t.startLineNumber+e,t.startColumn,t.endLineNumber+e,t.endColumn),Ar=(e,t)=>{const i=e.fullPreviewLines(),s=[];return i.forEach(((r,o)=>{const n=(t=>`${e.range().startLineNumber+t}`)(o),a=`  ${" ".repeat(t-n.length)}${n}: `,c=a.length,l=a+(r.split(/\r?\n?$/,1)[0]||""),h=({start:e,end:t})=>new P.e(1,(e??1)+c,1,(t??r.length+1)+c),d=e.rangeInPreview();let u;u=d.startLineNumber===d.endLineNumber?h({start:d.startColumn,end:d.endColumn}):0===o?h({start:d.startColumn}):o===i.length-1?h({end:d.endColumn}):h({}),s.push({lineNumber:n,line:l,ranges:[u]})})),s};function Nr(e,t,i,s,r=!0){const o=t[t.length-1].range().endLineNumber.toString().length,n=r?[`${s(e)}:`]:[],a=[],c={},l=[];let h;i.forEach(((e,t)=>l.push({line:e,lineNumber:t}))),l.sort(((e,t)=>e.lineNumber-t.lineNumber));const d=new Set;for(t.forEach((e=>{Ar(e,o).forEach((e=>{if(!d.has(e.lineNumber)){for(;l.length&&l[0].lineNumber<+e.lineNumber;){const{line:e,lineNumber:t}=l.shift();void 0!==h&&t!==h+1&&n.push(""),n.push(`  ${" ".repeat(o-`${t}`.length)}${t}  ${e}`),h=t}c[e.lineNumber]=n.length,d.add(e.lineNumber),n.push(e.line),h=+e.lineNumber}a.push(...e.ranges.map(Fr(c[e.lineNumber])))}))}));l.length;){const{line:e,lineNumber:t}=l.shift();n.push(`  ${t}  ${e}`)}return{text:n,matchRanges:a}}const Tr=e=>{const t={query:"",filesToInclude:"",filesToExclude:"",isRegexp:!1,isCaseSensitive:!1,useExcludeSettingsAndIgnoreFiles:!0,matchWholeWord:!1,contextLines:0,showIncludesExcludes:!1,onlyOpenEditors:!1,notebookSearchConfig:{includeMarkupInput:!0,includeMarkupPreview:!1,includeCodeInput:!0,includeOutput:!0}},i=e=>{let t="";for(let i=0;i<e.length;i++)if("\\"===e[i]){i++;const s=e[i];if("n"===s)t+="\n";else{if("\\"!==s)throw Error((0,R.NC)("invalidQueryStringError","All backslashes in Query string must be escaped (\\\\)"));t+="\\"}}else t+=e[i];return t},s=/^# ([^:]*): (.*)$/;for(const r of e){const e=s.exec(r);if(!e)continue;const[,o,n]=e;switch(o){case"Query":t.query=i(n);break;case"Including":t.filesToInclude=n;break;case"Excluding":t.filesToExclude=n;break;case"ContextLines":t.contextLines=+n;break;case"Flags":t.isRegexp=-1!==n.indexOf("RegExp"),t.isCaseSensitive=-1!==n.indexOf("CaseSensitive"),t.useExcludeSettingsAndIgnoreFiles=-1===n.indexOf("IgnoreExcludeSettings"),t.matchWholeWord=-1!==n.indexOf("WordMatch"),t.onlyOpenEditors=-1!==n.indexOf("OpenEditors")}}return t.showIncludesExcludes=!(!t.filesToInclude&&!t.filesToExclude&&t.useExcludeSettingsAndIgnoreFiles),t},Mr=(e,t,i,s,r,o,a)=>{if(!e.query)throw Error("Internal Error: Expected query, got null");const c=((e,t,i,s)=>({query:e.contentPattern.pattern,isRegexp:!!e.contentPattern.isRegExp,isCaseSensitive:!!e.contentPattern.isCaseSensitive,matchWholeWord:!!e.contentPattern.isWordMatch,filesToExclude:i,filesToInclude:t,showIncludesExcludes:!!(t||i||e?.userDisabledExcludesAndIgnoreFiles),useExcludeSettingsAndIgnoreFiles:void 0===e?.userDisabledExcludesAndIgnoreFiles||!e.userDisabledExcludesAndIgnoreFiles,contextLines:s,onlyOpenEditors:!!e.onlyOpenEditors,notebookSearchConfig:{includeMarkupInput:!!e.contentPattern.notebookInfo?.isInNotebookMarkdownInput,includeMarkupPreview:!!e.contentPattern.notebookInfo?.isInNotebookMarkdownPreview,includeCodeInput:!!e.contentPattern.notebookInfo?.isInNotebookCellInput,includeOutput:!!e.contentPattern.notebookInfo?.isInNotebookCellOutput}}))(e.query,t,i,s),l=e.fileCount()>1?(0,R.NC)("numFiles","{0} files",e.fileCount()):(0,R.NC)("oneFile","1 file"),h=e.count()>1?(0,R.NC)("numResults","{0} results",e.count()):(0,R.NC)("oneResult","1 result"),d=[e.count()?`${h} - ${l}`:(0,R.NC)("noResults","No Results")];a&&d.push((0,R.NC)("searchMaxResultsWarning","The result set only contains a subset of all matches. Be more specific in your search to narrow down the results.")),d.push("");const u=(e,t)=>(0,E.ct)(e,t,o),g=Pr((0,n.xH)(e.folderMatches().sort(u).map((e=>e.allDownstreamFileMatches().sort(u).flatMap((e=>function(e,t){const i=e.textMatches().length>0?Nr(e.resource,e.textMatches().sort(E.ct),e.context,t):void 0,s=e.cellMatches().sort(((e,t)=>e.cellIndex-t.cellIndex)).sort().filter((e=>e.contentMatches.length>0)).map(((e,i)=>function(e,t,i){return Nr(e.cell.uri,e.contentMatches.sort(E.ct),e.context,t,i)}(e,t,0===i)));return[i,...s].filter((e=>!!e))}(e,r)))))));return{matchRanges:g.matchRanges.map(Fr(d.length)),text:d.concat(g.text).join("\n"),config:c}},Pr=e=>{const t=[],i=[];return e.forEach((e=>{e.matchRanges.map(Fr(t.length)).forEach((e=>i.push(e))),e.text.forEach((e=>t.push(e))),t.push("")})),{text:t,matchRanges:i}},Or=async(e,t)=>{const i=e.get(T.MM),s=(await i.read(t)).value;return Wr(s)},Wr=e=>{const t=[],i=[];let s=!0;for(const r of e.split(/\r?\n/g))s?(t.push(r),""===r&&(s=!1)):i.push(r);return{config:Tr(t),text:i.join("\n")}};var Lr=i(26827);class Dr{constructor(e){this.config=e,this._onConfigDidUpdate=new Ft.Q5,this.onConfigDidUpdate=this._onConfigDidUpdate.event}updateConfig(e){this.config=e,this._onConfigDidUpdate.fire(e)}}class Br{constructor(e){this.resource=e}async resolve(){return(0,g.cW)(qr.models.get(this.resource)).resolve()}}const qr=new class{constructor(){this.models=new h.Y9}initializeModelFromExistingModel(e,t,i){if(this.models.has(t))throw Error("Unable to contruct model for resource that already exists");const s=e.get(_.O),r=e.get(p.q),o=e.get(A.TG),n=e.get(Lr.n);let a;this.models.set(t,{resolve:()=>(a||(a=(async()=>await this.tryFetchModelFromBackupService(t,s,r,n,o)||Promise.resolve({resultsModel:r.getModel(t)??r.createModel("",s.createById("search-result"),t),configurationModel:new Dr(i)}))()),a)})}initializeModelFromRawData(e,t,i,s){if(this.models.has(t))throw Error("Unable to contruct model for resource that already exists");const r=e.get(_.O),o=e.get(p.q),n=e.get(A.TG),a=e.get(Lr.n);let c;this.models.set(t,{resolve:()=>(c||(c=(async()=>await this.tryFetchModelFromBackupService(t,r,o,a,n)||Promise.resolve({resultsModel:o.createModel(s??"",r.createById("search-result"),t),configurationModel:new Dr(i)}))()),c)})}initializeModelFromExistingFile(e,t,i){if(this.models.has(t))throw Error("Unable to contruct model for resource that already exists");const s=e.get(_.O),r=e.get(p.q),o=e.get(A.TG),n=e.get(Lr.n);let a;this.models.set(t,{resolve:async()=>(a||(a=(async()=>{const e=await this.tryFetchModelFromBackupService(t,s,r,n,o);if(e)return e;const{text:a,config:c}=await o.invokeFunction(Or,i);return{resultsModel:r.createModel(a??"",s.createById("search-result"),t),configurationModel:new Dr(c)}})()),a)})}async tryFetchModelFromBackupService(e,t,i,s,r){const o=await s.resolve({resource:e,typeId:nr});let n=i.getModel(e);if(!n&&o){const s=await(0,N.Yb)(o.value);n=i.createModel(s,t.createById("search-result"),e)}if(n){const s=n.getValue(),{text:r,config:o}=Wr(s);return i.destroyModel(e),{resultsModel:i.createModel(r??"",t.createById("search-result"),e),configurationModel:new Dr(o)}}}};var Hr=i(53060),Vr=i(27169);const Kr=".code-search";let Qr=class e extends Vr.Q{static{this.ID=dr}get typeId(){return e.ID}get editorId(){return this.typeId}get capabilities(){let e=8;return this.backingUri||(e|=4),e}get resource(){return this.backingUri||this.modelUri}constructor(t,i,s,r,o,n,a,c,l,h){if(super(),this.modelUri=t,this.backingUri=i,this.modelService=s,this.textFileService=r,this.fileDialogService=o,this.instantiationService=n,this.workingCopyService=a,this.telemetryService=c,this.pathService=l,this.dirty=!1,this._onDidChangeContent=this._register(new Ft.Q5),this.onDidChangeContent=this._onDidChangeContent.event,this._onDidSave=this._register(new Ft.Q5),this.onDidSave=this._onDidSave.event,this.oldDecorationsIDs=[],this.model=n.createInstance(Br,t),this.modelUri.scheme!==or)throw Error("SearchEditorInput must be invoked with a SearchEditorScheme uri");this.memento=new Ji.N(e.ID,h),h.onWillSaveState((()=>this.memento.saveMemento()));const d=this,u=new class{constructor(){this.typeId=nr,this.resource=d.modelUri,this.capabilities=d.hasCapability(4)?2:0,this.onDidChangeDirty=d.onDidChangeDirty,this.onDidChangeContent=d.onDidChangeContent,this.onDidSave=d.onDidSave}get name(){return d.getName()}isDirty(){return d.isDirty()}isModified(){return d.isDirty()}backup(e){return d.backup(e)}save(e){return d.save(0,e).then((e=>!!e))}revert(e){return d.revert(0,e)}};this._register(this.workingCopyService.registerWorkingCopy(u))}async save(e,t){if(!(await this.resolveModels()).resultsModel.isDisposed())return this.backingUri?(await this.textFileService.write(this.backingUri,await this.serializeForDisk(),t),this.setDirty(!1),this._onDidSave.fire({reason:t?.reason,source:t?.source}),this):this.saveAs(e,t)}tryReadConfigSync(){return this._cachedConfigurationModel?.config}async serializeForDisk(){const{configurationModel:e,resultsModel:t}=await this.resolveModels();return(s=[`# Query: ${r=(i=e.config).query??"",r.replace(/\\/g,"\\\\").replace(/\n/g,"\\n")}`,(i.isCaseSensitive||i.matchWholeWord||i.isRegexp||!1===i.useExcludeSettingsAndIgnoreFiles)&&`# Flags: ${(0,n.kX)([i.isCaseSensitive&&"CaseSensitive",i.matchWholeWord&&"WordMatch",i.isRegexp&&"RegExp",i.onlyOpenEditors&&"OpenEditors",!1===i.useExcludeSettingsAndIgnoreFiles&&"IgnoreExcludeSettings"]).join(" ")}`,i.filesToInclude?`# Including: ${i.filesToInclude}`:void 0,i.filesToExclude?`# Excluding: ${i.filesToExclude}`:void 0,i.contextLines?`# ContextLines: ${i.contextLines}`:void 0,""],s.filter((e=>!1!==e&&null!=e))).join("\n")+"\n"+t.getValue();var i,s,r}registerConfigChangeListeners(e){this.configChangeListenerDisposable?.dispose(),this.isDisposed()||(this.configChangeListenerDisposable=e.onConfigDidUpdate((()=>{this.lastLabel!==this.getName()&&(this._onDidChangeLabel.fire(),this.lastLabel=this.getName()),this.memento.getMemento(1,1).searchConfig=e.config})),this._register(this.configChangeListenerDisposable))}async resolveModels(){return this.model.resolve().then((e=>(this._cachedResultsModel=e.resultsModel,this._cachedConfigurationModel=e.configurationModel,this.lastLabel!==this.getName()&&(this._onDidChangeLabel.fire(),this.lastLabel=this.getName()),this.registerConfigChangeListeners(e.configurationModel),e)))}async saveAs(e,t){const i=await this.fileDialogService.pickFileToSave(await this.suggestFileName(),t?.availableFileSystems);if(i){this.telemetryService.publicLog2("searchEditor/saveSearchResults");const e=await this.serializeForDisk();if(await this.textFileService.create([{resource:i,value:e,options:{overwrite:!0}}])){if(this.setDirty(!1),!(0,L.Xy)(i,this.modelUri)){const e=this.instantiationService.invokeFunction(Ur,{fileUri:i,from:"existingFile"});return e.setMatchRanges(this.getMatchRanges()),e}return this}}}getName(e=12){if(this.backingUri){const e=y.zK.getOriginalUri(this);return(0,R.NC)("searchTitle.withQuery","Search: {0}",(0,Ss.EZ)((e??this.backingUri).path,Kr))}const t=this._cachedConfigurationModel?.config?.query?.trim();return t?(0,R.NC)("searchTitle.withQuery","Search: {0}",(t=>t.length<e?t:`${t.slice(0,e-3)}...`)(t)):(0,R.NC)("searchTitle","Search")}setDirty(e){const t=this.dirty;this.dirty=e,t!==e&&this._onDidChangeDirty.fire()}isDirty(){return this.dirty}async rename(e,t){if((0,L.DZ)(t)===Kr)return{editor:this.instantiationService.invokeFunction(Ur,{from:"existingFile",fileUri:t})}}dispose(){this.modelService.destroyModel(this.modelUri),super.dispose()}matches(t){return!!super.matches(t)||t instanceof e&&(!(!t.modelUri.fragment||t.modelUri.fragment!==this.modelUri.fragment)||!(!t.backingUri||!(0,L.Xy)(t.backingUri,this.backingUri)))}getMatchRanges(){return(this._cachedResultsModel?.getAllDecorations()??[]).filter((e=>e.options.className===ar)).filter((({range:e})=>!(1===e.startColumn&&1===e.endColumn))).map((({range:e})=>e))}async setMatchRanges(e){this.oldDecorationsIDs=(await this.resolveModels()).resultsModel.deltaDecorations(this.oldDecorationsIDs,e.map((e=>({range:e,options:{description:"search-editor-find-match",className:ar,stickiness:1}}))))}async revert(e,t){if(t?.soft)this.setDirty(!1);else{if(this.backingUri){const{config:e,text:t}=await this.instantiationService.invokeFunction(Or,this.backingUri),{resultsModel:i,configurationModel:s}=await this.resolveModels();i.setValue(t),s.updateConfig(e)}else(await this.resolveModels()).resultsModel.setValue("");super.revert(e,t),this.setDirty(!1)}}async backup(e){const t=await this.serializeForDisk();return e.isCancellationRequested?{}:{content:(0,Hr.Xu)(Hr.KN.fromString(t))}}async suggestFileName(){const e=((await this.resolveModels()).configurationModel.config.query.replace(/[^\w \-_]+/g,"_")||"Search")+Kr;return(0,L.Vo)(await this.fileDialogService.defaultFilePath(this.pathService.defaultUriScheme),e)}toUntyped(){if(!this.hasCapability(4))return{resource:this.resource,options:{override:e.ID}}}};Qr=(0,o.g)([(0,o.f)(2,p.q),(0,o.f)(3,T.MM),(0,o.f)(4,Mt.Z$),(0,o.f)(5,A.TG),(0,o.f)(6,pe.C),(0,o.f)(7,v.bU),(0,o.f)(8,he.a),(0,o.f)(9,it.Uy)],Qr);const Ur=(e,t)=>{const i=e.get(it.Uy),s=e.get(fe.Ui),r=e.get(A.TG),o="model"===t.from?t.modelUri:de.ov.from({scheme:or,fragment:`${Math.random()}`});if(!qr.models.has(o))if("existingFile"===t.from)r.invokeFunction((e=>qr.initializeModelFromExistingFile(e,o,t.fileUri)));else{const e=s.getValue("search").searchEditor,n=e.reusePriorSearchConfiguration,a=e.defaultNumberOfContextLines,c={query:"",filesToInclude:"",filesToExclude:"",isRegexp:!1,isCaseSensitive:!1,useExcludeSettingsAndIgnoreFiles:!0,matchWholeWord:!1,contextLines:0,showIncludesExcludes:!1,onlyOpenEditors:!1,notebookSearchConfig:{includeMarkupInput:!0,includeMarkupPreview:!1,includeCodeInput:!0,includeOutput:!0},...n?new Ji.N(Qr.ID,i).getMemento(1,1).searchConfig:{},...t.config};null!=a&&(c.contextLines=t?.config?.contextLines??a),"rawData"===t.from?(t.resultsContents&&(c.contextLines=0),r.invokeFunction((e=>qr.initializeModelFromRawData(e,o,c,t.resultsContents)))):r.invokeFunction((e=>qr.initializeModelFromExistingModel(e,o,c)))}return r.createInstance(Qr,o,"existingFile"===t.from?t.fileUri:"model"===t.from?t.backupOf:void 0)};var $r=i(44474),Gr=i(86456);const zr=(e,t)=>{const i=e.get(w.AR);i.activeEditor instanceof Qr&&i.activeEditorPane.modifyContextLines(t)},jr=async(e,t={},i=!1)=>{const s=e.get(w.AR),r=e.get(Gr.Qw),o=e.get(v.bU),n=e.get(A.TG),a=e.get(fe.Ui),c=e.get($r.qb),l=e.get(ce.ec),h=e.get(ye.CE).getLastActiveWorkspaceRoot(d.lg.file),u=h?(0,g.f6)(l.getWorkspaceFolder(h)):void 0,p=s.activeTextEditorControl;let f,m="";if(p){f=(0,Ct.QI)(p)?p.getOriginalEditor().hasTextFocus()?p.getOriginalEditor():p.getModifiedEditor():p;const e=f?.getSelection();if(m=(e&&f?.getModel()?.getValueInRange(e))??"",e?.isEmpty()&&a.getValue("search").seedWithNearestWord){const t=f.getModel()?.getWordAtPosition(e.getStartPosition());t&&(m=t.word)}}else s.activeEditor instanceof Qr&&(m=s.activeEditorPane.getSelected());o.publicLog2("searchEditor/openNewSearchEditor");const S={query:"new"===t.location||a.getValue("editor").find.seedSearchStringFromSelection?m:void 0};for(const e of Object.entries(t)){const t=e[0],i=e[1];void 0!==i&&(S[t]="string"==typeof i?await c.resolveAsync(u,i):i)}const y=s.getEditors(0).find((e=>e.editor.typeId===Qr.ID));let C;if(y&&"reuse"===S.location){const e=r.getGroup(y.groupId);if(!e)throw new Error("Invalid group id for search editor");const t=y.editor;C=await e.openEditor(t),m?C.setQuery(m):C.selectQuery(),C.setSearchConfig(S)}else{const e=n.invokeFunction(Ur,{config:S,resultsContents:"",from:"rawData"});C=await s.openEditor(e,{pinned:!0},i?w.O3:w.LP)}const b=a.getValue("search").searchOnType;(!0===S.triggerSearch||!1!==S.triggerSearch&&b&&S.query)&&C.triggerSearch({focusResults:S.focusResults}),S.focusResults||C.focusSearchInput()},Yr=async(e,t,i,s,r)=>{if(!t.query)return void console.error("Expected searchResult.query to be defined. Got",t);const o=e.get(w.AR),n=e.get(v.bU),a=e.get(A.TG),c=e.get(W.e),l=e.get(fe.Ui),h=l.getValue("search").sortOrder;n.publicLog2("searchEditor/createEditorFromSearchResult");const{text:d,matchRanges:u,config:g}=Mr(t,i,s,0,(e=>c.getUriLabel(e,{relative:!0})),h);g.onlyOpenEditors=r;const p=l.getValue("search").searchEditor.defaultNumberOfContextLines;if(t.isDirty||0===p||null===p){const e=a.invokeFunction(Ur,{resultsContents:d,config:g,from:"rawData"});await o.openEditor(e,{pinned:!0}),e.setMatchRanges(u)}else{const e=a.invokeFunction(Ur,{from:"rawData",resultsContents:"",config:{...g,contextLines:p}});(await o.openEditor(e,{pinned:!0})).triggerSearch({focusResults:!0})}};var Xr=i(46973),Jr=i(39078);const Zr=Ae.$,eo=R.NC("searchCanceled","Search was canceled before any results could be found - ");let to=class e extends Xi.qV{static{this.ACTIONS_RIGHT_CLASS_NAME="actions-right"}constructor(e,t,i,s,r,o,n,c,h,d,u,g,p,f,m,v,S,y,w,C,b,x,E,I,R,_,F,A){super(e,E,b,g,m,u,d,R,w,_),this.fileService=t,this.editorService=i,this.codeEditorService=s,this.progressService=r,this.notificationService=o,this.dialogService=n,this.commandService=c,this.contextViewService=h,this.contextService=p,this.searchWorkbenchService=f,this.replaceService=v,this.textFileService=S,this.preferencesService=y,this.searchHistoryService=C,this.accessibilityService=x,this.storageService=I,this.notebookService=F,this.logService=A,this.isDisposed=!1,this.lastFocusState="input",this.messageDisposables=new l.SL,this.changedWhileHidden=!1,this.currentSearchQ=Promise.resolve(),this.pauseSearching=!1,this._visibleMatches=0,this.container=Ae.$(".search-view"),this.viewletVisible=ks.bindTo(this.contextKeyService),this.firstMatchFocused=Ps.bindTo(this.contextKeyService),this.fileMatchOrMatchFocused=Os.bindTo(this.contextKeyService),this.fileMatchOrFolderMatchFocus=Ws.bindTo(this.contextKeyService),this.fileMatchOrFolderMatchWithResourceFocus=Ls.bindTo(this.contextKeyService),this.fileMatchFocused=Ds.bindTo(this.contextKeyService),this.folderMatchFocused=Bs.bindTo(this.contextKeyService),this.folderMatchWithResourceFocused=qs.bindTo(this.contextKeyService),this.hasSearchResultsKey=Ms.bindTo(this.contextKeyService),this.matchFocused=Vs.bindTo(this.contextKeyService),this.searchStateKey=ae.Y0.bindTo(this.contextKeyService),this.hasSearchPatternKey=Ks.bindTo(this.contextKeyService),this.hasReplacePatternKey=Qs.bindTo(this.contextKeyService),this.hasFilePatternKey=Us.bindTo(this.contextKeyService),this.hasSomeCollapsibleResultKey=$s.bindTo(this.contextKeyService),this.treeViewKey=Gs.bindTo(this.contextKeyService),this.contextKeyService=this._register(this.contextKeyService.createScoped(this.container)),Is.bindTo(this.contextKeyService).set(!0),this.inputBoxFocused=Rs.bindTo(this.contextKeyService),this.inputPatternIncludesFocused=As.bindTo(this.contextKeyService),this.inputPatternExclusionsFocused=Ns.bindTo(this.contextKeyService),this.isEditableItem=Hs.bindTo(this.contextKeyService),this.instantiationService=this.instantiationService.createChild(new Qi.y([z.i6,this.contextKeyService])),this.configurationService.onDidChangeConfiguration((e=>{e.affectsConfiguration("search.sortOrder")&&("modified"===this.searchConfig.sortOrder&&this.removeFileStats(),this.refreshTree())})),this.viewModel=this._register(this.searchWorkbenchService.searchModel),this.queryBuilder=this.instantiationService.createInstance(ne.z),this.memento=new Ji.N(this.id,I),this.viewletState=this.memento.getMemento(1,1),this._register(this.fileService.onDidFilesChange((e=>this.onFilesChanged(e)))),this._register(this.textFileService.untitled.onWillDispose((e=>this.onUntitledDidDispose(e.resource)))),this._register(this.contextService.onDidChangeWorkbenchState((()=>this.onDidChangeWorkbenchState()))),this._register(this.searchHistoryService.onDidClearHistory((()=>this.clearHistory()))),this._register(this.configurationService.onDidChangeConfiguration((e=>this.onConfigurationUpdated(e)))),this.delayedRefresh=this._register(new a.vp(250)),this.addToSearchHistoryDelayer=this._register(new a.vp(2e3)),this.toggleCollapseStateDelayer=this._register(new a.vp(100)),this.triggerQueryDelayer=this._register(new a.vp(0)),this.treeAccessibilityProvider=this.instantiationService.createInstance(Js,this.viewModel),this.isTreeLayoutViewVisible=this.viewletState["view.treeLayout"]??"tree"===this.searchConfig.defaultViewMode,this._refreshResultsScheduler=this._register(new a.pY(this._updateResults.bind(this),80)),this._register(this.storageService.onWillSaveState((()=>{this._saveSearchHistoryService()}))),this._register(this.storageService.onDidChangeValue((e=>{if(e.key===k.r.SEARCH_HISTORY_KEY){const e=this.searchHistoryService.load();e.include&&this.inputPatternIncludes.prependHistory(e.include),e.exclude&&this.inputPatternExcludes.prependHistory(e.exclude),e.search&&this.searchWidget.prependSearchHistory(e.search),e.replace&&this.searchWidget.prependReplaceHistory(e.replace)}})))}get isTreeLayoutViewVisible(){return this.treeViewKey.get()??!1}set isTreeLayoutViewVisible(e){this.treeViewKey.set(e)}setTreeView(e){e!==this.isTreeLayoutViewVisible&&(this.isTreeLayoutViewVisible=e,this.updateIndentStyles(this.themeService.getFileIconTheme()),this.refreshTree())}get state(){return this.searchStateKey.get()??ae.Ps.Idle}set state(e){this.searchStateKey.set(e)}getContainer(){return this.container}get searchResult(){return this.viewModel&&this.viewModel.searchResult}onDidChangeWorkbenchState(){1!==this.contextService.getWorkbenchState()&&this.searchWithoutFolderMessageElement&&Ae.Cp(this.searchWithoutFolderMessageElement)}renderBody(e){super.renderBody(e),this.container=Ae.R3(e,Ae.$(".search-view")),this.searchWidgetsContainerElement=Ae.R3(this.container,Zr(".search-widgets-container")),this.createSearchWidget(this.searchWidgetsContainerElement);const t=this.searchHistoryService.load(),i=this.viewletState["query.filePatterns"]||"",s=this.viewletState["query.folderExclusions"]||"",r=t.exclude||[],o=this.viewletState["query.folderIncludes"]||"",n=t.include||[],a=this.viewletState["query.onlyOpenEditors"]||!1,c=this.viewletState["query.queryDetailsExpanded"]||"",l="boolean"!=typeof this.viewletState["query.useExcludesAndIgnoreFiles"]||this.viewletState["query.useExcludesAndIgnoreFiles"];this.queryDetails=Ae.R3(this.searchWidgetsContainerElement,Zr(".query-details")),this.toggleQueryDetailsButton=Ae.R3(this.queryDetails,Zr(".more"+St.kS.asCSSSelector(Kt),{tabindex:0,role:"button",title:R.NC("moreSearch","Toggle Search Details")})),this._register(Ae.nm(this.toggleQueryDetailsButton,Ae.tw.CLICK,(e=>{Ae.zB.stop(e),this.toggleQueryDetails(!this.accessibilityService.isScreenReaderOptimized())}))),this._register(Ae.nm(this.toggleQueryDetailsButton,Ae.tw.KEY_UP,(e=>{const t=new oi.y1(e);(t.equals(3)||t.equals(10))&&(Ae.zB.stop(e),this.toggleQueryDetails(!1))}))),this._register(Ae.nm(this.toggleQueryDetailsButton,Ae.tw.KEY_DOWN,(e=>{new oi.y1(e).equals(1026)&&(this.searchWidget.isReplaceActive()?this.searchWidget.focusReplaceAllAction():this.searchWidget.isReplaceShown()?this.searchWidget.replaceInput?.focusOnPreserve():this.searchWidget.focusRegexAction(),Ae.zB.stop(e))})));const h=Ae.R3(this.queryDetails,Zr(".file-types.includes")),d=R.NC("searchScope.includes","files to include");Ae.R3(h,Zr("h4",void 0,d)),this.inputPatternIncludes=this._register(this.instantiationService.createInstance(rs,h,this.contextViewService,{ariaLabel:d,placeholder:R.NC("placeholder.includes","e.g. *.ts, src/**/include"),showPlaceholderOnFocus:!0,history:n,inputBoxStyles:Gi.Hc})),this.inputPatternIncludes.setValue(o),this.inputPatternIncludes.setOnlySearchInOpenEditors(a),this._register(this.inputPatternIncludes.onCancel((()=>this.cancelSearch(!1)))),this._register(this.inputPatternIncludes.onChangeSearchInEditorsBox((()=>this.triggerQueryChange()))),this.trackInputBox(this.inputPatternIncludes.inputFocusTracker,this.inputPatternIncludesFocused);const u=Ae.R3(this.queryDetails,Zr(".file-types.excludes")),g=R.NC("searchScope.excludes","files to exclude");Ae.R3(u,Zr("h4",void 0,g)),this.inputPatternExcludes=this._register(this.instantiationService.createInstance(os,u,this.contextViewService,{ariaLabel:g,placeholder:R.NC("placeholder.excludes","e.g. *.ts, src/**/exclude"),showPlaceholderOnFocus:!0,history:r,inputBoxStyles:Gi.Hc})),this.inputPatternExcludes.setValue(s),this.inputPatternExcludes.setUseExcludesAndIgnoreFiles(l),this._register(this.inputPatternExcludes.onCancel((()=>this.cancelSearch(!1)))),this._register(this.inputPatternExcludes.onChangeIgnoreBox((()=>this.triggerQueryChange()))),this.trackInputBox(this.inputPatternExcludes.inputFocusTracker,this.inputPatternExclusionsFocused);const p=()=>this.hasFilePatternKey.set(this.inputPatternIncludes.getValue().length>0||this.inputPatternExcludes.getValue().length>0);p();const f=e=>{this.triggerQueryChange({triggeredOnType:e,delay:this.searchConfig.searchOnTypeDebouncePeriod}),e&&p()};this._register(this.inputPatternIncludes.onSubmit(f)),this._register(this.inputPatternExcludes.onSubmit(f)),this.messagesElement=Ae.R3(this.container,Zr(".messages.text-search-provider-messages")),1===this.contextService.getWorkbenchState()&&this.showSearchWithoutFolderMessage(),this.createSearchResultsView(this.container),""===i&&""===s&&""===o&&""===c&&l||this.toggleQueryDetails(!0,!0,!0),this._register(this.viewModel.searchResult.onChange((e=>this.onSearchResultsChanged(e)))),this._register(this.onDidChangeBodyVisibility((e=>this.onVisibilityChanged(e)))),this.updateIndentStyles(this.themeService.getFileIconTheme()),this._register(this.themeService.onDidFileIconThemeChange(this.updateIndentStyles,this))}updateIndentStyles(e){this.resultsElement.classList.toggle("hide-arrows",this.isTreeLayoutViewVisible&&e.hidesExplorerArrows)}onVisibilityChanged(e){this.viewletVisible.set(e),e?this.changedWhileHidden&&(this.refreshAndUpdateCount(),this.changedWhileHidden=!1):this.lastFocusState="input",this.viewModel?.searchResult.toggleHighlights(e)}get searchAndReplaceWidget(){return this.searchWidget}get searchIncludePattern(){return this.inputPatternIncludes}get searchExcludePattern(){return this.inputPatternExcludes}createSearchWidget(e){const t=this.viewletState["query.contentPattern"]||"",i=this.viewletState["query.replaceText"]||"",s=!0===this.viewletState["query.regex"],r=!0===this.viewletState["query.wholeWords"],o=!0===this.viewletState["query.caseSensitive"],n=this.searchHistoryService.load(),a=n.search||this.viewletState["query.searchHistory"]||[],c=n.replace||this.viewletState["query.replaceHistory"]||[],l="boolean"!=typeof this.viewletState["view.showReplace"]||this.viewletState["view.showReplace"],h=!0===this.viewletState["query.preserveCase"],d=this.viewletState["query.isInNotebookMarkdownInput"]??!0,u=this.viewletState["query.isInNotebookMarkdownPreview"]??!0,g=this.viewletState["query.isInNotebookCellInput"]??!0,p=this.viewletState["query.isInNotebookCellOutput"]??!0;if(this.searchWidget=this._register(this.instantiationService.createInstance(_r,e,{value:t,replaceValue:i,isRegex:s,isCaseSensitive:o,isWholeWords:r,searchHistory:a,replaceHistory:c,preserveCase:h,inputBoxStyles:Gi.Hc,toggleStyles:Gi.pl,notebookOptions:{isInNotebookMarkdownInput:d,isInNotebookMarkdownPreview:u,isInNotebookCellInput:g,isInNotebookCellOutput:p}})),!this.searchWidget.searchInput||!this.searchWidget.replaceInput)return void this.logService.warn(`Cannot fully create search widget. Search or replace input undefined. SearchInput: ${this.searchWidget.searchInput}, ReplaceInput: ${this.searchWidget.replaceInput}`);l&&this.searchWidget.toggleReplace(!0),this._register(this.searchWidget.onSearchSubmit((e=>this.triggerQueryChange(e)))),this._register(this.searchWidget.onSearchCancel((({focus:e})=>this.cancelSearch(e)))),this._register(this.searchWidget.searchInput.onDidOptionChange((()=>this.triggerQueryChange()))),this._register(this.searchWidget.getNotebookFilters().onDidChange((()=>this.triggerQueryChange())));const f=()=>this.hasSearchPatternKey.set(!!this.searchWidget.searchInput&&this.searchWidget.searchInput.getValue().length>0);f(),this._register(this.searchWidget.searchInput.onDidChange((()=>f())));const m=()=>this.hasReplacePatternKey.set(this.searchWidget.getReplaceValue().length>0);m(),this._register(this.searchWidget.replaceInput.inputBox.onDidChange((()=>m()))),this._register(this.searchWidget.onDidHeightChange((()=>this.reLayout()))),this._register(this.searchWidget.onReplaceToggled((()=>this.reLayout()))),this._register(this.searchWidget.onReplaceStateChange((e=>{this.viewModel.replaceActive=e,this.refreshTree()}))),this._register(this.searchWidget.onPreserveCaseChange((e=>{this.viewModel.preserveCase=e,this.refreshTree()}))),this._register(this.searchWidget.onReplaceValueChanged((()=>{this.viewModel.replaceString=this.searchWidget.getReplaceValue(),this.delayedRefresh.trigger((()=>this.refreshTree()))}))),this._register(this.searchWidget.onBlur((()=>{this.toggleQueryDetailsButton.focus()}))),this._register(this.searchWidget.onReplaceAll((()=>this.replaceAll()))),this.trackInputBox(this.searchWidget.searchInputFocusTracker),this.trackInputBox(this.searchWidget.replaceInputFocusTracker)}onConfigurationUpdated(e){e&&(e.affectsConfiguration("search.decorations.colors")||e.affectsConfiguration("search.decorations.badges"))&&this.refreshTree()}trackInputBox(e,t){e&&(this._register(e.onDidFocus((()=>{this.lastFocusState="input",this.inputBoxFocused.set(!0),t?.set(!0)}))),this._register(e.onDidBlur((()=>{this.inputBoxFocused.set(this.searchWidget.searchInputHasFocus()||this.searchWidget.replaceInputHasFocus()||this.inputPatternIncludes.inputHasFocus()||this.inputPatternExcludes.inputHasFocus()),t?.set(!1)}))))}onSearchResultsChanged(e){if(this.isVisible())return this.refreshAndUpdateCount(e);this.changedWhileHidden=!0}refreshAndUpdateCount(e){return this.searchWidget.setReplaceAllActionState(!this.viewModel.searchResult.isEmpty()),this.updateSearchResultCount(this.viewModel.searchResult.query.userDisabledExcludesAndIgnoreFiles,this.viewModel.searchResult.query?.onlyOpenEditors,e?.clearingAll),this.refreshTree(e)}refreshTree(e){const t=this.searchConfig.collapseResults;!e||e.added||e.removed?"modified"===this.searchConfig.sortOrder?this.retrieveFileStats().then((()=>this.tree.setChildren(null,this.createResultIterator(t)))):this.tree.setChildren(null,this.createResultIterator(t)):"countAscending"===this.searchConfig.sortOrder||"countDescending"===this.searchConfig.sortOrder?this.tree.setChildren(null,this.createResultIterator(t)):e.elements.forEach((e=>{this.tree.setChildren(e,this.createIterator(e,t)),this.tree.rerender(e)}))}createResultIterator(e){const t=this.searchResult.folderMatches().filter((e=>!e.isEmpty())).sort(E.ct);return 1===t.length?this.createFolderIterator(t[0],e,!0):ci.$.map(t,(t=>({element:t,children:this.createFolderIterator(t,e,!0),incompressible:!0})))}createFolderIterator(e,t,i){const s=this.searchConfig.sortOrder,r=(this.isTreeLayoutViewVisible?e.matches():e.allDownstreamFileMatches()).sort(((e,t)=>(0,E.ct)(e,t,s)));return ci.$.map(r,(e=>{let s;s=e instanceof E.ut?this.createFileIterator(e):this.createFolderIterator(e,t,!1);const r="alwaysCollapse"===t||e.count()>10&&"alwaysExpand"!==t?ai.kn.PreserveOrCollapsed:ai.kn.PreserveOrExpanded;return{element:e,children:s,collapsed:r,incompressible:e instanceof E.ut||i}}))}createFileIterator(e){const t=e.matches().sort(E.ct);return ci.$.map(t,(e=>({element:e,incompressible:!0})))}createIterator(e,t){return e instanceof E.lt?this.createResultIterator(t):e instanceof E.nA?this.createFolderIterator(e,t,!1):this.createFileIterator(e)}replaceAll(){if(0===this.viewModel.searchResult.count())return;const e=this.viewModel.searchResult.count(),t=this.viewModel.searchResult.fileCount(),i=this.searchWidget.getReplaceValue()||"",s=this.buildAfterReplaceAllMessage(e,t,i);let r,o;this.progressService.withProgress({location:this.getProgressLocation(),delay:100,total:e},(e=>(o=e,new Promise((e=>r=e)))));const n={title:R.NC("replaceAll.confirmation.title","Replace All"),message:this.buildReplaceAllConfirmationMessage(e,t,i),primaryButton:R.NC({key:"replaceAll.confirm.button",comment:["&& denotes a mnemonic"]},"&&Replace")};this.dialogService.confirm(n).then((e=>{e.confirmed?(this.searchWidget.setReplaceAllActionState(!1),this.viewModel.searchResult.replaceAll(o).then((()=>{r();const e=this.clearMessage();Ae.R3(e,s),this.reLayout()}),(e=>{r(),c.n2(e),this.notificationService.error(e)}))):r()}))}buildAfterReplaceAllMessage(e,t,i){return 1===e?1===t?i?R.NC("replaceAll.occurrence.file.message","Replaced {0} occurrence across {1} file with '{2}'.",e,t,i):R.NC("removeAll.occurrence.file.message","Replaced {0} occurrence across {1} file.",e,t):i?R.NC("replaceAll.occurrence.files.message","Replaced {0} occurrence across {1} files with '{2}'.",e,t,i):R.NC("removeAll.occurrence.files.message","Replaced {0} occurrence across {1} files.",e,t):1===t?i?R.NC("replaceAll.occurrences.file.message","Replaced {0} occurrences across {1} file with '{2}'.",e,t,i):R.NC("removeAll.occurrences.file.message","Replaced {0} occurrences across {1} file.",e,t):i?R.NC("replaceAll.occurrences.files.message","Replaced {0} occurrences across {1} files with '{2}'.",e,t,i):R.NC("removeAll.occurrences.files.message","Replaced {0} occurrences across {1} files.",e,t)}buildReplaceAllConfirmationMessage(e,t,i){return 1===e?1===t?i?R.NC("removeAll.occurrence.file.confirmation.message","Replace {0} occurrence across {1} file with '{2}'?",e,t,i):R.NC("replaceAll.occurrence.file.confirmation.message","Replace {0} occurrence across {1} file?",e,t):i?R.NC("removeAll.occurrence.files.confirmation.message","Replace {0} occurrence across {1} files with '{2}'?",e,t,i):R.NC("replaceAll.occurrence.files.confirmation.message","Replace {0} occurrence across {1} files?",e,t):1===t?i?R.NC("removeAll.occurrences.file.confirmation.message","Replace {0} occurrences across {1} file with '{2}'?",e,t,i):R.NC("replaceAll.occurrences.file.confirmation.message","Replace {0} occurrences across {1} file?",e,t):i?R.NC("removeAll.occurrences.files.confirmation.message","Replace {0} occurrences across {1} files with '{2}'?",e,t,i):R.NC("replaceAll.occurrences.files.confirmation.message","Replace {0} occurrences across {1} files?",e,t)}clearMessage(){this.searchWithoutFolderMessageElement=void 0;const e="none"===this.messagesElement.style.display;Ae.PO(this.messagesElement),Ae.$Z(this.messagesElement),this.messageDisposables.clear();const t=Ae.R3(this.messagesElement,Zr(".message"));return e&&this.reLayout(),t}createSearchResultsView(e){this.resultsElement=Ae.R3(e,Zr(".results.show-file-icons.file-icon-themable-tree"));const t=this.instantiationService.createInstance(zs);this.treeLabels=this._register(this.instantiationService.createInstance(Yi.RX,{onDidChangeVisibility:this.onDidChangeBodyVisibility})),this.tree=this._register(this.instantiationService.createInstance(Ui.J6,"SearchView",this.resultsElement,t,[this._register(this.instantiationService.createInstance(js,this,this.treeLabels)),this._register(this.instantiationService.createInstance(Ys,this,this.treeLabels)),this._register(this.instantiationService.createInstance(Xs,this.viewModel,this))],{identityProvider:{getId:e=>e.id()},accessibilityProvider:this.treeAccessibilityProvider,dnd:this.instantiationService.createInstance(ji.vb,(e=>e instanceof E.ut?e.resource:e instanceof E.qE?(0,be.YO)(e.parent().resource,e.range()):null)),multipleSelectionSupport:!0,selectionNavigation:!0,overrideStyles:{listBackground:this.getBackgroundColor()},additionalScrollHeight:zs.ITEM_HEIGHT})),this._register(this.tree.onContextMenu((e=>this.onContextMenu(e))));const i=()=>this.toggleCollapseStateDelayer.trigger((()=>this.hasSomeCollapsibleResultKey.set(this.hasSomeCollapsible())));i(),this._register(this.viewModel.searchResult.onChange((()=>i()))),this._register(this.tree.onDidChangeCollapseState((()=>i()))),this._register(Ft.ju.debounce(this.tree.onDidOpen,((e,t)=>t),75,!0)((e=>{if(e.element instanceof E.qE){const t=e.element;this.currentSelectedFileMatch?.setSelectedMatch(null),this.currentSelectedFileMatch=t.parent(),this.currentSelectedFileMatch.setSelectedMatch(t),this.onFocus(t,e.editorOptions.preserveFocus,e.sideBySide,e.editorOptions.pinned)}}))),this._register(Ft.ju.debounce(this.tree.onDidChangeFocus,((e,t)=>t),75,!0)((()=>{const e=this.tree.getSelection(),t=this.tree.getFocus()[0];e.length>1&&t instanceof E.qE&&this.onFocus(t,!0)}))),this._register(Ft.ju.any(this.tree.onDidFocus,this.tree.onDidChangeFocus)((()=>{const e=this.tree.getFocus()[0];this.tree.isDOMFocused()&&(this.firstMatchFocused.set(this.tree.navigate().first()===e),this.fileMatchOrMatchFocused.set(!!e),this.fileMatchFocused.set(e instanceof E.ut),this.folderMatchFocused.set(e instanceof E.nA),this.matchFocused.set(e instanceof E.qE),this.fileMatchOrFolderMatchFocus.set(e instanceof E.ut||e instanceof E.nA),this.fileMatchOrFolderMatchWithResourceFocus.set(e instanceof E.ut||e instanceof E.eG),this.folderMatchWithResourceFocused.set(e instanceof E.eG),this.lastFocusState="tree");let t=!1;e instanceof E.YT?t=!e.isWebviewMatch():(e instanceof E.ut||e instanceof E.nA)&&(t=!e.hasOnlyReadOnlyMatches()),this.isEditableItem.set(t)}))),this._register(this.tree.onDidBlur((()=>{this.firstMatchFocused.reset(),this.fileMatchOrMatchFocused.reset(),this.fileMatchFocused.reset(),this.folderMatchFocused.reset(),this.matchFocused.reset(),this.fileMatchOrFolderMatchFocus.reset(),this.fileMatchOrFolderMatchWithResourceFocus.reset(),this.folderMatchWithResourceFocused.reset(),this.isEditableItem.reset()})))}onContextMenu(e){e.browserEvent.preventDefault(),e.browserEvent.stopPropagation(),this.contextMenuService.showContextMenu({menuId:Xe.eH.SearchContext,menuActionOptions:{shouldForwardArgs:!0},contextKeyService:this.contextKeyService,getAnchor:()=>e.anchor,getActionsContext:()=>e.element})}hasSomeCollapsible(){const e=this.getControl(),t=e.navigate();let i=t.first();do{if(!e.isCollapsed(i))return!0}while(i=t.next());return!1}selectNextMatch(){if(!this.hasSearchResults())return;const[e]=this.tree.getSelection();!e||e instanceof E.qE||this.tree.isCollapsed(e)&&this.tree.expand(e);const t=this.tree.navigate(e);let i=t.next();for(i||(i=t.first());i&&!(i instanceof E.qE);)this.tree.isCollapsed(i)&&this.tree.expand(i),i=t.next();if(i){i===e&&this.tree.setFocus([]);const t=(0,Ui.gN)(void 0,!1,!1);this.tree.setFocus([i],t),this.tree.setSelection([i],t),this.tree.reveal(i);const s=this.treeAccessibilityProvider.getAriaLabel(i);s&&ni.i7(s)}}selectPreviousMatch(){if(!this.hasSearchResults())return;const[e]=this.tree.getSelection();let t=this.tree.navigate(e),i=t.previous();for(;!i||!(i instanceof E.qE)&&!this.tree.isCollapsed(i);){const e=i?t.previous():t.last();if(!i&&!e)return;i=e}for(;!(i instanceof E.qE);){const e=t.next();this.tree.expand(i),t=this.tree.navigate(e),i=e?t.previous():t.last()}if(i){i===e&&this.tree.setFocus([]);const t=(0,Ui.gN)(void 0,!1,!1);this.tree.setFocus([i],t),this.tree.setSelection([i],t),this.tree.reveal(i);const s=this.treeAccessibilityProvider.getAriaLabel(i);s&&ni.i7(s)}}moveFocusToResults(){this.tree.domFocus()}focus(){if(super.focus(),"input"!==this.lastFocusState&&this.hasSearchResults())this.tree.domFocus();else{const e=!!this.searchConfig.seedOnFocus&&this.updateTextFromSelection({allowSearchOnType:!1});this.searchWidget.focus(void 0,void 0,e)}}updateTextFromFindWidgetOrSelection({allowUnselectedWord:e=!0,allowSearchOnType:t=!0}){let i=this.editorService.activeTextEditorControl;if((0,Ct.CL)(i)&&!i?.hasTextFocus()){const e=ct.get(i);if(e&&e.isFindInputFocused())return this.updateTextFromFindWidget(e,{allowSearchOnType:t});const s=this.codeEditorService.listCodeEditors();i=s.find((e=>e instanceof li.Hn&&e.getParentEditor()===i&&e.hasTextFocus()))??i}return this.updateTextFromSelection({allowUnselectedWord:e,allowSearchOnType:t},i)}updateTextFromFindWidget(e,{allowSearchOnType:t=!0}){if(!this.searchConfig.seedWithNearestWord&&""===(window.getSelection()?.toString()??""))return!1;const i=e.getState().searchString;return""!==i&&(this.searchWidget.searchInput?.setCaseSensitive(e.getState().matchCase),this.searchWidget.searchInput?.setWholeWords(e.getState().wholeWord),this.searchWidget.searchInput?.setRegex(e.getState().isRegex),this.updateText(i,t),!0)}updateTextFromSelection({allowUnselectedWord:e=!0,allowSearchOnType:t=!0},i){if(!this.configurationService.getValue("editor").find.seedSearchStringFromSelection)return!1;let s=this.getSearchTextFromEditor(e,i);return null!==s&&(this.searchWidget.searchInput?.getRegex()&&(s=Ee.ec(s)),this.updateText(s,t),!0)}updateText(e,t=!0){t&&!this.viewModel.searchResult.isDirty?this.searchWidget.setValue(e):(this.pauseSearching=!0,this.searchWidget.setValue(e),this.pauseSearching=!1)}focusNextInputBox(){if(this.searchWidget.searchInputHasFocus())this.searchWidget.isReplaceShown()?this.searchWidget.focus(!0,!0):this.moveFocusFromSearchOrReplace();else{if(!this.searchWidget.replaceInputHasFocus())return this.inputPatternIncludes.inputHasFocus()?(this.inputPatternExcludes.focus(),void this.inputPatternExcludes.select()):void(this.inputPatternExcludes.inputHasFocus()&&this.selectTreeIfNotSelected());this.moveFocusFromSearchOrReplace()}}moveFocusFromSearchOrReplace(){this.showsFileTypes()?this.toggleQueryDetails(!0,this.showsFileTypes()):this.selectTreeIfNotSelected()}focusPreviousInputBox(){if(!this.searchWidget.searchInputHasFocus())if(this.searchWidget.replaceInputHasFocus())this.searchWidget.focus(!0);else{if(!this.inputPatternIncludes.inputHasFocus())return this.inputPatternExcludes.inputHasFocus()?(this.inputPatternIncludes.focus(),void this.inputPatternIncludes.select()):void(this.tree.isDOMFocused()&&this.moveFocusFromResults());this.searchWidget.focus(!0,!0)}}moveFocusFromResults(){this.showsFileTypes()?this.toggleQueryDetails(!0,!0,!1,!0):this.searchWidget.focus(!0,!0)}reLayout(){if(this.isDisposed||!this.size)return;const t=this.searchConfig.actionsPosition;this.getContainer().classList.toggle(e.ACTIONS_RIGHT_CLASS_NAME,"right"===t),this.searchWidget.setWidth(this.size.width-28),this.inputPatternExcludes.setWidth(this.size.width-28),this.inputPatternIncludes.setWidth(this.size.width-28);const i=Ae.wn(this.searchWidgetsContainerElement),s=Ae.wn(this.messagesElement);this.tree.layout(this.size.height-i-s,this.size.width-28)}layoutBody(e,t){super.layoutBody(e,t),this.size=new Ae.Ro(t,e),this.reLayout()}getControl(){return this.tree}allSearchFieldsClear(){return""===this.searchWidget.getReplaceValue()&&(!this.searchWidget.searchInput||""===this.searchWidget.searchInput.getValue())}allFilePatternFieldsClear(){return""===this.searchExcludePattern.getValue()&&""===this.searchIncludePattern.getValue()}hasSearchResults(){return!this.viewModel.searchResult.isEmpty()}clearSearchResults(e=!0){this.viewModel.searchResult.clear(),this.showEmptyStage(!0),1===this.contextService.getWorkbenchState()&&this.showSearchWithoutFolderMessage(),e&&(this.allSearchFieldsClear()&&this.clearFilePatternFields(),this.searchWidget.clear()),this.viewModel.cancelSearch(),this.tree.ariaLabel=R.NC("emptySearch","Empty Search"),ni.i7(R.NC("ariaSearchResultsClearStatus","The search results have been cleared")),this.reLayout()}clearFilePatternFields(){this.searchExcludePattern.clear(),this.searchIncludePattern.clear()}cancelSearch(e=!0){return!!this.viewModel.cancelSearch()&&(e&&this.searchWidget.focus(),!0)}selectTreeIfNotSelected(){if(this.tree.getNode(null)&&(this.tree.domFocus(),0===this.tree.getSelection().length)){const e=(0,Ui.gN)();this.tree.focusNext(void 0,void 0,e),this.tree.setSelection(this.tree.getFocus(),e)}}getSearchTextFromEditor(e,t){if(Ae.jg(document.activeElement,this.getContainer()))return null;if(t=t??this.editorService.activeTextEditorControl,(0,Ct.QI)(t)&&(t=t.getOriginalEditor().hasTextFocus()?t.getOriginalEditor():t.getModifiedEditor()),!(0,Ct.CL)(t)||!t.hasModel())return null;const i=t.getSelection();if(!i)return null;if(i.isEmpty()&&this.searchConfig.seedWithNearestWord&&e){const e=t.getModel().getWordAtPosition(i.getStartPosition());if(e)return e.word}if(!i.isEmpty()){let e="";for(let s=i.startLineNumber;s<=i.endLineNumber;s++){let r=t.getModel().getLineContent(s);s===i.endLineNumber&&(r=r.substring(0,i.endColumn-1)),s===i.startLineNumber&&(r=r.substring(i.startColumn-1)),s!==i.startLineNumber&&(r="\n"+r),e+=r}return e}return null}showsFileTypes(){return this.queryDetails.classList.contains("more")}toggleCaseSensitive(){this.searchWidget.searchInput?.setCaseSensitive(!this.searchWidget.searchInput.getCaseSensitive()),this.triggerQueryChange()}toggleWholeWords(){this.searchWidget.searchInput?.setWholeWords(!this.searchWidget.searchInput.getWholeWords()),this.triggerQueryChange()}toggleRegex(){this.searchWidget.searchInput?.setRegex(!this.searchWidget.searchInput.getRegex()),this.triggerQueryChange()}togglePreserveCase(){this.searchWidget.replaceInput?.setPreserveCase(!this.searchWidget.replaceInput.getPreserveCase()),this.triggerQueryChange()}setSearchParameters(e={}){"boolean"==typeof e.isCaseSensitive&&this.searchWidget.searchInput?.setCaseSensitive(e.isCaseSensitive),"boolean"==typeof e.matchWholeWord&&this.searchWidget.searchInput?.setWholeWords(e.matchWholeWord),"boolean"==typeof e.isRegex&&this.searchWidget.searchInput?.setRegex(e.isRegex),"string"==typeof e.filesToInclude&&this.searchIncludePattern.setValue(String(e.filesToInclude)),"string"==typeof e.filesToExclude&&this.searchExcludePattern.setValue(String(e.filesToExclude)),"string"==typeof e.query&&this.searchWidget.searchInput?.setValue(e.query),"string"==typeof e.replace?this.searchWidget.replaceInput?.setValue(e.replace):this.searchWidget.replaceInput&&""!==this.searchWidget.replaceInput.getValue()&&this.searchWidget.replaceInput.setValue(""),"boolean"==typeof e.triggerSearch&&e.triggerSearch&&this.triggerQueryChange(),"boolean"==typeof e.preserveCase&&this.searchWidget.replaceInput?.setPreserveCase(e.preserveCase),"boolean"==typeof e.useExcludeSettingsAndIgnoreFiles&&this.inputPatternExcludes.setUseExcludesAndIgnoreFiles(e.useExcludeSettingsAndIgnoreFiles),"boolean"==typeof e.onlyOpenEditors&&this.searchIncludePattern.setOnlySearchInOpenEditors(e.onlyOpenEditors)}toggleQueryDetails(e=!0,t,i,s){const r="more";t=void 0===t?!this.queryDetails.classList.contains(r):Boolean(t),this.viewletState["query.queryDetailsExpanded"]=t,i=Boolean(i),t?(this.toggleQueryDetailsButton.setAttribute("aria-expanded","true"),this.queryDetails.classList.add(r),e&&(s?(this.inputPatternExcludes.focus(),this.inputPatternExcludes.select()):(this.inputPatternIncludes.focus(),this.inputPatternIncludes.select()))):(this.toggleQueryDetailsButton.setAttribute("aria-expanded","false"),this.queryDetails.classList.remove(r),e&&this.searchWidget.focus()),!i&&this.size&&this.reLayout()}searchInFolders(e=[]){this._searchWithIncludeOrExclude(!0,e)}searchOutsideOfFolders(e=[]){this._searchWithIncludeOrExclude(!1,e)}_searchWithIncludeOrExclude(e,t){if(!t.length||t.some((e=>"."===e)))return this.inputPatternIncludes.setValue(""),void this.searchWidget.focus();this.showsFileTypes()||this.toggleQueryDetails(!0,!0),(e?this.inputPatternIncludes:this.inputPatternExcludes).setValue(t.join(", ")),this.searchWidget.focus(!1)}triggerQueryChange(e){const t={preserveFocus:!0,triggeredOnType:!1,delay:0,...e};t.triggeredOnType&&!this.searchConfig.searchOnType||this.pauseSearching||this.triggerQueryDelayer.trigger((()=>{this._onQueryChanged(t.preserveFocus,t.triggeredOnType)}),t.delay)}_onQueryChanged(e,t=!1){if(!this.searchWidget.searchInput?.inputBox.isInputValid())return;const i=this.searchWidget.searchInput.getRegex(),s=this.searchWidget.getNotebookFilters().markupInput,r=this.searchWidget.getNotebookFilters().markupPreview,o=this.searchWidget.getNotebookFilters().codeInput,n=this.searchWidget.getNotebookFilters().codeOutput,a=this.searchWidget.searchInput.getWholeWords(),c=this.searchWidget.searchInput.getCaseSensitive(),l=this.searchWidget.searchInput.getValue(),h=this.inputPatternExcludes.getValue().trim(),d=this.inputPatternIncludes.getValue().trim(),u=this.inputPatternExcludes.useExcludesAndIgnoreFiles(),p=this.inputPatternIncludes.onlySearchInOpenEditors();if(0===l.length)return this.clearSearchResults(!1),void this.clearMessage();const f={pattern:l,isRegExp:i,isCaseSensitive:c,isWordMatch:a,notebookInfo:{isInNotebookMarkdownInput:s,isInNotebookMarkdownPreview:r,isInNotebookCellInput:o,isInNotebookCellOutput:n}},m=this.inputPatternExcludes.getValue(),v=this.inputPatternIncludes.getValue(),S=f.isRegExp?1e4:1e3,y={_reason:"searchView",extraFileResources:this.instantiationService.invokeFunction(ae.ek),maxResults:(0,g.f6)(this.searchConfig.maxResults),disregardIgnoreFiles:!u||void 0,disregardExcludeSettings:!u||void 0,onlyOpenEditors:p,excludePattern:m,includePattern:v,previewOptions:{matchLines:1,charsPerLine:S},isSmartCase:this.searchConfig.smartCase,expandPatterns:!0},w=this.contextService.getWorkspace().folders,C=e=>{this.searchWidget.searchInput?.showMessage({content:e.message,type:3}),this.viewModel.searchResult.clear()};let b;try{b=this.queryBuilder.text(f,w.map((e=>e.uri)),y)}catch(e){return void C(e)}this.validateQuery(b).then((()=>{this.onQueryTriggered(b,y,h,d,t),e||this.searchWidget.focus(!1,void 0,!0)}),C)}validateQuery(e){const t=e.folderQueries.map((e=>this.fileService.exists(e.folder).catch((()=>!1))));return Promise.all(t).then((t=>{const i=e.folderQueries.filter(((e,i)=>t[i]));if(e.folderQueries.length&&!i.length){const t=e.folderQueries[0].folder.fsPath,i=R.NC("searchPathNotFoundError","Search path not found: {0}",t);return Promise.reject(new Error(i))}e.folderQueries=i}))}onQueryTriggered(e,t,i,s,r){this.addToSearchHistoryDelayer.trigger((()=>{this.searchWidget.searchInput?.onSearchSubmit(),this.inputPatternExcludes.onSearchSubmit(),this.inputPatternIncludes.onSearchSubmit()})),this.viewModel.cancelSearch(!0),this.currentSearchQ=this.currentSearchQ.then((()=>this.doSearch(e,i,s,r))).then((()=>{}),(()=>{}))}_updateResults(){if(this.state!==ae.Ps.Idle)try{const e=this.viewModel.searchResult.fileCount();this._visibleMatches!==e&&(this._visibleMatches=e,this.refreshAndUpdateCount())}finally{this._refreshResultsScheduler.schedule()}}doSearch(e,t,i,s){let r;this.progressService.withProgress({location:this.getProgressLocation(),delay:s?300:0},(e=>new Promise((e=>r=e)))),this.searchWidget.searchInput?.clearMessage(),this.state=ae.Ps.Searching,this.showEmptyStage();const o=setTimeout((()=>{this.state=ae.Ps.SlowSearch}),2e3),n=e=>{if(clearTimeout(o),this.state=ae.Ps.Idle,r(),this.onSearchResultsChanged(),"alwaysCollapse"!==this.searchConfig.collapseResults&&1===this.viewModel.searchResult.matches().length){const e=this.viewModel.searchResult.matches()[0];e.count()<50&&this.tree.expand(e)}this.viewModel.replaceString=this.searchWidget.getReplaceValue();const s=!this.viewModel.searchResult.isEmpty();if(1!==e?.exit){if(s)this.viewModel.searchResult.toggleHighlights(this.isVisible()),ni.i7(R.NC("ariaSearchResultsStatus","Search returned {0} results in {1} files",this.viewModel.searchResult.count(),this.viewModel.searchResult.fileCount()));else{const s=!!t,r=!!i;let o;o=e?this.inputPatternIncludes.onlySearchInOpenEditors()?r&&s?R.NC("noOpenEditorResultsIncludesExcludes","No results found in open editors matching '{0}' excluding '{1}' - ",i,t):r?R.NC("noOpenEditorResultsIncludes","No results found in open editors matching '{0}' - ",i):s?R.NC("noOpenEditorResultsExcludes","No results found in open editors excluding '{0}' - ",t):R.NC("noOpenEditorResultsFound","No results found in open editors. Review your settings for configured exclusions and check your gitignore files - "):r&&s?R.NC("noResultsIncludesExcludes","No results found in '{0}' excluding '{1}' - ",i,t):r?R.NC("noResultsIncludes","No results found in '{0}' - ",i):s?R.NC("noResultsExcludes","No results found excluding '{0}' - ",t):R.NC("noResultsFound","No results found. Review your settings for configured exclusions and check your gitignore files - "):eo,ni.i7(o);const n=this.clearMessage();if(Ae.R3(n,o),e)if(r||s){const e=this.messageDisposables.add(new io(R.NC("rerunSearchInAll.message","Search again in all files"),this.onSearchAgain.bind(this)));Ae.R3(n,e.element)}else{const e=this.messageDisposables.add(new io(R.NC("openSettings.message","Open Settings"),this.onOpenSettings.bind(this)));Ae.R3(n,e.element)}else{const e=this.messageDisposables.add(new io(R.NC("rerunSearch.message","Search again"),(()=>this.triggerQueryChange({preserveFocus:!1}))));Ae.R3(n,e.element)}if(e){Ae.R3(n,Zr("span",void 0," - "));const e=this.messageDisposables.add(new io(R.NC("openSettings.learnMore","Learn More"),this.onLearnMore.bind(this)));Ae.R3(n,e.element)}1===this.contextService.getWorkbenchState()&&this.showSearchWithoutFolderMessage(),this.reLayout()}if(e&&e.limitHit&&e.messages.push({type:ps.a.Warning,text:R.NC("searchMaxResultsWarning","The result set only contains a subset of all matches. Be more specific in your search to narrow down the results.")}),e&&e.messages)for(const t of e.messages)this.addMessage(t);this.reLayout()}};return this._visibleMatches=0,this._refreshResultsScheduler.schedule(),this.searchWidget.setReplaceAllActionState(!1),this.tree.setSelection([]),this.tree.setFocus([]),this.viewModel.search(e).then(n,(e=>(clearTimeout(o),this.state=ae.Ps.Idle,c.n2(e)?n(void 0):(r(),this.searchWidget.searchInput?.showMessage({content:e.message,type:3}),this.viewModel.searchResult.clear(),Promise.resolve()))))}onOpenSettings(e){Ae.zB.stop(e,!1),this.openSettings("@id:files.exclude,search.exclude,search.useParentIgnoreFiles,search.useGlobalIgnoreFiles,search.useIgnoreFiles")}openSettings(e){const t={query:e};return 1!==this.contextService.getWorkbenchState()?this.preferencesService.openWorkspaceSettings(t):this.preferencesService.openUserSettings(t)}onLearnMore(){this.openerService.open(de.ov.parse("https://go.microsoft.com/fwlink/?linkid=853977"))}onSearchAgain(){this.inputPatternExcludes.setValue(""),this.inputPatternIncludes.setValue(""),this.inputPatternIncludes.setOnlySearchInOpenEditors(!1),this.triggerQueryChange({preserveFocus:!1})}onEnableExcludes(){this.toggleQueryDetails(!1,!0),this.searchExcludePattern.setUseExcludesAndIgnoreFiles(!0)}onDisableSearchInOpenEditors(){this.toggleQueryDetails(!1,!0),this.inputPatternIncludes.setOnlySearchInOpenEditors(!1)}updateSearchResultCount(e,t,i=!1){const s=this.viewModel.searchResult.fileCount();this.hasSearchResultsKey.set(s>0);const r="none"===this.messagesElement.style.display,o=this.clearMessage(),n=i?"":this.buildResultCountMessage(this.viewModel.searchResult.count(),s);if(this.tree.ariaLabel=n+R.NC("forTerm"," - Search: {0}",this.searchResult.query?.contentPattern.pattern??""),Ae.R3(o,n),s>0){if(e){const e=" - "+R.NC("useIgnoresAndExcludesDisabled","exclude settings and ignore files are disabled")+" ",t=this.messageDisposables.add(new io(R.NC("excludes.enable","enable"),this.onEnableExcludes.bind(this),R.NC("useExcludesAndIgnoreFilesDescription","Use Exclude Settings and Ignore Files")));Ae.R3(o,Zr("span",void 0,e,"(",t.element,")"))}if(t){const e=" - "+R.NC("onlyOpenEditors","searching only in open files")+" ",t=this.messageDisposables.add(new io(R.NC("openEditors.disable","disable"),this.onDisableSearchInOpenEditors.bind(this),R.NC("disableOpenEditors","Search in entire workspace")));Ae.R3(o,Zr("span",void 0,e,"(",t.element,")"))}Ae.R3(o," - ");const i=as(R.NC("openInEditor.tooltip","Copy current search results to an editor"),this.keybindingService.lookupKeybinding("search.action.openInEditor")),s=this.messageDisposables.add(new io(R.NC("openInEditor.message","Open in editor"),(()=>this.instantiationService.invokeFunction(Yr,this.searchResult,this.searchIncludePattern.getValue(),this.searchExcludePattern.getValue(),this.searchIncludePattern.onlySearchInOpenEditors())),i));Ae.R3(o,s.element),this.reLayout()}else r||Ae.Cp(this.messagesElement)}addMessage(e){const t=this.messagesElement.firstChild;t&&Ae.R3(t,ms(e,this.instantiationService,this.notificationService,this.openerService,this.commandService,this.messageDisposables,(()=>this.triggerQueryChange())))}buildResultCountMessage(e,t){return 1===e&&1===t?R.NC("search.file.result","{0} result in {1} file",e,t):1===e?R.NC("search.files.result","{0} result in {1} files",e,t):1===t?R.NC("search.file.results","{0} results in {1} file",e,t):R.NC("search.files.results","{0} results in {1} files",e,t)}showSearchWithoutFolderMessage(){this.searchWithoutFolderMessageElement=this.clearMessage();const e=Ae.R3(this.searchWithoutFolderMessageElement,Zr("p",void 0,R.NC("searchWithoutFolder","You have not opened or specified a folder. Only open files are currently searched - "))),t=this.messageDisposables.add(new io(R.NC("openFolder","Open Folder"),(()=>{this.commandService.executeCommand(U.dz&&U.tY?zi.zX.ID:zi.JW.ID).catch((e=>c.dL(e)))})));Ae.R3(e,t.element)}showEmptyStage(e=!1){((this.messagesElement.firstChild?.textContent?.indexOf(eo)??-1)>-1||e||!this.configurationService.getValue().search.searchOnType)&&Ae.Cp(this.messagesElement),Ae.$Z(this.resultsElement),this.currentSelectedFileMatch=void 0}shouldOpenInNotebookEditor(e,t){return e instanceof E.YT||t.scheme!==d.lg.untitled&&this.notebookService.getContributedNotebookTypes(t).length>0}onFocus(e,t,i,s){const r=this.configurationService.getValue().search.useReplacePreview,o=e instanceof E.qE?e.parent().resource:e.resource;return r&&this.viewModel.isReplaceActive()&&this.viewModel.replaceString&&!this.shouldOpenInNotebookEditor(e,o)?this.replaceService.openReplacePreview(e,t,i,s):this.open(e,t,i,s,o)}async open(e,t,i,s,r){const o=this.getSelectionFrom(e),n=e instanceof E.qE?e.parent().matches():[],a=r??(e instanceof E.qE?e.parent().resource:e.resource);let l;const h={preserveFocus:t,pinned:s,selection:o,revealIfVisible:!0,indexedCellOptions:e instanceof E.YT?{cellIndex:e.cellIndex,selection:e.range}:void 0};try{l=await this.editorService.openEditor({resource:a,options:h},i?w.O3:w.LP);const s=l?.getControl();e instanceof E.qE&&t&&(0,Ct.CL)(s)?this.viewModel.searchResult.rangeHighlightDecorations.highlightRange(s.getModel(),e.range()):this.viewModel.searchResult.rangeHighlightDecorations.removeHighlightRange()}catch(e){return void c.dL(e)}if(l instanceof Zi){const t=e.parent();if(e instanceof E.qE)if(e instanceof E.YT)e.parent().showMatch(e);else{const i=l.getControl();if(i){t.bindNotebookEditorWidget(i),await t.updateMatchesForEditorWidget();const s=n.findIndex((t=>t.id()===e.id())),r=t.matches(),o=s>=r.length?r[r.length-1]:r[s];o instanceof E.YT&&(t.showMatch(o),this.tree.getFocus().includes(o)&&this.tree.getSelection().includes(o)||(this.tree.setSelection([o],(0,Ui.gN)()),this.tree.setFocus([o])))}}}}openEditorWithMultiCursor(e){const t=e instanceof E.qE?e.parent().resource:e.resource;return this.editorService.openEditor({resource:t,options:{preserveFocus:!1,pinned:!0,revealIfVisible:!0}}).then((t=>{if(t){let i=null;if(e instanceof E.ut?i=e:e instanceof E.qE&&(i=e.parent()),i){const e=i.matches().map((e=>new hi.Y(e.range().startLineNumber,e.range().startColumn,e.range().endLineNumber,e.range().endColumn))),s=(0,Ct.Pi)(t.getControl());if(s){const t=Ti.get(s);t?.selectAllUsingSelections(e)}}}this.viewModel.searchResult.rangeHighlightDecorations.removeHighlightRange()}),c.dL)}getSelectionFrom(e){let t=null;if(e instanceof E.qE&&(t=e),e instanceof E.ut&&e.count()>0&&(t=e.matches()[e.matches().length-1]),t){const e=t.range();if(this.viewModel.isReplaceActive()&&this.viewModel.replaceString){const i=t.replaceString;return{startLineNumber:e.startLineNumber,startColumn:e.startColumn,endLineNumber:e.startLineNumber,endColumn:e.startColumn+i.length}}return e}}onUntitledDidDispose(e){if(!this.viewModel)return;const t=this.viewModel.searchResult.matches();for(let i=0,s=t.length;i<s;i++)e.toString()===t[i].resource.toString()&&this.viewModel.searchResult.remove(t[i])}onFilesChanged(e){if(!this.viewModel||"modified"!==this.searchConfig.sortOrder&&!e.gotDeleted())return;const t=this.viewModel.searchResult.matches();if(e.gotDeleted()){const i=t.filter((t=>e.contains(t.resource,2)));this.viewModel.searchResult.remove(i)}else{const i=t.filter((t=>e.contains(t.resource)));i.length&&"modified"===this.searchConfig.sortOrder&&this.updateFileStats(i).then((()=>this.refreshTree()))}}get searchConfig(){return this.configurationService.getValue("search")}clearHistory(){this.searchWidget.clearHistory(),this.inputPatternExcludes.clearHistory(),this.inputPatternIncludes.clearHistory()}saveState(){if(!this.searchWidget)return;const e=this.inputPatternExcludes?.getValue().trim()??"",t=this.inputPatternIncludes?.getValue().trim()??"",i=this.inputPatternIncludes?.onlySearchInOpenEditors()??!1,s=this.inputPatternExcludes?.useExcludesAndIgnoreFiles()??!0,r=this.viewModel.preserveCase;if(this.searchWidget.searchInput){const e=this.searchWidget.searchInput.getRegex(),t=this.searchWidget.searchInput.getWholeWords(),i=this.searchWidget.searchInput.getCaseSensitive(),s=this.searchWidget.searchInput.getValue(),r=this.searchWidget.getNotebookFilters().codeInput,o=this.searchWidget.getNotebookFilters().codeOutput,n=this.searchWidget.getNotebookFilters().markupInput,a=this.searchWidget.getNotebookFilters().markupPreview;this.viewletState["query.contentPattern"]=s,this.viewletState["query.regex"]=e,this.viewletState["query.wholeWords"]=t,this.viewletState["query.caseSensitive"]=i,this.viewletState["query.isInNotebookMarkdownInput"]=n,this.viewletState["query.isInNotebookMarkdownPreview"]=a,this.viewletState["query.isInNotebookCellInput"]=r,this.viewletState["query.isInNotebookCellOutput"]=o}this.viewletState["query.folderExclusions"]=e,this.viewletState["query.folderIncludes"]=t,this.viewletState["query.useExcludesAndIgnoreFiles"]=s,this.viewletState["query.preserveCase"]=r,this.viewletState["query.onlyOpenEditors"]=i;const o=this.searchAndReplaceWidget.isReplaceShown();this.viewletState["view.showReplace"]=o,this.viewletState["view.treeLayout"]=this.isTreeLayoutViewVisible,this.viewletState["query.replaceText"]=o&&this.searchWidget.getReplaceValue(),this._saveSearchHistoryService(),this.memento.saveMemento(),super.saveState()}_saveSearchHistoryService(){const e=Object.create(null),t=this.searchWidget.getSearchHistory();t&&t.length&&(e.search=t);const i=this.searchWidget.getReplaceHistory();i&&i.length&&(e.replace=i);const s=this.inputPatternExcludes.getHistory();s&&s.length&&(e.exclude=s);const r=this.inputPatternIncludes.getHistory();r&&r.length&&(e.include=r),this.searchHistoryService.save(e)}async retrieveFileStats(){const e=this.searchResult.matches().filter((e=>!e.fileStat)).map((e=>e.resolveFileStat(this.fileService)));await Promise.all(e)}async updateFileStats(e){const t=e.map((e=>e.resolveFileStat(this.fileService)));await Promise.all(t)}removeFileStats(){for(const e of this.searchResult.matches())e.fileStat=void 0}dispose(){this.isDisposed=!0,this.saveState(),super.dispose()}};to=(0,o.g)([(0,o.f)(1,f.sn),(0,o.f)(2,w.AR),(0,o.f)(3,xe.$),(0,o.f)(4,$i.R9),(0,o.f)(5,tt.lT),(0,o.f)(6,Mt.Ss),(0,o.f)(7,Ki.H),(0,o.f)(8,Ze.u),(0,o.f)(9,A.TG),(0,o.f)(10,Z.XH),(0,o.f)(11,fe.Ui),(0,o.f)(12,ce.ec),(0,o.f)(13,E.Zj),(0,o.f)(14,z.i6),(0,o.f)(15,I.H),(0,o.f)(16,T.MM),(0,o.f)(17,Xr.UP),(0,o.f)(18,st.XE),(0,o.f)(19,k.c),(0,o.f)(20,Ze.i),(0,o.f)(21,Vi.F7),(0,o.f)(22,et.d),(0,o.f)(23,it.Uy),(0,o.f)(24,be.v4),(0,o.f)(25,v.bU),(0,o.f)(26,Jr.A),(0,o.f)(27,m.VZ)],to);class io extends l.JT{constructor(e,t,i){super(),this.element=Zr("a.pointer",{tabindex:0,title:i},e),this.addEventHandlers(t)}addEventHandlers(e){const t=t=>{Ae.zB.stop(t,!1),e(t)};this._register(Ae.nm(this.element,Ae.tw.CLICK,t)),this._register(Ae.nm(this.element,Ae.tw.KEY_DOWN,(e=>{const i=new oi.y1(e);(i.equals(10)||i.equals(3))&&(t(e),i.preventDefault(),i.stopPropagation())})))}}(0,Xe.r1)(class extends Xe.Ke{constructor(){super({id:"search.action.copyMatch",title:{value:R.NC("copyMatchLabel","Copy"),original:"Copy"},category:ns,keybinding:{weight:200,when:Os,primary:2081},menu:[{id:Xe.eH.SearchContext,when:Os,group:"search_2",order:1}]})}async run(e,t){await async function(e,t){if(!t){const i=ao(e);if(!i)return;t=i}const i=e.get(Je.p),s=e.get(W.e);let r;t instanceof E.qE?r=ro(t):t instanceof E.ut?r=oo(t,s).text:t instanceof E.nA&&(r=no(t,s).text),r&&await i.writeText(r)}(e,t)}}),(0,Xe.r1)(class extends Xe.Ke{constructor(){super({id:"search.action.copyPath",title:{value:R.NC("copyPathLabel","Copy Path"),original:"Copy Path"},category:ns,keybinding:{weight:200,when:Ls,primary:2593,win:{primary:1569}},menu:[{id:Xe.eH.SearchContext,when:Ls,group:"search_2",order:2}]})}async run(e,t){await async function(e,t){if(!t){const i=ao(e);if(!(i instanceof E.ut||i instanceof E.eG))return;t=i}const i=e.get(Je.p),s=e.get(W.e).getUriLabel(t.resource,{noPrefix:!0});await i.writeText(s)}(e,t)}}),(0,Xe.r1)(class extends Xe.Ke{constructor(){super({id:"search.action.copyAll",title:{value:R.NC("copyAllLabel","Copy All"),original:"Copy All"},category:ns,menu:[{id:Xe.eH.SearchContext,when:Ms,group:"search_2",order:3}]})}async run(e){await async function(e){const t=e.get(Z.qC),i=e.get(Je.p),s=e.get(W.e),r=cs(t);if(r){const e=function(e,t){const i=[];e=e.sort(E.ct);for(let s=0;s<e.length;s++){const r=no(e[s],t);r.count&&i.push(r.text)}return i.join(so+so)}(r.searchResult.folderMatches(),s);await i.writeText(e)}}(e)}});const so=U.ED?"\r\n":"\n";function ro(e,t=0){const i=()=>`${e.range().startLineNumber},${e.range().startColumn}`,s=t=>e.range().startLineNumber+t+"",r=e.fullPreviewLines(),o=r.reduce(((e,t,r)=>{const o=0===r?i().length:s(r).length;return Math.max(o,e)}),0);return r.map(((e,r)=>{const n=0===r?i():s(r),a=" ".repeat(o-n.length);return`${" ".repeat(t)}${n}: ${a}${e}`})).join("\n")}function oo(e,t){const i=e.matches().sort(E.ct).map((e=>ro(e,2)));return{text:`${t.getUriLabel(e.resource,{noPrefix:!0})}${so}${i.join(so)}`,count:i.length}}function no(e,t){const i=[];let s=0;return e.matches().sort(E.ct).forEach((e=>{const r=function(e,t){return e instanceof E.ut?oo(e,t):no(e,t)}(e,t);s+=r.count,i.push(r.text)})),{text:i.join(so+so),count:s}}function ao(e){const t=cs(e.get(Z.qC));return t?.getControl().getSelection()[0]}var co=i(43830),lo=i(26513),ho=i(7481);async function uo(e,t,i,s,r){const o=e.get(Ui.Lw),n=e.get(f.sn),a=e.get(Z.qC),c=e.get(ce.ec),l=e.get(Ki.H),h=e.get(fe.Ui).getValue().search,d=h.mode;let u;if(t)u=(0,co.kn)(s,o,e.get(w.AR),e.get(co.gE));else{const t=cs(e.get(Z.qC));if(!t)return;u=ls(t.getControl(),r,h).map((e=>e instanceof E.qE?null:e.resource)).filter((e=>null!==e))}const g=n.resolveAll(u.map((e=>({resource:e})))).then((e=>{const t=[];return e.forEach((e=>{e.success&&e.stat&&t.push(e.stat.isDirectory?e.stat.resource:(0,L.XX)(e.stat.resource))})),(0,ne.Z)(t,c)}));if("view"!==d)return i?l.executeCommand(lr,{filesToInclude:(await g).join(", "),showIncludesExcludes:!0,location:"newEditor"===d?"new":"reuse"}):l.executeCommand(lr,{filesToExclude:(await g).join(", "),showIncludesExcludes:!0,location:"newEditor"===d?"new":"reuse"});{const e=await hs(a,!0);u&&u.length&&e&&(i?e.searchInFolders(await g):e.searchOutsideOfFolders(await g))}}(0,Xe.r1)(class extends Xe.Ke{constructor(){super({id:"search.action.restrictSearchToFolder",title:{value:R.NC("restrictResultsToFolder","Restrict Search to Folder"),original:"Restrict Search to Folder"},category:ns,keybinding:{weight:200,when:z.Ao.and(ks,qs),primary:1572},menu:[{id:Xe.eH.SearchContext,group:"search",order:3,when:z.Ao.and(qs)}]})}async run(e,t){await uo(e,!1,!0,void 0,t)}}),(0,Xe.r1)(class extends Xe.Ke{constructor(){super({id:"search.action.excludeFromSearch",title:{value:R.NC("excludeFolderFromSearch","Exclude Folder from Search"),original:"Exclude Folder from Search"},category:ns,menu:[{id:Xe.eH.SearchContext,group:"search",order:4,when:z.Ao.and(qs)}]})}async run(e,t){await uo(e,!1,!1,void 0,t)}}),(0,Xe.r1)(class extends Xe.Ke{constructor(){super({id:"search.action.revealInSideBar",title:{value:R.NC("revealInSideBar","Reveal in Explorer View"),original:"Reveal in Explorer View"},category:ns,menu:[{id:Xe.eH.SearchContext,when:z.Ao.and(Ds,Ms),group:"search_3",order:1}]})}async run(e,t){const i=e.get(ho.c),s=e.get(co.gE),r=e.get(ce.ec),o=cs(e.get(Z.qC));if(!o)return;let n;t instanceof E.ut||(t=o.getControl().getFocus()[0]),t instanceof E.ut&&(n=t,i.openPaneComposite(lo.f3,0,!1).then((e=>{if(!e)return;const t=e.getViewPaneContainer(),i=n.resource;if(i&&r.isInsideWorkspace(i)){const e=t.getExplorerView();e.setExpanded(!0),s.select(i,!0).then((()=>e.focus()),c.dL)}})))}}),(0,Xe.r1)(class extends Xe.Ke{constructor(){super({id:"workbench.action.findInFiles",title:{value:R.NC("findInFiles","Find in Files"),mnemonicTitle:R.NC({key:"miFindInFiles",comment:["&& denotes a mnemonic"]},"Find &&in Files"),original:"Find in Files"},description:{description:R.NC("findInFiles.description","Open a workspace search"),args:[{name:R.NC("findInFiles.args","A set of options for the search"),schema:{type:"object",properties:{query:{type:"string"},replace:{type:"string"},preserveCase:{type:"boolean"},triggerSearch:{type:"boolean"},filesToInclude:{type:"string"},filesToExclude:{type:"string"},isRegex:{type:"boolean"},isCaseSensitive:{type:"boolean"},matchWholeWord:{type:"boolean"},useExcludeSettingsAndIgnoreFiles:{type:"boolean"},onlyOpenEditors:{type:"boolean"}}}}]},category:ns,keybinding:{weight:200,primary:3108},menu:[{id:Xe.eH.MenubarEditMenu,group:"4_find_global",order:1}],f1:!0})}async run(e,t={}){!async function(e,t={}){const i=e.get(fe.Ui).getValue().search,s=e.get(Z.qC),r=e.get(Ki.H),o={};if(0!==Object.keys(t).length){const i=e.get($r.qb),s=e.get(ye.CE),r=e.get(ce.ec),n=s.getLastActiveWorkspaceRoot(),a=n?.scheme===d.lg.file||n?.scheme===d.lg.vscodeRemote?n:void 0,c=a?(0,g.f6)(r.getWorkspaceFolder(a)):void 0;for(const e of Object.entries(t)){const t=e[0],s=e[1];void 0!==s&&(o[t]="string"==typeof s?await i.resolveAsync(c,s):s)}}const n=i.mode;if("view"===n)hs(s,!1).then((e=>{if(e){e.searchAndReplaceWidget.toggleReplace("string"==typeof o.replace);let t=!1;"string"!=typeof o.query&&(t=e.updateTextFromFindWidgetOrSelection({allowUnselectedWord:"string"!=typeof o.replace})),e.setSearchParameters(o),e.searchAndReplaceWidget.focus(void 0,t,t)}}));else{const e=e=>({location:"newEditor"===n?"new":"reuse",query:e.query,filesToInclude:e.filesToInclude,filesToExclude:e.filesToExclude,matchWholeWord:e.matchWholeWord,isCaseSensitive:e.isCaseSensitive,isRegexp:e.isRegex,useExcludeSettingsAndIgnoreFiles:e.useExcludeSettingsAndIgnoreFiles,onlyOpenEditors:e.onlyOpenEditors,showIncludesExcludes:!(!e.filesToExclude&&!e.filesToExclude&&e.useExcludeSettingsAndIgnoreFiles)});r.executeCommand(lr,e(o))}}(e,t)}}),(0,Xe.r1)(class extends Xe.Ke{constructor(){super({id:"filesExplorer.findInFolder",title:{value:R.NC("findInFolder","Find in Folder..."),original:"Find in Folder..."},category:ns,keybinding:{weight:200,when:z.Ao.and(lo.Ie,lo.W$),primary:1572},menu:[{id:Xe.eH.ExplorerContext,group:"4_search",order:10,when:z.Ao.and(lo.W$)}]})}async run(e,t){await uo(e,!0,!0,t)}}),(0,Xe.r1)(class extends Xe.Ke{constructor(){super({id:"filesExplorer.findInWorkspace",title:{value:R.NC("findInWorkspace","Find in Workspace..."),original:"Find in Workspace..."},category:ns,menu:[{id:Xe.eH.ExplorerContext,group:"4_search",order:10,when:z.Ao.and(lo.RQ,lo.W$.toNegated())}]})}async run(e){const t=e.get(fe.Ui).getValue().search.mode;if("view"!==t)return e.get(Ki.H).executeCommand(lr,{location:"newEditor"===t?"new":"reuse",filesToInclude:""});{const t=await hs(e.get(Z.qC),!0);t?.searchInFolders()}}}),(0,Xe.r1)(class extends Xe.Ke{constructor(){super({id:"workbench.action.search.toggleQueryDetails",title:{value:R.NC("ToggleQueryDetailsAction.label","Toggle Query Details"),original:"Toggle Query Details"},category:ns,keybinding:{weight:200,when:z.Ao.or(Is,rr),primary:3112}})}run(e){const t=e.get(z.i6).getContext(document.activeElement);if(t.getValue(rr.serialize()))e.get(w.AR).activeEditorPane.toggleQueryDetails();else if(t.getValue(Is.serialize())){const t=cs(e.get(Z.qC));(0,g.cW)(t).toggleQueryDetails()}}}),(0,Xe.r1)(class extends Xe.Ke{constructor(){super({id:"closeReplaceInFilesWidget",title:{value:R.NC("CloseReplaceWidget.label","Close Replace Widget"),original:"Close Replace Widget"},category:ns,keybinding:{weight:200,when:z.Ao.and(ks,Fs),primary:9}})}run(e){const t=cs(e.get(Z.qC));return t&&(t.searchAndReplaceWidget.toggleReplace(!1),t.searchAndReplaceWidget.focus()),Promise.resolve(null)}}),(0,Xe.r1)(class extends Xe.Ke{constructor(){super({id:ws,title:{value:R.NC("ToggleCaseSensitiveCommandId.label","Toggle Case Sensitive"),original:"Toggle Case Sensitive"},category:ns,keybinding:Object.assign({weight:200,when:U.dz?z.Ao.and(Is,Ws.toNegated()):Is},Fe.Dt)})}async run(e){!function(e){const t=cs(e.get(Z.qC));t?.toggleCaseSensitive()}(e)}}),(0,Xe.r1)(class extends Xe.Ke{constructor(){super({id:Cs,title:{value:R.NC("ToggleWholeWordCommandId.label","Toggle Whole Word"),original:"Toggle Whole Word"},keybinding:Object.assign({weight:200,when:Is},Fe.CP),category:ns})}async run(e){return function(e){const t=cs(e.get(Z.qC));t?.toggleWholeWords()}(e)}}),(0,Xe.r1)(class extends Xe.Ke{constructor(){super({id:bs,title:{value:R.NC("ToggleRegexCommandId.label","Toggle Regex"),original:"Toggle Regex"},keybinding:Object.assign({weight:200,when:Is},Fe.LM),category:ns})}async run(e){return function(e){const t=cs(e.get(Z.qC));t?.toggleRegex()}(e)}}),(0,Xe.r1)(class extends Xe.Ke{constructor(){super({id:xs,title:{value:R.NC("TogglePreserveCaseId.label","Toggle Preserve Case"),original:"Toggle Preserve Case"},keybinding:Object.assign({weight:200,when:Is},Fe.mt),category:ns})}async run(e){return function(e){const t=cs(e.get(Z.qC));t?.togglePreserveCase()}(e)}}),(0,Xe.r1)(class extends Xe.Ke{constructor(){super({id:"search.action.openResult",title:{value:R.NC("OpenMatch.label","Open Match"),original:"Open Match"},category:ns,keybinding:{weight:200,when:z.Ao.and(ks,Os),primary:3,mac:{primary:3,secondary:[2066]}}})}run(e){const t=cs(e.get(Z.qC));if(t){const e=t.getControl(),i=t.getControl(),s=e.getFocus()[0];s instanceof E.nA?i.toggleCollapsed(s):t.open(e.getFocus()[0],!1,!1,!0)}}}),(0,Xe.r1)(class extends Xe.Ke{constructor(){super({id:"search.action.openResultToSide",title:{value:R.NC("OpenMatchToSide.label","Open Match To Side"),original:"Open Match To Side"},category:ns,keybinding:{weight:200,when:z.Ao.and(ks,Os),primary:2051,mac:{primary:259}}})}run(e){const t=cs(e.get(Z.qC));if(t){const e=t.getControl();t.open(e.getFocus()[0],!1,!0,!0)}}}),(0,Xe.r1)(class extends Xe.Ke{constructor(){super({id:"addCursorsAtSearchResults",title:{value:R.NC("AddCursorsAtSearchResults.label","Add Cursors at Search Results"),original:"Add Cursors at Search Results"},keybinding:{weight:200,when:z.Ao.and(ks,Os),primary:3114},category:ns})}async run(e){const t=cs(e.get(Z.qC));if(t){const e=t.getControl();t.openEditorWithMultiCursor(e.getFocus()[0])}}}),(0,Xe.r1)(class extends Xe.Ke{constructor(){super({id:"search.focus.nextInputBox",title:{value:R.NC("FocusNextInputAction.label","Focus Next Input"),original:"Focus Next Input"},category:ns,keybinding:{weight:200,when:z.Ao.or(z.Ao.and(rr,Rs),z.Ao.and(ks,Rs)),primary:2066}})}async run(e){const t=e.get(w.AR);t.activeEditor instanceof Qr&&t.activeEditorPane.focusNextInput();const i=cs(e.get(Z.qC));i?.focusNextInputBox()}}),(0,Xe.r1)(class extends Xe.Ke{constructor(){super({id:"search.focus.previousInputBox",title:{value:R.NC("FocusPreviousInputAction.label","Focus Previous Input"),original:"Focus Previous Input"},category:ns,keybinding:{weight:200,when:z.Ao.or(z.Ao.and(rr,Rs),z.Ao.and(ks,Rs,_s.toNegated())),primary:2064}})}async run(e){const t=e.get(w.AR);t.activeEditor instanceof Qr&&t.activeEditorPane.focusPrevInput();const i=cs(e.get(Z.qC));i?.focusPreviousInputBox()}}),(0,Xe.r1)(class extends Xe.Ke{constructor(){super({id:"search.action.focusSearchFromResults",title:{value:R.NC("FocusSearchFromResults.label","Focus Search From Results"),original:"Focus Search From Results"},category:ns,keybinding:{weight:200,when:z.Ao.and(ks,z.Ao.or(Ps,Vi.UA)),primary:2064}})}run(e){const t=cs(e.get(Z.qC));t?.focusPreviousInputBox()}}),(0,Xe.r1)(class e extends Xe.Ke{static{this.searchOnTypeKey="search.searchOnType"}constructor(){super({id:"workbench.action.toggleSearchOnType",title:{value:R.NC("toggleTabs","Toggle Search on Type"),original:"Toggle Search on Type"},category:ns})}async run(t){const i=t.get(fe.Ui),s=i.getValue(e.searchOnTypeKey);return i.updateValue(e.searchOnTypeKey,!s)}}),(0,Xe.r1)(class extends Xe.Ke{constructor(){super({id:"search.action.focusSearchList",title:{value:R.NC("focusSearchListCommandLabel","Focus List"),original:"Focus List"},category:ns,f1:!0})}async run(e){go(e)}}),(0,Xe.r1)(class extends Xe.Ke{constructor(){super({id:"search.action.focusNextSearchResult",title:{value:R.NC("FocusNextSearchResult.label","Focus Next Search Result"),original:"Focus Next Search Result"},keybinding:[{primary:62,weight:200}],category:ns,f1:!0,precondition:z.Ao.or(Ms,rr)})}async run(e){return await async function(e){const t=e.get(w.AR);return t.activeEditor instanceof Qr?t.activeEditorPane.focusNextResult():hs(e.get(Z.qC)).then((e=>{e?.selectNextMatch()}))}(e)}}),(0,Xe.r1)(class extends Xe.Ke{constructor(){super({id:"search.action.focusPreviousSearchResult",title:{value:R.NC("FocusPreviousSearchResult.label","Focus Previous Search Result"),original:"Focus Previous Search Result"},keybinding:[{primary:1086,weight:200}],category:ns,f1:!0,precondition:z.Ao.or(Ms,rr)})}async run(e){return await async function(e){const t=e.get(w.AR);return t.activeEditor instanceof Qr?t.activeEditorPane.focusPreviousResult():hs(e.get(Z.qC)).then((e=>{e?.selectPreviousMatch()}))}(e)}}),(0,Xe.r1)(class extends Xe.Ke{constructor(){super({id:"workbench.action.replaceInFiles",title:{value:R.NC("replaceInFiles","Replace in Files"),original:"Replace in Files"},keybinding:[{primary:3110,weight:200}],category:ns,f1:!0,menu:[{id:Xe.eH.MenubarEditMenu,group:"4_find_global",order:2}]})}async run(e){return await async function(e,t){return hs(e.get(Z.qC),!1).then((e=>{if(e){e.searchAndReplaceWidget.toggleReplace(true);const t=e.updateTextFromFindWidgetOrSelection({allowUnselectedWord:!1});e.searchAndReplaceWidget.focus(void 0,t,t)}}))}(e)}});const go=e=>{hs(e.get(Z.qC)).then((e=>{e?.moveFocusToResults()}))};function po(e,t){const i=e.get(fe.Ui),s=cs(e.get(Z.qC)),r=t?.viewer??s?.getControl();if(!r)return;const o=t?.element??r.getFocus()[0],n=ls(r,o??void 0,i.getValue("search"));let a,c=r.getFocus()[0];if((!c||c&&!(0,E.tJ)(c,n)||c instanceof E.lt)&&(c=o),0===n.length)return;c&&(a=fo(r,c,n));const l=s?.searchResult;l&&l.batchReplace(n),c&&(a||(a=mo(r,c)),a)&&(r.reveal(a),r.setFocus([a],(0,Ui.gN)()),r.setSelection([a],(0,Ui.gN)()),a instanceof E.qE?!i.getValue().search.useReplacePreview||function(e,t){if(!(t instanceof E.qE))return!1;const i=e.get(w.AR).activeEditor,s=i?.resource;return!!s&&e.get(S.v).extUri.isEqual(s,t.parent().resource)}(e,a)||a instanceof E.YT?s?.open(a,!0):e.get(I.H).openReplacePreview(a,!0):a instanceof E.ut&&s?.open(a,!0)),r.domFocus()}function fo(e,t,i){const s=e.navigate(t);if(t instanceof E.nA)for(;s.next()&&(!(s.current()instanceof E.nA)||(0,E.tJ)(s.current(),i)););else if(t instanceof E.ut)for(;s.next()&&(!(s.current()instanceof E.ut)||(0,E.tJ)(s.current(),i));)e.expand(s.current());else for(;s.next()&&(!(s.current()instanceof E.qE)||(0,E.tJ)(s.current(),i));)e.expand(s.current());return s.current()}function mo(e,t){let i=e.lastVisibleElement??null;for(;i;){const o=(r=i,(s=t)instanceof E.qE?r instanceof E.qE?0:-1:s instanceof E.ut?r instanceof E.qE?1:r instanceof E.ut?0:-1:r instanceof E.nA?0:1);if(-1===o)e.expand(i),i=e.lastVisibleElement;else{if(1!==o)return i;i=e.getParentElement(i)}}var s,r}(0,Xe.r1)(class extends Xe.Ke{constructor(){super({id:"search.action.remove",title:{value:R.NC("RemoveAction.label","Dismiss"),original:"Dismiss"},category:ns,icon:jt,keybinding:{weight:200,when:z.Ao.and(ks,Os),primary:20,mac:{primary:2049}},menu:[{id:Xe.eH.SearchContext,group:"search",order:2},{id:Xe.eH.SearchActionMenu,group:"inline",order:2}]})}run(e,t){const i=e.get(Z.qC),s=e.get(fe.Ui),r=cs(i);if(!r)return;let o=t?.element,a=t?.viewer;a||(a=r.getControl()),o||(o=a.getFocus()[0]??void 0);const c=ls(a,o,s.getValue("search"));let l,h=a.getFocus()[0]??void 0;if(0===c.length)return;(!h||h instanceof E.lt)&&(h=o);const d=function(e,t){return!!t&&(!t||e.includes(t)||function(e,t){for(const i of e)if(i instanceof E.ut&&t instanceof E.qE&&i.matches().includes(t)||i instanceof E.nA&&(t instanceof E.ut&&i.getDownstreamFileMatch(t.resource)||t instanceof E.qE&&i.getDownstreamFileMatch(t.parent().resource)))return!0;return!1}(e,t))}(c,h);h&&d&&(l=fo(a,h,c));const u=r.searchResult;u&&u.batchRemove(c),h&&d?(l||(l=mo(a,h)),l&&!(0,E.tJ)(l,c)&&(a.reveal(l),a.setFocus([l],(0,Ui.gN)()),a.setSelection([l],(0,Ui.gN)()))):(0,n.fS)(a.getFocus(),a.getSelection())||a.setSelection(a.getFocus()),a.domFocus()}}),(0,Xe.r1)(class extends Xe.Ke{constructor(){super({id:"search.action.replace",title:{value:R.NC("match.replace.label","Replace"),original:"Replace"},category:ns,keybinding:{weight:200,when:z.Ao.and(ks,Ts,Vs,Hs),primary:3094},icon:zt,menu:[{id:Xe.eH.SearchContext,when:z.Ao.and(Ts,Vs,Hs),group:"search",order:1},{id:Xe.eH.SearchActionMenu,when:z.Ao.and(Ts,Vs,Hs),group:"inline",order:1}]})}async run(e,t){return po(e,t)}}),(0,Xe.r1)(class extends Xe.Ke{constructor(){super({id:"search.action.replaceAllInFile",title:{value:R.NC("file.replaceAll.label","Replace All"),original:"Replace All"},category:ns,keybinding:{weight:200,when:z.Ao.and(ks,Ts,Ds,Hs),primary:3094,secondary:[3075]},icon:zt,menu:[{id:Xe.eH.SearchContext,when:z.Ao.and(Ts,Ds,Hs),group:"search",order:1},{id:Xe.eH.SearchActionMenu,when:z.Ao.and(Ts,Ds,Hs),group:"inline",order:1}]})}async run(e,t){return po(e,t)}}),(0,Xe.r1)(class extends Xe.Ke{constructor(){super({id:"search.action.replaceAllInFolder",title:{value:R.NC("file.replaceAll.label","Replace All"),original:"Replace All"},category:ns,keybinding:{weight:200,when:z.Ao.and(ks,Ts,Bs,Hs),primary:3094,secondary:[3075]},icon:zt,menu:[{id:Xe.eH.SearchContext,when:z.Ao.and(Ts,Bs,Hs),group:"search",order:1},{id:Xe.eH.SearchActionMenu,when:z.Ao.and(Ts,Bs,Hs),group:"inline",order:1}]})}async run(e,t){return po(e,t)}}),(0,Xe.r1)(class e extends Xe.Ke{static{this.ID="workbench.action.showAllSymbols"}static{this.LABEL=R.NC("showTriggerActions","Go to Symbol in Workspace...")}static{this.ALL_SYMBOLS_PREFIX="#"}constructor(){super({id:Es,title:{value:R.NC("showTriggerActions","Go to Symbol in Workspace..."),original:"Go to Symbol in Workspace...",mnemonicTitle:R.NC({key:"miGotoSymbolInWorkspace",comment:["&& denotes a mnemonic"]},"Go to Symbol in &&Workspace...")},f1:!0,keybinding:{weight:200,primary:2098},menu:{id:Xe.eH.MenubarGoMenu,group:"3_global_nav",order:2}})}async run(t){t.get(se.eJ).quickAccess.show(e.ALL_SYMBOLS_PREFIX)}}),(0,Xe.r1)(class extends Xe.Ke{constructor(){super({id:"search.action.clearHistory",title:{value:R.NC("clearSearchHistoryLabel","Clear Search History"),original:"Clear Search History"},category:ns,f1:!0})}async run(e){vo(e)}}),(0,Xe.r1)(class extends Xe.Ke{constructor(){super({id:"search.action.cancel",title:{value:R.NC("CancelSearchAction.label","Cancel Search"),original:"Cancel Search"},icon:ii,category:ns,f1:!0,precondition:ae.Y0.isEqualTo(ae.Ps.Idle).negate(),keybinding:{weight:200,when:z.Ao.and(ks,Ui.CQ),primary:9},menu:[{id:Xe.eH.ViewTitle,group:"navigation",order:0,when:z.Ao.and(z.Ao.equals("view",r.nn),ae.Y0.isEqualTo(ae.Ps.SlowSearch))}]})}run(e){return function(e){const t=cs(e.get(Z.qC));t?.cancelSearch()}(e)}}),(0,Xe.r1)(class extends Xe.Ke{constructor(){super({id:"search.action.refreshSearchResults",title:{value:R.NC("RefreshAction.label","Refresh"),original:"Refresh"},icon:Yt,precondition:Ks,category:ns,f1:!0,menu:[{id:Xe.eH.ViewTitle,group:"navigation",order:0,when:z.Ao.and(z.Ao.equals("view",r.nn),ae.Y0.isEqualTo(ae.Ps.SlowSearch).negate())}]})}run(e,...t){return function(e){const t=cs(e.get(Z.qC));t?.triggerQueryChange({preserveFocus:!1})}(e)}}),(0,Xe.r1)(class extends Xe.Ke{constructor(){super({id:"search.action.collapseSearchResults",title:{value:R.NC("CollapseDeepestExpandedLevelAction.label","Collapse All"),original:"Collapse All"},category:ns,icon:Xt,f1:!0,precondition:z.Ao.and(Ms,$s),menu:[{id:Xe.eH.ViewTitle,group:"navigation",order:3,when:z.Ao.and(z.Ao.equals("view",r.nn),z.Ao.or(Ms.negate(),$s))}]})}run(e,...t){return function(e){const t=cs(e.get(Z.qC));if(t){const e=t.getControl(),i=e.navigate();let s=i.first(),r=!1,o=!1;if(s instanceof E.m5||t.isTreeLayoutViewVisible)for(;s=i.next();){if(s instanceof E.qE){r=!0;break}if(t.isTreeLayoutViewVisible&&!o){let t=s;if(s instanceof E.nA){const i=e.getCompressedTreeNode(s).element?.elements[0];t=!i||i instanceof E.qE?s:i}const i=t.parent();i instanceof E.m5||i instanceof E.uN||i instanceof E.lt||(o=!0)}}if(r){s=i.first();do{s instanceof E.ut&&e.collapse(s)}while(s=i.next())}else if(o){if(s=i.first(),s)do{let t=s;if(s instanceof E.nA){const i=e.getCompressedTreeNode(s).element?.elements[0];t=!i||i instanceof E.qE?s:i}const i=t.parent();(i instanceof E.m5||i instanceof E.uN)&&(e.hasElement(s)?e.collapse(s,!0):e.collapseAll())}while(s=i.next())}else e.collapseAll();const n=e.getFocus()[0]?.parent();n&&(n instanceof E.nA||n instanceof E.ut)&&e.hasElement(n)&&e.isCollapsed(n)&&(e.domFocus(),e.focusFirst(),e.setSelection(e.getFocus()))}}(e)}}),(0,Xe.r1)(class extends Xe.Ke{constructor(){super({id:"search.action.expandSearchResults",title:{value:R.NC("ExpandAllAction.label","Expand All"),original:"Expand All"},category:ns,icon:Jt,f1:!0,precondition:z.Ao.and(Ms,$s.toNegated()),menu:[{id:Xe.eH.ViewTitle,group:"navigation",order:3,when:z.Ao.and(z.Ao.equals("view",r.nn),Ms,$s.toNegated())}]})}run(e,...t){return function(e){const t=cs(e.get(Z.qC));t&&t.getControl().expandAll()}(e)}}),(0,Xe.r1)(class extends Xe.Ke{constructor(){super({id:"search.action.clearSearchResults",title:{value:R.NC("ClearSearchResultsAction.label","Clear Search Results"),original:"Clear Search Results"},category:ns,icon:ti,f1:!0,precondition:z.Ao.or(Ms,Ks,Qs,Us),menu:[{id:Xe.eH.ViewTitle,group:"navigation",order:1,when:z.Ao.equals("view",r.nn)}]})}run(e,...t){return function(e){const t=cs(e.get(Z.qC));t?.clearSearchResults()}(e)}}),(0,Xe.r1)(class extends Xe.Ke{constructor(){super({id:"search.action.viewAsTree",title:{value:R.NC("ViewAsTreeAction.label","View as Tree"),original:"View as Tree"},category:ns,icon:ei,f1:!0,precondition:z.Ao.and(Ms,Gs.toNegated()),menu:[{id:Xe.eH.ViewTitle,group:"navigation",order:2,when:z.Ao.and(z.Ao.equals("view",r.nn),Gs.toNegated())}]})}run(e,...t){const i=cs(e.get(Z.qC));i&&i.setTreeView(!0)}}),(0,Xe.r1)(class extends Xe.Ke{constructor(){super({id:"search.action.viewAsList",title:{value:R.NC("ViewAsListAction.label","View as List"),original:"View as List"},category:ns,icon:Zt,f1:!0,precondition:z.Ao.and(Ms,Gs),menu:[{id:Xe.eH.ViewTitle,group:"navigation",order:2,when:z.Ao.and(z.Ao.equals("view",r.nn),Gs)}]})}run(e,...t){const i=cs(e.get(Z.qC));i&&i.setTreeView(!1)}});const vo=e=>{e.get(k.c).clearHistory()};Y.B.as(Vt.I.Workbench).registerWorkbenchContribution(V,1),Y.B.as(Vt.I.Workbench).registerWorkbenchContribution(V,1),sr.W.registerCommandAndKeybindingRule({id:Er.ID,weight:200,when:z.Ao.and(ks,Ts,Fe.VO),primary:2563,handler:e=>{const t=e.get(Z.qC);if(function(e){const t=cs(e),i=document.activeElement;return!!(t&&i&&Ae.jg(i,t.getContainer()))}(t)){const e=cs(t);e&&new Er(e.searchAndReplaceWidget).run()}}});const So=Y.B.as(Z.IP.ViewContainersRegistry).registerViewContainer({id:r.f3,title:{value:R.NC("name","Search"),original:"Search"},ctorDescriptor:new s.M(X.XV,[r.f3,{mergeViewWithContainerWhenSingleView:!0}]),hideIfEmpty:!0,icon:si,order:1},0,{doNotRegisterOpenCommand:!0}),yo={id:r.nn,containerIcon:si,name:R.NC("search","Search"),ctorDescriptor:new s.M(to),canToggleVisibility:!1,canMoveView:!0,openCommandActionDescriptor:{id:So.id,mnemonicTitle:R.NC({key:"miViewSearch",comment:["&& denotes a mnemonic"]},"&&Search"),keybindings:{primary:3108,when:z.Ao.regex("neverMatch",/doesNotMatch/)},order:1}};Y.B.as(Z.IP.ViewsRegistry).registerViews([yo],So);const wo=Y.B.as(j.IP.Quickaccess);wo.registerQuickAccessProvider({ctor:Ht,prefix:Ht.PREFIX,placeholder:R.NC("anythingQuickAccessPlaceholder","Search files by name (append {0} to go to line or {1} to go to symbol)",$.q.PREFIX,ee.l.PREFIX),contextKey:J.Id,helpEntries:[{description:R.NC("anythingQuickAccess","Go to File"),commandId:"workbench.action.quickOpen"}]}),wo.registerQuickAccessProvider({ctor:yt,prefix:yt.PREFIX,placeholder:R.NC("symbolsQuickAccessPlaceholder","Type the name of a symbol to open."),contextKey:"inWorkspaceSymbolsPicker",helpEntries:[{description:R.NC("symbolsQuickAccess","Go to Symbol in Workspace"),commandId:Es}]}),Y.B.as(G.IP.Configuration).registerConfiguration({id:"search",order:13,title:R.NC("searchConfigurationTitle","Search"),type:"object",properties:{[r.XG]:{type:"object",markdownDescription:R.NC("exclude","Configure [glob patterns](https://code.visualstudio.com/docs/editor/codebasics#_advanced-search-options) for excluding files and folders in fulltext searches and quick open. Inherits all glob patterns from the `#files.exclude#` setting."),default:{"**/node_modules":!0,"**/bower_components":!0,"**/*.code-search":!0},additionalProperties:{anyOf:[{type:"boolean",description:R.NC("exclude.boolean","The glob pattern to match file paths against. Set to true or false to enable or disable the pattern.")},{type:"object",properties:{when:{type:"string",pattern:"\\w*\\$\\(basename\\)\\w*",default:"$(basename).ext",markdownDescription:R.NC({key:"exclude.when",comment:["\\$(basename) should not be translated"]},"Additional check on the siblings of a matching file. Use \\$(basename) as variable for the matching file name.")}}}]},scope:4},"search.mode":{type:"string",enum:["view","reuseEditor","newEditor"],default:"view",markdownDescription:R.NC("search.mode","Controls where new `Search: Find in Files` and `Find in Folder` operations occur: either in the search view, or in a search editor."),enumDescriptions:[R.NC("search.mode.view","Search in the search view, either in the panel or side bars."),R.NC("search.mode.reuseEditor","Search in an existing search editor if present, otherwise in a new search editor."),R.NC("search.mode.newEditor","Search in a new search editor.")]},"search.useRipgrep":{type:"boolean",description:R.NC("useRipgrep",'This setting is deprecated and now falls back on "search.usePCRE2".'),deprecationMessage:R.NC("useRipgrepDeprecated",'Deprecated. Consider "search.usePCRE2" for advanced regex feature support.'),default:!0},"search.maintainFileSearchCache":{type:"boolean",deprecationMessage:R.NC("maintainFileSearchCacheDeprecated","The search cache is kept in the extension host which never shuts down, so this setting is no longer needed."),description:R.NC("search.maintainFileSearchCache","When enabled, the searchService process will be kept alive instead of being shut down after an hour of inactivity. This will keep the file search cache in memory."),default:!1},"search.useIgnoreFiles":{type:"boolean",markdownDescription:R.NC("useIgnoreFiles","Controls whether to use `.gitignore` and `.ignore` files when searching for files."),default:!0,scope:4},"search.useGlobalIgnoreFiles":{type:"boolean",markdownDescription:R.NC("useGlobalIgnoreFiles","Controls whether to use your global gitignore file (e.g., from `$HOME/.config/git/ignore`) when searching for files. Requires `#search.useIgnoreFiles#` to be enabled."),default:!1,scope:4},"search.useParentIgnoreFiles":{type:"boolean",markdownDescription:R.NC("useParentIgnoreFiles","Controls whether to use `.gitignore` and `.ignore` files in parent directories when searching for files. Requires `#search.useIgnoreFiles#` to be enabled."),default:!1,scope:4},"search.quickOpen.includeSymbols":{type:"boolean",description:R.NC("search.quickOpen.includeSymbols","Whether to include results from a global symbol search in the file results for Quick Open."),default:!1},"search.quickOpen.includeHistory":{type:"boolean",description:R.NC("search.quickOpen.includeHistory","Whether to include results from recently opened files in the file results for Quick Open."),default:!0},"search.quickOpen.history.filterSortOrder":{type:"string",enum:["default","recency"],default:"default",enumDescriptions:[R.NC("filterSortOrder.default","History entries are sorted by relevance based on the filter value used. More relevant entries appear first."),R.NC("filterSortOrder.recency","History entries are sorted by recency. More recently opened entries appear first.")],description:R.NC("filterSortOrder","Controls sorting order of editor history in quick open when filtering.")},"search.followSymlinks":{type:"boolean",description:R.NC("search.followSymlinks","Controls whether to follow symlinks while searching."),default:!0},"search.smartCase":{type:"boolean",description:R.NC("search.smartCase","Search case-insensitively if the pattern is all lowercase, otherwise, search case-sensitively."),default:!1},"search.globalFindClipboard":{type:"boolean",default:!1,description:R.NC("search.globalFindClipboard","Controls whether the search view should read or modify the shared find clipboard on macOS."),included:U.dz},"search.location":{type:"string",enum:["sidebar","panel"],default:"sidebar",description:R.NC("search.location","Controls whether the search will be shown as a view in the sidebar or as a panel in the panel area for more horizontal space."),deprecationMessage:R.NC("search.location.deprecationMessage","This setting is deprecated. You can drag the search icon to a new location instead.")},"search.maxResults":{type:["number","null"],default:2e4,markdownDescription:R.NC("search.maxResults","Controls the maximum number of search results, this can be set to `null` (empty) to return unlimited results.")},"search.collapseResults":{type:"string",enum:["auto","alwaysCollapse","alwaysExpand"],enumDescriptions:[R.NC("search.collapseResults.auto","Files with less than 10 results are expanded. Others are collapsed."),"",""],default:"alwaysExpand",description:R.NC("search.collapseAllResults","Controls whether the search results will be collapsed or expanded.")},"search.useReplacePreview":{type:"boolean",default:!0,description:R.NC("search.useReplacePreview","Controls whether to open Replace Preview when selecting or replacing a match.")},"search.showLineNumbers":{type:"boolean",default:!1,description:R.NC("search.showLineNumbers","Controls whether to show line numbers for search results.")},"search.usePCRE2":{type:"boolean",default:!1,description:R.NC("search.usePCRE2","Whether to use the PCRE2 regex engine in text search. This enables using some advanced regex features like lookahead and backreferences. However, not all PCRE2 features are supported - only features that are also supported by JavaScript."),deprecationMessage:R.NC("usePCRE2Deprecated","Deprecated. PCRE2 will be used automatically when using regex features that are only supported by PCRE2.")},"search.actionsPosition":{type:"string",enum:["auto","right"],enumDescriptions:[R.NC("search.actionsPositionAuto","Position the actionbar to the right when the search view is narrow, and immediately after the content when the search view is wide."),R.NC("search.actionsPositionRight","Always position the actionbar to the right.")],default:"right",description:R.NC("search.actionsPosition","Controls the positioning of the actionbar on rows in the search view.")},"search.searchOnType":{type:"boolean",default:!0,description:R.NC("search.searchOnType","Search all files as you type.")},"search.seedWithNearestWord":{type:"boolean",default:!1,description:R.NC("search.seedWithNearestWord","Enable seeding search from the word nearest the cursor when the active editor has no selection.")},"search.seedOnFocus":{type:"boolean",default:!1,markdownDescription:R.NC("search.seedOnFocus","Update the search query to the editor's selected text when focusing the search view. This happens either on click or when triggering the `workbench.views.search.focus` command.")},"search.searchOnTypeDebouncePeriod":{type:"number",default:300,markdownDescription:R.NC("search.searchOnTypeDebouncePeriod","When {0} is enabled, controls the timeout in milliseconds between a character being typed and the search starting. Has no effect when {0} is disabled.","`#search.searchOnType#`")},"search.searchEditor.doubleClickBehaviour":{type:"string",enum:["selectWord","goToLocation","openLocationToSide"],default:"goToLocation",enumDescriptions:[R.NC("search.searchEditor.doubleClickBehaviour.selectWord","Double-clicking selects the word under the cursor."),R.NC("search.searchEditor.doubleClickBehaviour.goToLocation","Double-clicking opens the result in the active editor group."),R.NC("search.searchEditor.doubleClickBehaviour.openLocationToSide","Double-clicking opens the result in the editor group to the side, creating one if it does not yet exist.")],markdownDescription:R.NC("search.searchEditor.doubleClickBehaviour","Configure effect of double-clicking a result in a search editor.")},"search.searchEditor.reusePriorSearchConfiguration":{type:"boolean",default:!1,markdownDescription:R.NC({key:"search.searchEditor.reusePriorSearchConfiguration",comment:['"Search Editor" is a type of editor that can display search results. "includes, excludes, and flags" refers to the "files to include" and "files to exclude" input boxes, and the flags that control whether a query is case-sensitive or a regex.']},"When enabled, new Search Editors will reuse the includes, excludes, and flags of the previously opened Search Editor.")},"search.searchEditor.defaultNumberOfContextLines":{type:["number","null"],default:1,markdownDescription:R.NC("search.searchEditor.defaultNumberOfContextLines","The default number of surrounding context lines to use when creating new Search Editors. If using `#search.searchEditor.reusePriorSearchConfiguration#`, this can be set to `null` (empty) to use the prior Search Editor's configuration.")},"search.sortOrder":{type:"string",enum:["default","fileNames","type","modified","countDescending","countAscending"],default:"default",enumDescriptions:[R.NC("searchSortOrder.default","Results are sorted by folder and file names, in alphabetical order."),R.NC("searchSortOrder.filesOnly","Results are sorted by file names ignoring folder order, in alphabetical order."),R.NC("searchSortOrder.type","Results are sorted by file extensions, in alphabetical order."),R.NC("searchSortOrder.modified","Results are sorted by file last modified date, in descending order."),R.NC("searchSortOrder.countDescending","Results are sorted by count per file, in descending order."),R.NC("searchSortOrder.countAscending","Results are sorted by count per file, in ascending order.")],description:R.NC("search.sortOrder","Controls sorting order of search results.")},"search.decorations.colors":{type:"boolean",description:R.NC("search.decorations.colors","Controls whether search file decorations should use colors."),default:!0},"search.decorations.badges":{type:"boolean",description:R.NC("search.decorations.badges","Controls whether search file decorations should use badges."),default:!0},"search.defaultViewMode":{type:"string",enum:["tree","list"],default:"list",enumDescriptions:[R.NC("scm.defaultViewMode.tree","Shows search results as a tree."),R.NC("scm.defaultViewMode.list","Shows search results as a list.")],description:R.NC("search.defaultViewMode","Controls the default search result view mode.")},"search.experimental.closedNotebookRichContentResults":{type:"boolean",description:R.NC("search.experimental.closedNotebookResults","Show notebook editor rich content results for closed notebooks. Please refresh your search results after changing this setting."),default:!1}}}),Ki.P.registerCommand("_executeWorkspaceSymbolProvider",(async function(e,...t){const[i]=t;return(0,g.p_)("string"==typeof i),(await(0,ae.$g)(i)).map((e=>e.symbol))}));var Co=i(83240),bo=i(88813),xo=i(50187),Eo=i(71765),ko=i(88802),Io=i(20566),Ro=i(28820),_o=function(e,t){return function(i,s){t(i,s,e)}};const Fo="ignoreUnusualLineTerminators";let Ao=class extends l.JT{constructor(e,t,i){super(),this._editor=e,this._dialogService=t,this._codeEditorService=i,this._isPresentingDialog=!1,this._config=this._editor.getOption(124),this._register(this._editor.onDidChangeConfiguration((e=>{e.hasChanged(124)&&(this._config=this._editor.getOption(124),this._checkForUnusualLineTerminators())}))),this._register(this._editor.onDidChangeModel((()=>{this._checkForUnusualLineTerminators()}))),this._register(this._editor.onDidChangeModelContent((e=>{e.isUndoing||this._checkForUnusualLineTerminators()}))),this._checkForUnusualLineTerminators()}_checkForUnusualLineTerminators(){return e=this,t=void 0,s=function*(){if("off"===this._config)return;if(!this._editor.hasModel())return;const e=this._editor.getModel();if(!e.mightContainUnusualLineTerminators())return;const t=function(e,t){return e.getModelProperty(t.uri,Fo)}(this._codeEditorService,e);if(!0===t)return;if(this._editor.getOption(89))return;if("auto"===this._config)return void e.removeUnusualLineTerminators(this._editor.getSelections());if(this._isPresentingDialog)return;let i;try{this._isPresentingDialog=!0,i=yield this._dialogService.confirm({title:R.NC("unusualLineTerminators.title","Unusual Line Terminators"),message:R.NC("unusualLineTerminators.message","Detected unusual line terminators"),detail:R.NC("unusualLineTerminators.detail","The file '{0}' contains one or more unusual line terminator characters, like Line Separator (LS) or Paragraph Separator (PS).\n\nIt is recommended to remove them from the file. This can be configured via `editor.unusualLineTerminators`.",(0,L.EZ)(e.uri)),primaryButton:R.NC({key:"unusualLineTerminators.fix",comment:["&& denotes a mnemonic"]},"&&Remove Unusual Line Terminators"),cancelButton:R.NC("unusualLineTerminators.ignore","Ignore")})}finally{this._isPresentingDialog=!1}i.confirmed?e.removeUnusualLineTerminators(this._editor.getSelections()):function(e,t,i){e.setModelProperty(t.uri,Fo,!0)}(this._codeEditorService,e)},new((i=void 0)||(i=Promise))((function(r,o){function n(e){try{c(s.next(e))}catch(e){o(e)}}function a(e){try{c(s.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(n,a)}c((s=s.apply(e,t||[])).next())}));var e,t,i,s}};Ao.ID="editor.contrib.unusualLineTerminatorsDetector",Ao=function(e,t,i,s){var r,o=arguments.length,n=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(n=(o<3?r(n):o>3?r(t,i,n):r(t,i))||n);return o>3&&n&&Object.defineProperty(t,i,n),n}([_o(1,Ro.Ss),_o(2,xe.$)],Ao),(0,ke._K)(Ao.ID,Ao,1);const No=/^(\s+)(\d+)(: |  )(\s*)(.*)$/,To=/^(\S.*):$/;let Mo=class e extends Io.e{static{this.ID=cr}static{this.SEARCH_EDITOR_VIEW_STATE_PREFERENCE_KEY="searchEditorViewState"}get searchResultEditor(){return this.editorControl}constructor(t,i,s,r,o,n,c,h,d,u,g,p,f,m,v,S,y,w){super(e.ID,t,c,s,f,i,v,m,y),this.modelService=r,this.contextService=o,this.labelService=n,this.contextViewService=h,this.commandService=d,this.openerService=u,this.notificationService=g,this.configurationService=S,this.logService=w,this.runSearchDelayer=new a.vp(0),this.pauseSearching=!1,this.showingIncludesExcludes=!1,this.ongoingOperations=0,this.updatingModelForSearch=!1,this.container=Ae.$(".search-editor"),this.searchOperation=this._register(new $i.nR(p)),this._register(this.messageDisposables=new l.SL),this.searchHistoryDelayer=new a.vp(2e3),this.searchModel=this._register(this.instantiationService.createInstance(E.hU))}createEditor(e){Ae.R3(e,this.container),this.queryEditorContainer=Ae.R3(this.container,Ae.$(".query-container"));const t=Ae.R3(this.container,Ae.$(".search-results"));super.createEditor(t),this.registerEditorListeners();const i=(0,g.cW)(this.scopedContextKeyService);rr.bindTo(i).set(!0),this.createQueryEditor(this.queryEditorContainer,this.instantiationService.createChild(new Qi.y([z.i6,i])),Rs.bindTo(i))}createQueryEditor(e,t,i){const s=(0,Gi.tJ)({inputBorder:Po});this.queryEditorWidget=this._register(t.createInstance(_r,e,{_hideReplaceToggle:!0,showContextToggle:!0,inputBoxStyles:s,toggleStyles:Gi.pl})),this._register(this.queryEditorWidget.onReplaceToggled((()=>this.reLayout()))),this._register(this.queryEditorWidget.onDidHeightChange((()=>this.reLayout()))),this._register(this.queryEditorWidget.onSearchSubmit((({delay:e})=>this.triggerSearch({delay:e})))),this.queryEditorWidget.searchInput?this._register(this.queryEditorWidget.searchInput.onDidOptionChange((()=>this.triggerSearch({resetCursor:!1})))):this.logService.warn("SearchEditor: SearchWidget.searchInput is undefined, cannot register onDidOptionChange listener"),this._register(this.queryEditorWidget.onDidToggleContext((()=>this.triggerSearch({resetCursor:!1})))),this.includesExcludesContainer=Ae.R3(e,Ae.$(".includes-excludes")),this.toggleQueryDetailsButton=Ae.R3(this.includesExcludesContainer,Ae.$(".expand"+St.kS.asCSSSelector(Kt),{tabindex:0,role:"button",title:(0,R.NC)("moreSearch","Toggle Search Details")})),this._register(Ae.nm(this.toggleQueryDetailsButton,Ae.tw.CLICK,(e=>{Ae.zB.stop(e),this.toggleIncludesExcludes()}))),this._register(Ae.nm(this.toggleQueryDetailsButton,Ae.tw.KEY_UP,(e=>{const t=new oi.y1(e);(t.equals(3)||t.equals(10))&&(Ae.zB.stop(e),this.toggleIncludesExcludes())}))),this._register(Ae.nm(this.toggleQueryDetailsButton,Ae.tw.KEY_DOWN,(e=>{new oi.y1(e).equals(1026)&&(this.queryEditorWidget.isReplaceActive()?this.queryEditorWidget.focusReplaceAllAction():this.queryEditorWidget.isReplaceShown()?this.queryEditorWidget.replaceInput?.focusOnPreserve():this.queryEditorWidget.focusRegexAction(),Ae.zB.stop(e))})));const r=Ae.R3(this.includesExcludesContainer,Ae.$(".file-types.includes")),o=(0,R.NC)("searchScope.includes","files to include");Ae.R3(r,Ae.$("h4",void 0,o)),this.inputPatternIncludes=this._register(t.createInstance(rs,r,this.contextViewService,{ariaLabel:(0,R.NC)("label.includes","Search Include Patterns"),inputBoxStyles:s})),this.inputPatternIncludes.onSubmit((e=>this.triggerSearch({resetCursor:!1,delay:e?this.searchConfig.searchOnTypeDebouncePeriod:0}))),this._register(this.inputPatternIncludes.onChangeSearchInEditorsBox((()=>this.triggerSearch())));const n=Ae.R3(this.includesExcludesContainer,Ae.$(".file-types.excludes")),a=(0,R.NC)("searchScope.excludes","files to exclude");Ae.R3(n,Ae.$("h4",void 0,a)),this.inputPatternExcludes=this._register(t.createInstance(os,n,this.contextViewService,{ariaLabel:(0,R.NC)("label.excludes","Search Exclude Patterns"),inputBoxStyles:s})),this.inputPatternExcludes.onSubmit((e=>this.triggerSearch({resetCursor:!1,delay:e?this.searchConfig.searchOnTypeDebouncePeriod:0}))),this._register(this.inputPatternExcludes.onChangeIgnoreBox((()=>this.triggerSearch()))),this.messageBox=Ae.R3(e,Ae.$(".messages.text-search-provider-messages")),[this.queryEditorWidget.searchInputFocusTracker,this.queryEditorWidget.replaceInputFocusTracker,this.inputPatternExcludes.inputFocusTracker,this.inputPatternIncludes.inputFocusTracker].forEach((e=>{e&&(this._register(e.onDidFocus((()=>setTimeout((()=>i.set(!0)),0)))),this._register(e.onDidBlur((()=>i.set(!1)))))}))}toggleRunAgainMessage(e){if(Ae.PO(this.messageBox),this.messageDisposables.clear(),e){const e=Ae.R3(this.messageBox,Ae.$("a.pointer.prominent.message",{},(0,R.NC)("runSearch","Run Search")));this.messageDisposables.add(Ae.nm(e,Ae.tw.CLICK,(async()=>{await this.triggerSearch(),this.searchResultEditor.focus()})))}}_getContributions(){const e=[Ao.ID];return ke.Uc.getEditorContributions().filter((t=>-1===e.indexOf(t.id)))}getCodeEditorWidgetOptions(){return{contributions:this._getContributions()}}registerEditorListeners(){this.searchResultEditor.onMouseUp((e=>{if(2===e.event.detail){const t=this.searchConfig.searchEditor.doubleClickBehaviour,i=e.target.position;if(i&&"selectWord"!==t){const e=this.searchResultEditor.getModel()?.getLineContent(i.lineNumber)??"";e.match(No)?(this.searchResultEditor.setSelection(P.e.fromPositions(i)),this.commandService.executeCommand("goToLocation"===t?"editor.action.goToDeclaration":"editor.action.openDeclarationToTheSide")):e.match(To)&&(this.searchResultEditor.setSelection(P.e.fromPositions(i)),this.commandService.executeCommand("editor.action.peekDefinition"))}}})),this._register(this.searchResultEditor.onDidChangeModelContent((()=>{this.updatingModelForSearch||this.getInput()?.setDirty(!0)})))}getControl(){return this.searchResultEditor}focus(){const e=this.loadEditorViewState(this.getInput());e&&"editor"===e.focused?this.searchResultEditor.focus():this.queryEditorWidget.focus()}focusSearchInput(){this.queryEditorWidget.searchInput?.focus()}focusFilesToIncludeInput(){this.showingIncludesExcludes||this.toggleIncludesExcludes(!0),this.inputPatternIncludes.focus()}focusFilesToExcludeInput(){this.showingIncludesExcludes||this.toggleIncludesExcludes(!0),this.inputPatternExcludes.focus()}focusNextInput(){this.queryEditorWidget.searchInputHasFocus()?this.showingIncludesExcludes?this.inputPatternIncludes.focus():this.searchResultEditor.focus():this.inputPatternIncludes.inputHasFocus()?this.inputPatternExcludes.focus():this.inputPatternExcludes.inputHasFocus()?this.searchResultEditor.focus():this.searchResultEditor.hasWidgetFocus()}focusPrevInput(){this.queryEditorWidget.searchInputHasFocus()?this.searchResultEditor.focus():this.inputPatternIncludes.inputHasFocus()?this.queryEditorWidget.searchInput?.focus():this.inputPatternExcludes.inputHasFocus()?this.inputPatternIncludes.focus():this.searchResultEditor.hasWidgetFocus()}setQuery(e){this.queryEditorWidget.searchInput?.setValue(e)}selectQuery(){this.queryEditorWidget.searchInput?.select()}toggleWholeWords(){this.queryEditorWidget.searchInput?.setWholeWords(!this.queryEditorWidget.searchInput.getWholeWords()),this.triggerSearch({resetCursor:!1})}toggleRegex(){this.queryEditorWidget.searchInput?.setRegex(!this.queryEditorWidget.searchInput.getRegex()),this.triggerSearch({resetCursor:!1})}toggleCaseSensitive(){this.queryEditorWidget.searchInput?.setCaseSensitive(!this.queryEditorWidget.searchInput.getCaseSensitive()),this.triggerSearch({resetCursor:!1})}toggleContextLines(){this.queryEditorWidget.toggleContextLines()}modifyContextLines(e){this.queryEditorWidget.modifyContextLines(e)}toggleQueryDetails(){this.toggleIncludesExcludes()}deleteResultBlock(){const e=new Set,t=this.searchResultEditor.getSelections(),i=this.searchResultEditor.getModel();if(!t||!i)return;const s=i.getLineCount(),r=t=>{for(let s=t;s>=1;s--){const t=i.getLineContent(s);if(e.add(s),void 0!==t[0]&&" "!==t[0])break}},o=t=>{e.add(t);for(let r=t+1;r<=s;r++){const t=i.getLineContent(r);if(void 0!==t[0]&&" "!==t[0])return r;e.add(r)}},n=[];for(const i of t){const t=i.startLineNumber;n.push(o(t)),r(t);for(let t=i.startLineNumber;t<=i.endLineNumber;t++)e.add(t)}0===n.length&&n.push(1);const a=e=>void 0!==e;i.pushEditOperations(this.searchResultEditor.getSelections(),[...e].map((e=>({range:new P.e(e,1,e+1,1),text:""}))),(()=>n.filter(a).map((e=>new hi.Y(e,1,e,1)))))}cleanState(){this.getInput()?.setDirty(!1)}get searchConfig(){return this.configurationService.getValue("search")}iterateThroughMatches(e){const t=this.searchResultEditor.getModel();if(!t)return;const i=t.getLineCount()??1,s=t.getLineLength(i),r=e?new xo.L(i,s):new xo.L(1,1),o=this.searchResultEditor.getSelection()?.getStartPosition()??r,n=this.getInput()?.getMatchRanges();if(!n)return;const a=(e?Wo:Oo)(n,o);this.searchResultEditor.setSelection(a),this.searchResultEditor.revealLineInCenterIfOutsideViewport(a.startLineNumber),this.searchResultEditor.focus();const c=t.getLineContent(a.startLineNumber),l=t.getValueInRange(a);let h="";for(let e=a.startLineNumber;e>=1;e--)if(" "!==t.getValueInRange(new P.e(e,1,e,2))){h=t.getLineContent(e);break}(0,ni.Z9)((0,R.NC)("searchResultItem","Matched {0} at {1} in file {2}",l,c,h.slice(0,h.length-1)))}focusNextResult(){this.iterateThroughMatches(!1)}focusPreviousResult(){this.iterateThroughMatches(!0)}focusAllResults(){this.searchResultEditor.setSelections((this.getInput()?.getMatchRanges()??[]).map((e=>new hi.Y(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn)))),this.searchResultEditor.focus()}async triggerSearch(e){const t={resetCursor:!0,delay:0,...e};this.pauseSearching||await this.runSearchDelayer.trigger((async()=>{this.toggleRunAgainMessage(!1),await this.doRunSearch(),t.resetCursor&&(this.searchResultEditor.setPosition(new xo.L(1,1)),this.searchResultEditor.setScrollPosition({scrollTop:0,scrollLeft:0})),t.focusResults&&this.searchResultEditor.focus()}),t.delay)}readConfigFromWidget(){return{isCaseSensitive:this.queryEditorWidget.searchInput?.getCaseSensitive()??!1,contextLines:this.queryEditorWidget.getContextLines(),filesToExclude:this.inputPatternExcludes.getValue(),filesToInclude:this.inputPatternIncludes.getValue(),query:this.queryEditorWidget.searchInput?.getValue()??"",isRegexp:this.queryEditorWidget.searchInput?.getRegex()??!1,matchWholeWord:this.queryEditorWidget.searchInput?.getWholeWords()??!1,useExcludeSettingsAndIgnoreFiles:this.inputPatternExcludes.useExcludesAndIgnoreFiles(),onlyOpenEditors:this.inputPatternIncludes.onlySearchInOpenEditors(),showIncludesExcludes:this.showingIncludesExcludes,notebookSearchConfig:{includeMarkupInput:this.queryEditorWidget.getNotebookFilters().markupInput,includeMarkupPreview:this.queryEditorWidget.getNotebookFilters().markupPreview,includeCodeInput:this.queryEditorWidget.getNotebookFilters().codeInput,includeOutput:this.queryEditorWidget.getNotebookFilters().codeOutput}}}async doRunSearch(){this.searchModel.cancelSearch(!0);const e=this.getInput();if(!e)return;this.searchHistoryDelayer.trigger((()=>{this.queryEditorWidget.searchInput?.onSearchSubmit(),this.inputPatternExcludes.onSearchSubmit(),this.inputPatternIncludes.onSearchSubmit()}));const t=this.readConfigFromWidget();if(!t.query)return;const i={pattern:t.query,isRegExp:t.isRegexp,isCaseSensitive:t.isCaseSensitive,isWordMatch:t.matchWholeWord},s={_reason:"searchEditor",extraFileResources:this.instantiationService.invokeFunction(ae.ek),maxResults:(0,g.f6)(this.searchConfig.maxResults),disregardIgnoreFiles:!t.useExcludeSettingsAndIgnoreFiles||void 0,disregardExcludeSettings:!t.useExcludeSettingsAndIgnoreFiles||void 0,excludePattern:t.filesToExclude,includePattern:t.filesToInclude,onlyOpenEditors:t.onlyOpenEditors,previewOptions:{matchLines:1,charsPerLine:1e3},afterContext:t.contextLines,beforeContext:t.contextLines,isSmartCase:this.searchConfig.smartCase,expandPatterns:!0,notebookSearchConfig:{includeMarkupInput:t.notebookSearchConfig.includeMarkupInput,includeMarkupPreview:t.notebookSearchConfig.includeMarkupPreview,includeCodeInput:t.notebookSearchConfig.includeCodeInput,includeOutput:t.notebookSearchConfig.includeOutput}},r=this.contextService.getWorkspace().folders;let o;try{o=this.instantiationService.createInstance(ne.z).text(i,r.map((e=>e.uri)),s)}catch(e){return}this.searchOperation.start(500),this.ongoingOperations++;const{configurationModel:n}=await e.resolveModels();n.updateConfig(t),e.ongoingSearchOperation=this.searchModel.search(o).finally((()=>{this.ongoingOperations--,0===this.ongoingOperations&&this.searchOperation.stop()}));const a=await e.ongoingSearchOperation;await this.onSearchComplete(a,t,e)}async onSearchComplete(e,t,i){const s=this.getInput();if(!s||s!==i||JSON.stringify(t)!==JSON.stringify(this.readConfigFromWidget()))return;s.ongoingSearchOperation=void 0;const r=this.searchConfig.sortOrder;"modified"===r&&await this.retrieveFileStats(this.searchModel.searchResult);const o=ko.J.get(this.searchResultEditor);o?.closeWidget(!1);const n=Mr(this.searchModel.searchResult,t.filesToInclude,t.filesToExclude,t.contextLines,(e=>this.labelService.getUriLabel(e,{relative:!0})),r,e?.limitHit),{resultsModel:a}=await s.resolveModels();if(this.updatingModelForSearch=!0,this.modelService.updateModel(a,n.text),this.updatingModelForSearch=!1,e&&e.messages)for(const t of e.messages)this.addMessage(t);this.reLayout(),s.setDirty(!s.hasCapability(4)),s.setMatchRanges(n.matchRanges)}addMessage(e){let t;t=this.messageBox.firstChild?this.messageBox.firstChild:Ae.R3(this.messageBox,Ae.$(".message")),Ae.R3(t,ms(e,this.instantiationService,this.notificationService,this.openerService,this.commandService,this.messageDisposables,(()=>this.triggerSearch())))}async retrieveFileStats(e){const t=e.matches().filter((e=>!e.fileStat)).map((e=>e.resolveFileStat(this.fileService)));await Promise.all(t)}layout(e){this.dimension=e,this.reLayout()}getSelected(){const e=this.searchResultEditor.getSelection();return e?this.searchResultEditor.getModel()?.getValueInRange(e)??"":""}reLayout(){this.dimension&&(this.queryEditorWidget.setWidth(this.dimension.width-28),this.searchResultEditor.layout({height:this.dimension.height-Ae.wn(this.queryEditorContainer),width:this.dimension.width}),this.inputPatternExcludes.setWidth(this.dimension.width-28),this.inputPatternIncludes.setWidth(this.dimension.width-28))}getInput(){return this._input}setSearchConfig(e){this.priorConfig=e,void 0!==e.query&&this.queryEditorWidget.setValue(e.query),void 0!==e.isCaseSensitive&&this.queryEditorWidget.searchInput?.setCaseSensitive(e.isCaseSensitive),void 0!==e.isRegexp&&this.queryEditorWidget.searchInput?.setRegex(e.isRegexp),void 0!==e.matchWholeWord&&this.queryEditorWidget.searchInput?.setWholeWords(e.matchWholeWord),void 0!==e.contextLines&&this.queryEditorWidget.setContextLines(e.contextLines),void 0!==e.filesToExclude&&this.inputPatternExcludes.setValue(e.filesToExclude),void 0!==e.filesToInclude&&this.inputPatternIncludes.setValue(e.filesToInclude),void 0!==e.onlyOpenEditors&&this.inputPatternIncludes.setOnlySearchInOpenEditors(e.onlyOpenEditors),void 0!==e.useExcludeSettingsAndIgnoreFiles&&this.inputPatternExcludes.setUseExcludesAndIgnoreFiles(e.useExcludeSettingsAndIgnoreFiles),void 0!==e.showIncludesExcludes&&this.toggleIncludesExcludes(e.showIncludesExcludes)}async setInput(e,t,i,s){if(await super.setInput(e,t,i,s),s.isCancellationRequested)return;const{configurationModel:r,resultsModel:o}=await e.resolveModels();if(!s.isCancellationRequested&&(this.searchResultEditor.setModel(o),this.pauseSearching=!0,this.toggleRunAgainMessage(!e.ongoingSearchOperation&&1===o.getLineCount()&&""===o.getValue()&&""!==r.config.query),this.setSearchConfig(r.config),this._register(r.onConfigDidUpdate((e=>{e!==this.priorConfig&&(this.pauseSearching=!0,this.setSearchConfig(e),this.pauseSearching=!1)}))),this.restoreViewState(i),t?.preserveFocus||this.focus(),this.pauseSearching=!1,e.ongoingSearchOperation)){const t=this.readConfigFromWidget();e.ongoingSearchOperation.then((i=>{this.onSearchComplete(i,t,e)}))}}toggleIncludesExcludes(e){const t="expanded";e??!this.includesExcludesContainer.classList.contains(t)?(this.toggleQueryDetailsButton.setAttribute("aria-expanded","true"),this.includesExcludesContainer.classList.add(t)):(this.toggleQueryDetailsButton.setAttribute("aria-expanded","false"),this.includesExcludesContainer.classList.remove(t)),this.showingIncludesExcludes=this.includesExcludesContainer.classList.contains(t),this.reLayout()}toEditorViewStateResource(e){if(e.typeId===dr)return e.modelUri}computeEditorViewState(e){const t=this.getControl().saveViewState();if(t&&e.toString()===this.getInput()?.modelUri.toString())return{...t,focused:this.searchResultEditor.hasWidgetFocus()?"editor":"input"}}tracksEditorViewState(e){return e.typeId===dr}restoreViewState(e){const t=this.loadEditorViewState(this.getInput(),e);t&&this.searchResultEditor.restoreViewState(t)}getAriaLabel(){return this.getInput()?.getName()??(0,R.NC)("searchEditor","Search")}};Mo=(0,o.g)([(0,o.f)(0,v.bU),(0,o.f)(1,st.XE),(0,o.f)(2,it.Uy),(0,o.f)(3,p.q),(0,o.f)(4,ce.ec),(0,o.f)(5,W.e),(0,o.f)(6,A.TG),(0,o.f)(7,Ze.u),(0,o.f)(8,Ki.H),(0,o.f)(9,be.v4),(0,o.f)(10,tt.lT),(0,o.f)(11,$i.ek),(0,o.f)(12,Eo.V),(0,o.f)(13,Gr.Qw),(0,o.f)(14,w.AR),(0,o.f)(15,fe.Ui),(0,o.f)(16,f.sn),(0,o.f)(17,m.VZ)],Mo);const Po=(0,Ge.P6G)("searchEditor.textInputBorder",{dark:Ge.dt_,light:Ge.dt_,hcDark:Ge.dt_,hcLight:Ge.dt_},(0,R.NC)("textInputBoxBorder","Search editor text input box border."));function Oo(e,t){for(const i of e)if(xo.L.isBefore(t,i.getStartPosition()))return i;return e[0]}function Wo(e,t){for(let i=e.length-1;i>=0;i--){const s=e[i];if(xo.L.isBefore(s.getStartPosition(),t))return s}return e[e.length-1]}var Lo=i(32049),Do=i(44633);Y.B.as(y.bS.EditorPane).registerEditorPane(Co.gS.create(Mo,Mo.ID,(0,R.NC)("searchEditor","Search Editor")),[new s.M(Qr)]);let Bo=class{constructor(e,t){e.registerEditor("*"+Kr,{id:Qr.ID,label:(0,R.NC)("promptOpenWith.searchEditor.displayName","Search Editor"),detail:y.Cr.providerDisplayName,priority:Lo.OP.default},{singlePerResource:!0,canSupportResource:e=>(0,L.DZ)(e)===Kr},{createEditorInput:({resource:e})=>({editor:t.invokeFunction(Ur,{from:"existingFile",fileUri:e})})})}};Bo=(0,o.g)([(0,o.f)(0,Lo.es),(0,o.f)(1,A.TG)],Bo);const qo=Y.B.as(Vt.I.Workbench);qo.registerWorkbenchContribution(Bo,1),Ki.P.registerCommand("cleanSearchEditorState",(e=>{const t=e.get(w.AR).activeEditorPane;t instanceof Mo&&t.cleanState()}));const Ho={value:(0,R.NC)("search","Search Editor"),original:"Search Editor"},Vo=(e={})=>{const t={},i={includes:"filesToInclude",excludes:"filesToExclude",wholeWord:"matchWholeWord",caseSensitive:"isCaseSensitive",regexp:"isRegexp",useIgnores:"useExcludeSettingsAndIgnoreFiles"};return Object.entries(e).forEach((([e,s])=>{t[i[e]??e]=s})),t},Ko={description:"Open a new search editor. Arguments passed can include variables like ${relativeFileDirname}.",args:[{name:"Open new Search Editor args",schema:{properties:{query:{type:"string"},filesToInclude:{type:"string"},filesToExclude:{type:"string"},contextLines:{type:"number"},matchWholeWord:{type:"boolean"},isCaseSensitive:{type:"boolean"},isRegexp:{type:"boolean"},useExcludeSettingsAndIgnoreFiles:{type:"boolean"},showIncludesExcludes:{type:"boolean"},triggerSearch:{type:"boolean"},focusResults:{type:"boolean"},onlyOpenEditors:{type:"boolean"}}}}]};(0,Xe.r1)(class extends Xe.Ke{constructor(){super({id:"search.searchEditor.action.deleteFileResults",title:{value:(0,R.NC)("searchEditor.deleteResultBlock","Delete File Results"),original:"Delete File Results"},keybinding:{weight:100,primary:3073},precondition:rr,category:Ho,f1:!0})}async run(e){e.get(z.i6).getContext(document.activeElement).getValue(rr.serialize())&&e.get(w.AR).activeEditorPane.deleteResultBlock()}}),(0,Xe.r1)(class extends Xe.Ke{constructor(){super({id:"search.action.openNewEditor",title:{value:(0,R.NC)("search.openNewSearchEditor","New Search Editor"),original:"New Search Editor"},category:Ho,f1:!0,description:Ko})}async run(e,t){await e.get(A.TG).invokeFunction(jr,Vo({location:"new",...t}))}}),(0,Xe.r1)(class extends Xe.Ke{constructor(){super({id:lr,title:{value:(0,R.NC)("search.openSearchEditor","Open Search Editor"),original:"Open Search Editor"},category:Ho,f1:!0,description:Ko})}async run(e,t){await e.get(A.TG).invokeFunction(jr,Vo({location:"reuse",...t}))}}),(0,Xe.r1)(class extends Xe.Ke{constructor(){super({id:"search.action.openNewEditorToSide",title:{value:(0,R.NC)("search.openNewEditorToSide","Open New Search Editor to the Side"),original:"Open new Search Editor to the Side"},category:Ho,f1:!0,description:Ko})}async run(e,t){await e.get(A.TG).invokeFunction(jr,Vo(t),!0)}}),(0,Xe.r1)(class extends Xe.Ke{constructor(){super({id:"search.action.openInEditor",title:{value:(0,R.NC)("search.openResultsInEditor","Open Results in Editor"),original:"Open Results in Editor"},category:Ho,f1:!0,keybinding:{primary:515,when:z.Ao.and(Ms,Is),weight:200,mac:{primary:2051}}})}async run(e){const t=e.get(Z.qC),i=e.get(A.TG),s=cs(t);s&&await i.invokeFunction(Yr,s.searchResult,s.searchIncludePattern.getValue(),s.searchExcludePattern.getValue(),s.searchIncludePattern.onlySearchInOpenEditors())}}),(0,Xe.r1)(class extends Xe.Ke{constructor(){super({id:"rerunSearchEditorSearch",title:{value:(0,R.NC)("search.rerunSearchInEditor","Search Again"),original:"Search Again"},category:Ho,keybinding:{primary:3120,when:rr,weight:100},icon:Yt,menu:[{id:Xe.eH.EditorTitle,group:"navigation",when:bo.cM.isEqualTo(cr)},{id:Xe.eH.CommandPalette,when:bo.cM.isEqualTo(cr)}]})}async run(e){const t=e.get(w.AR);t.activeEditor instanceof Qr&&t.activeEditorPane.triggerSearch({resetCursor:!1})}}),(0,Xe.r1)(class extends Xe.Ke{constructor(){super({id:"search.action.focusQueryEditorWidget",title:{value:(0,R.NC)("search.action.focusQueryEditorWidget","Focus Search Editor Input"),original:"Focus Search Editor Input"},category:Ho,f1:!0,precondition:rr,keybinding:{primary:9,weight:100}})}async run(e){const t=e.get(w.AR);t.activeEditor instanceof Qr&&t.activeEditorPane.focusSearchInput()}}),(0,Xe.r1)(class extends Xe.Ke{constructor(){super({id:"search.action.focusFilesToInclude",title:{value:(0,R.NC)("search.action.focusFilesToInclude","Focus Search Editor Files to Include"),original:"Focus Search Editor Files to Include"},category:Ho,f1:!0,precondition:rr})}async run(e){const t=e.get(w.AR);t.activeEditor instanceof Qr&&t.activeEditorPane.focusFilesToIncludeInput()}}),(0,Xe.r1)(class extends Xe.Ke{constructor(){super({id:"search.action.focusFilesToExclude",title:{value:(0,R.NC)("search.action.focusFilesToExclude","Focus Search Editor Files to Exclude"),original:"Focus Search Editor Files to Exclude"},category:Ho,f1:!0,precondition:rr})}async run(e){const t=e.get(w.AR);t.activeEditor instanceof Qr&&t.activeEditorPane.focusFilesToExcludeInput()}}),(0,Xe.r1)(class extends Xe.Ke{constructor(){super({id:"toggleSearchEditorCaseSensitive",title:{value:(0,R.NC)("searchEditor.action.toggleSearchEditorCaseSensitive","Toggle Match Case"),original:"Toggle Match Case"},category:Ho,f1:!0,precondition:rr,keybinding:Object.assign({weight:200,when:_s},Fe.Dt)})}run(e){(e=>{const t=e.get(w.AR);t.activeEditor instanceof Qr&&t.activeEditorPane.toggleCaseSensitive()})(e)}}),(0,Xe.r1)(class extends Xe.Ke{constructor(){super({id:"toggleSearchEditorWholeWord",title:{value:(0,R.NC)("searchEditor.action.toggleSearchEditorWholeWord","Toggle Match Whole Word"),original:"Toggle Match Whole Word"},category:Ho,f1:!0,precondition:rr,keybinding:Object.assign({weight:200,when:_s},Fe.CP)})}run(e){(e=>{const t=e.get(w.AR);t.activeEditor instanceof Qr&&t.activeEditorPane.toggleWholeWords()})(e)}}),(0,Xe.r1)(class extends Xe.Ke{constructor(){super({id:"toggleSearchEditorRegex",title:{value:(0,R.NC)("searchEditor.action.toggleSearchEditorRegex","Toggle Use Regular Expression"),original:'Toggle Use Regular Expression"'},category:Ho,f1:!0,precondition:rr,keybinding:Object.assign({weight:200,when:_s},Fe.LM)})}run(e){(e=>{const t=e.get(w.AR);t.activeEditor instanceof Qr&&t.activeEditorPane.toggleRegex()})(e)}}),(0,Xe.r1)(class extends Xe.Ke{constructor(){super({id:hr,title:{value:(0,R.NC)("searchEditor.action.toggleSearchEditorContextLines","Toggle Context Lines"),original:'Toggle Context Lines"'},category:Ho,f1:!0,precondition:rr,keybinding:{weight:200,primary:554,mac:{primary:2602}}})}run(e){(e=>{const t=e.get(w.AR);t.activeEditor instanceof Qr&&t.activeEditorPane.toggleContextLines()})(e)}}),(0,Xe.r1)(class extends Xe.Ke{constructor(){super({id:"increaseSearchEditorContextLines",title:{original:"Increase Context Lines",value:(0,R.NC)("searchEditor.action.increaseSearchEditorContextLines","Increase Context Lines")},category:Ho,f1:!0,precondition:rr,keybinding:{weight:200,primary:598}})}run(e){zr(e,!0)}}),(0,Xe.r1)(class extends Xe.Ke{constructor(){super({id:"decreaseSearchEditorContextLines",title:{original:"Decrease Context Lines",value:(0,R.NC)("searchEditor.action.decreaseSearchEditorContextLines","Decrease Context Lines")},category:Ho,f1:!0,precondition:rr,keybinding:{weight:200,primary:600}})}run(e){zr(e,!1)}}),(0,Xe.r1)(class extends Xe.Ke{constructor(){super({id:"selectAllSearchEditorMatches",title:{original:"Select All Matches",value:(0,R.NC)("searchEditor.action.selectAllSearchEditorMatches","Select All Matches")},category:Ho,f1:!0,precondition:rr,keybinding:{weight:200,primary:3114}})}run(e){(e=>{const t=e.get(w.AR);t.activeEditor instanceof Qr&&t.activeEditorPane.focusAllResults()})(e)}}),(0,Xe.r1)(class extends Xe.Ke{constructor(){super({id:"search.action.openNewEditorFromView",title:(0,R.NC)("search.openNewEditor","Open New Search Editor"),category:Ho,icon:ri,menu:[{id:Xe.eH.ViewTitle,group:"navigation",order:2,when:z.Ao.equals("view",r.nn)}]})}run(e,...t){return async function(e){const t=e.get(Z.qC),i=e.get(A.TG),s=cs(t);s?await i.invokeFunction(jr,{filesToInclude:s.searchIncludePattern.getValue(),onlyOpenEditors:s.searchIncludePattern.onlySearchInOpenEditors(),filesToExclude:s.searchExcludePattern.getValue(),isRegexp:s.searchAndReplaceWidget.searchInput?.getRegex(),isCaseSensitive:s.searchAndReplaceWidget.searchInput?.getCaseSensitive(),matchWholeWord:s.searchAndReplaceWidget.searchInput?.getWholeWords(),useExcludeSettingsAndIgnoreFiles:s.searchExcludePattern.useExcludesAndIgnoreFiles(),showIncludesExcludes:!(!s.searchIncludePattern.getValue()&&!s.searchExcludePattern.getValue()&&s.searchExcludePattern.useExcludesAndIgnoreFiles())}):await i.invokeFunction(jr)}(e)}});let Qo=class extends l.JT{constructor(e,t){super(),this.instantiationService=e,this._register(t.registerHandler(this))}handles(e){return e.resource.scheme===or}isOpen(e,t){return!!this.handles(e)&&t instanceof Qr&&(0,L.Xy)(e.resource,t.modelUri)}createEditor(e){const t=this.instantiationService.invokeFunction(Ur,{from:"model",modelUri:e.resource});return t.setDirty(!0),t}};function Uo(){return{[r.x1.toString()]:new s.M(x,[],!0),[E.Zj.toString()]:new s.M(E.pv,[],!0),[k.c.toString()]:new s.M(k.r,[],!0),[I.H.toString()]:new s.M(Q,[],!0)}}Qo=(0,o.g)([(0,o.f)(0,A.TG),(0,o.f)(1,Do.i)],Qo),qo.registerWorkbenchContribution(Qo,2)},96692:(e,t,i)=>{i.d(t,{N:()=>l});var s=i(73046),r=i(63580),o=i(25670);const n=o.kS.asClassName(s.lA.pin),a=o.kS.asClassName(s.lA.pinned),c=[n,a];async function l(e,t,i,s){const r=i.items;let o=h(t,i,e,void 0,s);i.onDidTriggerItemButton((async n=>{n.button.iconClass&&c.includes(n.button.iconClass)&&(i.items=r,o=h(t,i,e,n.item,s),i.items=i.value?r:o)})),i.onDidChangeValue((async e=>{i.items===o&&e?i.items=r:i.items!==r||e||(i.items=o)})),i.items=i.value?r:o,i.show()}function h(e,t,i,s,o){const n=[];let c;c=s?function(e,t,i){const s=t.buttons?.find((e=>e.iconClass===a));let r=g(e,i);return s?r=r.filter((e=>d(e)!==d(t))):r.push(t),i.store(e,JSON.stringify(r),1,1),r}(e,s,i):g(e,i),c.length&&n.push({type:"separator",label:(0,r.NC)("terminal.commands.pinned","pinned")});const l=new Set;for(const e of c){const i=t.items.find((t=>{return i=e,d(t)===d(i);var i}));if(i){const e=d(i),t=Object.assign({},i);o&&l.has(e)||(l.add(e),u(t,!1),n.push(t))}}for(const e of t.items)u(e,!0),n.push(e);return n}function d(e){return"separator"===e.type?"":e.id||`${e.label}${e.description}${e.detail}}`}function u(e,t){if("separator"===e.type)return;const i=e.buttons?.filter((e=>e.iconClass&&!c.includes(e.iconClass)))??[];i.unshift({iconClass:t?n:a,tooltip:t?(0,r.NC)("pinCommand","Pin command"):(0,r.NC)("pinnedCommand","Pinned command"),alwaysVisible:!1}),e.buttons=i}function g(e,t){const i=t.get(e,1);return i?JSON.parse(i):[]}},52433:(e,t,i)=>{i.d(t,{$m:()=>p,Bl:()=>n,DJ:()=>g,QR:()=>a,j8:()=>c,jO:()=>l,mb:()=>d,qT:()=>h,tO:()=>u});var s=i(73046),r=i(63580),o=i(59554);(0,o.q5)("extensions-view-icon",s.lA.extensions,(0,r.NC)("extensionsViewIcon","View icon of the extensions view."));const n=(0,o.q5)("extensions-manage",s.lA.gear,(0,r.NC)("manageExtensionIcon","Icon for the 'Manage' action in the extensions view."));(0,o.q5)("extensions-clear-search-results",s.lA.clearAll,(0,r.NC)("clearSearchResultsIcon","Icon for the 'Clear Search Result' action in the extensions view.")),(0,o.q5)("extensions-refresh",s.lA.refresh,(0,r.NC)("refreshIcon","Icon for the 'Refresh' action in the extensions view."));const a=(0,o.q5)("extensions-filter",s.lA.filter,(0,r.NC)("filterIcon","Icon for the 'Filter' action in the extensions view."));(0,o.q5)("extensions-install-local-in-remote",s.lA.cloudDownload,(0,r.NC)("installLocalInRemoteIcon","Icon for the 'Install Local Extension in Remote' action in the extensions view.")),(0,o.q5)("extensions-install-workspace-recommended",s.lA.cloudDownload,(0,r.NC)("installWorkspaceRecommendedIcon","Icon for the 'Install Workspace Recommended Extensions' action in the extensions view.")),(0,o.q5)("extensions-configure-recommended",s.lA.pencil,(0,r.NC)("configureRecommendedIcon","Icon for the 'Configure Recommended Extensions' action in the extensions view."));const c=(0,o.q5)("extensions-sync-enabled",s.lA.sync,(0,r.NC)("syncEnabledIcon","Icon to indicate that an extension is synced.")),l=(0,o.q5)("extensions-sync-ignored",s.lA.syncIgnored,(0,r.NC)("syncIgnoredIcon","Icon to indicate that an extension is ignored when syncing."));(0,o.q5)("extensions-remote",s.lA.remote,(0,r.NC)("remoteIcon","Icon to indicate that an extension is remote in the extensions view and editor.")),(0,o.q5)("extensions-install-count",s.lA.cloudDownload,(0,r.NC)("installCountIcon","Icon shown along with the install count in the extensions view and editor.")),(0,o.q5)("extensions-rating",s.lA.star,(0,r.NC)("ratingIcon","Icon shown along with the rating in the extensions view and editor.")),(0,o.q5)("extensions-verified-publisher",s.lA.verifiedFilled,(0,r.NC)("verifiedPublisher","Icon used for the verified extension publisher in the extensions view and editor."));const h=(0,o.q5)("extensions-pre-release",s.lA.versions,(0,r.NC)("preReleaseIcon","Icon shown for extensions having pre-release versions in extensions view and editor."));(0,o.q5)("extensions-sponsor",s.lA.heartFilled,(0,r.NC)("sponsorIcon","Icon used for sponsoring extensions in the extensions view and editor.")),(0,o.q5)("extensions-star-full",s.lA.starFull,(0,r.NC)("starFullIcon","Full star icon used for the rating in the extensions editor.")),(0,o.q5)("extensions-star-half",s.lA.starHalf,(0,r.NC)("starHalfIcon","Half star icon used for the rating in the extensions editor.")),(0,o.q5)("extensions-star-empty",s.lA.starEmpty,(0,r.NC)("starEmptyIcon","Empty star icon used for the rating in the extensions editor."));const d=(0,o.q5)("extensions-error-message",s.lA.error,(0,r.NC)("errorIcon","Icon shown with a error message in the extensions editor.")),u=(0,o.q5)("extensions-warning-message",s.lA.warning,(0,r.NC)("warningIcon","Icon shown with a warning message in the extensions editor.")),g=(0,o.q5)("extensions-info-message",s.lA.info,(0,r.NC)("infoIcon","Icon shown with an info message in the extensions editor.")),p=(0,o.q5)("extension-workspace-trust",s.lA.shield,(0,r.NC)("trustIcon","Icon shown with a workspace trust message in the extension editor."));(0,o.q5)("extension-activation-time",s.lA.history,(0,r.NC)("activationtimeIcon","Icon shown with a activation time message in the extension editor."))}}]);
//# sourceMappingURL=101.bundle.js.map